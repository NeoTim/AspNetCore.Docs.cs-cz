# <a name="upload-files-sample-app"></a><span data-ttu-id="4cb03-101">Ukázková aplikace pro nahrání souborů</span><span class="sxs-lookup"><span data-stu-id="4cb03-101">Upload Files Sample App</span></span>

<span data-ttu-id="4cb03-102">Tato ukázková aplikace ukazuje koncepty popsané v tématu [nahrávání souborů v ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads) .</span><span class="sxs-lookup"><span data-stu-id="4cb03-102">This sample app demonstrates concepts described in the [Upload files in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads) topic.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="4cb03-103">Důležité informace o zabezpečení</span><span class="sxs-lookup"><span data-stu-id="4cb03-103">Security considerations</span></span>

<span data-ttu-id="4cb03-104">Pokud chcete uživatelům poskytnout možnost nahrávat soubory na server, buďte opatrní.</span><span class="sxs-lookup"><span data-stu-id="4cb03-104">Use caution when providing users with the ability to upload files to a server.</span></span> <span data-ttu-id="4cb03-105">Útočníci mohou provádět útoky [s cílem odepření služeb](/windows-hardware/drivers/ifs/denial-of-service) , pokus o nahrání virů nebo malwaru nebo pokus o ohrožení sítí a serverů jinými způsoby.</span><span class="sxs-lookup"><span data-stu-id="4cb03-105">Attackers may execute [denial of service](/windows-hardware/drivers/ifs/denial-of-service) attacks, attempt to upload viruses or malware, or attempt to compromise networks and servers in other ways.</span></span>

<span data-ttu-id="4cb03-106">Bezpečnostní kroky, které snižují pravděpodobnost úspěšného útoku, jsou:</span><span class="sxs-lookup"><span data-stu-id="4cb03-106">Security steps that reduce the likelihood of a successful attack are:</span></span>

* <span data-ttu-id="4cb03-107">Nahrajte soubory do vyhrazené oblasti pro nahrání souborů v systému, nejlépe pro nesystémovou jednotku.</span><span class="sxs-lookup"><span data-stu-id="4cb03-107">Upload files to a dedicated file upload area on the system, preferably to a non-system drive.</span></span> <span data-ttu-id="4cb03-108">Použití vyhrazeného umístění usnadňuje ukládání bezpečnostních opatření do odesílaných souborů.</span><span class="sxs-lookup"><span data-stu-id="4cb03-108">Use of a dedicated location makes it easier to impose security measures on uploaded files.</span></span> <span data-ttu-id="4cb03-109">Zakažte oprávnění EXECUTE pro umístění pro nahrání souboru.&dagger;</span><span class="sxs-lookup"><span data-stu-id="4cb03-109">Disable execute permissions on the file upload location.&dagger;</span></span>
* <span data-ttu-id="4cb03-110">Neuchovávat nahrané soubory ve stejném adresářovém stromu jako aplikace.&dagger;</span><span class="sxs-lookup"><span data-stu-id="4cb03-110">Never persist uploaded files in the same directory tree as the app.&dagger;</span></span>
* <span data-ttu-id="4cb03-111">Použijte název bezpečného souboru určený aplikací.</span><span class="sxs-lookup"><span data-stu-id="4cb03-111">Use a safe file name determined by the app.</span></span> <span data-ttu-id="4cb03-112">Nepoužívejte název souboru poskytnutý uživatelským vstupem nebo nedůvěryhodného názvu odeslaného souboru.&dagger;</span><span class="sxs-lookup"><span data-stu-id="4cb03-112">Don't use a file name provided by user input or the untrusted file name of the uploaded file.&dagger;</span></span>
* <span data-ttu-id="4cb03-113">Povoluje pouze konkrétní sadu schválených přípon souborů.&dagger;</span><span class="sxs-lookup"><span data-stu-id="4cb03-113">Only allow a specific set of approved file extensions.&dagger;</span></span>
* <span data-ttu-id="4cb03-114">Ověřte podpis formátu souboru, abyste zabránili uživateli v nahrávání maskovaných souborů (například nahrání souboru *. exe* s příponou *. txt* ).&dagger;</span><span class="sxs-lookup"><span data-stu-id="4cb03-114">Check the file format signature to prevent a user from uploading a masqueraded file (for example, uploading an *.exe* file with a *.txt* extension).&dagger;</span></span>
* <span data-ttu-id="4cb03-115">Ověřte, zda jsou na serveru provedeny také kontroly na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="4cb03-115">Verify that client-side checks are also performed on the server.</span></span> <span data-ttu-id="4cb03-116">Kontroly na straně klienta je snadné obejít.&dagger;</span><span class="sxs-lookup"><span data-stu-id="4cb03-116">Client-side checks are easy to circumvent.&dagger;</span></span>
* <span data-ttu-id="4cb03-117">Ověřte velikost nahrávání a zabraňte nahrávání, které jsou větší, než se očekávalo.&dagger;</span><span class="sxs-lookup"><span data-stu-id="4cb03-117">Check the size of the upload and prevent uploads that are larger than expected.&dagger;</span></span>
* <span data-ttu-id="4cb03-118">Pokud by soubory neměly být přepsány nahraným souborem se stejným názvem, před nahráním souboru ověřte název souboru proti databázi nebo fyzickému úložišti.</span><span class="sxs-lookup"><span data-stu-id="4cb03-118">When files shouldn't be overwritten by an uploaded file with the same name, check the file name against the database or physical storage before uploading the file.</span></span>
* <span data-ttu-id="4cb03-119">**Před uložením souboru spusťte v nahraném obsahu skener virů nebo malwaru.**</span><span class="sxs-lookup"><span data-stu-id="4cb03-119">**Run a virus/malware scanner on uploaded content before the file is stored.**</span></span>

<span data-ttu-id="4cb03-120">&dagger;ukázková aplikace ukazuje přístup, který splňuje kritéria.</span><span class="sxs-lookup"><span data-stu-id="4cb03-120">&dagger;The sample app demonstrates an approach that meets the criteria.</span></span>

> [!WARNING]
> <span data-ttu-id="4cb03-121">Nahrává se škodlivý kód do systému je často prvním krokem při provádění kódu, který můžete:</span><span class="sxs-lookup"><span data-stu-id="4cb03-121">Uploading malicious code to a system is frequently the first step to executing code that can:</span></span>
>
> * <span data-ttu-id="4cb03-122">Úplné převzetí systému.</span><span class="sxs-lookup"><span data-stu-id="4cb03-122">Completely takeover a system.</span></span>
> * <span data-ttu-id="4cb03-123">Přetížit systém s výsledkem, že dojde k chybě systému.</span><span class="sxs-lookup"><span data-stu-id="4cb03-123">Overload a system with the result that the system crashes.</span></span>
> * <span data-ttu-id="4cb03-124">Ohrozit data uživatele nebo systému.</span><span class="sxs-lookup"><span data-stu-id="4cb03-124">Compromise user or system data.</span></span>
> * <span data-ttu-id="4cb03-125">Použijte graffiti pro veřejné uživatelské rozhraní.</span><span class="sxs-lookup"><span data-stu-id="4cb03-125">Apply graffiti to a public UI.</span></span>
>
> <span data-ttu-id="4cb03-126">Informace o omezení možností útoku, při přijetí soubory od uživatelů najdete v následujících zdrojích:</span><span class="sxs-lookup"><span data-stu-id="4cb03-126">For information on reducing the attack surface area when accepting files from users, see the following resources:</span></span>
>
> * [<span data-ttu-id="4cb03-127">Nahrání souboru bez omezení</span><span class="sxs-lookup"><span data-stu-id="4cb03-127">Unrestricted File Upload</span></span>](https://www.owasp.org/index.php/Unrestricted_File_Upload)
> * [<span data-ttu-id="4cb03-128">Zabezpečení Azure: Ujistěte se, že odpovídající ovládací prvky jsou na místě při přijetí soubory od uživatelů</span><span class="sxs-lookup"><span data-stu-id="4cb03-128">Azure Security: Ensure appropriate controls are in place when accepting files from users</span></span>](/azure/security/azure-security-threat-modeling-tool-input-validation#controls-users)

<span data-ttu-id="4cb03-129">Další informace najdete v tématu [nahrání souborů v ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads).</span><span class="sxs-lookup"><span data-stu-id="4cb03-129">For additional information, see [Upload files in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads).</span></span>

## <a name="how-to-use-the-sample"></a><span data-ttu-id="4cb03-130">Jak používat ukázku</span><span class="sxs-lookup"><span data-stu-id="4cb03-130">How to use the sample</span></span>

<span data-ttu-id="4cb03-131">V souboru *appSettings. JSON* :</span><span class="sxs-lookup"><span data-stu-id="4cb03-131">In the *appsettings.json* file:</span></span>

1. <span data-ttu-id="4cb03-132">Nastavte cestu pro uložené soubory (`StoredFilesPath`).</span><span class="sxs-lookup"><span data-stu-id="4cb03-132">Set the path for stored files (`StoredFilesPath`).</span></span>

   * <span data-ttu-id="4cb03-133">Ukázková aplikace nastaví hodnotu na `c:\\files`, což předpokládá, že složka s názvem *Files* existuje v kořenu jednotky C:.</span><span class="sxs-lookup"><span data-stu-id="4cb03-133">The sample app sets the value to `c:\\files`, which assumes that a folder named *files* exists at the system's C: drive root.</span></span>
   * <span data-ttu-id="4cb03-134">Cesta musí existovat.</span><span class="sxs-lookup"><span data-stu-id="4cb03-134">The path must exist.</span></span> <span data-ttu-id="4cb03-135">Vytvořte složku *soubory* na jednotce C: a nastavte cestu na vhodné umístění.</span><span class="sxs-lookup"><span data-stu-id="4cb03-135">Create a *files* folder on the system's C: drive or set the path to a suitable location.</span></span>
   * <span data-ttu-id="4cb03-136">Proces aplikace vyžaduje pro cestu oprávnění ke čtení a zápisu.</span><span class="sxs-lookup"><span data-stu-id="4cb03-136">The app's process requires read/write permissions to the path.</span></span>
   * <span data-ttu-id="4cb03-137">**VÝZNAMNÁ!**</span><span class="sxs-lookup"><span data-stu-id="4cb03-137">**IMPORTANT!**</span></span> <span data-ttu-id="4cb03-138">Zakažte oprávnění EXECUTE pro všechny uživatele v cestě.</span><span class="sxs-lookup"><span data-stu-id="4cb03-138">Disable execute permissions for all users at the path.</span></span>

1. <span data-ttu-id="4cb03-139">Nastavte limit velikosti souboru (`FileSizeLimit`) v bajtech.</span><span class="sxs-lookup"><span data-stu-id="4cb03-139">Set the file size limit (`FileSizeLimit`) in bytes.</span></span> <span data-ttu-id="4cb03-140">Výchozí hodnota `2097152` (2 097 152 bajtů) ukázkové aplikace povoluje nahrávání souborů až do velikosti 2 MB.</span><span class="sxs-lookup"><span data-stu-id="4cb03-140">The sample app's default value of `2097152` (2,097,152 bytes) permits file uploads up to 2 MB.</span></span>
