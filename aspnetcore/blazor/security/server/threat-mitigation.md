---
title: Pokyny pro zmírnění hrozeb pro ASP.NET Core Blazor Server
author: guardrex
description: Naučte se zmírnit bezpečnostní hrozby pro Blazor serverové aplikace.
monikerRange: '>= aspnetcore-3.1'
ms.author: riande
ms.custom: mvc
ms.date: 05/05/2020
no-loc:
- Blazor
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: blazor/security/server/threat-mitigation
ms.openlocfilehash: a94dcd818c3f4e19ace57fad6390a84e704192bd
ms.sourcegitcommit: 066d66ea150f8aab63f9e0e0668b06c9426296fd
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/23/2020
ms.locfileid: "85242963"
---
# <a name="threat-mitigation-guidance-for-aspnet-core-blazor-server"></a><span data-ttu-id="05b96-103">Pokyny pro zmírnění hrozeb pro ASP.NET Core Blazor Server</span><span class="sxs-lookup"><span data-stu-id="05b96-103">Threat mitigation guidance for ASP.NET Core Blazor Server</span></span>

<span data-ttu-id="05b96-104">[Javier Calvarro Nelson](https://github.com/javiercn)</span><span class="sxs-lookup"><span data-stu-id="05b96-104">By [Javier Calvarro Nelson](https://github.com/javiercn)</span></span>

Blazor<span data-ttu-id="05b96-105">Serverové aplikace přijímají *stavový* model zpracování dat, kde server a klient udržuje dlouhotrvající relaci.</span><span class="sxs-lookup"><span data-stu-id="05b96-105"> Server apps adopt a *stateful* data processing model, where the server and client maintain a long-lived relationship.</span></span> <span data-ttu-id="05b96-106">Trvalý stav je udržován [okruhem](xref:blazor/state-management), který může zahrnovat připojení, která jsou také potenciálně dlouhodobá.</span><span class="sxs-lookup"><span data-stu-id="05b96-106">The persistent state is maintained by a [circuit](xref:blazor/state-management), which can span connections that are also potentially long-lived.</span></span>

<span data-ttu-id="05b96-107">Když uživatel navštíví Blazor Server lokality, Server vytvoří okruh v paměti serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-107">When a user visits a Blazor Server site, the server creates a circuit in the server's memory.</span></span> <span data-ttu-id="05b96-108">Okruh indikuje prohlížeči, který obsah se má vykreslit a reagovat na události, například když uživatel vybere tlačítko v uživatelském rozhraní.</span><span class="sxs-lookup"><span data-stu-id="05b96-108">The circuit indicates to the browser what content to render and responds to events, such as when the user selects a button in the UI.</span></span> <span data-ttu-id="05b96-109">Chcete-li provést tyto akce, okruh vyvolá funkce JavaScriptu v prohlížeči uživatele a metodách .NET na serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-109">To perform these actions, a circuit invokes JavaScript functions in the user's browser and .NET methods on the server.</span></span> <span data-ttu-id="05b96-110">Tato obousměrná interakce založená na jazyce JavaScript je označována jako zprostředkovatel [komunikace JavaScript (zprostředkovatel komunikace js)](xref:blazor/call-javascript-from-dotnet).</span><span class="sxs-lookup"><span data-stu-id="05b96-110">This two-way JavaScript-based interaction is referred to as [JavaScript interop (JS interop)](xref:blazor/call-javascript-from-dotnet).</span></span>

<span data-ttu-id="05b96-111">Vzhledem k tomu, že interoperabilita JS probíhá přes Internet a klient používá vzdálený prohlížeč, Blazor aplikace serveru sdílí většinu otázek zabezpečení webových aplikací.</span><span class="sxs-lookup"><span data-stu-id="05b96-111">Because JS interop occurs over the Internet and the client uses a remote browser, Blazor Server apps share most web app security concerns.</span></span> <span data-ttu-id="05b96-112">Toto téma popisuje běžné hrozby pro Blazor serverové aplikace a poskytuje pokyny pro zmírnění hrozeb zaměřené na internetové aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-112">This topic describes common threats to Blazor Server apps and provides threat mitigation guidance focused on Internet-facing apps.</span></span>

<span data-ttu-id="05b96-113">V omezených prostředích, jako jsou v podnikových sítích nebo intranetech, se jedná o některé pokyny k omezení rizik:</span><span class="sxs-lookup"><span data-stu-id="05b96-113">In constrained environments, such as inside corporate networks or intranets, some of the mitigation guidance either:</span></span>

* <span data-ttu-id="05b96-114">Neplatí v omezeném prostředí.</span><span class="sxs-lookup"><span data-stu-id="05b96-114">Doesn't apply in the constrained environment.</span></span>
* <span data-ttu-id="05b96-115">Nestojí za implementaci, protože bezpečnostní riziko je nízké v omezeném prostředí.</span><span class="sxs-lookup"><span data-stu-id="05b96-115">Isn't worth the cost to implement because the security risk is low in a constrained environment.</span></span>

## <a name="blazor-and-shared-state"></a>Blazor<span data-ttu-id="05b96-116">a sdílený stav</span><span class="sxs-lookup"><span data-stu-id="05b96-116"> and shared state</span></span>

[!INCLUDE[](~/includes/blazor-security/blazor-shared-state.md)]

## <a name="resource-exhaustion"></a><span data-ttu-id="05b96-117">Vyčerpání prostředků</span><span class="sxs-lookup"><span data-stu-id="05b96-117">Resource exhaustion</span></span>

<span data-ttu-id="05b96-118">K vyčerpání prostředků může dojít, když klient komunikuje se serverem a způsobí, že Server spotřebovává nadměrné prostředky.</span><span class="sxs-lookup"><span data-stu-id="05b96-118">Resource exhaustion can occur when a client interacts with the server and causes the server to consume excessive resources.</span></span> <span data-ttu-id="05b96-119">Nadměrné využití prostředků primárně ovlivňuje:</span><span class="sxs-lookup"><span data-stu-id="05b96-119">Excessive resource consumption primarily affects:</span></span>

* [<span data-ttu-id="05b96-120">Procesor</span><span class="sxs-lookup"><span data-stu-id="05b96-120">CPU</span></span>](#cpu)
* [<span data-ttu-id="05b96-121">Memory (Paměť)</span><span class="sxs-lookup"><span data-stu-id="05b96-121">Memory</span></span>](#memory)
* [<span data-ttu-id="05b96-122">Připojení klientů</span><span class="sxs-lookup"><span data-stu-id="05b96-122">Client connections</span></span>](#client-connections)

<span data-ttu-id="05b96-123">Útoky DoS (Denial of Service) obvykle hledají vyčerpání prostředků aplikace nebo serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-123">Denial of service (DoS) attacks usually seek to exhaust an app or server's resources.</span></span> <span data-ttu-id="05b96-124">Vyčerpání prostředků ale nemusí být nutně výsledkem útoku na systém.</span><span class="sxs-lookup"><span data-stu-id="05b96-124">However, resource exhaustion isn't necessarily the result of an attack on the system.</span></span> <span data-ttu-id="05b96-125">Například omezené prostředky je možné vyčerpat z důvodu vysoké poptávky uživatelů.</span><span class="sxs-lookup"><span data-stu-id="05b96-125">For example, finite resources can be exhausted due to high user demand.</span></span> <span data-ttu-id="05b96-126">V části věnované [útokům DOS (Denial of Service)](#denial-of-service-dos-attacks) se systém DOS podrobněji zabývá.</span><span class="sxs-lookup"><span data-stu-id="05b96-126">DoS is covered further in the [Denial of service (DoS) attacks](#denial-of-service-dos-attacks) section.</span></span>

<span data-ttu-id="05b96-127">Prostředky, které jsou externí pro Blazor rámec, jako jsou databáze a obslužné rutiny souborů (slouží ke čtení a zápisu souborů), můžou taky vyčerpat prostředky.</span><span class="sxs-lookup"><span data-stu-id="05b96-127">Resources external to the Blazor framework, such as databases and file handles (used to read and write files), may also experience resource exhaustion.</span></span> <span data-ttu-id="05b96-128">Další informace naleznete v tématu <xref:performance/performance-best-practices>.</span><span class="sxs-lookup"><span data-stu-id="05b96-128">For more information, see <xref:performance/performance-best-practices>.</span></span>

### <a name="cpu"></a><span data-ttu-id="05b96-129">Procesor</span><span class="sxs-lookup"><span data-stu-id="05b96-129">CPU</span></span>

<span data-ttu-id="05b96-130">K vyčerpání procesoru může dojít v případě, že jeden nebo více klientů vynutí, aby server prováděl náročné fungování procesoru.</span><span class="sxs-lookup"><span data-stu-id="05b96-130">CPU exhaustion can occur when one or more clients force the server to perform intensive CPU work.</span></span>

<span data-ttu-id="05b96-131">Představte si třeba Blazor serverovou aplikaci, která vypočítá *Fibonnacci číslo*.</span><span class="sxs-lookup"><span data-stu-id="05b96-131">For example, consider a Blazor Server app that calculates a *Fibonnacci number*.</span></span> <span data-ttu-id="05b96-132">Fibonnacci číslo je vytvořeno z Fibonnacci sekvence, kde každé číslo v sekvenci je součet dvou předcházejících čísel.</span><span class="sxs-lookup"><span data-stu-id="05b96-132">A Fibonnacci number is produced from a Fibonnacci sequence, where each number in the sequence is the sum of the two preceding numbers.</span></span> <span data-ttu-id="05b96-133">Množství práce potřebné k dosažení odpovědi závisí na délce sekvence a na velikosti počáteční hodnoty.</span><span class="sxs-lookup"><span data-stu-id="05b96-133">The amount of work required to reach the answer depends on the length of the sequence and the size of the initial value.</span></span> <span data-ttu-id="05b96-134">Pokud aplikace neumístí omezení na požadavky klienta, mohou výpočty náročné na procesor poznamenat čas procesoru a snížit výkon dalších úloh.</span><span class="sxs-lookup"><span data-stu-id="05b96-134">If the app doesn't place limits on a client's request, the CPU-intensive calculations may dominate the CPU's time and diminish the performance of other tasks.</span></span> <span data-ttu-id="05b96-135">Nadměrné využití prostředků je zabezpečení, které má vliv na dostupnost.</span><span class="sxs-lookup"><span data-stu-id="05b96-135">Excessive resource consumption is a security concern impacting availability.</span></span>

<span data-ttu-id="05b96-136">Vyčerpání výkonu procesoru je obavou pro všechny veřejné aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-136">CPU exhaustion is a concern for all public-facing apps.</span></span> <span data-ttu-id="05b96-137">V běžných webových aplikacích jsou požadavky a připojení vyprší jako ochrana, ale Blazor serverové aplikace neposkytují stejné záruky.</span><span class="sxs-lookup"><span data-stu-id="05b96-137">In regular web apps, requests and connections time out as a safeguard, but Blazor Server apps don't provide the same safeguards.</span></span> Blazor<span data-ttu-id="05b96-138">Serverové aplikace musí před provedením práce náročné na procesor zahrnovat vhodné kontroly a omezení.</span><span class="sxs-lookup"><span data-stu-id="05b96-138"> Server apps must include appropriate checks and limits before performing potentially CPU-intensive work.</span></span>

### <a name="memory"></a><span data-ttu-id="05b96-139">Memory (Paměť)</span><span class="sxs-lookup"><span data-stu-id="05b96-139">Memory</span></span>

<span data-ttu-id="05b96-140">K vyčerpání paměti může dojít v případě, že jeden nebo více klientů vynutí Server, aby využíval velké množství paměti.</span><span class="sxs-lookup"><span data-stu-id="05b96-140">Memory exhaustion can occur when one or more clients force the server to consume a large amount of memory.</span></span>

<span data-ttu-id="05b96-141">Představte si třeba Blazor aplikaci na straně serveru s komponentou, která přijímá a zobrazuje seznam položek.</span><span class="sxs-lookup"><span data-stu-id="05b96-141">For example, consider a Blazor-server side app with a component that accepts and displays a list of items.</span></span> <span data-ttu-id="05b96-142">Pokud Blazor aplikace neumístí omezení na povolený počet položek nebo počet položek, které se vrátí klientovi, může zpracování a vykreslování náročné na paměť podznamenat paměť serveru do bodu, ve kterém výkon serveru utrpí.</span><span class="sxs-lookup"><span data-stu-id="05b96-142">If the Blazor app doesn't place limits on the number of items allowed or the number of items rendered back to the client, the memory-intensive processing and rendering may dominate the server's memory to the point where performance of the server suffers.</span></span> <span data-ttu-id="05b96-143">Server může způsobit selhání nebo zpomalit bod, na kterém se zdá, že došlo k chybě.</span><span class="sxs-lookup"><span data-stu-id="05b96-143">The server may crash or slow to the point that it appears to have crashed.</span></span>

<span data-ttu-id="05b96-144">Při údržbě a zobrazování seznamu položek, které se vztahují k potenciálnímu scénáři vyčerpání paměti na serveru, vezměte v úvahu následující scénář:</span><span class="sxs-lookup"><span data-stu-id="05b96-144">Consider the following scenario for maintaining and displaying a list of items that pertain to a potential memory exhaustion scenario on the server:</span></span>

* <span data-ttu-id="05b96-145">Položky ve `List<MyItem>` vlastnosti nebo poli používají paměť serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-145">The items in a `List<MyItem>` property or field use the server's memory.</span></span> <span data-ttu-id="05b96-146">Pokud aplikace umožňuje dosáhnout neohraničeného seznamu položek, dojde k riziku serveru, který nemá dostatek paměti.</span><span class="sxs-lookup"><span data-stu-id="05b96-146">If the app allows the list of items to grow unbounded, there's a risk of the server running out of memory.</span></span> <span data-ttu-id="05b96-147">Nedostatek paměti způsobí, že aktuální relace skončí (zhroucení) a všechny souběžné relace v této instanci serveru obdrží výjimku z důvodu nedostatku paměti.</span><span class="sxs-lookup"><span data-stu-id="05b96-147">Running out of memory causes the current session to end (crash) and all of the concurrent sessions in that server instance receive an out-of-memory exception.</span></span> <span data-ttu-id="05b96-148">Aby nedocházelo k tomuto scénáři, musí aplikace používat datovou strukturu, která ukládá omezení počtu položek na souběžných uživatelích.</span><span class="sxs-lookup"><span data-stu-id="05b96-148">To prevent this scenario from occurring, the app must use a data structure that imposes an item limit on concurrent users.</span></span>
* <span data-ttu-id="05b96-149">Pokud se schéma stránkování nepoužívá pro vykreslování, server používá další paměť pro objekty, které nejsou viditelné v uživatelském rozhraní.</span><span class="sxs-lookup"><span data-stu-id="05b96-149">If a paging scheme isn't used for rendering, the server uses additional memory for objects that aren't visible in the UI.</span></span> <span data-ttu-id="05b96-150">Bez omezení počtu položek mohou nároky na paměť vyčerpat dostupnou paměť serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-150">Without a limit on the number of items, memory demands may exhaust the available server memory.</span></span> <span data-ttu-id="05b96-151">Chcete-li zabránit tomuto scénáři, použijte jeden z následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="05b96-151">To prevent this scenario, use one of the following approaches:</span></span>
  * <span data-ttu-id="05b96-152">Při vykreslování použít stránkované seznamy.</span><span class="sxs-lookup"><span data-stu-id="05b96-152">Use paginated lists when rendering.</span></span>
  * <span data-ttu-id="05b96-153">Zobrazí se pouze prvních 100 až 1 000 položek a vyžaduje, aby uživatel zadal kritéria hledání, aby vyhledal položky nad zobrazenými položkami.</span><span class="sxs-lookup"><span data-stu-id="05b96-153">Only display the first 100 to 1,000 items and require the user to enter search criteria to find items beyond the items displayed.</span></span>
  * <span data-ttu-id="05b96-154">Pro pokročilejší scénář vykreslování implementujte seznamy nebo mřížky podporující *virtualizaci*.</span><span class="sxs-lookup"><span data-stu-id="05b96-154">For a more advanced rendering scenario, implement lists or grids that support *virtualization*.</span></span> <span data-ttu-id="05b96-155">Pomocí virtualizace vykreslí pouze podmnožinu položek, které jsou aktuálně viditelné uživateli.</span><span class="sxs-lookup"><span data-stu-id="05b96-155">Using virtualization, lists only render a subset of items currently visible to the user.</span></span> <span data-ttu-id="05b96-156">Když uživatel pracuje s posuvníkem v uživatelském rozhraní, komponenta vykreslí pouze ty položky, které jsou nutné k zobrazení.</span><span class="sxs-lookup"><span data-stu-id="05b96-156">When the user interacts with the scrollbar in the UI, the component renders only those items required for display.</span></span> <span data-ttu-id="05b96-157">Položky, které nejsou aktuálně požadovány k zobrazení, lze uchovávat v sekundárním úložišti, což je ideální přístup.</span><span class="sxs-lookup"><span data-stu-id="05b96-157">The items that aren't currently required for display can be held in secondary storage, which is the ideal approach.</span></span> <span data-ttu-id="05b96-158">Nezobrazené položky je také možné uchovávat v paměti, což je méně ideální.</span><span class="sxs-lookup"><span data-stu-id="05b96-158">Undisplayed items can also be held in memory, which is less ideal.</span></span>

Blazor<span data-ttu-id="05b96-159">Serverové aplikace nabízejí podobný programovací model pro jiné architektury uživatelského rozhraní pro stavové aplikace, jako je WPF, model Windows Forms nebo Blazor WebAssembly.</span><span class="sxs-lookup"><span data-stu-id="05b96-159"> Server apps offer a similar programming model to other UI frameworks for stateful apps, such as WPF, Windows Forms, or Blazor WebAssembly.</span></span> <span data-ttu-id="05b96-160">Hlavním rozdílem je to, že v několika rozhraních uživatelského rozhraní paměť spotřebovaná aplikací patří klientovi a ovlivňuje pouze jednotlivé klienty.</span><span class="sxs-lookup"><span data-stu-id="05b96-160">The main difference is that in several of the UI frameworks the memory consumed by the app belongs to the client and only affects that individual client.</span></span> <span data-ttu-id="05b96-161">Například Blazor aplikace typu WebAssembly běží zcela na klientovi a používá pouze prostředky paměti klienta.</span><span class="sxs-lookup"><span data-stu-id="05b96-161">For example, a Blazor WebAssembly app runs entirely on the client and only uses client memory resources.</span></span> <span data-ttu-id="05b96-162">Ve Blazor scénáři serveru patří paměť, kterou aplikace spotřebovává, do serveru a sdílí se mezi klienty v instanci serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-162">In the Blazor Server scenario, the memory consumed by the app belongs to the server and is shared among clients on the server instance.</span></span>

<span data-ttu-id="05b96-163">Požadavky na paměť na straně serveru jsou zvážené pro všechny Blazor serverové aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-163">Server-side memory demands are a consideration for all Blazor Server apps.</span></span> <span data-ttu-id="05b96-164">Většina webových aplikací je ale Bezstavová a při vrácení odpovědi se uvolní paměť, která se používá při zpracování žádosti.</span><span class="sxs-lookup"><span data-stu-id="05b96-164">However, most web apps are stateless, and the memory used while processing a request is released when the response is returned.</span></span> <span data-ttu-id="05b96-165">Obecně doporučujeme, abyste klientům nepovolili přidělit nevázanou velikost paměti jako v jakékoli jiné aplikaci na straně serveru, která se zachovává připojení klientů.</span><span class="sxs-lookup"><span data-stu-id="05b96-165">As a general recommendation, don't permit clients to allocate an unbound amount of memory as in any other server-side app that persists client connections.</span></span> <span data-ttu-id="05b96-166">Paměť využitá Blazor serverovou aplikací trvá déle než jedna žádost.</span><span class="sxs-lookup"><span data-stu-id="05b96-166">The memory consumed by a Blazor Server app persists for a longer time than a single request.</span></span>

> [!NOTE]
> <span data-ttu-id="05b96-167">Během vývoje lze použít Profiler nebo zaznamenané trasování pro vyhodnocení požadavků na paměť klientů.</span><span class="sxs-lookup"><span data-stu-id="05b96-167">During development, a profiler can be used or a trace captured to assess memory demands of clients.</span></span> <span data-ttu-id="05b96-168">Profiler nebo trasování nezachycuje paměť přidělenou konkrétnímu klientovi.</span><span class="sxs-lookup"><span data-stu-id="05b96-168">A profiler or trace won't capture the memory allocated to a specific client.</span></span> <span data-ttu-id="05b96-169">Pokud chcete zachytit využití paměti konkrétního klienta během vývoje, Zachyťte výpis paměti a prověřte požadavky na paměť všech objektů, které jsou v okruhu uživatele rootem.</span><span class="sxs-lookup"><span data-stu-id="05b96-169">To capture the memory use of a specific client during development, capture a dump and examine the memory demand of all the objects rooted at a user's circuit.</span></span>

### <a name="client-connections"></a><span data-ttu-id="05b96-170">Připojení klientů</span><span class="sxs-lookup"><span data-stu-id="05b96-170">Client connections</span></span>

<span data-ttu-id="05b96-171">K vyčerpání spojení může dojít, když jeden nebo více klientů otevře příliš mnoho souběžných připojení k serveru, což brání ostatním klientům v navázání nových připojení.</span><span class="sxs-lookup"><span data-stu-id="05b96-171">Connection exhaustion can occur when one or more clients open too many concurrent connections to the server, preventing other clients from establishing new connections.</span></span>

Blazor<span data-ttu-id="05b96-172">klienti navážou jedno připojení na jednu relaci a udržují připojení otevřené po celou dobu, než se otevře okno prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="05b96-172"> clients establish a single connection per session and keep the connection open for as long as the browser window is open.</span></span> <span data-ttu-id="05b96-173">Požadavky na server správy všech připojení nejsou specifické pro Blazor aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-173">The demands on the server of maintaining all of the connections isn't specific to Blazor apps.</span></span> <span data-ttu-id="05b96-174">S ohledem na trvalou povahu připojení a stavové povahy Blazor serverových aplikací je vyčerpání připojení větší riziko pro dostupnost aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-174">Given the persistent nature of the connections and the stateful nature of Blazor Server apps, connection exhaustion is a greater risk to availability of the app.</span></span>

<span data-ttu-id="05b96-175">Ve výchozím nastavení neexistuje žádné omezení počtu připojení na uživatele pro Blazor serverovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="05b96-175">By default, there's no limit on the number of connections per user for a Blazor Server app.</span></span> <span data-ttu-id="05b96-176">Pokud aplikace vyžaduje limit připojení, proveďte jednu nebo více následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="05b96-176">If the app requires a connection limit, take one or more of the following approaches:</span></span>

* <span data-ttu-id="05b96-177">Vyžaduje ověření, které přirozeně omezuje možnosti neautorizovaných uživatelů připojit se k aplikaci.</span><span class="sxs-lookup"><span data-stu-id="05b96-177">Require authentication, which naturally limits the ability of unauthorized users to connect to the app.</span></span> <span data-ttu-id="05b96-178">Aby byl tento scénář účinný, je nutné uživatelům zabránit v zřizování nových uživatelů.</span><span class="sxs-lookup"><span data-stu-id="05b96-178">For this scenario to be effective, users must be prevented from provisioning new users at will.</span></span>
* <span data-ttu-id="05b96-179">Omezte počet připojení na uživatele.</span><span class="sxs-lookup"><span data-stu-id="05b96-179">Limit the number of connections per user.</span></span> <span data-ttu-id="05b96-180">Omezení připojení je možné dosáhnout pomocí následujících přístupů.</span><span class="sxs-lookup"><span data-stu-id="05b96-180">Limiting connections can be accomplished via the following approaches.</span></span> <span data-ttu-id="05b96-181">Dbejte na to, abyste uživatelům povolili přístup k aplikaci (například když je na základě IP adresy klienta vytvořen limit připojení).</span><span class="sxs-lookup"><span data-stu-id="05b96-181">Exercise care to allow legitimate users to access the app (for example, when a connection limit is established based on the client's IP address).</span></span>
  * <span data-ttu-id="05b96-182">Na úrovni aplikace:</span><span class="sxs-lookup"><span data-stu-id="05b96-182">At the app level:</span></span>
    * <span data-ttu-id="05b96-183">Rozšiřitelnost směrování koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="05b96-183">Endpoint routing extensibility.</span></span>
    * <span data-ttu-id="05b96-184">Vyžadovat ověřování pro připojení k aplikaci a sledování aktivních relací na uživatele.</span><span class="sxs-lookup"><span data-stu-id="05b96-184">Require authentication to connect to the app and keep track of the active sessions per user.</span></span>
    * <span data-ttu-id="05b96-185">Po dosažení limitu zamítnout nové relace.</span><span class="sxs-lookup"><span data-stu-id="05b96-185">Reject new sessions upon reaching a limit.</span></span>
    * <span data-ttu-id="05b96-186">Proxy připojení WebSocket k aplikaci prostřednictvím proxy serveru, jako je například [ SignalR Služba Azure](/azure/azure-signalr/signalr-overview) , která multiplexuje připojení z klientů do aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-186">Proxy WebSocket connections to an app through the use of a proxy, such as the [Azure SignalR Service](/azure/azure-signalr/signalr-overview) that multiplexes connections from clients to an app.</span></span> <span data-ttu-id="05b96-187">Tato funkce poskytuje aplikaci s větší kapacitou připojení, než může jeden klient navázat a zabránit klientovi v vyčerpání připojení k serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-187">This provides an app with greater connection capacity than a single client can establish, preventing a client from exhausting the connections to the server.</span></span>
  * <span data-ttu-id="05b96-188">Na úrovni serveru: před aplikací použijte proxy server nebo bránu.</span><span class="sxs-lookup"><span data-stu-id="05b96-188">At the server level: Use a proxy/gateway in front of the app.</span></span> <span data-ttu-id="05b96-189">Například [přední dveře Azure](/azure/frontdoor/front-door-overview) umožňují definovat, spravovat a monitorovat globální směrování webového provozu do aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-189">For example, [Azure Front Door](/azure/frontdoor/front-door-overview) enables you to define, manage, and monitor the global routing of web traffic to an app.</span></span>

## <a name="denial-of-service-dos-attacks"></a><span data-ttu-id="05b96-190">Útoky DoS (Denial of Service)</span><span class="sxs-lookup"><span data-stu-id="05b96-190">Denial of service (DoS) attacks</span></span>

<span data-ttu-id="05b96-191">Útoky DoS (Denial of Service) zahrnují klienta, který způsobuje, že server vyčerpá jeden nebo víc svých prostředků, takže aplikace nebude k dispozici.</span><span class="sxs-lookup"><span data-stu-id="05b96-191">Denial of service (DoS) attacks involve a client causing the server to exhaust one or more of its resources making the app unavailable.</span></span> Blazor<span data-ttu-id="05b96-192">Serverové aplikace zahrnují některá výchozí omezení a spoléhají na jiné ASP.NET Core a SignalR omezení ochrany proti útokům DOS, které jsou nastavené na <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions> .</span><span class="sxs-lookup"><span data-stu-id="05b96-192"> Server apps include some default limits and rely on other ASP.NET Core and SignalR limits to protect against DoS attacks that are set on <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions>.</span></span>

| Blazor<span data-ttu-id="05b96-193">Omezení serverové aplikace</span><span class="sxs-lookup"><span data-stu-id="05b96-193"> Server app limit</span></span> | <span data-ttu-id="05b96-194">Description</span><span class="sxs-lookup"><span data-stu-id="05b96-194">Description</span></span> | <span data-ttu-id="05b96-195">Výchozí</span><span class="sxs-lookup"><span data-stu-id="05b96-195">Default</span></span> |
| --- | --- | --- |
| <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DisconnectedCircuitMaxRetained> | <span data-ttu-id="05b96-196">Maximální počet odpojených okruhů, které daný server uchovává v paměti.</span><span class="sxs-lookup"><span data-stu-id="05b96-196">Maximum number of disconnected circuits that a given server holds in memory at a time.</span></span> | <span data-ttu-id="05b96-197">100</span><span class="sxs-lookup"><span data-stu-id="05b96-197">100</span></span> |
| <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DisconnectedCircuitRetentionPeriod> | <span data-ttu-id="05b96-198">Maximální doba, po kterou je odpojený okruh uložený v paměti předtím, než se rozpustí.</span><span class="sxs-lookup"><span data-stu-id="05b96-198">Maximum amount of time a disconnected circuit is held in memory before being torn down.</span></span> | <span data-ttu-id="05b96-199">3 minuty</span><span class="sxs-lookup"><span data-stu-id="05b96-199">3 minutes</span></span> |
| <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout> | <span data-ttu-id="05b96-200">Maximální doba, po kterou Server počká, než vyprší časový limit asynchronního vyvolání funkce JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="05b96-200">Maximum amount of time the server waits before timing out an asynchronous JavaScript function invocation.</span></span> | <span data-ttu-id="05b96-201">1 min.</span><span class="sxs-lookup"><span data-stu-id="05b96-201">1 minute</span></span> |
| <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.MaxBufferedUnacknowledgedRenderBatches> | <span data-ttu-id="05b96-202">Maximální počet nepotvrzených vykreslících vykreslování: Server udržuje paměť na okruh v daném čase pro zajištění podpory robustního opětovného připojení.</span><span class="sxs-lookup"><span data-stu-id="05b96-202">Maximum number of unacknowledged render batches the server keeps in memory per circuit at a given time to support robust reconnection.</span></span> <span data-ttu-id="05b96-203">Po dosažení limitu Server přestane vytvářet nové dávky vykreslování, dokud klient nepotvrdí jednu nebo více dávek.</span><span class="sxs-lookup"><span data-stu-id="05b96-203">After reaching the limit, the server stops producing new render batches until one or more batches have been acknowledged by the client.</span></span> | <span data-ttu-id="05b96-204">10</span><span class="sxs-lookup"><span data-stu-id="05b96-204">10</span></span> |

<span data-ttu-id="05b96-205">Nastavte maximální velikost zprávy pro jednu příchozí zprávu centra pomocí <xref:Microsoft.AspNetCore.SignalR.HubConnectionContextOptions> .</span><span class="sxs-lookup"><span data-stu-id="05b96-205">Set the maximum message size of a single incoming hub message with <xref:Microsoft.AspNetCore.SignalR.HubConnectionContextOptions>.</span></span>

| SignalR<span data-ttu-id="05b96-206">a omezení ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="05b96-206"> and ASP.NET Core limit</span></span> | <span data-ttu-id="05b96-207">Description</span><span class="sxs-lookup"><span data-stu-id="05b96-207">Description</span></span> | <span data-ttu-id="05b96-208">Výchozí</span><span class="sxs-lookup"><span data-stu-id="05b96-208">Default</span></span> |
| --- | --- | --- |
| <xref:Microsoft.AspNetCore.SignalR.HubConnectionContextOptions.MaximumReceiveMessageSize?displayProperty=nameWithType> | <span data-ttu-id="05b96-209">Velikost zprávy pro jednotlivou zprávu</span><span class="sxs-lookup"><span data-stu-id="05b96-209">Message size for an individual message.</span></span> | <span data-ttu-id="05b96-210">32 KB</span><span class="sxs-lookup"><span data-stu-id="05b96-210">32 KB</span></span> |

## <a name="interactions-with-the-browser-client"></a><span data-ttu-id="05b96-211">Interakce s prohlížečem (klient)</span><span class="sxs-lookup"><span data-stu-id="05b96-211">Interactions with the browser (client)</span></span>

<span data-ttu-id="05b96-212">Klient komunikuje s odesláním a dokončením vykreslování událostí serveru prostřednictvím aplikace JS.</span><span class="sxs-lookup"><span data-stu-id="05b96-212">A client interacts with the server through JS interop event dispatching and render completion.</span></span> <span data-ttu-id="05b96-213">Komunikace interoperability JS přechází mezi oběma způsoby mezi jazykem JavaScript a .NET:</span><span class="sxs-lookup"><span data-stu-id="05b96-213">JS interop communication goes both ways between JavaScript and .NET:</span></span>

* <span data-ttu-id="05b96-214">Události prohlížeče jsou odesílány z klienta na server asynchronním způsobem.</span><span class="sxs-lookup"><span data-stu-id="05b96-214">Browser events are dispatched from the client to the server in an asynchronous fashion.</span></span>
* <span data-ttu-id="05b96-215">Server odpoví asynchronním vykreslením uživatelského rozhraní podle potřeby.</span><span class="sxs-lookup"><span data-stu-id="05b96-215">The server responds asynchronously rerendering the UI as necessary.</span></span>

### <a name="javascript-functions-invoked-from-net"></a><span data-ttu-id="05b96-216">Funkce JavaScriptu vyvolané z .NET</span><span class="sxs-lookup"><span data-stu-id="05b96-216">JavaScript functions invoked from .NET</span></span>

<span data-ttu-id="05b96-217">Pro volání z metod .NET do JavaScriptu:</span><span class="sxs-lookup"><span data-stu-id="05b96-217">For calls from .NET methods to JavaScript:</span></span>

* <span data-ttu-id="05b96-218">Všechna volání mají konfigurovatelný časový limit, po jehož uplynutí selžou, a vrátí <xref:System.OperationCanceledException> volajícímu.</span><span class="sxs-lookup"><span data-stu-id="05b96-218">All invocations have a configurable timeout after which they fail, returning a <xref:System.OperationCanceledException> to the caller.</span></span>
  * <span data-ttu-id="05b96-219">Výchozí časový limit pro volání ( <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType> ) po jednu minutu.</span><span class="sxs-lookup"><span data-stu-id="05b96-219">There's a default timeout for the calls (<xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType>) of one minute.</span></span> <span data-ttu-id="05b96-220">Pokud chcete tento limit nakonfigurovat, přečtěte si téma <xref:blazor/call-javascript-from-dotnet#harden-js-interop-calls> .</span><span class="sxs-lookup"><span data-stu-id="05b96-220">To configure this limit, see <xref:blazor/call-javascript-from-dotnet#harden-js-interop-calls>.</span></span>
  * <span data-ttu-id="05b96-221">Je možné zadat token zrušení pro řízení zrušení u jednotlivých volání.</span><span class="sxs-lookup"><span data-stu-id="05b96-221">A cancellation token can be provided to control the cancellation on a per-call basis.</span></span> <span data-ttu-id="05b96-222">Spoléhá se na výchozí časový limit volání, kde je to možné, a s časovým limitem pro jakékoli volání klienta, pokud je k dispozici token zrušení.</span><span class="sxs-lookup"><span data-stu-id="05b96-222">Rely on the default call timeout where possible and time-bound any call to the client if a cancellation token is provided.</span></span>
* <span data-ttu-id="05b96-223">Výsledek volání JavaScriptu nemůže být důvěryhodný.</span><span class="sxs-lookup"><span data-stu-id="05b96-223">The result of a JavaScript call can't be trusted.</span></span> <span data-ttu-id="05b96-224">BlazorKlient aplikace spuštěný v prohlížeči vyhledá funkci JavaScriptu, která se má vyvolat.</span><span class="sxs-lookup"><span data-stu-id="05b96-224">The Blazor app client running in the browser searches for the JavaScript function to invoke.</span></span> <span data-ttu-id="05b96-225">Funkce je vyvolána a výsledek nebo chyba je vytvořena.</span><span class="sxs-lookup"><span data-stu-id="05b96-225">The function is invoked, and either the result or an error is produced.</span></span> <span data-ttu-id="05b96-226">Zlomyslný klient se může pokusit:</span><span class="sxs-lookup"><span data-stu-id="05b96-226">A malicious client can attempt to:</span></span>
  * <span data-ttu-id="05b96-227">Způsobí problém v aplikaci vrácením chyby z funkce JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="05b96-227">Cause an issue in the app by returning an error from the JavaScript function.</span></span>
  * <span data-ttu-id="05b96-228">Vyvolávat nezamýšlené chování na serveru vrácením neočekávaného výsledku z funkce JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="05b96-228">Induce an unintended behavior on the server by returning an unexpected result from the JavaScript function.</span></span>

<span data-ttu-id="05b96-229">Pro ochranu před předchozími scénáři proveďte následující opatření:</span><span class="sxs-lookup"><span data-stu-id="05b96-229">Take the following precautions to guard against the preceding scenarios:</span></span>

* <span data-ttu-id="05b96-230">Zabalte volání interoperability JS v rámci [`try-catch`](/dotnet/csharp/language-reference/keywords/try-catch) příkazů do účtu pro chyby, ke kterým může dojít během vyvolání.</span><span class="sxs-lookup"><span data-stu-id="05b96-230">Wrap JS interop calls within [`try-catch`](/dotnet/csharp/language-reference/keywords/try-catch) statements to account for errors that might occur during the invocations.</span></span> <span data-ttu-id="05b96-231">Další informace naleznete v tématu <xref:blazor/fundamentals/handle-errors#javascript-interop>.</span><span class="sxs-lookup"><span data-stu-id="05b96-231">For more information, see <xref:blazor/fundamentals/handle-errors#javascript-interop>.</span></span>
* <span data-ttu-id="05b96-232">Před provedením jakékoli akce Ověřte data vrácená z volání Interop v JS, včetně chybových zpráv.</span><span class="sxs-lookup"><span data-stu-id="05b96-232">Validate data returned from JS interop invocations, including error messages, before taking any action.</span></span>

### <a name="net-methods-invoked-from-the-browser"></a><span data-ttu-id="05b96-233">Metody .NET vyvolané z prohlížeče</span><span class="sxs-lookup"><span data-stu-id="05b96-233">.NET methods invoked from the browser</span></span>

<span data-ttu-id="05b96-234">Nemusíte důvěřovat volání metod z JavaScriptu do .NET.</span><span class="sxs-lookup"><span data-stu-id="05b96-234">Don't trust calls from JavaScript to .NET methods.</span></span> <span data-ttu-id="05b96-235">Pokud je k JavaScriptu k dispozici metoda .NET, zvažte, jak je vyvolána metoda .NET:</span><span class="sxs-lookup"><span data-stu-id="05b96-235">When a .NET method is exposed to JavaScript, consider how the .NET method is invoked:</span></span>

* <span data-ttu-id="05b96-236">Považovat jakoukoli metodu .NET zveřejněnou pro JavaScript stejně jako veřejný koncový bod pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="05b96-236">Treat any .NET method exposed to JavaScript as you would a public endpoint to the app.</span></span>
  * <span data-ttu-id="05b96-237">Ověřte vstup.</span><span class="sxs-lookup"><span data-stu-id="05b96-237">Validate input.</span></span>
    * <span data-ttu-id="05b96-238">Ujistěte se, že hodnoty jsou v rámci očekávaných rozsahů.</span><span class="sxs-lookup"><span data-stu-id="05b96-238">Ensure that values are within expected ranges.</span></span>
    * <span data-ttu-id="05b96-239">Zajistěte, aby měl uživatel oprávnění k provedení požadované akce.</span><span class="sxs-lookup"><span data-stu-id="05b96-239">Ensure that the user has permission to perform the action requested.</span></span>
  * <span data-ttu-id="05b96-240">Nepřiřazujte nadměrné množství prostředků jako součást volání metod .NET.</span><span class="sxs-lookup"><span data-stu-id="05b96-240">Don't allocate an excessive quantity of resources as part of the .NET method invocation.</span></span> <span data-ttu-id="05b96-241">Například proveďte kontrolu a umístěte omezení využití procesoru a paměti.</span><span class="sxs-lookup"><span data-stu-id="05b96-241">For example, perform checks and place limits on CPU and memory use.</span></span>
  * <span data-ttu-id="05b96-242">Vezměte v úvahu, že statické a instanční metody můžou být vystavené klientům JavaScriptu.</span><span class="sxs-lookup"><span data-stu-id="05b96-242">Take into account that static and instance methods can be exposed to JavaScript clients.</span></span> <span data-ttu-id="05b96-243">Vyhněte se sdílení stavu napříč relacemi, pokud se návrh nevolá pro stav sdílení s příslušnými omezeními.</span><span class="sxs-lookup"><span data-stu-id="05b96-243">Avoid sharing state across sessions unless the design calls for sharing state with appropriate constraints.</span></span>
    * <span data-ttu-id="05b96-244">Pro metody `DotNetReference` , které jsou vystaveny prostřednictvím objektů, které byly vytvořeny prostřednictvím injektáže Dependency vstřik (di), by měly být objekty registrovány jako objekty s oborem.</span><span class="sxs-lookup"><span data-stu-id="05b96-244">For instance methods exposed through `DotNetReference` objects that are originally created through dependency injection (DI), the objects should be registered as scoped objects.</span></span> <span data-ttu-id="05b96-245">To platí pro libovolnou službu DI, kterou Blazor používá serverová aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-245">This applies to any DI service that the Blazor Server app uses.</span></span>
    * <span data-ttu-id="05b96-246">U statických metod Vyhněte se vytváření stavu, který nelze nastavit na klienta, pokud aplikace explicitně nesdílí stav pro všechny uživatele v instanci serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-246">For static methods, avoid establishing state that can't be scoped to the client unless the app is explicitly sharing state by-design across all users on a server instance.</span></span>
  * <span data-ttu-id="05b96-247">Vyhněte se předávání dat poskytovaných uživatelem v parametrech volání JavaScript.</span><span class="sxs-lookup"><span data-stu-id="05b96-247">Avoid passing user-supplied data in parameters to JavaScript calls.</span></span> <span data-ttu-id="05b96-248">Pokud je předávání dat v parametrech naprosto povinné, ujistěte se, že kód jazyka JavaScript zpracovává předávání dat bez nutnosti chyby zabezpečení [SKRIPTOVÁNÍ XSS (více lokalit)](#cross-site-scripting-xss) .</span><span class="sxs-lookup"><span data-stu-id="05b96-248">If passing data in parameters is absolutely required, ensure that the JavaScript code handles passing the data without introducing [Cross-site scripting (XSS)](#cross-site-scripting-xss) vulnerabilities.</span></span> <span data-ttu-id="05b96-249">Nepište například data dodaná uživatelem do model DOM (Document Object Model) (DOM) nastavením `innerHTML` vlastnosti prvku.</span><span class="sxs-lookup"><span data-stu-id="05b96-249">For example, don't write user-supplied data to the Document Object Model (DOM) by setting the `innerHTML` property of an element.</span></span> <span data-ttu-id="05b96-250">Zvažte použití [zásad zabezpečení obsahu (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) k zakázání `eval` a dalším nebezpečným primitivním primitivům jazyka JavaScript.</span><span class="sxs-lookup"><span data-stu-id="05b96-250">Consider using [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) to disable `eval` and other unsafe JavaScript primitives.</span></span>
* <span data-ttu-id="05b96-251">Neimplementujte implementaci vlastního odesílání volání .NET nad rámec implementace odesílajícího rozhraní.</span><span class="sxs-lookup"><span data-stu-id="05b96-251">Avoid implementing custom dispatching of .NET invocations on top of the framework's dispatching implementation.</span></span> <span data-ttu-id="05b96-252">Vystavení metod .NET v prohlížeči je pokročilý scénář, který se nedoporučuje pro obecný Blazor vývoj.</span><span class="sxs-lookup"><span data-stu-id="05b96-252">Exposing .NET methods to the browser is an advanced scenario, not recommended for general Blazor development.</span></span>

### <a name="events"></a><span data-ttu-id="05b96-253">Události</span><span class="sxs-lookup"><span data-stu-id="05b96-253">Events</span></span>

<span data-ttu-id="05b96-254">Události poskytují vstupní bod Blazor serverové aplikaci.</span><span class="sxs-lookup"><span data-stu-id="05b96-254">Events provide an entry point to a Blazor Server app.</span></span> <span data-ttu-id="05b96-255">Stejná pravidla pro ochranu koncových bodů ve webových aplikacích se vztahují na zpracování událostí v Blazor serverových aplikacích.</span><span class="sxs-lookup"><span data-stu-id="05b96-255">The same rules for safeguarding endpoints in web apps apply to event handling in Blazor Server apps.</span></span> <span data-ttu-id="05b96-256">Škodlivý klient může odesílat všechna data, která chce odeslat jako datovou část pro událost.</span><span class="sxs-lookup"><span data-stu-id="05b96-256">A malicious client can send any data it wishes to send as the payload for an event.</span></span>

<span data-ttu-id="05b96-257">Příklad:</span><span class="sxs-lookup"><span data-stu-id="05b96-257">For example:</span></span>

* <span data-ttu-id="05b96-258">Událost změny pro `<select>` by mohla odeslat hodnotu, která není v rámci možností, které aplikace prezentuje klientovi.</span><span class="sxs-lookup"><span data-stu-id="05b96-258">A change event for a `<select>` could send a value that isn't within the options that the app presented to the client.</span></span>
* <span data-ttu-id="05b96-259">`<input>`Může odeslat veškerá textová data na server a obejít ověřování na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="05b96-259">An `<input>` could send any text data to the server, bypassing client-side validation.</span></span>

<span data-ttu-id="05b96-260">Aplikace musí ověřit data pro všechny události, které aplikace zpracovává.</span><span class="sxs-lookup"><span data-stu-id="05b96-260">The app must validate the data for any event that the app handles.</span></span> <span data-ttu-id="05b96-261">Blazor [Komponenty formulářů](xref:blazor/forms-validation) rozhraní provádějí základní ověření.</span><span class="sxs-lookup"><span data-stu-id="05b96-261">The Blazor framework [forms components](xref:blazor/forms-validation) perform basic validations.</span></span> <span data-ttu-id="05b96-262">Pokud aplikace používá vlastní součásti formulářů, je nutné napsat vlastní kód pro ověření dat události podle potřeby.</span><span class="sxs-lookup"><span data-stu-id="05b96-262">If the app uses custom forms components, custom code must be written to validate event data as appropriate.</span></span>

Blazor<span data-ttu-id="05b96-263">Události serveru jsou asynchronní, takže je možné odeslat do serveru více událostí, než aplikace začne reagovat tím, že vygeneruje nové vykreslování.</span><span class="sxs-lookup"><span data-stu-id="05b96-263"> Server events are asynchronous, so multiple events can be dispatched to the server before the app has time to react by producing a new render.</span></span> <span data-ttu-id="05b96-264">To má vliv na některé zabezpečení, které je potřeba vzít v úvahu.</span><span class="sxs-lookup"><span data-stu-id="05b96-264">This has some security implications to consider.</span></span> <span data-ttu-id="05b96-265">Omezení akcí klienta v aplikaci musí být provedeno uvnitř obslužných rutin událostí a nemusí být závislé na aktuálním stavu zobrazení.</span><span class="sxs-lookup"><span data-stu-id="05b96-265">Limiting client actions in the app must be performed inside event handlers and not depend on the current rendered view state.</span></span>

<span data-ttu-id="05b96-266">Vezměte v úvahu komponentu čítače, která by uživateli umožnila zvýšit hodnotu čítače maximálně třikrát.</span><span class="sxs-lookup"><span data-stu-id="05b96-266">Consider a counter component that should allow a user to increment a counter a maximum of three times.</span></span> <span data-ttu-id="05b96-267">Tlačítko pro zvýšení čítače je podmíněně na základě hodnoty `count` :</span><span class="sxs-lookup"><span data-stu-id="05b96-267">The button to increment the counter is conditionally based on the value of `count`:</span></span>

```razor
<p>Count: @count<p>

@if (count < 3)
{
    <button @onclick="IncrementCount" value="Increment count" />
}

@code 
{
    private int count = 0;

    private void IncrementCount()
    {
        count++;
    }
}
```

<span data-ttu-id="05b96-268">Klient může odeslat jednu nebo více událostí přírůstku předtím, než architektura vytvoří nové vykreslování této součásti.</span><span class="sxs-lookup"><span data-stu-id="05b96-268">A client can dispatch one or more increment events before the framework produces a new render of this component.</span></span> <span data-ttu-id="05b96-269">Výsledkem je, že `count` uživatel může tento krok zvýšit *za třikrát* , protože toto tlačítko není v uživatelském rozhraní k dispozici dostatečně rychle.</span><span class="sxs-lookup"><span data-stu-id="05b96-269">The result is that the `count` can be incremented *over three times* by the user because the button isn't removed by the UI quickly enough.</span></span> <span data-ttu-id="05b96-270">Správný způsob, jak dosáhnout limitu tří `count` přírůstků, je znázorněn v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="05b96-270">The correct way to achieve the limit of three `count` increments is shown in the following example:</span></span>

```razor
<p>Count: @count<p>

@if (count < 3)
{
    <button @onclick="IncrementCount" value="Increment count" />
}

@code 
{
    private int count = 0;

    private void IncrementCount()
    {
        if (count < 3)
        {
            count++;
        }
    }
}
```

<span data-ttu-id="05b96-271">Přidáním kontroly do `if (count < 3) { ... }` obslužné rutiny je rozhodnutí o zvýšení na `count` základě aktuálního stavu aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-271">By adding the `if (count < 3) { ... }` check inside the handler, the decision to increment `count` is based on the current app state.</span></span> <span data-ttu-id="05b96-272">Rozhodnutí není založené na stavu uživatelského rozhraní jako v předchozím příkladu, což může být dočasně zastaralé.</span><span class="sxs-lookup"><span data-stu-id="05b96-272">The decision isn't based on the state of the UI as it was in the previous example, which might be temporarily stale.</span></span>

### <a name="guard-against-multiple-dispatches"></a><span data-ttu-id="05b96-273">Ochrana proti více odesláním</span><span class="sxs-lookup"><span data-stu-id="05b96-273">Guard against multiple dispatches</span></span>

<span data-ttu-id="05b96-274">Pokud zpětné volání události vyvolá asynchronně běžící operaci, jako je například načítání dat z externí služby nebo databáze, zvažte použití ochrany.</span><span class="sxs-lookup"><span data-stu-id="05b96-274">If an event callback invokes a long running operation asynchronously, such as fetching data from an external service or database, consider using a guard.</span></span> <span data-ttu-id="05b96-275">Ochrana může uživatelům zabránit ve zařazení více operací do fronty, zatímco operace probíhá pomocí vizuální zpětné vazby.</span><span class="sxs-lookup"><span data-stu-id="05b96-275">The guard can prevent the user from queueing up multiple operations while the operation is in progress with visual feedback.</span></span> <span data-ttu-id="05b96-276">Následující kód komponenty nastaví `isLoading` na, `true` Když `GetForecastAsync` získá data ze serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-276">The following component code sets `isLoading` to `true` while `GetForecastAsync` obtains data from the server.</span></span> <span data-ttu-id="05b96-277">`isLoading`V nástroji je `true` tlačítko neaktivní v uživatelském rozhraní:</span><span class="sxs-lookup"><span data-stu-id="05b96-277">While `isLoading` is `true`, the button is disabled in the UI:</span></span>

```razor
@page "/fetchdata"
@using BlazorServerSample.Data
@inject WeatherForecastService ForecastService

<button disabled="@isLoading" @onclick="UpdateForecasts">Update</button>

@code {
    private bool isLoading;
    private WeatherForecast[] forecasts;

    private async Task UpdateForecasts()
    {
        if (!isLoading)
        {
            isLoading = true;
            forecasts = await ForecastService.GetForecastAsync(DateTime.Now);
            isLoading = false;
        }
    }
}
```

<span data-ttu-id="05b96-278">Vzor ochrany znázorněný v předchozím příkladu funguje, pokud je operace na pozadí prováděna asynchronně se `async` - `await` vzorem.</span><span class="sxs-lookup"><span data-stu-id="05b96-278">The guard pattern demonstrated in the preceding example works if the background operation is executed asynchronously with the `async`-`await` pattern.</span></span>

### <a name="cancel-early-and-avoid-use-after-dispose"></a><span data-ttu-id="05b96-279">Zrušit počáteční a vyhnout se použití po vyřazení</span><span class="sxs-lookup"><span data-stu-id="05b96-279">Cancel early and avoid use-after-dispose</span></span>

<span data-ttu-id="05b96-280">Kromě používání ochrany, jak je popsáno v části [Guard proti více odesláních](#guard-against-multiple-dispatches) , zvažte použití nástroje <xref:System.Threading.CancellationToken> ke zrušení dlouhotrvajících operací při likvidaci komponenty.</span><span class="sxs-lookup"><span data-stu-id="05b96-280">In addition to using a guard as described in the [Guard against multiple dispatches](#guard-against-multiple-dispatches) section, consider using a <xref:System.Threading.CancellationToken> to cancel long-running operations when the component is disposed.</span></span> <span data-ttu-id="05b96-281">Tento přístup má výhodu při zamezení používání funkcí *po Dispose* v součástech:</span><span class="sxs-lookup"><span data-stu-id="05b96-281">This approach has the added benefit of avoiding *use-after-dispose* in components:</span></span>

```razor
@implements IDisposable

...

@code {
    private readonly CancellationTokenSource TokenSource = 
        new CancellationTokenSource();

    private async Task UpdateForecasts()
    {
        ...

        forecasts = await ForecastService.GetForecastAsync(DateTime.Now, 
            TokenSource.Token);

        if (TokenSource.Token.IsCancellationRequested)
        {
           return;
        }

        ...
    }

    public void Dispose()
    {
        TokenSource.Cancel();
    }
}
```

### <a name="avoid-events-that-produce-large-amounts-of-data"></a><span data-ttu-id="05b96-282">Vyhněte se událostem, které vytváří velké objemy dat</span><span class="sxs-lookup"><span data-stu-id="05b96-282">Avoid events that produce large amounts of data</span></span>

<span data-ttu-id="05b96-283">Některé události modelu DOM, například `oninput` nebo `onscroll` , mohou vytvořit velké množství dat.</span><span class="sxs-lookup"><span data-stu-id="05b96-283">Some DOM events, such as `oninput` or `onscroll`, can produce a large amount of data.</span></span> <span data-ttu-id="05b96-284">Nepoužívejte tyto události v Blazor serverových aplikacích.</span><span class="sxs-lookup"><span data-stu-id="05b96-284">Avoid using these events in Blazor server apps.</span></span>

## <a name="additional-security-guidance"></a><span data-ttu-id="05b96-285">Další pokyny k zabezpečení</span><span class="sxs-lookup"><span data-stu-id="05b96-285">Additional security guidance</span></span>

<span data-ttu-id="05b96-286">Pokyny pro zabezpečení ASP.NET Core aplikací se vztahují na Blazor serverové aplikace a jsou uvedené v následujících oddílech:</span><span class="sxs-lookup"><span data-stu-id="05b96-286">The guidance for securing ASP.NET Core apps apply to Blazor Server apps and are covered in the following sections:</span></span>

* [<span data-ttu-id="05b96-287">Protokolování a citlivá data</span><span class="sxs-lookup"><span data-stu-id="05b96-287">Logging and sensitive data</span></span>](#logging-and-sensitive-data)
* [<span data-ttu-id="05b96-288">Ochrana informací při přenosu pomocí protokolu HTTPS</span><span class="sxs-lookup"><span data-stu-id="05b96-288">Protect information in transit with HTTPS</span></span>](#protect-information-in-transit-with-https)
* [<span data-ttu-id="05b96-289">Skriptování mezi weby (XSS)</span><span class="sxs-lookup"><span data-stu-id="05b96-289">Cross-site scripting (XSS)</span></span>](#cross-site-scripting-xss)
* [<span data-ttu-id="05b96-290">Ochrana mezi zdroji</span><span class="sxs-lookup"><span data-stu-id="05b96-290">Cross-origin protection</span></span>](#cross-origin-protection)
* [<span data-ttu-id="05b96-291">Kliknutí – zdířka</span><span class="sxs-lookup"><span data-stu-id="05b96-291">Click-jacking</span></span>](#click-jacking)
* [<span data-ttu-id="05b96-292">Otevřít přesměrování</span><span class="sxs-lookup"><span data-stu-id="05b96-292">Open redirects</span></span>](#open-redirects)

### <a name="logging-and-sensitive-data"></a><span data-ttu-id="05b96-293">Protokolování a citlivá data</span><span class="sxs-lookup"><span data-stu-id="05b96-293">Logging and sensitive data</span></span>

<span data-ttu-id="05b96-294">Interakce interoperability v JS mezi klientem a serverem se zaznamenávají v protokolech serveru s <xref:Microsoft.Extensions.Logging.ILogger> instancemi.</span><span class="sxs-lookup"><span data-stu-id="05b96-294">JS interop interactions between the client and server are recorded in the server's logs with <xref:Microsoft.Extensions.Logging.ILogger> instances.</span></span> Blazor<span data-ttu-id="05b96-295">Nepoužívejte protokolování citlivých informací, jako jsou například skutečné události nebo vstupy a výstupy interoperability JS.</span><span class="sxs-lookup"><span data-stu-id="05b96-295"> avoids logging sensitive information, such as actual events or JS interop inputs and outputs.</span></span>

<span data-ttu-id="05b96-296">Když na serveru dojde k chybě, rozhraní upozorní klienta a rozhlasí relaci.</span><span class="sxs-lookup"><span data-stu-id="05b96-296">When an error occurs on the server, the framework notifies the client and tears down the session.</span></span> <span data-ttu-id="05b96-297">Ve výchozím nastavení klient obdrží obecnou chybovou zprávu, která se může zobrazit v vývojářských nástrojích prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="05b96-297">By default, the client receives a generic error message that can be seen in the browser's developer tools.</span></span>

<span data-ttu-id="05b96-298">Chyba na straně klienta neobsahuje zásobník volání a neposkytuje podrobné informace o příčině chyby, ale protokoly serveru obsahují takové informace.</span><span class="sxs-lookup"><span data-stu-id="05b96-298">The client-side error doesn't include the callstack and doesn't provide detail on the cause of the error, but server logs do contain such information.</span></span> <span data-ttu-id="05b96-299">Pro účely vývoje lze klientovi zpřístupnit citlivé informace o chybách tím, že povolíte podrobné chyby.</span><span class="sxs-lookup"><span data-stu-id="05b96-299">For development purposes, sensitive error information can be made available to the client by enabling detailed errors.</span></span>

<span data-ttu-id="05b96-300">Povolit podrobné chyby v JavaScriptu pomocí:</span><span class="sxs-lookup"><span data-stu-id="05b96-300">Enable detailed errors in JavaScript with:</span></span>

* <span data-ttu-id="05b96-301"><xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DetailedErrors?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="05b96-301"><xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.DetailedErrors?displayProperty=nameWithType>.</span></span>
* <span data-ttu-id="05b96-302">`DetailedErrors`Konfigurační klíč nastavený na `true` , který se dá nastavit v souboru nastavení aplikace ( `appsettings.json` ).</span><span class="sxs-lookup"><span data-stu-id="05b96-302">The `DetailedErrors` configuration key set to `true`, which can be set in the app settings file (`appsettings.json`).</span></span> <span data-ttu-id="05b96-303">Klíč lze také nastavit pomocí `ASPNETCORE_DETAILEDERRORS` proměnné prostředí s hodnotou `true` .</span><span class="sxs-lookup"><span data-stu-id="05b96-303">The key can also be set using the `ASPNETCORE_DETAILEDERRORS` environment variable with a value of `true`.</span></span>

> [!WARNING]
> <span data-ttu-id="05b96-304">Odhalení informací o chybách klientům na internetu je bezpečnostní riziko, které by se mělo vždy vyhnout.</span><span class="sxs-lookup"><span data-stu-id="05b96-304">Exposing error information to clients on the Internet is a security risk that should always be avoided.</span></span>

### <a name="protect-information-in-transit-with-https"></a><span data-ttu-id="05b96-305">Ochrana informací při přenosu pomocí protokolu HTTPS</span><span class="sxs-lookup"><span data-stu-id="05b96-305">Protect information in transit with HTTPS</span></span>

Blazor<span data-ttu-id="05b96-306">Server používá SignalR ke komunikaci mezi klientem a serverem.</span><span class="sxs-lookup"><span data-stu-id="05b96-306"> Server uses SignalR for communication between the client and the server.</span></span> Blazor<span data-ttu-id="05b96-307">Server normálně používá přenos, který SignalR je vyjednávat, což je obvykle WebSockets.</span><span class="sxs-lookup"><span data-stu-id="05b96-307"> Server normally uses the transport that SignalR negotiates, which is typically WebSockets.</span></span>

Blazor<span data-ttu-id="05b96-308">Server nezajišťuje integritu a důvěrnost dat odesílaných mezi serverem a klientem.</span><span class="sxs-lookup"><span data-stu-id="05b96-308"> Server doesn't ensure the integrity and confidentiality of the data sent between the server and the client.</span></span> <span data-ttu-id="05b96-309">Vždy používat protokol HTTPS.</span><span class="sxs-lookup"><span data-stu-id="05b96-309">Always use HTTPS.</span></span>

### <a name="cross-site-scripting-xss"></a><span data-ttu-id="05b96-310">Skriptování mezi weby (XSS)</span><span class="sxs-lookup"><span data-stu-id="05b96-310">Cross-site scripting (XSS)</span></span>

<span data-ttu-id="05b96-311">Skriptování mezi weby (XSS) umožňuje neoprávněné straně spustit libovolnou logiku v kontextu prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="05b96-311">Cross-site scripting (XSS) allows an unauthorized party to execute arbitrary logic in the context of the browser.</span></span> <span data-ttu-id="05b96-312">Ohrožená aplikace by mohla spustit libovolný kód v klientovi.</span><span class="sxs-lookup"><span data-stu-id="05b96-312">A compromised app could potentially run arbitrary code on the client.</span></span> <span data-ttu-id="05b96-313">Chybu zabezpečení lze použít k potenciálnímu provedení určitého množství škodlivých akcí proti serveru:</span><span class="sxs-lookup"><span data-stu-id="05b96-313">The vulnerability could be used to potentially perform a number of malicious actions against the server:</span></span>

* <span data-ttu-id="05b96-314">Odeslání falešných/neplatných událostí na server.</span><span class="sxs-lookup"><span data-stu-id="05b96-314">Dispatch fake/invalid events to the server.</span></span>
* <span data-ttu-id="05b96-315">Odeslání neúspěšných nebo neplatných dokončení vykreslování.</span><span class="sxs-lookup"><span data-stu-id="05b96-315">Dispatch fail/invalid render completions.</span></span>
* <span data-ttu-id="05b96-316">Vyhněte se odesílání doplňování vykreslování.</span><span class="sxs-lookup"><span data-stu-id="05b96-316">Avoid dispatching render completions.</span></span>
* <span data-ttu-id="05b96-317">Odešlete volání Interop z JavaScriptu do .NET.</span><span class="sxs-lookup"><span data-stu-id="05b96-317">Dispatch interop calls from JavaScript to .NET.</span></span>
* <span data-ttu-id="05b96-318">Upravte odpověď volání Interop z rozhraní .NET na JavaScript.</span><span class="sxs-lookup"><span data-stu-id="05b96-318">Modify the response of interop calls from .NET to JavaScript.</span></span>
* <span data-ttu-id="05b96-319">Vyhněte se odesílání výsledků interoperability .NET to JS.</span><span class="sxs-lookup"><span data-stu-id="05b96-319">Avoid dispatching .NET to JS interop results.</span></span>

<span data-ttu-id="05b96-320">BlazorRozhraní serveru přijímá kroky k ochraně před některými předchozími hrozbami:</span><span class="sxs-lookup"><span data-stu-id="05b96-320">The Blazor Server framework takes steps to protect against some of the preceding threats:</span></span>

* <span data-ttu-id="05b96-321">Ukončí vytváření nových aktualizací uživatelského rozhraní, pokud klient nepotvrzující dávky vykreslování.</span><span class="sxs-lookup"><span data-stu-id="05b96-321">Stops producing new UI updates if the client isn't acknowledging render batches.</span></span> <span data-ttu-id="05b96-322">Nakonfigurováno pomocí <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.MaxBufferedUnacknowledgedRenderBatches?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="05b96-322">Configured with <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.MaxBufferedUnacknowledgedRenderBatches?displayProperty=nameWithType>.</span></span>
* <span data-ttu-id="05b96-323">Vyprší časový limit volání rozhraní .NET do JavaScriptu po jedné minutě, aniž by byla obdržena odpověď od klienta.</span><span class="sxs-lookup"><span data-stu-id="05b96-323">Times out any .NET to JavaScript call after one minute without receiving a response from the client.</span></span> <span data-ttu-id="05b96-324">Nakonfigurováno pomocí <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="05b96-324">Configured with <xref:Microsoft.AspNetCore.Components.Server.CircuitOptions.JSInteropDefaultCallTimeout?displayProperty=nameWithType>.</span></span>
* <span data-ttu-id="05b96-325">Provede základní ověření na všech vstupech přicházejících z prohlížeče během interoperability JS:</span><span class="sxs-lookup"><span data-stu-id="05b96-325">Performs basic validation on all input coming from the browser during JS interop:</span></span>
  * <span data-ttu-id="05b96-326">Odkazy .NET jsou platné a typ očekávaný metodou .NET.</span><span class="sxs-lookup"><span data-stu-id="05b96-326">.NET references are valid and of the type expected by the .NET method.</span></span>
  * <span data-ttu-id="05b96-327">Data nejsou poškozena.</span><span class="sxs-lookup"><span data-stu-id="05b96-327">The data isn't malformed.</span></span>
  * <span data-ttu-id="05b96-328">V datové části je uveden správný počet argumentů pro metodu.</span><span class="sxs-lookup"><span data-stu-id="05b96-328">The correct number of arguments for the method are present in the payload.</span></span>
  * <span data-ttu-id="05b96-329">Argumenty nebo výsledky lze před vyvoláním metody deserializovat správně.</span><span class="sxs-lookup"><span data-stu-id="05b96-329">The arguments or result can be deserialized correctly before invoking the method.</span></span>
* <span data-ttu-id="05b96-330">Provede základní ověření ve všech vstupech přicházejících z prohlížeče z odeslaných událostí:</span><span class="sxs-lookup"><span data-stu-id="05b96-330">Performs basic validation in all input coming from the browser from dispatched events:</span></span>
  * <span data-ttu-id="05b96-331">Událost má platný typ.</span><span class="sxs-lookup"><span data-stu-id="05b96-331">The event has a valid type.</span></span>
  * <span data-ttu-id="05b96-332">Data pro událost lze deserializovat.</span><span class="sxs-lookup"><span data-stu-id="05b96-332">The data for the event can be deserialized.</span></span>
  * <span data-ttu-id="05b96-333">K události je přidružená obslužná rutina události.</span><span class="sxs-lookup"><span data-stu-id="05b96-333">There's an event handler associated with the event.</span></span>

<span data-ttu-id="05b96-334">Kromě ochrany, kterou implementuje rozhraní, musí být aplikace kódována vývojářem k ochraně před hrozbami a provádět příslušné akce:</span><span class="sxs-lookup"><span data-stu-id="05b96-334">In addition to the safeguards that the framework implements, the app must be coded by the developer to safeguard against threats and take appropriate actions:</span></span>

* <span data-ttu-id="05b96-335">Při zpracování událostí vždy ověřovat data.</span><span class="sxs-lookup"><span data-stu-id="05b96-335">Always validate data when handling events.</span></span>
* <span data-ttu-id="05b96-336">Po přijetí neplatných dat proveďte příslušnou akci:</span><span class="sxs-lookup"><span data-stu-id="05b96-336">Take appropriate action upon receiving invalid data:</span></span>
  * <span data-ttu-id="05b96-337">Ignorujte data a vraťte se.</span><span class="sxs-lookup"><span data-stu-id="05b96-337">Ignore the data and return.</span></span> <span data-ttu-id="05b96-338">Tím umožníte, aby aplikace pokračovala v zpracování požadavků.</span><span class="sxs-lookup"><span data-stu-id="05b96-338">This allows the app to continue processing requests.</span></span>
  * <span data-ttu-id="05b96-339">Pokud aplikace zjistí, že vstup je illegitimate a nemohl být vytvořen legitimním klientem, vyvolejte výjimku.</span><span class="sxs-lookup"><span data-stu-id="05b96-339">If the app determines that the input is illegitimate and couldn't be produced by legitimate client, throw an exception.</span></span> <span data-ttu-id="05b96-340">Došlo k výjimce při odtrhlině okruhu a ukončení relace.</span><span class="sxs-lookup"><span data-stu-id="05b96-340">Throwing an exception tears down the circuit and ends the session.</span></span>
* <span data-ttu-id="05b96-341">Nedůvěra na chybovou zprávu poskytovanou dokončováním dávek vykreslování zahrnutými v protokolech.</span><span class="sxs-lookup"><span data-stu-id="05b96-341">Don't trust the error message provided by render batch completions included in the logs.</span></span> <span data-ttu-id="05b96-342">Klient poskytuje chybu a nemůže být obecně důvěryhodný, protože může dojít k ohrožení zabezpečení klienta.</span><span class="sxs-lookup"><span data-stu-id="05b96-342">The error is provided by the client and can't generally be trusted, as the client might be compromised.</span></span>
* <span data-ttu-id="05b96-343">Nedůvěřovat vstupu volání interoperability JS v obou směrech mezi metodami jazyka JavaScript a .NET.</span><span class="sxs-lookup"><span data-stu-id="05b96-343">Don't trust the input on JS interop calls in either direction between JavaScript and .NET methods.</span></span>
* <span data-ttu-id="05b96-344">Aplikace zodpovídá za ověření, že obsah argumentů a výsledků je platný, i když jsou argumenty nebo výsledky správně deserializovány.</span><span class="sxs-lookup"><span data-stu-id="05b96-344">The app is responsible for validating that the content of arguments and results are valid, even if the arguments or results are correctly deserialized.</span></span>

<span data-ttu-id="05b96-345">Aby mohla existovat ohrožení zabezpečení XSS, musí aplikace na vykreslené stránce zahrnovat vstup uživatele.</span><span class="sxs-lookup"><span data-stu-id="05b96-345">For a XSS vulnerability to exist, the app must incorporate user input in the rendered page.</span></span> Blazor<span data-ttu-id="05b96-346">Serverové komponenty spouštějí krok v čase kompilace, kde je kód v `.razor` souboru transformován do logiky jazyka C#.</span><span class="sxs-lookup"><span data-stu-id="05b96-346"> Server components execute a compile-time step where the markup in a `.razor` file is transformed into procedural C# logic.</span></span> <span data-ttu-id="05b96-347">V době běhu vytvoří logika jazyka C# *strom vykreslování* , který popisuje prvky, text a podřízené komponenty.</span><span class="sxs-lookup"><span data-stu-id="05b96-347">At runtime, the C# logic builds a *render tree* describing the elements, text, and child components.</span></span> <span data-ttu-id="05b96-348">To se aplikuje na DOM v prohlížeči pomocí sekvence instrukcí JavaScriptu (nebo je v případě předvykreslování serializovaná na HTML):</span><span class="sxs-lookup"><span data-stu-id="05b96-348">This is applied to the browser's DOM via a sequence of JavaScript instructions (or is serialized to HTML in the case of prerendering):</span></span>

* <span data-ttu-id="05b96-349">Uživatelský vstup vykreslený pomocí normální Razor syntaxe (například `@someStringValue` ) nevystavuje zranitelnost XSS, protože Razor syntaxe je přidána do modelu DOM prostřednictvím příkazů, které mohou zapisovat pouze text.</span><span class="sxs-lookup"><span data-stu-id="05b96-349">User input rendered via normal Razor syntax (for example, `@someStringValue`) doesn't expose a XSS vulnerability because the Razor syntax is added to the DOM via commands that can only write text.</span></span> <span data-ttu-id="05b96-350">I v případě, že hodnota obsahuje kód HTML, hodnota se zobrazí jako statický text.</span><span class="sxs-lookup"><span data-stu-id="05b96-350">Even if the value includes HTML markup, the value is displayed as static text.</span></span> <span data-ttu-id="05b96-351">Při předběžné vykreslování je výstupem kódovaný HTML, který také zobrazuje obsah jako statický text.</span><span class="sxs-lookup"><span data-stu-id="05b96-351">When prerendering, the output is HTML-encoded, which also displays the content as static text.</span></span>
* <span data-ttu-id="05b96-352">Značky skriptu nejsou povoleny a neměly by být zahrnuty do stromu vykreslování součásti aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-352">Script tags aren't allowed and shouldn't be included in the app's component render tree.</span></span> <span data-ttu-id="05b96-353">Je-li značka skriptu obsažena v kódu komponenty, je vygenerována chyba při kompilaci.</span><span class="sxs-lookup"><span data-stu-id="05b96-353">If a script tag is included in a component's markup, a compile-time error is generated.</span></span>
* <span data-ttu-id="05b96-354">Autoři komponent mohou vytvářet komponenty v jazyce C# bez použití Razor .</span><span class="sxs-lookup"><span data-stu-id="05b96-354">Component authors can author components in C# without using Razor.</span></span> <span data-ttu-id="05b96-355">Autor komponenty zodpovídá za použití správných rozhraní API při generování výstupu.</span><span class="sxs-lookup"><span data-stu-id="05b96-355">The component author is responsible for using the correct APIs when emitting output.</span></span> <span data-ttu-id="05b96-356">Můžete například použít `builder.AddContent(0, someUserSuppliedString)` a *nikoli* `builder.AddMarkupContent(0, someUserSuppliedString)` , protože by to mohlo vytvořit chybu zabezpečení XSS.</span><span class="sxs-lookup"><span data-stu-id="05b96-356">For example, use `builder.AddContent(0, someUserSuppliedString)` and *not* `builder.AddMarkupContent(0, someUserSuppliedString)`, as the latter could create a XSS vulnerability.</span></span>

<span data-ttu-id="05b96-357">Jako součást ochrany proti útokům XSS zvažte implementaci zmírnění XSS, jako je například [zásada zabezpečení obsahu (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP).</span><span class="sxs-lookup"><span data-stu-id="05b96-357">As part of protecting against XSS attacks, consider implementing XSS mitigations, such as [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP).</span></span>

<span data-ttu-id="05b96-358">Další informace naleznete v tématu <xref:security/cross-site-scripting>.</span><span class="sxs-lookup"><span data-stu-id="05b96-358">For more information, see <xref:security/cross-site-scripting>.</span></span>

### <a name="cross-origin-protection"></a><span data-ttu-id="05b96-359">Ochrana mezi zdroji</span><span class="sxs-lookup"><span data-stu-id="05b96-359">Cross-origin protection</span></span>

<span data-ttu-id="05b96-360">Útoky mezi zdroji zahrnují klienta z jiného zdroje, který provádí akci na serveru.</span><span class="sxs-lookup"><span data-stu-id="05b96-360">Cross-origin attacks involve a client from a different origin performing an action against the server.</span></span> <span data-ttu-id="05b96-361">Škodlivá akce je obvykle požadavek GET nebo POST formuláře (pro padělání žádostí mezi weby, CSRF), ale otevírání škodlivého WebSocket je také možné.</span><span class="sxs-lookup"><span data-stu-id="05b96-361">The malicious action is typically a GET request or a form POST (Cross-Site Request Forgery, CSRF), but opening a malicious WebSocket is also possible.</span></span> Blazor<span data-ttu-id="05b96-362">Serverové aplikace nabízejí [stejné záruky jako všechny ostatní SignalR aplikace s využitím nabídky protokolu rozbočovače](xref:signalr/security):</span><span class="sxs-lookup"><span data-stu-id="05b96-362"> Server apps offer [the same guarantees that any other SignalR app using the hub protocol offer](xref:signalr/security):</span></span>

* Blazor<span data-ttu-id="05b96-363">K serverovým aplikacím se dá přihlédnout z více zdrojů, pokud se nepřijmou další opatření, která jim zabrání.</span><span class="sxs-lookup"><span data-stu-id="05b96-363"> Server apps can be accessed cross-origin unless additional measures are taken to prevent it.</span></span> <span data-ttu-id="05b96-364">Pokud chcete zakázat přístup pro více zdrojů, buď zakažte CORS v koncovém bodu přidáním middlewaru CORS do kanálu a přidáním <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> do Blazor metadat koncového bodu, nebo omezte sadu povolených [ SignalR zdrojů konfigurací pro sdílení prostředků mezi zdroji](xref:signalr/security#cross-origin-resource-sharing).</span><span class="sxs-lookup"><span data-stu-id="05b96-364">To disable cross-origin access, either disable CORS in the endpoint by adding the CORS middleware to the pipeline and adding the <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> to the Blazor endpoint metadata or limit the set of allowed origins by [configuring SignalR for cross-origin resource sharing](xref:signalr/security#cross-origin-resource-sharing).</span></span>
* <span data-ttu-id="05b96-365">Pokud je CORS povolená, můžou se při ochraně aplikace v závislosti na konfiguraci CORS vyžadovat další kroky.</span><span class="sxs-lookup"><span data-stu-id="05b96-365">If CORS is enabled, extra steps might be required to protect the app depending on the CORS configuration.</span></span> <span data-ttu-id="05b96-366">Pokud je CORS povolená globálně, můžete pro centrum serverů zakázat CORS, a Blazor to přidáním <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> metadat do metadat koncového bodu po volání do <xref:Microsoft.AspNetCore.Builder.ComponentEndpointRouteBuilderExtensions.MapBlazorHub%2A> Tvůrce tras koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="05b96-366">If CORS is globally enabled, CORS can be disabled for the Blazor Server hub by adding the <xref:Microsoft.AspNetCore.Cors.DisableCorsAttribute> metadata to the endpoint metadata after calling <xref:Microsoft.AspNetCore.Builder.ComponentEndpointRouteBuilderExtensions.MapBlazorHub%2A> on the endpoint route builder.</span></span>

<span data-ttu-id="05b96-367">Další informace naleznete v tématu <xref:security/anti-request-forgery>.</span><span class="sxs-lookup"><span data-stu-id="05b96-367">For more information, see <xref:security/anti-request-forgery>.</span></span>

### <a name="click-jacking"></a><span data-ttu-id="05b96-368">Kliknutí – zdířka</span><span class="sxs-lookup"><span data-stu-id="05b96-368">Click-jacking</span></span>

<span data-ttu-id="05b96-369">Kliknutí na zásuvky zahrnuje vykreslování lokality jako `<iframe>` v rámci lokality z jiného zdroje, aby uživatel mohl v rámci útoku přimět uživatele k provádění akcí na webu.</span><span class="sxs-lookup"><span data-stu-id="05b96-369">Click-jacking involves rendering a site as an `<iframe>` inside a site from a different origin in order to trick the user into performing actions on the site under attack.</span></span>

<span data-ttu-id="05b96-370">K ochraně aplikace před vykreslováním v nástroji `<iframe>` použijte [zásady zabezpečení obsahu (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) a `X-Frame-Options` hlavičku.</span><span class="sxs-lookup"><span data-stu-id="05b96-370">To protect an app from rendering inside of an `<iframe>`, use [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) and the `X-Frame-Options` header.</span></span> <span data-ttu-id="05b96-371">Další informace najdete v tématu [MDN web Docs: X-frame-Options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options).</span><span class="sxs-lookup"><span data-stu-id="05b96-371">For more information, see [MDN web docs: X-Frame-Options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options).</span></span>

### <a name="open-redirects"></a><span data-ttu-id="05b96-372">Otevřít přesměrování</span><span class="sxs-lookup"><span data-stu-id="05b96-372">Open redirects</span></span>

<span data-ttu-id="05b96-373">Když se Blazor spustí relace serverových aplikací, Server provede základní ověření adres URL odesílaných v rámci zahájení relace.</span><span class="sxs-lookup"><span data-stu-id="05b96-373">When a Blazor Server app session starts, the server performs basic validation of the URLs sent as part of starting the session.</span></span> <span data-ttu-id="05b96-374">Architektura kontroluje, zda je základní adresa URL nadřazena aktuální adrese URL před vytvořením okruhu.</span><span class="sxs-lookup"><span data-stu-id="05b96-374">The framework checks that the base URL is a parent of the current URL before establishing the circuit.</span></span> <span data-ttu-id="05b96-375">Rozhraní neprovádí žádné další kontroly.</span><span class="sxs-lookup"><span data-stu-id="05b96-375">No additional checks are performed by the framework.</span></span>

<span data-ttu-id="05b96-376">Když uživatel vybere odkaz na klientovi, adresa URL odkazu se pošle na server, který určuje, jakou akci chcete provést.</span><span class="sxs-lookup"><span data-stu-id="05b96-376">When a user selects a link on the client, the URL for the link is sent to the server, which determines what action to take.</span></span> <span data-ttu-id="05b96-377">Aplikace může například provádět navigaci na straně klienta nebo naznačit prohlížeči, aby přešel do nového umístění.</span><span class="sxs-lookup"><span data-stu-id="05b96-377">For example, the app may perform a client-side navigation or indicate to the browser to go to the new location.</span></span>

<span data-ttu-id="05b96-378">Komponenty mohou také aktivovat požadavky na navigaci programově prostřednictvím použití <xref:Microsoft.AspNetCore.Components.NavigationManager> .</span><span class="sxs-lookup"><span data-stu-id="05b96-378">Components can also trigger navigation requests programatically through the use of <xref:Microsoft.AspNetCore.Components.NavigationManager>.</span></span> <span data-ttu-id="05b96-379">V takových scénářích může aplikace provést navigaci na straně klienta nebo v prohlížeči označit, že se má přejít na nové umístění.</span><span class="sxs-lookup"><span data-stu-id="05b96-379">In such scenarios, the app might perform a client-side navigation or indicate to the browser to go to the new location.</span></span>

<span data-ttu-id="05b96-380">Komponenty musí:</span><span class="sxs-lookup"><span data-stu-id="05b96-380">Components must:</span></span>

* <span data-ttu-id="05b96-381">Nepoužívejte vstup uživatele jako součást argumentů volání navigace.</span><span class="sxs-lookup"><span data-stu-id="05b96-381">Avoid using user input as part of the navigation call arguments.</span></span>
* <span data-ttu-id="05b96-382">Ověřte argumenty a ujistěte se, že je cíl povolený aplikací.</span><span class="sxs-lookup"><span data-stu-id="05b96-382">Validate arguments to ensure that the target is allowed by the app.</span></span>

<span data-ttu-id="05b96-383">V opačném případě může uživatel se zlými úmysly vynutit, aby prohlížeč přešel k webu kontrolovanému útočníkem.</span><span class="sxs-lookup"><span data-stu-id="05b96-383">Otherwise, a malicious user can force the browser to go to an attacker-controlled site.</span></span> <span data-ttu-id="05b96-384">V tomto scénáři útočník získá aplikaci do použití určitého vstupu uživatele jako součást volání <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> metody.</span><span class="sxs-lookup"><span data-stu-id="05b96-384">In this scenario, the attacker tricks the app into using some user input as part of the invocation of the <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="05b96-385">Tato doporučení platí i při vykreslování odkazů jako součást aplikace:</span><span class="sxs-lookup"><span data-stu-id="05b96-385">This advice also applies when rendering links as part of the app:</span></span>

* <span data-ttu-id="05b96-386">Pokud je to možné, používejte relativní odkazy.</span><span class="sxs-lookup"><span data-stu-id="05b96-386">If possible, use relative links.</span></span>
* <span data-ttu-id="05b96-387">Ověřte, zda jsou cíle absolutních odkazů platné, než je zařadíte do stránky.</span><span class="sxs-lookup"><span data-stu-id="05b96-387">Validate that absolute link destinations are valid before including them in a page.</span></span>

<span data-ttu-id="05b96-388">Další informace naleznete v tématu <xref:security/preventing-open-redirects>.</span><span class="sxs-lookup"><span data-stu-id="05b96-388">For more information, see <xref:security/preventing-open-redirects>.</span></span>

## <a name="security-checklist"></a><span data-ttu-id="05b96-389">Kontrolní seznam zabezpečení</span><span class="sxs-lookup"><span data-stu-id="05b96-389">Security checklist</span></span>

<span data-ttu-id="05b96-390">Následující seznam bezpečnostních otázek není vyčerpávající:</span><span class="sxs-lookup"><span data-stu-id="05b96-390">The following list of security considerations isn't comprehensive:</span></span>

* <span data-ttu-id="05b96-391">Ověřte argumenty z událostí.</span><span class="sxs-lookup"><span data-stu-id="05b96-391">Validate arguments from events.</span></span>
* <span data-ttu-id="05b96-392">Ověřte vstupy a výsledky volání interoperability JS.</span><span class="sxs-lookup"><span data-stu-id="05b96-392">Validate inputs and results from JS interop calls.</span></span>
* <span data-ttu-id="05b96-393">Nepoužívejte (nebo ověřte předem) uživatelský vstup pro volání interoperability .NET to JS.</span><span class="sxs-lookup"><span data-stu-id="05b96-393">Avoid using (or validate beforehand) user input for .NET to JS interop calls.</span></span>
* <span data-ttu-id="05b96-394">Zabrání klientovi v přidělování nevázané velikosti paměti.</span><span class="sxs-lookup"><span data-stu-id="05b96-394">Prevent the client from allocating an unbound amount of memory.</span></span>
  * <span data-ttu-id="05b96-395">Data v rámci součásti.</span><span class="sxs-lookup"><span data-stu-id="05b96-395">Data within the component.</span></span>
  * <span data-ttu-id="05b96-396">`DotNetObject`odkazy vracené klientovi.</span><span class="sxs-lookup"><span data-stu-id="05b96-396">`DotNetObject` references returned to the client.</span></span>
* <span data-ttu-id="05b96-397">Ochrana proti více odesláním.</span><span class="sxs-lookup"><span data-stu-id="05b96-397">Guard against multiple dispatches.</span></span>
* <span data-ttu-id="05b96-398">Zrušit dlouhotrvající operace, když je komponenta vyřazena.</span><span class="sxs-lookup"><span data-stu-id="05b96-398">Cancel long-running operations when the component is disposed.</span></span>
* <span data-ttu-id="05b96-399">Vyhněte se událostem, které vytváří velké objemy dat.</span><span class="sxs-lookup"><span data-stu-id="05b96-399">Avoid events that produce large amounts of data.</span></span>
* <span data-ttu-id="05b96-400">Vyhněte se použití vstupu uživatele jako součásti volání <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> a ověření vstupu uživatele pro adresy URL proti sadě povolených původních míst, pokud je to nenevyhnutelné.</span><span class="sxs-lookup"><span data-stu-id="05b96-400">Avoid using user input as part of calls to <xref:Microsoft.AspNetCore.Components.NavigationManager.NavigateTo%2A?displayProperty=nameWithType> and validate user input for URLs against a set of allowed origins first if unavoidable.</span></span>
* <span data-ttu-id="05b96-401">Neprovádějte rozhodnutí o autorizaci na základě stavu uživatelského rozhraní, ale jenom ze stavu součásti.</span><span class="sxs-lookup"><span data-stu-id="05b96-401">Don't make authorization decisions based on the state of the UI but only from component state.</span></span>
* <span data-ttu-id="05b96-402">Zvažte použití [zásad zabezpečení obsahu (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) k ochraně před útoky XSS.</span><span class="sxs-lookup"><span data-stu-id="05b96-402">Consider using [Content Security Policy (CSP)](https://developer.mozilla.org/docs/Web/HTTP/CSP) to protect against XSS attacks.</span></span>
* <span data-ttu-id="05b96-403">Zvažte použití CSP a [možností X-frame –](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options) k ochraně před kliknutím na konektory.</span><span class="sxs-lookup"><span data-stu-id="05b96-403">Consider using CSP and [X-Frame-Options](https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options) to protect against click-jacking.</span></span>
* <span data-ttu-id="05b96-404">Zajistěte, aby nastavení CORS byla vhodná při povolování CORS nebo explicitně zakázala CORS pro Blazor aplikace.</span><span class="sxs-lookup"><span data-stu-id="05b96-404">Ensure CORS settings are appropriate when enabling CORS or explicitly disable CORS for Blazor apps.</span></span>
* <span data-ttu-id="05b96-405">Otestujte, abyste zajistili, že omezení na straně serveru pro Blazor aplikaci poskytují přijatelné uživatelské prostředí bez nepřijatelných úrovní rizika.</span><span class="sxs-lookup"><span data-stu-id="05b96-405">Test to ensure that the server-side limits for the Blazor app provide an acceptable user experience without unacceptable levels of risk.</span></span>
