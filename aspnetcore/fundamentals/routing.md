---
title: Směrování v ASP.NET jádru
author: rick-anderson
description: Zjistěte, jak ASP.NET základní směrování je zodpovědný za odpovídající požadavky HTTP a odeslání spustitelných koncových bodů.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 4/1/2020
uid: fundamentals/routing
ms.openlocfilehash: 0fc89ccf15c14c67f284a7084a21159af300a195
ms.sourcegitcommit: 5af16166977da598953f82da3ed3b7712d38f6cb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/14/2020
ms.locfileid: "81277220"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="ba1ea-103">Směrování v ASP.NET jádru</span><span class="sxs-lookup"><span data-stu-id="ba1ea-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="ba1ea-104">[Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5), a [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-104">By [Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="ba1ea-105">Směrování je zodpovědný za odpovídající příchozí požadavky HTTP a odeslání těchto požadavků do koncových bodů spustitelné aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-105">Routing is responsible for matching incoming HTTP requests and dispatching those requests to the app's executable endpoints.</span></span> <span data-ttu-id="ba1ea-106">[Koncové body](#endpoint) jsou jednotky kódu zpracování spustitelných požadavků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-106">[Endpoints](#endpoint) are the app's units of executable request-handling code.</span></span> <span data-ttu-id="ba1ea-107">Koncové body jsou definovány v aplikaci a nakonfigurovány při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-107">Endpoints are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="ba1ea-108">Proces porovnávání koncových bodů můžete extrahovat hodnoty z adresy URL požadavku a poskytnout tyto hodnoty pro zpracování požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-108">The endpoint matching process can extract values from the request's URL and provide those values for request processing.</span></span> <span data-ttu-id="ba1ea-109">Pomocí informací o koncovém bodu z aplikace směrování je také možné generovat adresy URL, které mapují koncové body.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-109">Using endpoint information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="ba1ea-110">Aplikace mohou konfigurovat směrování pomocí:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-110">Apps can configure routing using:</span></span>

- <span data-ttu-id="ba1ea-111">Kontrolery</span><span class="sxs-lookup"><span data-stu-id="ba1ea-111">Controllers</span></span>
- <span data-ttu-id="ba1ea-112">Razor Pages</span><span class="sxs-lookup"><span data-stu-id="ba1ea-112">Razor Pages</span></span>
- <span data-ttu-id="ba1ea-113">SignalR</span><span class="sxs-lookup"><span data-stu-id="ba1ea-113">SignalR</span></span>
- <span data-ttu-id="ba1ea-114">gRPC Služby</span><span class="sxs-lookup"><span data-stu-id="ba1ea-114">gRPC Services</span></span>
- <span data-ttu-id="ba1ea-115">[Middleware](xref:fundamentals/middleware/index) s povoleným koncovým bodem, například [kontroly stavu](xref:host-and-deploy/health-checks).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-115">Endpoint-enabled [middleware](xref:fundamentals/middleware/index) such as [Health Checks](xref:host-and-deploy/health-checks).</span></span>
- <span data-ttu-id="ba1ea-116">Delegáti a lambdas registrováni s směrováním.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-116">Delegates and lambdas registered with routing.</span></span>

<span data-ttu-id="ba1ea-117">Tento dokument popisuje podrobnosti nízké úrovně ASP.NET směrování Core.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-117">This document covers low-level details of ASP.NET Core routing.</span></span> <span data-ttu-id="ba1ea-118">Informace o konfiguraci směrování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-118">For information on configuring routing:</span></span>

* <span data-ttu-id="ba1ea-119">Informace o řadičích naleznete v tématu <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-119">For controllers, see <xref:mvc/controllers/routing>.</span></span>
* <span data-ttu-id="ba1ea-120">Konvence Razor Pages najdete v tématu <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-120">For Razor Pages conventions, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ba1ea-121">Systém směrování koncových bodů popsaný v tomto dokumentu se vztahuje na ASP.NET jádrem 3.0 a novějším.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-121">The endpoint routing system described in this document applies to ASP.NET Core 3.0 and later.</span></span> <span data-ttu-id="ba1ea-122">Informace o předchozím systému <xref:Microsoft.AspNetCore.Routing.IRouter>směrování založeném na písmenu a) vyberte ASP.NET verzi Core 2.1 pomocí jednoho z následujících postupů:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-122">For information on the previous routing system based on <xref:Microsoft.AspNetCore.Routing.IRouter>, select the ASP.NET Core 2.1 version using one of the following approaches:</span></span>

* <span data-ttu-id="ba1ea-123">Volič verze pro předchozí verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-123">The version selector for a previous version.</span></span>
* <span data-ttu-id="ba1ea-124">Vyberte [ASP.NET směrování Jádra 2.1](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-124">Select [ASP.NET Core 2.1 routing](https://docs.microsoft.com/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

<span data-ttu-id="ba1ea-125">[Zobrazit nebo stáhnout ukázkový kód](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) [(jak stáhnout)](xref:index#how-to-download-a-sample)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-125">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples/3.x) ([how to download](xref:index#how-to-download-a-sample))</span></span>

<span data-ttu-id="ba1ea-126">Ukázky stahování pro tento dokument `Startup` jsou povoleny určitou třídou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-126">The download samples for this document are enabled by a specific `Startup` class.</span></span> <span data-ttu-id="ba1ea-127">Chcete-li spustit konkrétní *Program.cs* ukázku, `Startup` upravte Program.cs volat požadovanou třídu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-127">To run a specific sample, modify *Program.cs* to call the desired `Startup` class.</span></span>

## <a name="routing-basics"></a><span data-ttu-id="ba1ea-128">Základy směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-128">Routing basics</span></span>

<span data-ttu-id="ba1ea-129">Všechny ASP.NET základní šablony zahrnují směrování v generovaném kódu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-129">All ASP.NET Core templates include routing in the generated code.</span></span> <span data-ttu-id="ba1ea-130">Směrování je registrováno v `Startup.Configure` [kanálu middleware](xref:fundamentals/middleware/index) v .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-130">Routing is registered in the [middleware](xref:fundamentals/middleware/index) pipeline in `Startup.Configure`.</span></span>

<span data-ttu-id="ba1ea-131">Následující kód ukazuje základní příklad směrování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-131">The following code shows a basic example of routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet&highlight=8,10)]

<span data-ttu-id="ba1ea-132">Směrování používá dvojici middleware, <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>registrovaných a:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-132">Routing uses a pair of middleware, registered by <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>:</span></span>

* <span data-ttu-id="ba1ea-133">`UseRouting`přidá odpovídající trasu do kanálu middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-133">`UseRouting` adds route matching to the middleware pipeline.</span></span> <span data-ttu-id="ba1ea-134">Tento middleware se dívá na sadu koncových bodů definovaných v aplikaci a vybere [nejlepší shodu](#urlm) na základě požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-134">This middleware looks at the set of endpoints defined in the app, and selects the [best match](#urlm) based on the request.</span></span>
* <span data-ttu-id="ba1ea-135">`UseEndpoints`přidá spuštění koncového bodu do kanálu middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-135">`UseEndpoints` adds endpoint execution to the middleware pipeline.</span></span> <span data-ttu-id="ba1ea-136">Spustí delegáta přidruženého k vybranému koncovému bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-136">It runs the delegate associated with the selected endpoint.</span></span>

<span data-ttu-id="ba1ea-137">Předchozí příklad obsahuje jednu *trasu ke koncovému* bodu kódu pomocí metody [MapGet:](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-137">The preceding example includes a single *route to code* endpoint using the [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*) method:</span></span>

* <span data-ttu-id="ba1ea-138">Při odeslání `GET` požadavku HTTP na `/`kořenovou adresu URL :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-138">When an HTTP `GET` request is sent to the root URL `/`:</span></span>
  * <span data-ttu-id="ba1ea-139">Delegát požadavku zobrazí provede.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-139">The request delegate shown executes.</span></span>
  * <span data-ttu-id="ba1ea-140">`Hello World!`je zapsána do odpovědi HTTP.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-140">`Hello World!` is written to the HTTP response.</span></span> <span data-ttu-id="ba1ea-141">Ve výchozím nastavení `/` je `https://localhost:5001/`kořenová adresa URL .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-141">By default, the root URL `/` is `https://localhost:5001/`.</span></span>
* <span data-ttu-id="ba1ea-142">Pokud metoda požadavku `GET` není nebo kořenová `/`adresa URL není , není vrácena žádná trasa a je vrácena metoda HTTP 404.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-142">If the request method is not `GET` or the root URL is not `/`, no route matches and an HTTP 404 is returned.</span></span>

### <a name="endpoint"></a><span data-ttu-id="ba1ea-143">Koncový bod</span><span class="sxs-lookup"><span data-stu-id="ba1ea-143">Endpoint</span></span>

<a name="endpoint"></a>

<span data-ttu-id="ba1ea-144">Metoda `MapGet` se používá k definování **koncového bodu**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-144">The `MapGet` method is used to define an **endpoint**.</span></span> <span data-ttu-id="ba1ea-145">Koncový bod je něco, co může být:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-145">An endpoint is something that can be:</span></span>

* <span data-ttu-id="ba1ea-146">Vybráno porovnáním adresy URL a metody HTTP.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-146">Selected, by matching the URL and HTTP method.</span></span>
* <span data-ttu-id="ba1ea-147">Spuštěno spuštěním delegáta.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-147">Executed, by running the delegate.</span></span>

<span data-ttu-id="ba1ea-148">Koncové body, které mohou být spárovány a `UseEndpoints`provedeny aplikací, jsou nakonfigurovány v aplikaci .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-148">Endpoints that can be matched and executed by the app are configured in `UseEndpoints`.</span></span> <span data-ttu-id="ba1ea-149">Například <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>, a [podobné metody](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) připojit delegáty požadavků do systému směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-149">For example, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>, and [similar methods](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) connect request delegates to the routing system.</span></span>
<span data-ttu-id="ba1ea-150">Další metody lze použít k připojení ASP.NET funkce core framework u systému směrování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-150">Additional methods can be used to connect ASP.NET Core framework features to the routing system:</span></span>
- [<span data-ttu-id="ba1ea-151">MapRazorPages pro Razor Stránky</span><span class="sxs-lookup"><span data-stu-id="ba1ea-151">MapRazorPages for Razor Pages</span></span>](xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*)
- [<span data-ttu-id="ba1ea-152">MapControllers pro řadiče</span><span class="sxs-lookup"><span data-stu-id="ba1ea-152">MapControllers for controllers</span></span>](xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*)
- [<span data-ttu-id="ba1ea-153">MapHub\<THub> pro SignalR</span><span class="sxs-lookup"><span data-stu-id="ba1ea-153">MapHub\<THub> for SignalR</span></span>](xref:Microsoft.AspNetCore.SignalR.HubRouteBuilder.MapHub*) 
- [<span data-ttu-id="ba1ea-154">MapGrpcService\<TService> pro gRPC</span><span class="sxs-lookup"><span data-stu-id="ba1ea-154">MapGrpcService\<TService> for gRPC</span></span>](xref:grpc/aspnetcore)

<span data-ttu-id="ba1ea-155">Následující příklad ukazuje směrování s propracovanější šablonou trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-155">The following example shows routing with a more sophisticated route template:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/RouteTemplateStartup.cs?name=snippet)]

<span data-ttu-id="ba1ea-156">Řetězec `/hello/{name:alpha}` je **šablona postupu**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-156">The string `/hello/{name:alpha}` is a **route template**.</span></span> <span data-ttu-id="ba1ea-157">Slouží ke konfiguraci, jak je koncový bod spárován.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-157">It is used to configure how the endpoint is matched.</span></span> <span data-ttu-id="ba1ea-158">V tomto případě šablona odpovídá:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-158">In this case, the template matches:</span></span>

* <span data-ttu-id="ba1ea-159">Adresa URL jako`/hello/Ryan`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-159">A URL like `/hello/Ryan`</span></span>
* <span data-ttu-id="ba1ea-160">Jakákoli cesta URL, `/hello/` která začíná následovaným posloupností abecedních znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-160">Any URL path that begins with `/hello/` followed by a sequence of alphabetic characters.</span></span>  <span data-ttu-id="ba1ea-161">`:alpha`použije omezení trasy, které odpovídá pouze abecedním znakům.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-161">`:alpha` applies a route constraint that matches only alphabetic characters.</span></span> <span data-ttu-id="ba1ea-162">Omezení postupu jsou [vysvětlena](#route-constraint-reference) dále v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-162">[Route constraints](#route-constraint-reference) are explained later in this document.</span></span>

<span data-ttu-id="ba1ea-163">Druhý segment cesty URL: `{name:alpha}`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-163">The second segment of the URL path, `{name:alpha}`:</span></span>

* <span data-ttu-id="ba1ea-164">Je vázán `name` na parametr.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-164">Is bound to the `name` parameter.</span></span>
* <span data-ttu-id="ba1ea-165">Je zachycena a uložena v [HttpRequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-165">Is captured and stored in [HttpRequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span></span>

<span data-ttu-id="ba1ea-166">Systém směrování koncových bodů popsaný v tomto dokumentu je od ASP.NET jádru 3.0 nový.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-166">The endpoint routing system described in this document is new as of ASP.NET Core 3.0.</span></span> <span data-ttu-id="ba1ea-167">Všechny verze ASP.NET Core však podporují stejnou sadu funkcí šablony trasy a omezení trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-167">However, all versions of ASP.NET Core support the same set of route template features and route constraints.</span></span>

<span data-ttu-id="ba1ea-168">Následující příklad ukazuje směrování s [kontrolami stavu](xref:host-and-deploy/health-checks) a autorizací:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-168">The following example shows routing with [health checks](xref:host-and-deploy/health-checks) and authorization:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

[!INCLUDE[request localized comments](~/includes/code-comments-loc.md)]

<span data-ttu-id="ba1ea-169">Předchozí příklad ukazuje, jak:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-169">The preceding example demonstrates how:</span></span>

* <span data-ttu-id="ba1ea-170">Autorizační middleware lze použít s směrováním.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-170">The authorization middleware can be used with routing.</span></span>
* <span data-ttu-id="ba1ea-171">Koncové body lze použít ke konfiguraci chování autorizace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-171">Endpoints can be used to configure authorization behavior.</span></span>

<span data-ttu-id="ba1ea-172">Volání <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> přidá koncový bod kontroly stavu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-172">The <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> call adds a health check endpoint.</span></span> <span data-ttu-id="ba1ea-173">Řetězení <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> na toto volání připojí zásady autorizace ke koncovému bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-173">Chaining <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> on to this call attaches an authorization policy to the endpoint.</span></span>

<span data-ttu-id="ba1ea-174">Volání <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> a přidá ověřování a autorizace middleware.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-174">Calling <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> and <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> adds the authentication and authorization middleware.</span></span> <span data-ttu-id="ba1ea-175">Tyto middleware jsou <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> `UseEndpoints` umístěny mezi a tak, že mohou:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-175">These middleware are placed between <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and `UseEndpoints` so that they can:</span></span>

* <span data-ttu-id="ba1ea-176">Podívejte se, který `UseRouting`koncový bod byl vybrán .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-176">See which endpoint was selected by `UseRouting`.</span></span>
* <span data-ttu-id="ba1ea-177">Před <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> odesláním do koncového bodu použijte zásadu autorizace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-177">Apply an authorization policy before <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> dispatches to the endpoint.</span></span>

<a name="metadata"></a>

### <a name="endpoint-metadata"></a><span data-ttu-id="ba1ea-178">Metadata koncového bodu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-178">Endpoint metadata</span></span>

<span data-ttu-id="ba1ea-179">V předchozím příkladu existují dva koncové body, ale pouze koncový bod kontroly stavu má připojené zásady autorizace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-179">In the preceding example, there are two endpoints, but only the health check endpoint has an authorization policy attached.</span></span> <span data-ttu-id="ba1ea-180">Pokud požadavek odpovídá koncovému `/healthz`bodu kontroly stavu , provede se kontrola autorizace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-180">If the request matches the health check endpoint, `/healthz`, an authorization check is performed.</span></span> <span data-ttu-id="ba1ea-181">To ukazuje, že koncové body mohou mít další data k nim připojena.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-181">This demonstrates that endpoints can have extra data attached to them.</span></span> <span data-ttu-id="ba1ea-182">Tato další data se nazývají **metadata**koncového bodu :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-182">This extra data is called endpoint **metadata**:</span></span>

* <span data-ttu-id="ba1ea-183">Metadata mohou být zpracovány pomocí middleware s vědomím směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-183">The metadata can be processed by routing-aware middleware.</span></span>
* <span data-ttu-id="ba1ea-184">Metadata mohou být libovolného typu .NET.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-184">The metadata can be of any .NET type.</span></span>

## <a name="routing-concepts"></a><span data-ttu-id="ba1ea-185">Koncepty směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-185">Routing concepts</span></span>

<span data-ttu-id="ba1ea-186">Systém směrování se staví na hlavním kanálu middlewaru přidáním výkonného konceptu **koncového bodu.**</span><span class="sxs-lookup"><span data-stu-id="ba1ea-186">The routing system builds on top of the middleware pipeline by adding the powerful **endpoint** concept.</span></span> <span data-ttu-id="ba1ea-187">Koncové body představují jednotky funkcí aplikace, které se od sebe liší, pokud jde o směrování, autorizaci a libovolný počet ASP.NET systémů Core.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-187">Endpoints represent units of the app's functionality that are distinct from each other in terms of routing, authorization, and any number of ASP.NET Core's systems.</span></span>

<a name="endpoint"></a>

### <a name="aspnet-core-endpoint-definition"></a><span data-ttu-id="ba1ea-188">definice ASP.NET základního koncového bodu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-188">ASP.NET Core endpoint definition</span></span>

<span data-ttu-id="ba1ea-189">ASP.NET základní koncový bod je:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-189">An ASP.NET Core endpoint is:</span></span>

* <span data-ttu-id="ba1ea-190">Spustitelný soubor: <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>Má .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-190">Executable: Has a <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span></span>
* <span data-ttu-id="ba1ea-191">Rozšiřitelné: Má [metadata](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*) kolekce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-191">Extensible: Has a [Metadata](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*) collection.</span></span>
* <span data-ttu-id="ba1ea-192">Volitelně: Volitelně má [informace o směrování](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-192">Selectable: Optionally, has [routing information](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span></span>
* <span data-ttu-id="ba1ea-193">Výčet: Kolekce koncových bodů mohou být uvedeny načtením <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> z [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-193">Enumerable: The collection of endpoints can be listed by retrieving the <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> from [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="ba1ea-194">Následující kód ukazuje, jak načíst a zkontrolovat koncový bod odpovídající aktuálnímu požadavku:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-194">The following code shows how to retrieve and inspect the endpoint matching the current request:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/EndpointInspectorStartup.cs?name=snippet)]

<span data-ttu-id="ba1ea-195">Koncový bod, pokud je vybrán, lze `HttpContext`načíst z .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-195">The endpoint, if selected, can be retrieved from the `HttpContext`.</span></span> <span data-ttu-id="ba1ea-196">Jeho vlastnosti mohou být kontrolovány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-196">Its properties can be inspected.</span></span> <span data-ttu-id="ba1ea-197">Objekty koncového bodu jsou neměnné a po vytvoření je nelze změnit.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-197">Endpoint objects are immutable and cannot be modified after creation.</span></span> <span data-ttu-id="ba1ea-198">Nejběžnějším typem <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>koncového bodu je .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-198">The most common type of endpoint is a <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>.</span></span> <span data-ttu-id="ba1ea-199">`RouteEndpoint`obsahuje informace, které umožňují, aby byl vybrán systémem směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-199">`RouteEndpoint` includes information that allows it to be to selected by the routing system.</span></span>

<span data-ttu-id="ba1ea-200">V předchozím kódu [aplikace. Použití](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) konfiguruje in-line [middleware](xref:fundamentals/middleware/index).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-200">In the preceding code, [app.Use](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) configures an in-line [middleware](xref:fundamentals/middleware/index).</span></span>

<a name="mt"></a>

<span data-ttu-id="ba1ea-201">Následující kód ukazuje, že `app.Use` v závislosti na tom, kde je volána v kanálu, nemusí být koncový bod:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-201">The following code shows that, depending on where `app.Use` is called in the pipeline, there may not be an endpoint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/MiddlewareFlowStartup.cs?name=snippet)]

<span data-ttu-id="ba1ea-202">Tato předchozí ukázka přidá `Console.WriteLine` příkazy, které zobrazují, zda byl vybrán koncový bod.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-202">This preceding sample adds `Console.WriteLine` statements that display whether or not an endpoint has been selected.</span></span> <span data-ttu-id="ba1ea-203">Pro přehlednost vzorku přiřadí zobrazovaný název `/` k poskytnutému koncovému bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-203">For clarity, the sample assigns a display name to the provided `/` endpoint.</span></span>

<span data-ttu-id="ba1ea-204">Spuštění tohoto kódu s `/` adresou URL zobrazení:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-204">Running this code with a URL of `/` displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: Hello
3. Endpoint: Hello
```

<span data-ttu-id="ba1ea-205">Spuštění tohoto kódu s jinými projevy adres URL:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-205">Running this code with any other URL displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: (null)
4. Endpoint: (null)
```

<span data-ttu-id="ba1ea-206">Tento výstup ukazuje, že:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-206">This output demonstrates that:</span></span>

* <span data-ttu-id="ba1ea-207">Koncový bod je vždy `UseRouting` null před je volána.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-207">The endpoint is always null before `UseRouting` is called.</span></span>
* <span data-ttu-id="ba1ea-208">Pokud je nalezena shoda, koncový bod `UseRouting` není <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>null mezi a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-208">If a match is found, the endpoint is non-null between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="ba1ea-209">Middleware `UseEndpoints` je **terminál,** když je nalezena shoda.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-209">The `UseEndpoints` middleware is **terminal** when a match is found.</span></span> <span data-ttu-id="ba1ea-210">[Terminálový middleware](#tm) je definován dále v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-210">[Terminal middleware](#tm) is defined later in this document.</span></span>
* <span data-ttu-id="ba1ea-211">Middleware po `UseEndpoints` spuštění pouze v případě, že není nalezena žádná shoda.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-211">The middleware after `UseEndpoints` execute only when no match is found.</span></span>

<span data-ttu-id="ba1ea-212">Middleware `UseRouting` používá [Metodu SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) k připojení koncového bodu k aktuálnímu kontextu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-212">The `UseRouting` middleware uses the [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) method to attach the endpoint to the current context.</span></span> <span data-ttu-id="ba1ea-213">Je možné nahradit `UseRouting` middleware s vlastní logikou a stále získat výhody použití koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-213">It's possible to replace the `UseRouting` middleware with custom logic and still get the benefits of using endpoints.</span></span> <span data-ttu-id="ba1ea-214">Koncové body jsou primitivní jako middleware nižší úrovně a nejsou spojeny s implementací směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-214">Endpoints are a low-level primitive like middleware, and aren't coupled to the routing implementation.</span></span> <span data-ttu-id="ba1ea-215">Většina aplikací nemusí být `UseRouting` nahrazena vlastní logikou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-215">Most apps don't need to replace `UseRouting` with custom logic.</span></span>

<span data-ttu-id="ba1ea-216">Middleware `UseEndpoints` je určen pro použití v tandemu `UseRouting` s middleware.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-216">The `UseEndpoints` middleware is designed to be used in tandem with the `UseRouting` middleware.</span></span> <span data-ttu-id="ba1ea-217">Základní logika pro spuštění koncového bodu není složitá.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-217">The core logic to execute an endpoint isn't complicated.</span></span> <span data-ttu-id="ba1ea-218">Slouží <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> k načtení koncového bodu <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> a potom vyvolat jeho vlastnost.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-218">Use <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> to retrieve the endpoint, and then invoke its <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> property.</span></span>

<span data-ttu-id="ba1ea-219">Následující kód ukazuje, jak middleware může ovlivnit nebo reagovat na směrování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-219">The following code demonstrates how middleware can influence or react to routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/IntegratedMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="ba1ea-220">Předchozí příklad ukazuje dva důležité pojmy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-220">The preceding example demonstrates two important concepts:</span></span>

* <span data-ttu-id="ba1ea-221">Middleware lze `UseRouting` spustit před upravit data, která směrování pracuje na.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-221">Middleware can run before `UseRouting` to modify the data that routing operates upon.</span></span>
    * <span data-ttu-id="ba1ea-222">Middleware, který se zobrazí před směrováním, obvykle upraví <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*>některé <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>vlastnosti požadavku, například <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, nebo .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-222">Usually middleware that appears before routing modifies some property of the request, such as <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*>, or <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span></span>
* <span data-ttu-id="ba1ea-223">Middleware může `UseRouting` běžet <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> mezi a zpracovat výsledky směrování před spuštěním koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-223">Middleware can run between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> to process the results of routing before the endpoint is executed.</span></span>
    * <span data-ttu-id="ba1ea-224">Middleware, který `UseRouting` `UseEndpoints`běží mezi a :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-224">Middleware that runs between `UseRouting` and `UseEndpoints`:</span></span>
      * <span data-ttu-id="ba1ea-225">Obvykle kontroluje metadata pochopit koncové body.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-225">Usually inspects metadata to understand the endpoints.</span></span>
      * <span data-ttu-id="ba1ea-226">Často dělá rozhodnutí o zabezpečení, jak je tomu v rámci `UseAuthorization` a `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-226">Often makes security decisions, as done by `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="ba1ea-227">Kombinace middlewaru a metadat umožňuje konfiguraci zásad pro koncový bod.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-227">The combination of middleware and metadata allows configuring policies per-endpoint.</span></span>

<span data-ttu-id="ba1ea-228">Předchozí kód ukazuje příklad vlastního middlewaru, který podporuje zásady pro koncový bod.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-228">The preceding code shows an example of a custom middleware that supports per-endpoint policies.</span></span> <span data-ttu-id="ba1ea-229">Middleware zapíše *protokol auditu* přístupu k citlivým datům do konzoly.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-229">The middleware writes an *audit log* of access to sensitive data to the console.</span></span> <span data-ttu-id="ba1ea-230">Middleware lze nakonfigurovat tak, aby `AuditPolicyAttribute` *auditovat* koncový bod s metadaty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-230">The middleware can be configured to *audit* an endpoint with the `AuditPolicyAttribute` metadata.</span></span> <span data-ttu-id="ba1ea-231">Tato ukázka ukazuje *vzor opt-in,* kde jsou auditovány pouze koncové body, které jsou označeny jako citlivé.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-231">This sample demonstrates an *opt-in* pattern where only endpoints that are marked as sensitive are audited.</span></span> <span data-ttu-id="ba1ea-232">Je možné definovat tuto logiku v opačném pořadí, auditování vše, co není označeno jako bezpečné, například.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-232">It's possible to define this logic in reverse, auditing everything that isn't marked as safe, for example.</span></span> <span data-ttu-id="ba1ea-233">Systém metadat koncových bodů je flexibilní.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-233">The endpoint metadata system is flexible.</span></span> <span data-ttu-id="ba1ea-234">Tato logika by mohla být navržena jakýmkoli způsobem vyhovuje případu použití.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-234">This logic could be designed in whatever way suits the use case.</span></span>

<span data-ttu-id="ba1ea-235">Předchozí ukázkový kód je určen k prokázání základní pojmy koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-235">The preceding sample code is intended to demonstrate the basic concepts of endpoints.</span></span> <span data-ttu-id="ba1ea-236">**Vzorek není určen pro výrobní účely**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-236">**The sample is not intended for production use**.</span></span> <span data-ttu-id="ba1ea-237">Úplnější verze middlewaru *protokolu auditu* by:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-237">A more complete version of an *audit log* middleware would:</span></span>

* <span data-ttu-id="ba1ea-238">Protokolovat do souboru nebo databáze.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-238">Log to a file or database.</span></span>
* <span data-ttu-id="ba1ea-239">Uveďte podrobnosti, jako je uživatel, IP adresa, název citlivého koncového bodu a další.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-239">Include details such as the user, IP address, name of the sensitive endpoint, and more.</span></span>

<span data-ttu-id="ba1ea-240">Metadata zásad `AuditPolicyAttribute` auditu jsou `Attribute` definována jako pro snadnější použití s architekturami založenými na třídách, jako jsou řadiče a SignalR.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-240">The audit policy metadata `AuditPolicyAttribute` is defined as an `Attribute` for easier use with class-based frameworks such as controllers and SignalR.</span></span> <span data-ttu-id="ba1ea-241">Při použití *trasy ke kódu*:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-241">When using *route to code*:</span></span>

* <span data-ttu-id="ba1ea-242">Metadata jsou připojena k rozhraní API tvůrce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-242">Metadata is attached with a builder API.</span></span>
* <span data-ttu-id="ba1ea-243">Architektury založené na třídách zahrnují všechny atributy na odpovídající metodu a třídu při vytváření koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-243">Class-based frameworks include all attributes on the corresponding method and class when creating endpoints.</span></span>

<span data-ttu-id="ba1ea-244">Doporučené postupy pro typy metadat jsou definovat je buď jako rozhraní nebo atributy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-244">The best practices for metadata types are to define them either as interfaces or attributes.</span></span> <span data-ttu-id="ba1ea-245">Rozhraní a atributy umožňují opakované použití kódu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-245">Interfaces and attributes allow code reuse.</span></span> <span data-ttu-id="ba1ea-246">Systém metadat je flexibilní a neukládá žádná omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-246">The metadata system is flexible and doesn't impose any limitations.</span></span>

<a name="tm"></a>

### <a name="comparing-a-terminal-middleware-and-routing"></a><span data-ttu-id="ba1ea-247">Porovnání koncového middlewaru a směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-247">Comparing a terminal middleware and routing</span></span>

<span data-ttu-id="ba1ea-248">Následující ukázka kódu kontrastuje pomocí middleware s pomocí směrování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-248">The following code sample contrasts using middleware with using routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/TerminalMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="ba1ea-249">Styl middleware je `Approach 1:` zobrazen s je **terminál middleware**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-249">The style of middleware shown with `Approach 1:` is **terminal middleware**.</span></span> <span data-ttu-id="ba1ea-250">Říká se tomu terminálmiddleware, protože provádí odpovídající operaci:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-250">It's called terminal middleware because it does a matching operation:</span></span>

* <span data-ttu-id="ba1ea-251">Odpovídající operace v předchozí ukázce `Path == "/"` je `Path == "/Movie"` pro middleware a pro směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-251">The matching operation in the preceding sample is `Path == "/"` for the middleware and `Path == "/Movie"` for routing.</span></span>
* <span data-ttu-id="ba1ea-252">Pokud je shoda úspěšná, provede některé funkce a vrátí, spíše `next` než vyvolání middleware.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-252">When a match is successful, it executes some functionality and returns, rather than invoking the `next` middleware.</span></span>

<span data-ttu-id="ba1ea-253">Nazývá se terminálmiddleware, protože ukončí vyhledávání, provede některé funkce a pak se vrátí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-253">It's called terminal middleware because it terminates the search, executes some functionality, and then returns.</span></span>

<span data-ttu-id="ba1ea-254">Porovnání koncového middlewaru a směrování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-254">Comparing a terminal middleware and routing:</span></span>
* <span data-ttu-id="ba1ea-255">Oba přístupy umožňují ukončení kanálu zpracování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-255">Both approaches allow terminating the processing pipeline:</span></span>
    * <span data-ttu-id="ba1ea-256">Middleware ukončí potrubí tím, že vrátí spíše `next`než vyvolání .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-256">Middleware terminates the pipeline by returning rather than invoking `next`.</span></span>
    * <span data-ttu-id="ba1ea-257">Koncové body jsou vždy terminální.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-257">Endpoints are always terminal.</span></span>
* <span data-ttu-id="ba1ea-258">Terminálmiddleware umožňuje umístění middleware na libovolné místo v potrubí:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-258">Terminal middleware allows positioning the middleware at an arbitrary place in the pipeline:</span></span>
    * <span data-ttu-id="ba1ea-259">Koncové body se provádějí <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>na pozici .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-259">Endpoints execute at the position of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="ba1ea-260">Terminálmiddleware umožňuje libovolný kód určit, kdy middleware odpovídá:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-260">Terminal middleware allows arbitrary code to determine when the middleware matches:</span></span>
    * <span data-ttu-id="ba1ea-261">Vlastní kód pro porovnávání tras může být podrobný a obtížně správně zapisovat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-261">Custom route matching code can be verbose and difficult to write correctly.</span></span>
    * <span data-ttu-id="ba1ea-262">Směrování poskytuje jednoduchá řešení pro typické aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-262">Routing provides straightforward solutions for typical apps.</span></span> <span data-ttu-id="ba1ea-263">Většina aplikací nevyžaduje vlastní kód pro porovnávání tras.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-263">Most apps don't require custom route matching code.</span></span>
* <span data-ttu-id="ba1ea-264">Koncové body rozhraní s `UseAuthorization` middleware, jako je například a `UseCors`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-264">Endpoints interface with middleware such as `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="ba1ea-265">Použití koncového middlewaru s `UseAuthorization` autorizačním systémem nebo `UseCors` vyžaduje ruční propojení s autorizačním systémem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-265">Using a terminal middleware with `UseAuthorization` or `UseCors` requires manual interfacing with the authorization system.</span></span>

<span data-ttu-id="ba1ea-266">[Koncový bod](#endpoint) definuje obojí:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-266">An [endpoint](#endpoint) defines both:</span></span>

* <span data-ttu-id="ba1ea-267">Delegát pro zpracování požadavků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-267">A delegate to process requests.</span></span>
* <span data-ttu-id="ba1ea-268">Kolekce libovolných metadat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-268">A collection of arbitrary metadata.</span></span> <span data-ttu-id="ba1ea-269">Metadata se používá k implementaci průřezové obavy založené na zásady a konfigurace připojené ke každému koncovému bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-269">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="ba1ea-270">Terminál middleware může být účinným nástrojem, ale může vyžadovat:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-270">Terminal middleware can be an effective tool, but can require:</span></span>

* <span data-ttu-id="ba1ea-271">Značné množství kódování a testování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-271">A significant amount of coding and testing.</span></span>
* <span data-ttu-id="ba1ea-272">Ruční integrace s jinými systémy pro dosažení požadované úrovně flexibility.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-272">Manual integration with other systems to achieve the desired level of flexibility.</span></span>

<span data-ttu-id="ba1ea-273">Zvažte integraci s směrováním před napsáním terminálového middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-273">Consider integrating with routing before writing a terminal middleware.</span></span>

<span data-ttu-id="ba1ea-274">Existující terminálový middleware, který <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> se integruje s [mapou](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) nebo může být obvykle přeměněn na koncový bod vědomý směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-274">Existing terminal middleware that integrates with [Map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) or <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> can usually be turned into a routing aware endpoint.</span></span> <span data-ttu-id="ba1ea-275">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) ukazuje vzor pro router-ware:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-275">[MapHealthChecks](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) demonstrates the pattern for router-ware:</span></span>
* <span data-ttu-id="ba1ea-276">Napište metodu <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>rozšíření na aplikaci .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-276">Write an extension method on <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span>
* <span data-ttu-id="ba1ea-277">Vytvořte vnořený <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>kanál middlewaru pomocí aplikace .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-277">Create a nested middleware pipeline using <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span></span>
* <span data-ttu-id="ba1ea-278">Připojte middleware k novému potrubí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-278">Attach the middleware to the new pipeline.</span></span> <span data-ttu-id="ba1ea-279">V tomto <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>případě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-279">In this case, <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>.</span></span>
* <span data-ttu-id="ba1ea-280"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*>middleware potrubí do <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-280"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*> the middleware pipeline into a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span>
* <span data-ttu-id="ba1ea-281">Zavolejte `Map` a poskytněte nový middleware potrubí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-281">Call `Map` and provide the new middleware pipeline.</span></span>
* <span data-ttu-id="ba1ea-282">Vrátí objekt tvůrce poskytované `Map` z metody rozšíření.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-282">Return the builder object provided by `Map` from the extension method.</span></span>

<span data-ttu-id="ba1ea-283">Následující kód ukazuje použití [MapHealthChecks](xref:host-and-deploy/health-checks):</span><span class="sxs-lookup"><span data-stu-id="ba1ea-283">The following code shows use of [MapHealthChecks](xref:host-and-deploy/health-checks):</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

<span data-ttu-id="ba1ea-284">Předchozí ukázka ukazuje, proč je důležité vrácení objektu tvůrce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-284">The preceding sample shows why returning the builder object is important.</span></span> <span data-ttu-id="ba1ea-285">Vrácení objektu tvůrce umožňuje vývojáři aplikace konfigurovat zásady, jako je autorizace pro koncový bod.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-285">Returning the builder object allows the app developer to configure policies such as authorization for the endpoint.</span></span> <span data-ttu-id="ba1ea-286">V tomto příkladu middleware kontroly stavu nemá žádnou přímou integraci se systémem autorizace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-286">In this example, the health checks middleware has no direct integration with the authorization system.</span></span>

<span data-ttu-id="ba1ea-287">Systém metadat byl vytvořen v reakci na problémy, s nimiž se setkávají autoři rozšiřitelnosti pomocí terminálového middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-287">The metadata system was created in response to the problems encountered by extensibility authors using terminal middleware.</span></span> <span data-ttu-id="ba1ea-288">Pro každý middleware je problematické implementovat vlastní integraci s autorizačním systémem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-288">It's problematic for each middleware to implement its own integration with the authorization system.</span></span>

<a name="urlm"></a>

### <a name="url-matching"></a><span data-ttu-id="ba1ea-289">Párování adres URL</span><span class="sxs-lookup"><span data-stu-id="ba1ea-289">URL matching</span></span>

* <span data-ttu-id="ba1ea-290">Je proces, kterým směrování odpovídá příchozí požadavek na [koncový bod](#endpoint).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-290">Is the process by which routing matches an incoming request to an [endpoint](#endpoint).</span></span>
* <span data-ttu-id="ba1ea-291">Je založen na datech v cestě URL a záhlavích.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-291">Is based on data in the URL path and headers.</span></span>
* <span data-ttu-id="ba1ea-292">Lze rozšířit, aby zvážila všechna data v žádosti.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-292">Can be extended to consider any data in the request.</span></span>

<span data-ttu-id="ba1ea-293">Když směrování middleware spustí, nastaví `Endpoint` a směrování hodnoty na [požadavek funkce](xref:fundamentals/request-features) <xref:Microsoft.AspNetCore.Http.HttpContext> na od aktuálního požadavku:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-293">When a routing middleware executes, it sets an `Endpoint` and route values to a [request feature](xref:fundamentals/request-features) on the <xref:Microsoft.AspNetCore.Http.HttpContext> from the current request:</span></span>

* <span data-ttu-id="ba1ea-294">Volání [HttpContext.GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) získá koncový bod.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-294">Calling [HttpContext.GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) gets the endpoint.</span></span>
* <span data-ttu-id="ba1ea-295">`HttpRequest.RouteValues`získá kolekci hodnot trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-295">`HttpRequest.RouteValues` gets the collection of route values.</span></span>

<span data-ttu-id="ba1ea-296">[Middleware](xref:fundamentals/middleware/index) běží po směrování middleware můžete zkontrolovat koncový bod a přijmout opatření.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-296">[Middleware](xref:fundamentals/middleware/index) running after the routing middleware can inspect the endpoint and take action.</span></span> <span data-ttu-id="ba1ea-297">Middleware autorizace může například vyslýchat kolekci metadat koncového bodu pro zásady autorizace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-297">For example, an authorization middleware can interrogate the endpoint's metadata collection for an authorization policy.</span></span> <span data-ttu-id="ba1ea-298">Po spuštění všech middleware v kanálu zpracování požadavku je vyvolána delegát vybraného koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-298">After all of the middleware in the request processing pipeline is executed, the selected endpoint's delegate is invoked.</span></span>

<span data-ttu-id="ba1ea-299">Systém směrování v směrování koncových bodů je zodpovědný za všechna rozhodnutí o odeslání.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-299">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="ba1ea-300">Vzhledem k tomu, že middleware používá zásady založené na vybraném koncovém bodu, je důležité, aby:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-300">Because the middleware applies policies based on the selected endpoint, it's important that:</span></span>

* <span data-ttu-id="ba1ea-301">Jakékoli rozhodnutí, které může ovlivnit odeslání nebo použití zásad zabezpečení, je provedeno uvnitř systému směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-301">Any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

> [!WARNING]
> <span data-ttu-id="ba1ea-302">Pro zpětnou kompatibilitu při controller nebo Razor Pages koncový bod delegáta je proveden, vlastnosti [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) jsou nastaveny na příslušné hodnoty na základě zpracování požadavku provádí tak daleko.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-302">For backwards-compatibility, when a Controller or Razor Pages endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>
>
> <span data-ttu-id="ba1ea-303">Typ `RouteContext` bude v budoucí verzi označen jako zastaralý:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-303">The `RouteContext` type will be marked obsolete in a future release:</span></span>
>
> * <span data-ttu-id="ba1ea-304">Migrace `RouteData.Values` `HttpRequest.RouteValues`do aplikace .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-304">Migrate `RouteData.Values` to `HttpRequest.RouteValues`.</span></span>
> * <span data-ttu-id="ba1ea-305">Migrovat `RouteData.DataTokens` k načtení [metadat IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) z metadat koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-305">Migrate `RouteData.DataTokens` to retrieve [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) from the endpoint metadata.</span></span>

<span data-ttu-id="ba1ea-306">Párování adres URL funguje v konfigurovatelné sadě fází.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-306">URL matching operates in a configurable set of phases.</span></span> <span data-ttu-id="ba1ea-307">V každé fázi je výstupem sada shod.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-307">In each phase, the output is a set of matches.</span></span> <span data-ttu-id="ba1ea-308">Sadu zápasů lze v další fázi dále zúžit.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-308">The set of matches can be narrowed down further by the next phase.</span></span> <span data-ttu-id="ba1ea-309">Implementace směrování nezaručuje pořadí zpracování pro odpovídající koncové body.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-309">The routing implementation does not guarantee a processing order for matching endpoints.</span></span> <span data-ttu-id="ba1ea-310">**Všechny** možné shody jsou zpracovány najednou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-310">**All** possible matches are processed at once.</span></span> <span data-ttu-id="ba1ea-311">Fáze párování adres URL se vyskytují v následujícím pořadí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-311">The URL matching phases occur in the following order.</span></span> <span data-ttu-id="ba1ea-312">ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-312">ASP.NET Core:</span></span>

1. <span data-ttu-id="ba1ea-313">Zpracuje cestu URL proti sadě koncových bodů a jejich šablony tras, shromažďování **všech** shod.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-313">Processes the URL path against the set of endpoints and their route templates, collecting **all** of the matches.</span></span>
1. <span data-ttu-id="ba1ea-314">Odebere předchozí seznam a odebere shody, které se nezdaří s použitými omezeními trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-314">Takes the preceding list and removes matches that fail with route constraints applied.</span></span>
1. <span data-ttu-id="ba1ea-315">Odebere předchozí seznam a odebere shody, které neporuší sadu instancí [MatcherPolicy.](xref:Microsoft.AspNetCore.Routing.MatcherPolicy)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-315">Takes the preceding list and removes matches that fail the set of [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy) instances.</span></span>
1. <span data-ttu-id="ba1ea-316">Používá [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) k konečnému rozhodnutí z předchozího seznamu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-316">Uses the [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) to make a final decision from the preceding list.</span></span>

<span data-ttu-id="ba1ea-317">Seznam koncových bodů je upřednostněn podle:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-317">The list of endpoints is prioritized according to:</span></span>

* <span data-ttu-id="ba1ea-318">[RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-318">The [RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span></span>
* <span data-ttu-id="ba1ea-319">[Priorita šablony trasy](#rtp)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-319">The [route template precedence](#rtp)</span></span>

<span data-ttu-id="ba1ea-320">Všechny odpovídající koncové body jsou zpracovány <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> v každé fázi, dokud není dosaženo.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-320">All matching endpoints are processed in each phase until the <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> is reached.</span></span> <span data-ttu-id="ba1ea-321">Je `EndpointSelector` to poslední fáze.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-321">The `EndpointSelector` is the final phase.</span></span> <span data-ttu-id="ba1ea-322">Vybere koncový bod s nejvyšší prioritou ze zápasů jako nejlepší shoda.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-322">It chooses the highest priority endpoint from the matches as the best match.</span></span> <span data-ttu-id="ba1ea-323">Pokud existují jiné shody se stejnou prioritou jako nejlepší shoda, je vyvolána nejednoznačná výjimka shody.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-323">If there are other matches with the same priority as the best match, an ambiguous match exception is thrown.</span></span>

<span data-ttu-id="ba1ea-324">Priorita trasy se vypočítá na základě **konkrétnější** šablony trasy, která má vyšší prioritu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-324">The route precedence is computed based on a **more specific** route template being given a higher priority.</span></span> <span data-ttu-id="ba1ea-325">Zvažte například šablony `/hello` `/{message}`a :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-325">For example, consider the templates `/hello` and `/{message}`:</span></span>

* <span data-ttu-id="ba1ea-326">Obě odpovídají cestě `/hello`URL .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-326">Both match the URL path `/hello`.</span></span>
* <span data-ttu-id="ba1ea-327">`/hello`konkrétnější, a tudíž vyšší prioritu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-327">`/hello`  is more specific and therefore higher priority.</span></span>

<span data-ttu-id="ba1ea-328">Obecně platí, že priorita trasy dělá dobrou práci při výběru nejlepší shody pro typy schémat adres URL používaných v praxi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-328">In general, route precedence does a good job of choosing the best match for the kinds of URL schemes used in practice.</span></span> <span data-ttu-id="ba1ea-329">Používejte <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> pouze v případě potřeby, aby se zabránilo nejednoznačnosti.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-329">Use <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> only when necessary to avoid an ambiguity.</span></span>

<span data-ttu-id="ba1ea-330">Vzhledem k druhům rozšiřitelnosti poskytované směrování, není možné pro systém směrování vypočítat předem nejednoznačné trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-330">Due to the kinds of extensibility provided by routing, it isn't possible for the routing system to compute ahead of time the ambiguous routes.</span></span> <span data-ttu-id="ba1ea-331">Vezměme si příklad, `/{message:alpha}` jako `/{message:int}`jsou šablony tras a :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-331">Consider an example such as the route templates `/{message:alpha}` and `/{message:int}`:</span></span>

* <span data-ttu-id="ba1ea-332">Omezení `alpha` odpovídá pouze abecedním znakům.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-332">The `alpha` constraint matches only alphabetic characters.</span></span>
* <span data-ttu-id="ba1ea-333">Omezení `int` odpovídá pouze číslům.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-333">The `int` constraint matches only numbers.</span></span>
* <span data-ttu-id="ba1ea-334">Tyto šablony mají stejnou prioritu trasy, ale neexistuje žádná jediná adresa URL, které se obě shodují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-334">These templates have the same route precedence, but there's no single URL they both match.</span></span>
* <span data-ttu-id="ba1ea-335">Pokud systém směrování ohlásil chybu nejednoznačnosti při spuštění, zablokoval by tento platný případ použití.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-335">If the routing system reported an ambiguity error at startup, it would block this valid use case.</span></span>

> [!WARNING]
>
> <span data-ttu-id="ba1ea-336">Pořadí operací uvnitř <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> nemá vliv na chování směrování, s jednou výjimkou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-336">The order of operations inside <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> doesn't influence the behavior of routing, with one exception.</span></span> <span data-ttu-id="ba1ea-337"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*>a <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> automaticky přiřadit hodnotu objednávky jejich koncovým bodům na základě pořadí, ve které jsou vyvolány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-337"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> and <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> automatically assign an order value to their endpoints based on the order they are invoked.</span></span> <span data-ttu-id="ba1ea-338">To simuluje dlouhodobé chování řadičů bez systému směrování poskytující stejné záruky jako starší implementace směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-338">This simulates long-time behavior of controllers without the routing system providing the same guarantees as older routing implementations.</span></span>
>
> <span data-ttu-id="ba1ea-339">Ve starší implementaci směrování je možné implementovat rozšiřitelnost směrování, která má závislost na pořadí, ve kterém jsou zpracovávány trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-339">In the legacy implementation of routing, it's possible to implement routing extensibility that has a dependency on the order in which routes are processed.</span></span> <span data-ttu-id="ba1ea-340">Směrování koncového bodu v ASP.NET jádrem 3.0 a novějším:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-340">Endpoint routing in ASP.NET Core 3.0 and later:</span></span>
> 
> * <span data-ttu-id="ba1ea-341">Nemá pojem trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-341">Doesn't have a concept of routes.</span></span>
> * <span data-ttu-id="ba1ea-342">Neposkytuje záruky objednávání.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-342">Doesn't provide ordering guarantees.</span></span> <span data-ttu-id="ba1ea-343">Všechny koncové body jsou zpracovány najednou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-343">All endpoints are processed at once.</span></span>
>
> <span data-ttu-id="ba1ea-344">Pokud to znamená, že jste přilepená pomocí starší ho systému směrování, [otevřete github problém pro pomoc](https://github.com/dotnet/aspnetcore/issues).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-344">If this means you're stuck using the legacy routing system, [open a GitHub issue for assistance](https://github.com/dotnet/aspnetcore/issues).</span></span>

<a name="rtp"></a>

### <a name="route-template-precedence-and-endpoint-selection-order"></a><span data-ttu-id="ba1ea-345">Priorita šablony trasy a pořadí výběru koncového bodu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-345">Route template precedence and endpoint selection order</span></span>

<span data-ttu-id="ba1ea-346">[Priorita šablony postupu](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) je systém, který každé šabloně trasy přiřazuje hodnotu na základě toho, jak je specifická.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-346">[Route template precedence](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) is a system that assigns each route template a value based on how specific it is.</span></span> <span data-ttu-id="ba1ea-347">Priorita šablony trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-347">Route template precedence:</span></span>

* <span data-ttu-id="ba1ea-348">Vyhýbá se nutnosti upravit pořadí koncových bodů v běžných případech.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-348">Avoids the need to adjust the order of endpoints in common cases.</span></span>
* <span data-ttu-id="ba1ea-349">Pokusy o sladění selský rozum očekávání směrování chování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-349">Attempts to match the common-sense expectations of routing behavior.</span></span>

<span data-ttu-id="ba1ea-350">Zvažte například `/Products/List` šablony `/Products/{id}`a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-350">For example, consider templates `/Products/List` and `/Products/{id}`.</span></span> <span data-ttu-id="ba1ea-351">Bylo by rozumné předpokládat, že `/Products/List` `/Products/{id}` je lepší `/Products/List`shoda než pro cestu URL .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-351">It would be reasonable to assume that `/Products/List` is a better match than `/Products/{id}` for the URL path `/Products/List`.</span></span> <span data-ttu-id="ba1ea-352">Funguje, protože segment `/List` literálu je považován za lepší `/{id}`prioritu než segment parametru .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-352">The works because the literal segment `/List` is considered to have better precedence than the parameter segment `/{id}`.</span></span>

<span data-ttu-id="ba1ea-353">Podrobnosti o tom, jak funguje priorita, jsou spojeny s tím, jak jsou definovány šablony tras:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-353">The details of how precedence works are coupled to how route templates are defined:</span></span>

* <span data-ttu-id="ba1ea-354">Šablony s více segmenty jsou považovány za konkrétnější.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-354">Templates with more segments are considered more specific.</span></span>
* <span data-ttu-id="ba1ea-355">Segment s literálovým textem je považován za specifičtější než segment parametrů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-355">A segment with literal text is considered more specific than a parameter segment.</span></span>
* <span data-ttu-id="ba1ea-356">Segment parametru s vazbou je považován za specifičtější než segment bez.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-356">A parameter segment with a constraint is considered more specific than one without.</span></span>
* <span data-ttu-id="ba1ea-357">Složitý segment je považován za specifický jako segment parametrů s vazbou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-357">A complex segment is considered as specific as a parameter segment with a constraint.</span></span>
* <span data-ttu-id="ba1ea-358">Catch všechny parametry jsou nejméně specifické.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-358">Catch all parameters are the least specific.</span></span>

<span data-ttu-id="ba1ea-359">Podívejte se na [zdrojový kód na GitHubu](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) pro odkaz na přesné hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-359">See the [source code on GitHub](https://github.com/dotnet/aspnetcore/blob/master/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) for a reference of exact values.</span></span>

<a name="lg"></a>

### <a name="url-generation-concepts"></a><span data-ttu-id="ba1ea-360">Koncepty generování adres URL</span><span class="sxs-lookup"><span data-stu-id="ba1ea-360">URL generation concepts</span></span>

<span data-ttu-id="ba1ea-361">Generování adresy URL:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-361">URL generation:</span></span>

* <span data-ttu-id="ba1ea-362">Je proces, kterým směrování může vytvořit cestu URL na základě sady hodnot trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-362">Is the process by which routing can create a URL path based on a set of route values.</span></span>
* <span data-ttu-id="ba1ea-363">Umožňuje logické oddělení mezi koncovými body a adresy URL, které k nim přistupují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-363">Allows for a logical separation between endpoints and the URLs that access them.</span></span>

<span data-ttu-id="ba1ea-364">Směrování koncových <xref:Microsoft.AspNetCore.Routing.LinkGenerator> bodů zahrnuje rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-364">Endpoint routing includes the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API.</span></span> <span data-ttu-id="ba1ea-365">`LinkGenerator`je singleton služba k dispozici od [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-365">`LinkGenerator` is a singleton service available from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="ba1ea-366">Rozhraní `LinkGenerator` API lze použít mimo kontext vykonávajícího požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-366">The `LinkGenerator` API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="ba1ea-367">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) a scénáře, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>které jsou závislé na , jako jsou [pomocné spoje značek](xref:mvc/views/tag-helpers/intro), html pomocníci a [výsledky akcí](xref:mvc/controllers/actions), používají `LinkGenerator` rozhraní API interně k poskytování možností generování odkazů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-367">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the `LinkGenerator` API internally to provide link generating capabilities.</span></span>

<span data-ttu-id="ba1ea-368">Generátor propojení je podpořen konceptem schémat **adres** a **adres**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-368">The link generator is backed by the concept of an **address** and **address schemes**.</span></span> <span data-ttu-id="ba1ea-369">Schéma adresy je způsob, jak určit koncové body, které by měly být považovány za generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-369">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="ba1ea-370">Například scénáře název trasy a hodnoty trasy mnoho uživatelů jsou obeznámeni s z řadičů a Razor Pages jsou implementovány jako schéma adres.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-370">For example, the route name and route values scenarios many users are familiar with from controllers and Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="ba1ea-371">Generátor odkazů lze propojit s řadiči a Razor Pages pomocí následujících metod rozšíření:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-371">The link generator can link to controllers and Razor Pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="ba1ea-372">Přetížení těchto metod přijmout argumenty, `HttpContext`které zahrnují .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-372">Overloads of these methods accept arguments that include the `HttpContext`.</span></span> <span data-ttu-id="ba1ea-373">Tyto metody jsou funkčně ekvivalentní [url.action](xref:System.Web.Mvc.UrlHelper.Action*) a [url.page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), ale nabízejí další flexibilitu a možnosti.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-373">These methods are functionally equivalent to [Url.Action](xref:System.Web.Mvc.UrlHelper.Action*) and [Url.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), but offer additional flexibility and options.</span></span>

<span data-ttu-id="ba1ea-374">Metody `GetPath*` jsou nejvíce `Url.Action` podobné `Url.Page`a , v tom, že generují identifikátor URI obsahující absolutní cestu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-374">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page`, in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="ba1ea-375">Metody `GetUri*` vždy generovat absolutní URI obsahující schéma a hostitele.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-375">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="ba1ea-376">Metody, které `HttpContext` přijímají generovat identifikátor URI v kontextu vykonávajícího požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-376">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="ba1ea-377">Hodnoty [trasy okolí,](#ambient) základní cesta URL, schéma a hostitel z vykonávajícího požadavku se používají, pokud nejsou přepsány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-377">The [ambient](#ambient) route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="ba1ea-378"><xref:Microsoft.AspNetCore.Routing.LinkGenerator>je volána s adresou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-378"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="ba1ea-379">Generování identifikátoru URI probíhá ve dvou krocích:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-379">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="ba1ea-380">Adresa je vázána na seznam koncových bodů, které odpovídají adrese.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-380">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="ba1ea-381">Každý koncový bod <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> je vyhodnocen, dokud není nalezen vzorek postupu, který odpovídá zadaným hodnotám.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-381">Each endpoint's <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="ba1ea-382">Výsledný výstup je kombinován s ostatními částmi URI dodanými do generátoru propojení a vráceny.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-382">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="ba1ea-383">Metody poskytované <xref:Microsoft.AspNetCore.Routing.LinkGenerator> podporou standardních možností generování propojení pro jakýkoli typ adresy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-383">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="ba1ea-384">Nejpohodlnější způsob, jak používat generátor propojení je prostřednictvím rozšíření metody, které provádějí operace pro určitý typ adresy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-384">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type:</span></span>

| <span data-ttu-id="ba1ea-385">Metoda rozšíření</span><span class="sxs-lookup"><span data-stu-id="ba1ea-385">Extension Method</span></span> | <span data-ttu-id="ba1ea-386">Popis</span><span class="sxs-lookup"><span data-stu-id="ba1ea-386">Description</span></span> |
| ---------------- | ----------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="ba1ea-387">Generuje identifikátor URI s absolutní cestou na základě zadaných hodnot.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-387">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="ba1ea-388">Generuje absolutní identifikátor URI na základě zadaných hodnot.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-388">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="ba1ea-389">Věnujte pozornost následujícím <xref:Microsoft.AspNetCore.Routing.LinkGenerator> důsledkům volání metod:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-389">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="ba1ea-390">V `GetUri*` konfiguraci aplikace, která neověřuje `Host` záhlaví příchozích požadavků, používejte metody rozšíření opatrně.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-390">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="ba1ea-391">Pokud `Host` záhlaví příchozích požadavků není ověřeno, nelze klientovi v zobrazení nebo na stránce odeslat zpět nedůvěryhodný vstup požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-391">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view or page.</span></span> <span data-ttu-id="ba1ea-392">Doporučujeme, aby všechny produkční aplikace `Host` nakonfigurovaly svůj server tak, aby ověřoval záhlaví proti známým platným hodnotám.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-392">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="ba1ea-393">Používejte <xref:Microsoft.AspNetCore.Routing.LinkGenerator> s opatrností v `Map` middleware v kombinaci s nebo `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-393">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="ba1ea-394">`Map*`změní základní cestu vykonávajícího požadavku, což má vliv na výstup generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-394">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="ba1ea-395">Všechna <xref:Microsoft.AspNetCore.Routing.LinkGenerator> api umožňují určení základní cesty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-395">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="ba1ea-396">Zadejte prázdnou základní cestu, která má vrátit `Map*` vliv na generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-396">Specify an empty base path to undo the `Map*` affect on link generation.</span></span>

### <a name="middleware-example"></a><span data-ttu-id="ba1ea-397">Middleware příklad</span><span class="sxs-lookup"><span data-stu-id="ba1ea-397">Middleware example</span></span>

<span data-ttu-id="ba1ea-398">V následujícím příkladu middleware <xref:Microsoft.AspNetCore.Routing.LinkGenerator> používá rozhraní API k vytvoření odkazu na metodu akce, která uvádí seznam produktů úložiště.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-398">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create a link to an action method that lists store products.</span></span> <span data-ttu-id="ba1ea-399">Použití generátoru propojení vstřikováním `GenerateLink` do třídy a volání je k dispozici pro všechny třídy v aplikaci:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-399">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Middleware/ProductsLinkMiddleware.cs?name=snippet)]

<a name="rtr"></a>

## <a name="route-template-reference"></a><span data-ttu-id="ba1ea-400">Odkaz na šablonu trasy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-400">Route template reference</span></span>

<span data-ttu-id="ba1ea-401">Tokeny `{}` v rámci definovat parametry trasy, které jsou vázány, pokud je trasa uzavřeno.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-401">Tokens within `{}` define route parameters that are bound if the route is matched.</span></span> <span data-ttu-id="ba1ea-402">V segmentu trasy lze definovat více než jeden parametr trasy, ale parametry trasy musí být odděleny hodnotou literálu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-402">More than one route parameter can be defined in a route segment, but route parameters  must be separated by a literal value.</span></span> <span data-ttu-id="ba1ea-403">Například `{controller=Home}{action=Index}` není platná trasa, protože neexistuje žádná hodnota `{controller}` literálu mezi a `{action}`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-403">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span>  <span data-ttu-id="ba1ea-404">Parametry trasy musí mít název a mohou mít zadané další atributy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-404">Route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="ba1ea-405">Doslovný text jiný než parametry `{id}`trasy (například) a oddělovač `/` cesty se musí shodovat s textem v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-405">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="ba1ea-406">Porovnávání textu nerozlišuje malá a velká písmena a je založena na dekódované reprezentaci cesty url.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-406">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="ba1ea-407">Chcete-li porovnat oddělovač `{` parametrů `}`literálu trasy nebo , unikne oddělovači opakováním znaku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-407">To match a literal route parameter delimiter `{` or `}`, escape the delimiter by repeating the character.</span></span> <span data-ttu-id="ba1ea-408">Například `{{` `}}`nebo .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-408">For example `{{` or `}}`.</span></span>

<span data-ttu-id="ba1ea-409">Hvězdička `*` nebo dvojitá `**`hvězdička :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-409">Asterisk `*` or double asterisk `**`:</span></span>

* <span data-ttu-id="ba1ea-410">Lze použít jako předponu parametru trasy k vazbě na zbytek identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-410">Can be used as a prefix to a route parameter to bind to the rest of the URI.</span></span>
* <span data-ttu-id="ba1ea-411">Nazývají **catch-all** parametry.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-411">Are called a **catch-all** parameters.</span></span> <span data-ttu-id="ba1ea-412">Například: `blog/{**slug}`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-412">For example, `blog/{**slug}`:</span></span>
  * <span data-ttu-id="ba1ea-413">Odpovídá všem identifikátorům `/blog` URI, který začíná a má za ním libovolnou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-413">Matches any URI that starts with `/blog` and has any value following it.</span></span>
  * <span data-ttu-id="ba1ea-414">Následující `/blog` hodnota je přiřazena hodnotě trasy [popisu.](https://developer.mozilla.org/docs/Glossary/Slug)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-414">The value following `/blog` is assigned to the [slug](https://developer.mozilla.org/docs/Glossary/Slug) route value.</span></span>

<span data-ttu-id="ba1ea-415">Catch-all parametry mohou také odpovídat prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-415">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="ba1ea-416">Catch-all Parametr unikne příslušné znaky při směrování slouží ke generování `/` adresy URL, včetně oddělovací znaky cesty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-416">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator `/` characters.</span></span> <span data-ttu-id="ba1ea-417">Například trasa `foo/{*path}` s `{ path = "my/path" }` hodnotami `foo/my%2Fpath`trasy generuje .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-417">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="ba1ea-418">Všimněte si uvozené lomítko.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-418">Note the escaped forward slash.</span></span> <span data-ttu-id="ba1ea-419">K oddělovacím znakům cesty `**` okolení použijte předponu parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-419">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="ba1ea-420">Trasa `foo/{**path}` `{ path = "my/path" }` s `foo/my/path`generuje .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-420">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="ba1ea-421">Další důležité informace mají vzory adres URL, které se pokoušejí zachytit název souboru s volitelnou příponou souboru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-421">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="ba1ea-422">Zvažte například `files/{filename}.{ext?}`šablonu .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-422">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="ba1ea-423">Pokud jsou `filename` hodnoty `ext` pro oba a existují, jsou vyplněny obě hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-423">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="ba1ea-424">Pokud v adrese `filename` URL existuje pouze hodnota pro, trasa se shoduje, protože koncové je `.` volitelné.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-424">If only a value for `filename` exists in the URL, the route matches because the trailing `.` is  optional.</span></span> <span data-ttu-id="ba1ea-425">Následující adresy URL odpovídají této trase:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-425">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="ba1ea-426">Parametry postupu mohou mít **výchozí hodnoty** určené zadáním výchozí hodnoty za názvem`=`parametru odděleným znaménkem rovná se ( ).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-426">Route parameters may have **default values** designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="ba1ea-427">Definuje například `{controller=Home}` `Home` jako výchozí hodnotu pro `controller`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-427">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="ba1ea-428">Výchozí hodnota se používá, pokud v adrese URL parametru není žádná hodnota.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-428">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="ba1ea-429">Parametry trasy jsou volitelné připojením otazníku (`?`) na konec názvu parametru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-429">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name.</span></span> <span data-ttu-id="ba1ea-430">Například, `id?`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-430">For example, `id?`.</span></span> <span data-ttu-id="ba1ea-431">Rozdíl mezi volitelnými hodnotami a výchozími parametry trasy je následující:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-431">The difference between optional values and default route parameters is:</span></span>

* <span data-ttu-id="ba1ea-432">Parametr trasy s výchozí hodnotou vždy vytvoří hodnotu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-432">A route parameter with a default value always produces a value.</span></span>
* <span data-ttu-id="ba1ea-433">Volitelný parametr má hodnotu pouze v případě, že hodnota je poskytnuta adresou URL požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-433">An optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="ba1ea-434">Parametry trasy mohou mít omezení, která musí odpovídat hodnotě trasy vázané z adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-434">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="ba1ea-435">Přidání `:` a název omezení za název parametru trasy určuje vázací omezení parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-435">Adding `:` and constraint name after the route parameter name specifies an inline constraint on a route parameter.</span></span> <span data-ttu-id="ba1ea-436">Pokud omezení vyžaduje argumenty, jsou uzavřeny v `(...)` závorcích za názvem omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-436">If the constraint requires arguments, they're enclosed in parentheses `(...)` after the constraint name.</span></span> <span data-ttu-id="ba1ea-437">Více *vřádkové omezení* lze zadat `:` připojením jiného a názvu omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-437">Multiple *inline constraints* can be specified by appending another `:` and constraint name.</span></span>

<span data-ttu-id="ba1ea-438">Název omezení a argumenty jsou <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> předány službě <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> k vytvoření instance pro použití při zpracování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-438">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="ba1ea-439">Například šablona `blog/{article:minlength(10)}` trasy určuje `minlength` omezení s `10`argumentem .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-439">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="ba1ea-440">Další informace o omezeních postupu a seznam omezení poskytovaných rámcem naleznete v referenční části [omezení trasy.](#route-constraint-reference)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-440">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="ba1ea-441">Parametry trasy mohou mít také parametrtransformátory.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-441">Route parameters may also have parameter transformers.</span></span> <span data-ttu-id="ba1ea-442">Parametrové transformátory transformují hodnotu parametru při generování odkazů a odpovídajících akcí a stránek na adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-442">Parameter transformers transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="ba1ea-443">Podobně jako omezení mohou být transformátory parametrů přidány do `:` parametru trasy přidáním názvu a transformátoru za název parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-443">Like constraints, parameter transformers can be added inline to a route parameter by adding a `:` and transformer name after the route parameter name.</span></span> <span data-ttu-id="ba1ea-444">Například šablona `blog/{article:slugify}` trasy určuje `slugify` transformátor.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-444">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="ba1ea-445">Další informace o transformátorech parametrů naleznete v [části Reference parametrtransformátoru.](#parameter-transformer-reference)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-445">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="ba1ea-446">Následující tabulka ukazuje ukázkové šablony tras a jejich chování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-446">The following table demonstrates example route templates and their behavior:</span></span>

| <span data-ttu-id="ba1ea-447">Šablona postupu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-447">Route Template</span></span>                           | <span data-ttu-id="ba1ea-448">Příklad odpovídajícího identifikátoru URI</span><span class="sxs-lookup"><span data-stu-id="ba1ea-448">Example Matching URI</span></span>    | <span data-ttu-id="ba1ea-449">Identifikátor URI požadavku&hellip;</span><span class="sxs-lookup"><span data-stu-id="ba1ea-449">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="ba1ea-450">Odpovídá pouze jedné `/hello`cestě .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-450">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="ba1ea-451">Odpovídá a `Page` `Home`nastavuje na .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-451">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="ba1ea-452">Odpovídá a `Page` `Contact`nastavuje na .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-452">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="ba1ea-453">Mapuje `Products` na `List` ovladač a akci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-453">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="ba1ea-454">Mapuje `Products` na `Details` ovladač`id` a akce s nastavenou na 123.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-454">Maps to the `Products` controller and  `Details` action with`id` set to 123.</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="ba1ea-455">Mapuje `Home` na `Index` řadič a metodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-455">Maps to the `Home` controller and `Index` method.</span></span> <span data-ttu-id="ba1ea-456">`id` se ignoruje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-456">`id` is ignored.</span></span>        |
| `{controller=Home}/{action=Index}/{id?}` | `/Products`         | <span data-ttu-id="ba1ea-457">Mapuje `Products` na `Index` řadič a metodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-457">Maps to the `Products` controller and `Index` method.</span></span> <span data-ttu-id="ba1ea-458">`id` se ignoruje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-458">`id` is ignored.</span></span>        |

<span data-ttu-id="ba1ea-459">Použití šablony je obecně nejjednodušší přístup k směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-459">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="ba1ea-460">Omezení a výchozí hodnoty lze zadat také mimo šablonu trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-460">Constraints and defaults can also be specified outside the route template.</span></span>

### <a name="complex-segments"></a><span data-ttu-id="ba1ea-461">Složité segmenty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-461">Complex segments</span></span>

<span data-ttu-id="ba1ea-462">Složité segmenty jsou zpracovány porovnáním literálových oddělovačů zprava [doleva nechamtivým](#greedy) způsobem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-462">Complex segments are processed by matching up literal delimiters from right to left in a [non-greedy](#greedy) way.</span></span> <span data-ttu-id="ba1ea-463">Například `[Route("/a{b}c{d}")]` je složitý segment.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-463">For example, `[Route("/a{b}c{d}")]` is a complex segment.</span></span>
<span data-ttu-id="ba1ea-464">Složité segmenty fungují určitým způsobem, který je třeba chápat, aby byly úspěšně používány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-464">Complex segments work in a particular way that must be understood to use them successfully.</span></span> <span data-ttu-id="ba1ea-465">Příklad v této části ukazuje, proč složité segmenty skutečně fungují dobře pouze v případě, že se text oddělovače nezobrazuje uvnitř hodnot parametrů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-465">The example in this section demonstrates why complex segments only really work well when the delimiter text doesn't appear inside the parameter values.</span></span> <span data-ttu-id="ba1ea-466">Použití [regulárního výrazu](/dotnet/standard/base-types/regular-expressions) a následné ruční extrahování hodnot je potřeba pro složitější případy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-466">Using a [regex](/dotnet/standard/base-types/regular-expressions) and then manually extracting the values is needed for more complex cases.</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="ba1ea-467">Toto je souhrn kroků, které směrování `/a{b}c{d}` provádí se `/abcd`šablonou a cestou url .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-467">This is a summary of the steps that routing performs with the template `/a{b}c{d}` and the URL path `/abcd`.</span></span> <span data-ttu-id="ba1ea-468">Slouží `|` k vizualizaci, jak algoritmus funguje:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-468">The `|` is used to help visualize how the algorithm works:</span></span>

* <span data-ttu-id="ba1ea-469">První literál, zprava doleva, je `c`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-469">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="ba1ea-470">Tak `/abcd` je prohledán `/ab|c|d`zprava a najde .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-470">So `/abcd` is searched from right and finds `/ab|c|d`.</span></span>
* <span data-ttu-id="ba1ea-471">Vše vpravo`d`( ) je nyní spárováno s parametrem `{d}`trasy .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-471">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="ba1ea-472">Další literál, zprava doleva, je `a`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-472">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="ba1ea-473">Takže `/ab|c|d` je prohledána začíná `a` tam, `/|a|b|c|d`kde jsme skončili, pak se nachází .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-473">So `/ab|c|d` is searched starting where we left off, then `a` is found `/|a|b|c|d`.</span></span>
* <span data-ttu-id="ba1ea-474">Hodnota vpravo (`b`) je nyní spárována `{b}`s parametrem trasy .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-474">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="ba1ea-475">Neexistuje žádný zbývající text a žádná zbývající šablona trasy, takže se jedná o shodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-475">There is no remaining text and no remaining route template, so this is a match.</span></span>

<span data-ttu-id="ba1ea-476">Tady je příklad negativního případu, který `/a{b}c{d}` používá stejnou `/aabcd`šablonu a cestu url .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-476">Here's an example of a negative case using the same template `/a{b}c{d}` and the URL path `/aabcd`.</span></span> <span data-ttu-id="ba1ea-477">Slouží `|` k vizualizaci, jak algoritmus funguje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-477">The `|` is used to help visualize how the algorithm works.</span></span> <span data-ttu-id="ba1ea-478">Tento případ se neshoduje, což je vysvětleno stejným algoritmem:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-478">This case isn't a match, which is explained by the same algorithm:</span></span>
* <span data-ttu-id="ba1ea-479">První literál, zprava doleva, je `c`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-479">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="ba1ea-480">Tak `/aabcd` je prohledán `/aab|c|d`zprava a najde .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-480">So `/aabcd` is searched from right and finds `/aab|c|d`.</span></span>
* <span data-ttu-id="ba1ea-481">Vše vpravo`d`( ) je nyní spárováno s parametrem `{d}`trasy .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-481">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="ba1ea-482">Další literál, zprava doleva, je `a`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-482">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="ba1ea-483">Takže `/aab|c|d` je prohledána začíná `a` tam, `/a|a|b|c|d`kde jsme skončili, pak se nachází .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-483">So `/aab|c|d` is searched starting where we left off, then `a` is found `/a|a|b|c|d`.</span></span>
* <span data-ttu-id="ba1ea-484">Hodnota vpravo (`b`) je nyní spárována `{b}`s parametrem trasy .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-484">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="ba1ea-485">V tomto okamžiku je `a`zbývající text , ale algoritmus má nedostatek šablony trasy analyzovat, takže to není shoda.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-485">At this point there is remaining text `a`, but the algorithm has run out of route template to parse, so this is not a match.</span></span>

<span data-ttu-id="ba1ea-486">Vzhledem k tomu, odpovídající algoritmus je [non-chamtivý](#greedy):</span><span class="sxs-lookup"><span data-stu-id="ba1ea-486">Since the matching algorithm is [non-greedy](#greedy):</span></span>

* <span data-ttu-id="ba1ea-487">Odpovídá nejmenšímu možnému množství textu v každém kroku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-487">It matches the smallest amount of text possible in each step.</span></span>
* <span data-ttu-id="ba1ea-488">V každém případě, kdy se hodnota oddělovače objeví uvnitř hodnot parametrů, dojde k neshodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-488">Any case where the delimiter value appears inside the parameter values results in not matching.</span></span>

<span data-ttu-id="ba1ea-489">Regulární výrazy poskytují mnohem větší kontrolu nad jejich chování odpovídající.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-489">Regular expressions provide much more control over their matching behavior.</span></span>

<a name="greedy"></a>

<span data-ttu-id="ba1ea-490">Greedy odpovídající, také vědět, jak [opožděné odpovídající](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), odpovídá největší možný řetězec.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-490">Greedy matching, also know as [lazy matching](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), matches the largest possible string.</span></span> <span data-ttu-id="ba1ea-491">Nechamtivý odpovídá nejmenší možný řetězec.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-491">Non-greedy matches the smallest possible string.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="ba1ea-492">Odkaz na omezení postupu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-492">Route constraint reference</span></span>

<span data-ttu-id="ba1ea-493">Omezení trasy se spustí, když došlo ke shodě s příchozí adresou URL a cesta url je tokenizována na hodnoty trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-493">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="ba1ea-494">Omezení postupu obvykle kontrolují hodnotu postupu přidruženou prostřednictvím šablony postupu a činí pravdivé nebo nepravdivé rozhodnutí o tom, zda je hodnota přijatelná.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-494">Route constraints generally inspect the route value associated via the route template and make a true or false decision about whether the value is acceptable.</span></span> <span data-ttu-id="ba1ea-495">Některá omezení postupu používají data mimo hodnotu postupu k posouzení, zda lze požadavek směrovat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-495">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="ba1ea-496">Například <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> může přijmout nebo odmítnout požadavek na základě jeho slovesa HTTP.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-496">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="ba1ea-497">Omezení se používají v požadavcích na směrování a generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-497">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="ba1ea-498">Nepoužívejte omezení pro ověření vstupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-498">Don't use constraints for input validation.</span></span> <span data-ttu-id="ba1ea-499">Pokud omezení se používají pro ověření vstupu, `404` neplatný vstup výsledky v nenalezené odpovědi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-499">If constraints are used for input validation, invalid input results in a `404` Not Found response.</span></span> <span data-ttu-id="ba1ea-500">Neplatný vstup `400` by měl vytvořit chybný požadavek s příslušnou chybovou zprávou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-500">Invalid input should produce a `400` Bad Request with an appropriate error message.</span></span> <span data-ttu-id="ba1ea-501">Omezení trasy se používají k rozdvojení podobných tras, nikoli k ověření vstupů pro určitou trasu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-501">Route constraints are used to disambiguate similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="ba1ea-502">Následující tabulka ukazuje ukázková omezení trasy a jejich očekávané chování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-502">The following table demonstrates example route constraints and their expected behavior:</span></span>

| <span data-ttu-id="ba1ea-503">omezení</span><span class="sxs-lookup"><span data-stu-id="ba1ea-503">constraint</span></span> | <span data-ttu-id="ba1ea-504">Příklad</span><span class="sxs-lookup"><span data-stu-id="ba1ea-504">Example</span></span> | <span data-ttu-id="ba1ea-505">Příklady shod</span><span class="sxs-lookup"><span data-stu-id="ba1ea-505">Example Matches</span></span> | <span data-ttu-id="ba1ea-506">Poznámky</span><span class="sxs-lookup"><span data-stu-id="ba1ea-506">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="ba1ea-507">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-507">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ba1ea-508">Shoduje se s libovolným celéčíslo</span><span class="sxs-lookup"><span data-stu-id="ba1ea-508">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="ba1ea-509">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-509">`true`, `FALSE`</span></span> | <span data-ttu-id="ba1ea-510">`true` Zápasy `false`nebo .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-510">Matches `true` or `false`.</span></span> <span data-ttu-id="ba1ea-511">Case-insensitive</span><span class="sxs-lookup"><span data-stu-id="ba1ea-511">Case-insensitive</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="ba1ea-512">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-512">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="ba1ea-513">Odpovídá platné `DateTime` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-513">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-514">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-514">See preceding warning.</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="ba1ea-515">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-515">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="ba1ea-516">Odpovídá platné `decimal` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-516">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-517">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-517">See preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="ba1ea-518">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-518">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ba1ea-519">Odpovídá platné `double` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-519">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-520">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-520">See preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="ba1ea-521">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-521">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ba1ea-522">Odpovídá platné `float` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-522">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-523">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-523">See preceding warning.</span></span>|
| `guid` | `{id:guid}` | `CD2C1638-1638-72D5-1638-DEADBEEF1638` | <span data-ttu-id="ba1ea-524">Odpovídá platné `Guid` hodnotě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-524">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="ba1ea-525">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-525">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ba1ea-526">Odpovídá platné `long` hodnotě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-526">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="ba1ea-527">Řetězec musí mít alespoň 4 znaky.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-527">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="ba1ea-528">Řetězec nesmí být větší než 8 znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-528">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="ba1ea-529">Řetězec musí mít přesně 12 znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-529">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="ba1ea-530">Řetězec musí mít alespoň 8 a nesmí mít přes 16 znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-530">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="ba1ea-531">Hodnota celého čísla musí být alespoň 18</span><span class="sxs-lookup"><span data-stu-id="ba1ea-531">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="ba1ea-532">Celá hodnota nesmí být větší než 120</span><span class="sxs-lookup"><span data-stu-id="ba1ea-532">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="ba1ea-533">Hodnota celého čísla musí být alespoň 18, ale ne větší než 120</span><span class="sxs-lookup"><span data-stu-id="ba1ea-533">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="ba1ea-534">Řetězec se musí skládat z `a` - `z` jednoho nebo více abecedních znaků a bez rozlišování velkých a malých písmen.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-534">String must consist of one or more alphabetical characters, `a`-`z` and case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="ba1ea-535">Řetězec musí odpovídat regulárnímu výrazu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-535">String must match the regular expression.</span></span> <span data-ttu-id="ba1ea-536">Podívejte se na tipy pro definici regulárního výrazu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-536">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="ba1ea-537">Slouží k vynucení, že hodnota neparametrje přítomna během generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-537">Used to enforce that a non-parameter value is present during URL generation</span></span> |

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="ba1ea-538">Na jeden parametr lze použít více omezení vymezených dvojtečkou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-538">Multiple, colon delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="ba1ea-539">Například následující omezení omezuje parametr na celou hodnotu 1 nebo vyšší:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-539">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="ba1ea-540">Omezení trasy, která ověřují adresu URL a jsou převedena na typ CLR, vždy používají invariantní jazykovou verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-540">Route constraints that verify the URL and are converted to a CLR type always use the invariant culture.</span></span> <span data-ttu-id="ba1ea-541">Například převod na typ `int` CLR nebo `DateTime`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-541">For example, conversion to the CLR type `int` or `DateTime`.</span></span> <span data-ttu-id="ba1ea-542">Tato omezení předpokládají, že adresu URL nelze lokalizovat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-542">These constraints assume that the URL is not localizable.</span></span> <span data-ttu-id="ba1ea-543">Omezení trasy poskytovaná rámcem nemění hodnoty uložené v hodnotách trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-543">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="ba1ea-544">Všechny hodnoty trasy analyzované z adresy URL jsou uloženy jako řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-544">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="ba1ea-545">Například `float` omezení se pokusí převést hodnotu trasy na float, ale převedená hodnota se používá pouze k ověření, že může být převedena na float.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-545">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

### <a name="regular-expressions-in-constraints"></a><span data-ttu-id="ba1ea-546">Regulární výrazy v omezeních</span><span class="sxs-lookup"><span data-stu-id="ba1ea-546">Regular expressions in constraints</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="ba1ea-547">Regulární výrazy lze zadat jako `regex(...)` válčná omezení pomocí omezení postupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-547">Regular expressions can be specified as inline constraints using the `regex(...)` route constraint.</span></span> <span data-ttu-id="ba1ea-548">Metody v <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> rodině také přijmout literál objektu omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-548">Methods in the <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> family also accept an object literal of constraints.</span></span> <span data-ttu-id="ba1ea-549">Pokud je tento formulář použit, řetězcové hodnoty jsou interpretovány jako regulární výrazy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-549">If that form is used, string values are interpreted as regular expressions.</span></span>

<span data-ttu-id="ba1ea-550">Následující kód používá omezení vposlední regulární výraz:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-550">The following code uses an inline regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex.cs?name=snippet)]

<span data-ttu-id="ba1ea-551">Následující kód používá literál objektu k určení omezení regulárního výrazu:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-551">The following code uses an object literal to specify a regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex2.cs?name=snippet)]

<span data-ttu-id="ba1ea-552">Rozhraní ASP.NET Core `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` přidává k konstruktoru regulárního výrazu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-552">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="ba1ea-553">Viz <xref:System.Text.RegularExpressions.RegexOptions> popis těchto členů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-553">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="ba1ea-554">Regulární výrazy používají oddělovače a tokeny podobné těm, které používají směrování a jazyk C#.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-554">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="ba1ea-555">Tokeny regulárního výrazu musí být uvozeny.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-555">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="ba1ea-556">Chcete-li použít `^\d{3}-\d{2}-\d{4}$` regulární výraz v inline omezení, použijte jednu z následujících možností:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-556">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in an inline constraint, use one of the following:</span></span>

* <span data-ttu-id="ba1ea-557">Nahraďte `\` znaky uvedené `\\` v řetězci jako znaky ve zdrojovém souboru Jazyka C#, aby se vyhnuly řídicímu znaku `\` řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-557">Replace `\` characters provided in the string as `\\` characters in the C# source file in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="ba1ea-558">[Doslovné řetězcové literály](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-558">[Verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="ba1ea-559">Chcete-li `{`uniknout znaky oddělovače parametrů směrování , `}`, `[`zdvojnásobte `[[` `]]` `]`znaky ve výrazu, `{{`například , `}}`, , .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-559">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression, for example, `{{`, `}}`, `[[`, `]]`.</span></span> <span data-ttu-id="ba1ea-560">V následující tabulce je uveden regulární výraz a jeho uvozená verze:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-560">The following table shows a regular expression and its escaped version:</span></span>

| <span data-ttu-id="ba1ea-561">Regulární výraz</span><span class="sxs-lookup"><span data-stu-id="ba1ea-561">Regular expression</span></span>    | <span data-ttu-id="ba1ea-562">Uvozen regulární výraz</span><span class="sxs-lookup"><span data-stu-id="ba1ea-562">Escaped regular expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="ba1ea-563">Regulární výrazy používané při `^` směrování často začínají znakem a odpovídají počáteční pozici řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-563">Regular expressions used in routing often start with the `^` character and match the starting position of the string.</span></span> <span data-ttu-id="ba1ea-564">Výrazy často končí `$` znakem a odpovídají konci řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-564">The expressions often end with the `$` character and match the end of the string.</span></span> <span data-ttu-id="ba1ea-565">Znaky `^` `$` a zajišťují, že regulární výraz odpovídá celé hodnotě parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-565">The `^` and `$` characters ensure that the regular expression matches the entire route parameter value.</span></span> <span data-ttu-id="ba1ea-566">Bez `^` znaků `$` a regulární výraz odpovídá libovolnému podřetězci v řetězci, což je často nežádoucí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-566">Without the `^` and `$` characters, the regular expression matches any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="ba1ea-567">V následující tabulce jsou uvedeny příklady a vysvětleny, proč se shodují nebo neshodují:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-567">The following table provides examples and explains why they match or fail to match:</span></span>

| <span data-ttu-id="ba1ea-568">Expression</span><span class="sxs-lookup"><span data-stu-id="ba1ea-568">Expression</span></span>   | <span data-ttu-id="ba1ea-569">Řetězec</span><span class="sxs-lookup"><span data-stu-id="ba1ea-569">String</span></span>    | <span data-ttu-id="ba1ea-570">Shoda</span><span class="sxs-lookup"><span data-stu-id="ba1ea-570">Match</span></span> | <span data-ttu-id="ba1ea-571">Poznámka</span><span class="sxs-lookup"><span data-stu-id="ba1ea-571">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-572">hello</span><span class="sxs-lookup"><span data-stu-id="ba1ea-572">hello</span></span>     | <span data-ttu-id="ba1ea-573">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-573">Yes</span></span>   | <span data-ttu-id="ba1ea-574">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ba1ea-574">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-575">123abc456</span><span class="sxs-lookup"><span data-stu-id="ba1ea-575">123abc456</span></span> | <span data-ttu-id="ba1ea-576">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-576">Yes</span></span>   | <span data-ttu-id="ba1ea-577">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ba1ea-577">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-578">Mz</span><span class="sxs-lookup"><span data-stu-id="ba1ea-578">mz</span></span>        | <span data-ttu-id="ba1ea-579">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-579">Yes</span></span>   | <span data-ttu-id="ba1ea-580">Odpovídá výrazu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-580">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-581">MZ</span><span class="sxs-lookup"><span data-stu-id="ba1ea-581">MZ</span></span>        | <span data-ttu-id="ba1ea-582">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-582">Yes</span></span>   | <span data-ttu-id="ba1ea-583">Neuznačují malá a velká písmen</span><span class="sxs-lookup"><span data-stu-id="ba1ea-583">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="ba1ea-584">hello</span><span class="sxs-lookup"><span data-stu-id="ba1ea-584">hello</span></span>     | <span data-ttu-id="ba1ea-585">Ne</span><span class="sxs-lookup"><span data-stu-id="ba1ea-585">No</span></span>    | <span data-ttu-id="ba1ea-586">Viz `^` `$` a výše</span><span class="sxs-lookup"><span data-stu-id="ba1ea-586">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="ba1ea-587">123abc456</span><span class="sxs-lookup"><span data-stu-id="ba1ea-587">123abc456</span></span> | <span data-ttu-id="ba1ea-588">Ne</span><span class="sxs-lookup"><span data-stu-id="ba1ea-588">No</span></span>    | <span data-ttu-id="ba1ea-589">Viz `^` `$` a výše</span><span class="sxs-lookup"><span data-stu-id="ba1ea-589">See `^` and `$` above</span></span> |

<span data-ttu-id="ba1ea-590">Další informace o syntaxi regulárních výrazů naleznete [v tématu .NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-590">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="ba1ea-591">Chcete-li omezit parametr na známou sadu možných hodnot, použijte regulární výraz.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-591">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="ba1ea-592">Například `{action:regex(^(list|get|create)$)}` pouze odpovídá `action` hodnotě `list` `get`trasy `create`do , , nebo .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-592">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="ba1ea-593">Pokud je předán do slovníku `^(list|get|create)$` omezení, řetězec je ekvivalentní.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-593">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="ba1ea-594">Omezení, která jsou předána ve slovníku omezení, které neodpovídají jednomu ze známých omezení, jsou také považována za regulární výrazy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-594">Constraints that are passed in the constraints dictionary that don't match one of the known constraints are also treated as regular expressions.</span></span> <span data-ttu-id="ba1ea-595">Omezení, která jsou předána v rámci šablony, která neodpovídají jednomu ze známých omezení, nejsou považována za regulární výrazy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-595">Constraints that are passed  within a template that don't match one of the known constraints are not treated as regular expressions.</span></span>

### <a name="custom-route-constraints"></a><span data-ttu-id="ba1ea-596">Vlastní omezení trasy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-596">Custom route constraints</span></span>

<span data-ttu-id="ba1ea-597">Vlastní omezení trasy lze vytvořit implementací <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-597">Custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="ba1ea-598">Rozhraní `IRouteConstraint` obsahuje <xref:System.Web.Routing.IRouteConstraint.Match*>, `true` který vrátí, pokud `false` je splněna omezení a jinak.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-598">The `IRouteConstraint` interface contains <xref:System.Web.Routing.IRouteConstraint.Match*>, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="ba1ea-599">Omezení vlastní trasy jsou zřídka potřeba.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-599">Custom route constraints are rarely needed.</span></span> <span data-ttu-id="ba1ea-600">Před implementací omezení vlastní trasy zvažte alternativy, jako je například vazba modelu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-600">Before implementing a custom route constraint, consider alternatives, such as model binding.</span></span>

<span data-ttu-id="ba1ea-601">Chcete-li `IRouteConstraint`použít vlastní , musí být typ omezení <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> postupu registrován u aplikace v kontejneru servisu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-601">To use a custom `IRouteConstraint`, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the service container.</span></span> <span data-ttu-id="ba1ea-602">A `ConstraintMap` je slovník, který mapuje `IRouteConstraint` klíče omezení trasy na implementace, které tato omezení ověřují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-602">A `ConstraintMap` is a dictionary that maps route constraint keys to `IRouteConstraint` implementations that validate those constraints.</span></span> <span data-ttu-id="ba1ea-603">Aplikace `ConstraintMap` lze aktualizovat buď `Startup.ConfigureServices` jako součást [služby. AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) volání nebo <xref:Microsoft.AspNetCore.Routing.RouteOptions> konfigurací `services.Configure<RouteOptions>`přímo s .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-603">An app's `ConstraintMap` can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="ba1ea-604">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-604">For example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet)]

<span data-ttu-id="ba1ea-605">Předchozí omezení se použije v následujícím kódu:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-605">The preceding constraint is applied in the following code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet&highlight=6,13)]

[!INCLUDE[](~/includes/MyDisplayRouteInfo.md)]

<span data-ttu-id="ba1ea-606">Implementace zabránění `MyCustomConstraint` `0` použití parametru trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-606">The implementation of `MyCustomConstraint` prevents `0` being applied to a route parameter:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet2)]

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="ba1ea-607">Předcházející kód:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-607">The preceding code:</span></span>

* <span data-ttu-id="ba1ea-608">Zabrání `0` v `{id}` segmentu trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-608">Prevents `0` in the `{id}` segment of the route.</span></span>
* <span data-ttu-id="ba1ea-609">Je zobrazen a poskytuje základní příklad implementace vlastní omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-609">Is shown to provide a basic example of implementing a custom constraint.</span></span> <span data-ttu-id="ba1ea-610">Neměl by být používán v produkční aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-610">It should not be used in a production app.</span></span>

<span data-ttu-id="ba1ea-611">Následující kód je lepší přístup `id` k zabránění obsahující `0` obsahující z zpracování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-611">The following code is a better approach to preventing an `id` containing a `0` from being processed:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet2)]

<span data-ttu-id="ba1ea-612">Předchozí kód má následující výhody `MyCustomConstraint` oproti přístupu:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-612">The preceding code has the following advantages over the `MyCustomConstraint` approach:</span></span>

* <span data-ttu-id="ba1ea-613">Nevyžaduje vlastní omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-613">It doesn't require a custom constraint.</span></span>
* <span data-ttu-id="ba1ea-614">Vrátí popisnější chybu, pokud parametr trasy `0`zahrne .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-614">It returns a more descriptive error when the route parameter includes `0`.</span></span>

## <a name="parameter-transformer-reference"></a><span data-ttu-id="ba1ea-615">Odkaz na parametr transformátor</span><span class="sxs-lookup"><span data-stu-id="ba1ea-615">Parameter transformer reference</span></span>

<span data-ttu-id="ba1ea-616">Parametrické transformátory:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-616">Parameter transformers:</span></span>

* <span data-ttu-id="ba1ea-617">Spusťte při generování <xref:Microsoft.AspNetCore.Routing.LinkGenerator>propojení pomocí .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-617">Execute when generating a link using <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span></span>
* <span data-ttu-id="ba1ea-618">Implementovat <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-618">Implement <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span></span>
* <span data-ttu-id="ba1ea-619">Jsou konfigurovány pomocí <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-619">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="ba1ea-620">Vezměte hodnotu trasy parametru a transformujte ji na novou hodnotu řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-620">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="ba1ea-621">Výsledkem je použití transformované hodnoty ve generovaném propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-621">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="ba1ea-622">`slugify` Například vlastní parametr transformátor `blog\{article:slugify}` ve `Url.Action(new { article = "MyTestArticle" })` vzoru `blog\my-test-article`trasy s generuje .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-622">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="ba1ea-623">Zvažte `IOutboundParameterTransformer` následující implementaci:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-623">Consider the following `IOutboundParameterTransformer` implementation:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet2)]

<span data-ttu-id="ba1ea-624">Chcete-li použít parametrový transformátor ve <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> `Startup.ConfigureServices`vzoru trasy, nakonfigurujte jej pomocí aplikace :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-624">To use a parameter transformer in a route pattern, configure it using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet)]

<span data-ttu-id="ba1ea-625">Rozhraní ASP.NET Core framework používá parametr transformátory k transformaci identifikátoru URI, kde se řeší koncový bod.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-625">The ASP.NET Core framework uses parameter transformers to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="ba1ea-626">Například parametrové transformátory transformují `area`hodnoty `controller` `action`trasy `page`použité tak, aby odpovídaly , , a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-626">For example, parameter transformers transform the route values used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapControllerRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="ba1ea-627">S předchozí šablonou trasy `SubscriptionManagementController.GetAll` je akce spárována `/subscription-management/get-all`s identifikátorem URI .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-627">With the preceding route template, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="ba1ea-628">Transformátor parametrů nezmění hodnoty trasy použité ke generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-628">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="ba1ea-629">Například `Url.Action("GetAll", "SubscriptionManagement")` výstupy `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-629">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="ba1ea-630">ASP.NET Core poskytuje konvencí rozhraní API pro použití parametrických transformátorů s generovanými trasami:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-630">ASP.NET Core provides API conventions for using parameter transformers with generated routes:</span></span>

* <span data-ttu-id="ba1ea-631">Konvence <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> MVC použije zadaný parametr transformátor u všech tras atributů v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-631">The <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> MVC convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="ba1ea-632">Parametr transformer transformuje atribut route tokeny jako jsou nahrazeny.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-632">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="ba1ea-633">Další informace naleznete [v tématu Použití transformátoru parametrů k přizpůsobení nahrazení tokenu](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-633">For more information, see [Use a parameter transformer to customize token replacement](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="ba1ea-634">Razor Pages <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> používá konvenci rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-634">Razor Pages uses the <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> API convention.</span></span> <span data-ttu-id="ba1ea-635">Tato konvence aplikuje zadaný parametr transformátoru na všechny automaticky zjištěné Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-635">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="ba1ea-636">Parametr transformer transformuje segmenty názvů složek a souborů tras Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-636">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="ba1ea-637">Další informace naleznete [v tématu Použití transformátoru parametrů k přizpůsobení tras stránek](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-637">For more information, see [Use a parameter transformer to customize page routes](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

<a name="ugr"></a>

## <a name="url-generation-reference"></a><span data-ttu-id="ba1ea-638">Odkaz na generování adresy URL</span><span class="sxs-lookup"><span data-stu-id="ba1ea-638">URL generation reference</span></span>

<span data-ttu-id="ba1ea-639">Tato část obsahuje odkaz na algoritmus implementovaný generováním adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-639">This section contains a reference for the algorithm implemented by URL generation.</span></span> <span data-ttu-id="ba1ea-640">V praxi nejsložitější příklady generování adres URL používají řadiče nebo Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-640">In practice, most complex examples of URL generation use controllers or Razor Pages.</span></span> <span data-ttu-id="ba1ea-641">Další informace naleznete [v tématu směrování v řadičích.](xref:mvc/controllers/routing)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-641">See  [routing in controllers](xref:mvc/controllers/routing) for additional information.</span></span>

<span data-ttu-id="ba1ea-642">Proces generování adresy URL začíná [volánílinkem LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) nebo podobnou metodou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-642">The URL generation process begins with a call to [LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) or a similar method.</span></span> <span data-ttu-id="ba1ea-643">Metoda je k dispozici s adresou, sadou hodnot postupu a volitelně informacemi o aktuálním požadavku od `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-643">The method is provided with an address, a set of route values, and optionally information about the current request from `HttpContext`.</span></span>

<span data-ttu-id="ba1ea-644">Prvním krokem je použití adresy k vyřešení sady koncových [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) bodů kandidáta pomocí typu, který odpovídá typu adresy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-644">The first step is to use the address to resolve a set of candidate endpoints using an [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) that matches the address's type.</span></span>

<span data-ttu-id="ba1ea-645">Jakmile sada kandidátů je nalezen a schéma adresy, koncové body jsou seřazeny a zpracovány iterativně, dokud operace generování adresy URL úspěšné.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-645">Once of set of candidates is found by the address scheme, the endpoints are ordered and processed iteratively until a URL generation operation succeeds.</span></span> <span data-ttu-id="ba1ea-646">Generování adresy URL **nekontroluje** nejednoznačnosti, první vrácený výsledek je konečný výsledek.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-646">URL generation does **not** check for ambiguities, the first result returned is the final result.</span></span>

### <a name="troubleshooting-url-generation-with-logging"></a><span data-ttu-id="ba1ea-647">Poradce při potížích s generováním adresy URL s protokolováním</span><span class="sxs-lookup"><span data-stu-id="ba1ea-647">Troubleshooting URL generation with logging</span></span>

<span data-ttu-id="ba1ea-648">Prvním krokem při odstraňování potíží s generováním `Microsoft.AspNetCore.Routing` `TRACE`adresy URL je nastavení úrovně protokolování na .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-648">The first step in troubleshooting URL generation is setting the logging level of `Microsoft.AspNetCore.Routing` to `TRACE`.</span></span> <span data-ttu-id="ba1ea-649">`LinkGenerator`zaznamenává mnoho podrobností o jeho zpracování, které mohou být užitečné pro řešení problémů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-649">`LinkGenerator` logs many details about its processing which can be useful to troubleshoot problems.</span></span>

<span data-ttu-id="ba1ea-650">Podrobnosti o generování adresy URL najdete v [tématu odkaz](#ugr) na generování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-650">See [URL generation reference](#ugr) for details on URL generation.</span></span>

### <a name="addresses"></a><span data-ttu-id="ba1ea-651">Adresy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-651">Addresses</span></span>

<span data-ttu-id="ba1ea-652">Adresy jsou koncept v generování adres URL slouží k vytvoření svázání volání do generátoru propojení na sadu koncových bodů kandidáta.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-652">Addresses are the concept in URL generation used to bind a call into the link generator to a set of candidate endpoints.</span></span>

<span data-ttu-id="ba1ea-653">Adresy jsou rozšiřitelný koncept, které přicházejí s dvě implementace ve výchozím nastavení:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-653">Addresses are an extensible concept that come with two implementations by default:</span></span>

* <span data-ttu-id="ba1ea-654">Použití *názvu koncového bodu* (`string`) jako adresy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-654">Using *endpoint name* (`string`) as the address:</span></span>
    * <span data-ttu-id="ba1ea-655">Poskytuje podobné funkce jako název trasy MVC.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-655">Provides similar functionality to MVC's route name.</span></span>
    * <span data-ttu-id="ba1ea-656">Používá <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata> typ metadat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-656">Uses the <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata> metadata type.</span></span>
    * <span data-ttu-id="ba1ea-657">Řeší zadaný řetězec proti metadatům všech registrovaných koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-657">Resolves the provided string against the metadata of all registered endpoints.</span></span>
    * <span data-ttu-id="ba1ea-658">Vyvolá výjimku při spuštění, pokud více koncových bodů používá stejný název.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-658">Throws an exception on startup if multiple endpoints use the same name.</span></span>
    * <span data-ttu-id="ba1ea-659">Doporučeno pro všeobecné použití mimo ovladače a Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-659">Recommended for general-purpose use outside of controllers and Razor Pages.</span></span>
* <span data-ttu-id="ba1ea-660">Použití *hodnot* <xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>trasy ( ) jako adresy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-660">Using *route values* (<xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>) as the address:</span></span>
    * <span data-ttu-id="ba1ea-661">Poskytuje podobné funkce pro řadiče a generování starších adres URL razor pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-661">Provides similar functionality to controllers and Razor Pages legacy URL generation.</span></span>
    * <span data-ttu-id="ba1ea-662">Velmi složité rozšířit a ladit.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-662">Very complex to extend and debug.</span></span>
    * <span data-ttu-id="ba1ea-663">Poskytuje implementaci používanou `IUrlHelper`pomocí , Tag Helpers, HTML Helpers, Výsledky akcí atd.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-663">Provides the implementation used by `IUrlHelper`, Tag Helpers, HTML Helpers, Action Results, etc.</span></span>

<span data-ttu-id="ba1ea-664">Úlohou schématu adres je přidružení mezi adresou a odpovídajícími koncovými body podle libovolných kritérií:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-664">The role of the address scheme is to make the association between the address and matching endpoints by arbitrary criteria:</span></span>

* <span data-ttu-id="ba1ea-665">Schéma názvu koncového bodu provádí základní slovníkvyhledávání.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-665">The endpoint name scheme performs a basic dictionary lookup.</span></span>
* <span data-ttu-id="ba1ea-666">Schéma hodnot trasy má komplexní nejlepší podmnožinu algoritmu sady.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-666">The route values scheme has a complex best subset of set algorithm.</span></span>

<a name="ambient"></a>

### <a name="ambient-values-and-explicit-values"></a><span data-ttu-id="ba1ea-667">Okolní hodnoty a explicitní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-667">Ambient values and explicit values</span></span>

<span data-ttu-id="ba1ea-668">Z aktuálního požadavku přistupuje směrování `HttpContext.Request.RouteValues`k hodnotám trasy aktuálního požadavku .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-668">From the current request, routing accesses the route values of the current request `HttpContext.Request.RouteValues`.</span></span> <span data-ttu-id="ba1ea-669">Hodnoty přidružené k aktuálnímu požadavku jsou označovány jako **hodnoty okolí**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-669">The values associated with the current request are referred to as the **ambient values**.</span></span> <span data-ttu-id="ba1ea-670">Pro účely přehlednosti se v dokumentaci označují hodnoty postupu předávané metodám jako **explicitní hodnoty**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-670">For the purpose of clarity, the documentation refers to the route values passed in to methods as **explicit values**.</span></span>

<span data-ttu-id="ba1ea-671">Následující příklad ukazuje okolní hodnoty a explicitní hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-671">The following example shows ambient values and explicit values.</span></span> <span data-ttu-id="ba1ea-672">Poskytuje okolní hodnoty z aktuálního požadavku `{ id = 17, }`a explicitní hodnoty: :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-672">It provides ambient values from the current request and explicit values: `{ id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet)]

<span data-ttu-id="ba1ea-673">Předcházející kód:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-673">The preceding code:</span></span>

* <span data-ttu-id="ba1ea-674">Vrátí`/Widget/Index/17`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-674">Returns `/Widget/Index/17`</span></span>
* <span data-ttu-id="ba1ea-675">Získá <xref:Microsoft.AspNetCore.Routing.LinkGenerator> přes [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-675">Gets <xref:Microsoft.AspNetCore.Routing.LinkGenerator> via [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="ba1ea-676">Následující kód neobsahuje žádné okolní `{ controller = "Home", action = "Subscribe", id = 17, }`hodnoty a explicitní hodnoty: :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-676">The following code provides no ambient values and explicit values: `{ controller = "Home", action = "Subscribe", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet2)]

<span data-ttu-id="ba1ea-677">Předchozí metoda vrátí`/Home/Subscribe/17`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-677">The preceding  method returns `/Home/Subscribe/17`</span></span>

<span data-ttu-id="ba1ea-678">Následující kód ve `WidgetController` `/Widget/Subscribe/17`přiznáních :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-678">The following code in the `WidgetController` returns `/Widget/Subscribe/17`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet3)]

<span data-ttu-id="ba1ea-679">Následující kód poskytuje řadič z okolních hodnot v `{ action = "Edit", id = 17, }`aktuálním požadavku a explicitní hodnoty: :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-679">The following code provides the controller from ambient values in the current request and explicit values: `{ action = "Edit", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/GadgetController.cs?name=snippet)]

<span data-ttu-id="ba1ea-680">V předchozím kódu:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-680">In the preceding code:</span></span>

* <span data-ttu-id="ba1ea-681">`/Gadget/Edit/17`je vrácena.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-681">`/Gadget/Edit/17` is returned.</span></span>
* <span data-ttu-id="ba1ea-682"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url>získá <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-682"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> gets the <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span></span>
* <xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*>   
<span data-ttu-id="ba1ea-683">vygeneruje adresu URL s absolutní cestou pro metodu akce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-683">generates a URL with an absolute path for an action method.</span></span> <span data-ttu-id="ba1ea-684">Adresa URL obsahuje `action` zadaný název a `route` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-684">The URL contains the specified `action` name and `route` values.</span></span>

<span data-ttu-id="ba1ea-685">Následující kód poskytuje okolní hodnoty z aktuálního `{ page = "./Edit, id = 17, }`požadavku a explicitní hodnoty: :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-685">The following code provides ambient values from the current request and explicit values: `{ page = "./Edit, id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Pages/Index.cshtml.cs?name=snippet)]

<span data-ttu-id="ba1ea-686">Předchozí kód nastaví, `url` `/Edit/17` když upravit holicí strojek stránka obsahuje následující direktivu stránky:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-686">The preceding code sets `url` to  `/Edit/17` when the Edit Razor Page contains the following page directive:</span></span>

 `@page "{id:int}"`

<span data-ttu-id="ba1ea-687">Pokud stránka Úpravy šablonu `"{id:int}"` trasy `url` neobsahuje, je `/Edit?id=17`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-687">If the Edit page doesn't contain the `"{id:int}"` route template, `url` is `/Edit?id=17`.</span></span>

<span data-ttu-id="ba1ea-688">Chování MVC přidává <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> vrstvu složitosti kromě pravidel popsaných zde:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-688">The behavior of MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> adds a layer of complexity in addition to the rules described here:</span></span>

* <span data-ttu-id="ba1ea-689">`IUrlHelper`vždy poskytuje hodnoty trasy z aktuálního požadavku jako hodnoty okolí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-689">`IUrlHelper` always provides the route values from the current request as ambient values.</span></span>
* <span data-ttu-id="ba1ea-690">[IUrlHelper.Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) vždy zkopíruje aktuální `action` a `controller` směrování hodnoty jako explicitní hodnoty, pokud přepsána vývojářem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-690">[IUrlHelper.Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) always copies the current `action` and `controller` route values as explicit values unless overridden by the developer.</span></span>
* <span data-ttu-id="ba1ea-691">[IUrlHelper.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) vždy zkopíruje aktuální `page` hodnotu trasy jako explicitní hodnotu, pokud není přepsána.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-691">[IUrlHelper.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) always copies the current `page` route value as an explicit value unless overridden.</span></span> <!--by the user-->
* <span data-ttu-id="ba1ea-692">`IUrlHelper.Page`vždy přepíše `handler` aktuální hodnotu trasy `null` jako explicitní hodnoty, pokud není přepsána.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-692">`IUrlHelper.Page` always overrides the current `handler` route value with `null` as an explicit values unless overridden.</span></span>

<span data-ttu-id="ba1ea-693">Uživatelé jsou často překvapeni podrobnostmi chování okolních hodnot, protože MVC nezdá se, že dodržovat vlastní pravidla.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-693">Users are often surprised by the behavioral details of ambient values, because MVC doesn't seem to follow its own rules.</span></span> <span data-ttu-id="ba1ea-694">Z historických důvodů a z `action`důvodů `controller` `page`kompatibility `handler` mají určité hodnoty trasy, například , , , a mají své vlastní chování zvláštních případů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-694">For historical and compatibility reasons, certain route values such as `action`, `controller`, `page`, and `handler` have their own special-case behavior.</span></span>

<span data-ttu-id="ba1ea-695">Ekvivalentní funkce poskytované `LinkGenerator.GetPathByAction` a `LinkGenerator.GetPathByPage` duplikuje `IUrlHelper` tyto anomálie pro kompatibilitu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-695">The equivalent functionality provided by `LinkGenerator.GetPathByAction` and `LinkGenerator.GetPathByPage` duplicates these anomalies of `IUrlHelper` for compatibility.</span></span>

### <a name="url-generation-process"></a><span data-ttu-id="ba1ea-696">Proces generování adres URL</span><span class="sxs-lookup"><span data-stu-id="ba1ea-696">URL generation process</span></span>

<span data-ttu-id="ba1ea-697">Jakmile je nalezena sada koncových bodů kandidáta, algoritmus generování adresy URL:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-697">Once the set of candidate endpoints are found, the URL generation algorithm:</span></span>

* <span data-ttu-id="ba1ea-698">Zpracovává koncové body iterativně.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-698">Processes the endpoints iteratively.</span></span>
* <span data-ttu-id="ba1ea-699">Vrátí první úspěšný výsledek.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-699">Returns the first successful result.</span></span>

<span data-ttu-id="ba1ea-700">První krok v tomto procesu se nazývá **zneplatnění hodnoty postupu**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-700">The first step in this process is called **route value invalidation**.</span></span>  <span data-ttu-id="ba1ea-701">Zneplatnění hodnoty postupu je proces, při kterém směrování rozhoduje o tom, které hodnoty postupu z okolních hodnot by měly být použity a které by měly být ignorovány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-701">Route value invalidation is the process by which routing decides which route values from the ambient values should be used and which should be ignored.</span></span> <span data-ttu-id="ba1ea-702">Každá hodnota okolí je považována za a buď v kombinaci s explicitní hodnoty nebo ignorovány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-702">Each ambient value is considered and either combined with the explicit values, or ignored.</span></span>

<span data-ttu-id="ba1ea-703">Nejlepší způsob, jak přemýšlet o roli okolních hodnot je, že se pokoušejí uložit vývojáři aplikací psaní, v některých běžných případech.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-703">The best way to think about the role of ambient values is that they attempt to save application developers typing, in some common cases.</span></span> <span data-ttu-id="ba1ea-704">Scénáře, kde jsou užitečné hodnoty okolí, se tradičně vztahují k MVC:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-704">Traditionally, the scenarios where ambient values are helpful are related to MVC:</span></span>

* <span data-ttu-id="ba1ea-705">Při propojení s jinou akcí ve stejném řadiči není nutné zadat název řadiče.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-705">When linking to another action in the same controller, the controller name doesn't need to be specified.</span></span>
* <span data-ttu-id="ba1ea-706">Při propojení s jiným řadičem ve stejné oblasti není nutné zadat název oblasti.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-706">When linking to another controller in the same area, the area name doesn't need to be specified.</span></span>
* <span data-ttu-id="ba1ea-707">Při propojení se stejnou metodou akce není nutné zadanit hodnoty trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-707">When linking to the same action method, route values don't need to be specified.</span></span>
* <span data-ttu-id="ba1ea-708">Při propojení s jinou částí aplikace nechcete přenášet hodnoty trasy, které nemají v této části aplikace žádný význam.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-708">When linking to another part of the app, you don't want to carry over route values that have no meaning in that part of the app.</span></span>

<span data-ttu-id="ba1ea-709">Volání `LinkGenerator` nebo `IUrlHelper` že `null` návrat jsou obvykle způsobeny nepochopení hodnoty trasy zneplatnění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-709">Calls to `LinkGenerator` or `IUrlHelper` that return `null` are usually caused by not understanding route value invalidation.</span></span> <span data-ttu-id="ba1ea-710">Poradce při potížích s neplatností hodnoty postupu explicitním zadáním více hodnot trasy, abyste zjistili, zda se tím problém vyřešil.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-710">Troubleshoot route value invalidation by explicitly specifying more of the route values to see if that solves the problem.</span></span>

<span data-ttu-id="ba1ea-711">Zplatnění hodnoty postupu funguje za předpokladu, že schéma adresy URL aplikace je hierarchické, s hierarchií vytvořenou zleva doprava.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-711">Route value invalidation works on the assumption that the app's URL scheme is hierarchical, with a hierarchy formed from left-to-right.</span></span> <span data-ttu-id="ba1ea-712">Zvažte základní šablonu `{controller}/{action}/{id?}` trasy řadiče, abyste získali intuitivní představu o tom, jak to funguje v praxi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-712">Consider the basic controller route template `{controller}/{action}/{id?}` to get an intuitive sense of how this works in practice.</span></span> <span data-ttu-id="ba1ea-713">**Změna** hodnoty **zruší platnost** všech hodnot trasy, které se zobrazí vpravo.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-713">A **change** to a value **invalidates** all of the route values that appear to the right.</span></span> <span data-ttu-id="ba1ea-714">To odráží předpoklad o hierarchii.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-714">This reflects the assumption about hierarchy.</span></span> <span data-ttu-id="ba1ea-715">Pokud má aplikace hodnotu `id`okolí pro aplikaci a operace `controller`určuje jinou hodnotu pro :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-715">If the app has an ambient value for `id`, and the operation specifies a different value for the `controller`:</span></span>

* <span data-ttu-id="ba1ea-716">`id`nebude znovu použit, `{controller}` protože je nalevo od `{id?}`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-716">`id` won't be reused because `{controller}` is to the left of `{id?}`.</span></span>

<span data-ttu-id="ba1ea-717">Některé příklady prokazující tuto zásadu:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-717">Some examples demonstrating this principle:</span></span>

* <span data-ttu-id="ba1ea-718">Pokud explicitní hodnoty obsahují `id`hodnotu pro `id` , je hodnota okolí pro ignorována.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-718">If the explicit values contain a value for `id`, the ambient value for `id` is ignored.</span></span> <span data-ttu-id="ba1ea-719">Hodnoty okolí `controller` pro `action` a lze použít.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-719">The ambient values for `controller` and `action` can be used.</span></span>
* <span data-ttu-id="ba1ea-720">Pokud explicitní hodnoty obsahují `action`hodnotu pro `action` , všechny okolní hodnoty pro je ignorována.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-720">If the explicit values contain a value for `action`, any ambient value for `action` is ignored.</span></span> <span data-ttu-id="ba1ea-721">Lze použít `controller` hodnoty okolí pro.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-721">The ambient values for `controller` can be used.</span></span> <span data-ttu-id="ba1ea-722">Pokud se explicitní `action` hodnota pro liší `action`od `id` hodnoty okolí pro , nebude hodnota použita.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-722">If the explicit value for `action` is different from the ambient value for `action`, the `id` value won't be used.</span></span>  <span data-ttu-id="ba1ea-723">Pokud je explicitní `action` hodnota pro je stejná jako hodnota okolí pro `action`, lze použít hodnotu. `id`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-723">If the explicit value for `action` is the same as the ambient value for `action`, the `id` value can be used.</span></span>
* <span data-ttu-id="ba1ea-724">Pokud explicitní hodnoty obsahují `controller`hodnotu pro `controller` , všechny okolní hodnoty pro je ignorována.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-724">If the explicit values contain a value for `controller`, any ambient value for `controller` is ignored.</span></span> <span data-ttu-id="ba1ea-725">Pokud explicitní hodnota `controller` pro se liší `controller`od `action` hodnoty `id` okolí pro , a hodnoty nebudou použity.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-725">If the explicit value for `controller` is different from the ambient value for `controller`, the `action` and `id` values won't be used.</span></span> <span data-ttu-id="ba1ea-726">Pokud je explicitní `controller` hodnota pro je stejná `action` jako `id` hodnota okolí pro `controller`, hodnoty a lze použít.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-726">If the explicit value for `controller` is the same as the ambient value for `controller`, the `action` and `id` values can be used.</span></span>

<span data-ttu-id="ba1ea-727">Tento proces je dále komplikován existencí tras atributů a vyhrazených konvenčních tras.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-727">This process is further complicated by the existence of attribute routes and dedicated conventional routes.</span></span> <span data-ttu-id="ba1ea-728">Kontroler konvenční trasy, jako je například `{controller}/{action}/{id?}` určit hierarchii pomocí parametrů trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-728">Controller conventional routes such as `{controller}/{action}/{id?}` specify a hierarchy using route parameters.</span></span> <span data-ttu-id="ba1ea-729">Pro [vyhrazené konvenční trasy](xref:mvc/controllers/routing#dcr) a trasy [atributů](xref:mvc/controllers/routing#ar) regulátorům a žiletkovým stránkám:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-729">For [dedicated conventional routes](xref:mvc/controllers/routing#dcr) and [attribute routes](xref:mvc/controllers/routing#ar) to controllers and Razor Pages:</span></span>

* <span data-ttu-id="ba1ea-730">Existuje hierarchie hodnot trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-730">There is a hierarchy of route values.</span></span>
* <span data-ttu-id="ba1ea-731">Nezobrazují se v šabloně.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-731">They don't appear in the template.</span></span>

<span data-ttu-id="ba1ea-732">Pro tyto případy definuje generování adresy URL koncept **požadovaných hodnot.**</span><span class="sxs-lookup"><span data-stu-id="ba1ea-732">For these cases, URL generation defines the **required values** concept.</span></span> <span data-ttu-id="ba1ea-733">Koncové body vytvořené řadiči a razor pages mají zadané požadované hodnoty, které umožňují zneplatnění hodnoty trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-733">Endpoints created by controllers and Razor Pages have required values specified that allow route value invalidation to work.</span></span>

<span data-ttu-id="ba1ea-734">Algoritmus zneplatnění hodnoty trasy podrobně:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-734">The route value invalidation algorithm in detail:</span></span>

* <span data-ttu-id="ba1ea-735">Požadované názvy hodnot jsou kombinovány s parametry trasy a poté zpracovány zleva doprava.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-735">The required value names are combined with the route parameters, then processed from left-to-right.</span></span>
* <span data-ttu-id="ba1ea-736">Pro každý parametr se porovná hodnota okolí a explicitní hodnota:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-736">For each parameter, the ambient value and explicit value are compared:</span></span>
    * <span data-ttu-id="ba1ea-737">Pokud okolní hodnota a explicitní hodnota jsou stejné, proces pokračuje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-737">If the ambient value and explicit value are the same, the process continues.</span></span>
    * <span data-ttu-id="ba1ea-738">Pokud je k dispozici hodnota okolí a explicitní hodnota není, hodnota okolí se používá při generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-738">If the ambient value is present and the explicit value isn't, the ambient value is used when generating the URL.</span></span>
    * <span data-ttu-id="ba1ea-739">Pokud hodnota okolí není k dispozici a explicitní hodnota je, odmítnout hodnotu okolí a všechny následné hodnoty okolí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-739">If the ambient value isn't present and the explicit value is, reject the ambient value and all subsequent ambient values.</span></span>
    * <span data-ttu-id="ba1ea-740">Pokud jsou přítomny hodnota okolí a explicitní hodnota a dvě hodnoty se liší, odmítnout hodnotu okolí a všechny následné hodnoty okolí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-740">If the ambient value and the explicit value are present, and the two values are different, reject the ambient value and all subsequent ambient values.</span></span>

<span data-ttu-id="ba1ea-741">V tomto okamžiku operace generování adresy URL je připravena k vyhodnocení omezení trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-741">At this point, the URL generation operation is ready to evaluate route constraints.</span></span> <span data-ttu-id="ba1ea-742">Sada přijatých hodnot je kombinována s výchozími hodnotami parametrů, které jsou k dispozici omezením.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-742">The set of accepted values is combined with the parameter default values, which is provided to constraints.</span></span> <span data-ttu-id="ba1ea-743">Pokud všechna omezení přecházejí, operace pokračuje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-743">If the constraints all pass, the operation continues.</span></span>

<span data-ttu-id="ba1ea-744">Dále **lze přijaté hodnoty** použít k rozbalení šablony trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-744">Next, the **accepted values** can be used to expand the route template.</span></span> <span data-ttu-id="ba1ea-745">Šablona trasy je zpracována:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-745">The route template is processed:</span></span>

* <span data-ttu-id="ba1ea-746">Zleva doprava.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-746">From left-to-right.</span></span>
* <span data-ttu-id="ba1ea-747">Každý parametr má svou přijatou hodnotu nahrazenou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-747">Each parameter has its accepted value substituted.</span></span>
* <span data-ttu-id="ba1ea-748">S následujícími zvláštními případy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-748">With the following special cases:</span></span>
  * <span data-ttu-id="ba1ea-749">Pokud přijaté hodnoty chybí hodnota a parametr má výchozí hodnotu, použije se výchozí hodnota.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-749">If the accepted values is missing a value and the parameter has a default value, the default value is used.</span></span>
  * <span data-ttu-id="ba1ea-750">Pokud přijaté hodnoty chybí hodnotu a parametr je volitelný, zpracování pokračuje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-750">If the accepted values is missing a value and the parameter is optional, processing continues.</span></span>
  * <span data-ttu-id="ba1ea-751">Pokud má libovolný parametr trasy vpravo od chybějícího volitelného parametru hodnotu, operace se nezdaří.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-751">If any route parameter to the right of a missing optional parameter has a value, the operation fails.</span></span>
  * <!-- review default-valued parameters optional parameters --> <span data-ttu-id="ba1ea-752">Souvislé parametry s výchozí hodnotou a volitelné parametry jsou pokud možno sbaleny.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-752">Contiguous default-valued parameters and optional parameters are collapsed where possible.</span></span>

<span data-ttu-id="ba1ea-753">Do řetězce dotazu jsou přidány explicitně poskytnuté hodnoty, které neodpovídají segmentu trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-753">Values explicitly provided that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="ba1ea-754">V následující tabulce je uveden výsledek `{controller}/{action}/{id?}`při použití šablony trasy .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-754">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="ba1ea-755">Okolní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-755">Ambient Values</span></span>                     | <span data-ttu-id="ba1ea-756">Explicitní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-756">Explicit Values</span></span>                        | <span data-ttu-id="ba1ea-757">Výsledek</span><span class="sxs-lookup"><span data-stu-id="ba1ea-757">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="ba1ea-758">regulátor = "Domů"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-758">controller = "Home"</span></span>                | <span data-ttu-id="ba1ea-759">akce = "O"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-759">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ba1ea-760">regulátor = "Domů"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-760">controller = "Home"</span></span>                | <span data-ttu-id="ba1ea-761">controller = "Objednávka", akce = "O"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-761">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="ba1ea-762">regulátor = "Domů", barva = "Červená"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-762">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="ba1ea-763">akce = "O"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-763">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ba1ea-764">regulátor = "Domů"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-764">controller = "Home"</span></span>                | <span data-ttu-id="ba1ea-765">akce = "O", barva = "Červená"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-765">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

### <a name="problems-with-route-value-invalidation"></a><span data-ttu-id="ba1ea-766">Problémy s neplatností hodnoty trasy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-766">Problems with route value invalidation</span></span>

<span data-ttu-id="ba1ea-767">Od ASP.NET Core 3.0, některá schémata generování adres URL používaná v dřívějších verzích ASP.NET Core nefungují dobře s generováním adres URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-767">As of ASP.NET Core 3.0, some URL generation schemes used in earlier ASP.NET Core versions don't work well with URL generation.</span></span> <span data-ttu-id="ba1ea-768">Tým ASP.NET Core plánuje přidat funkce pro řešení těchto potřeb v budoucí verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-768">The ASP.NET Core team plans to add features to address these needs in a future release.</span></span> <span data-ttu-id="ba1ea-769">Pro tuto chvíli je nejlepším řešením použít starší směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-769">For now the best solution is to use legacy routing.</span></span>

<span data-ttu-id="ba1ea-770">Následující kód ukazuje příklad schématu generování adres URL, které není podporováno směrováním.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-770">The following code shows an example of a URL generation scheme that's not supported by routing.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupUnsupported.cs?name=snippet)]

<span data-ttu-id="ba1ea-771">V předchozím kódu se `culture` parametr trasy používá pro lokalizaci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-771">In the preceding code, the `culture` route parameter is used for localization.</span></span> <span data-ttu-id="ba1ea-772">Touha je mít `culture` parametr vždy přijat jako okolní hodnota.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-772">The desire is to have the `culture` parameter always accepted as an ambient value.</span></span> <span data-ttu-id="ba1ea-773">`culture` Parametr však není přijat jako hodnota okolí z důvodu způsobu, jakým požadované hodnoty fungují:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-773">However, the `culture` parameter is not accepted as an ambient value because of the way required values work:</span></span>

* <span data-ttu-id="ba1ea-774">V `"default"` šabloně trasy `culture` je parametr trasy `controller`nalevo `controller` od , takže `culture`se změní na nezruší platnost .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-774">In the `"default"` route template, the `culture` route parameter is to the left of `controller`, so changes to `controller` won't invalidate `culture`.</span></span>
* <span data-ttu-id="ba1ea-775">V `"blog"` šabloně trasy `culture` je parametr trasy považován za `controller`pravý od , který se zobrazí v požadovaných hodnotách.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-775">In the `"blog"` route template, the `culture` route parameter is considered to be to the right of `controller`, which appears in the required values.</span></span>

## <a name="configuring-endpoint-metadata"></a><span data-ttu-id="ba1ea-776">Konfigurace metadat koncového bodu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-776">Configuring endpoint metadata</span></span>

<span data-ttu-id="ba1ea-777">Následující odkazy poskytují informace o konfiguraci metadat koncového bodu:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-777">The following links provide information on configuring endpoint metadata:</span></span>

* [<span data-ttu-id="ba1ea-778">Povolení corsu s směrováním koncových bodů</span><span class="sxs-lookup"><span data-stu-id="ba1ea-778">Enable Cors with endpoint routing</span></span>](xref:security/cors#enable-cors-with-endpoint-routing)
* <span data-ttu-id="ba1ea-779">[Ukázka iAuthorizationPolicyProvider](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) `[MinimumAgeAuthorize]` pomocí vlastního atributu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-779">[IAuthorizationPolicyProvider sample](https://github.com/dotnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) using a custom `[MinimumAgeAuthorize]` attribute</span></span>
* <span data-ttu-id="ba1ea-780">[Testování ověřování pomocí atributu [Authorize]](xref:security/authentication/identity#test-identity)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-780">[Test authentication with the [Authorize] attribute](xref:security/authentication/identity#test-identity)</span></span>
* <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*>
* <span data-ttu-id="ba1ea-781">[Výběr schématu s atributem [Authorize]](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-781">[Selecting the scheme with the [Authorize] attribute](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span></span>
* <span data-ttu-id="ba1ea-782">[Použití zásad pomocí atributu [Authorize]](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-782">[Applying policies using the [Authorize] attribute](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span></span>
* <xref:security/authorization/roles>

<a name="hostmatch"></a>

## <a name="host-matching-in-routes-with-requirehost"></a><span data-ttu-id="ba1ea-783">Porovnávání hostitelů v trasách s RequireHost</span><span class="sxs-lookup"><span data-stu-id="ba1ea-783">Host matching in routes with RequireHost</span></span>

<span data-ttu-id="ba1ea-784"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*>použije omezení na trasu, která vyžaduje zadaného hostitele.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-784"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> applies a constraint to the route which requires the specified host.</span></span> <span data-ttu-id="ba1ea-785">Parametr `RequireHost` [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) může být:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-785">The `RequireHost` or [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) parameter can be:</span></span>

* <span data-ttu-id="ba1ea-786">Hostitel: `www.domain.com`, `www.domain.com` odpovídá libovolnému portu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-786">Host: `www.domain.com`, matches `www.domain.com` with any port.</span></span>
* <span data-ttu-id="ba1ea-787">Hostitel se `*.domain.com`zástupnými `www.domain.com`znaky: , zápasy , `subdomain.domain.com`nebo `www.subdomain.domain.com` na libovolném portu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-787">Host with wildcard: `*.domain.com`, matches `www.domain.com`, `subdomain.domain.com`, or `www.subdomain.domain.com` on any port.</span></span>
* <span data-ttu-id="ba1ea-788">Port: `*:5000`, odpovídá portu 5000 libovolnému hostiteli.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-788">Port: `*:5000`, matches port 5000 with any host.</span></span>
* <span data-ttu-id="ba1ea-789">Hostitel a `www.domain.com:5000` port: nebo `*.domain.com:5000`, odpovídá hostiteli a portu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-789">Host and port: `www.domain.com:5000` or `*.domain.com:5000`, matches host and port.</span></span>

<span data-ttu-id="ba1ea-790">Více parametrů lze zadat `RequireHost` `[Host]`pomocí nebo .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-790">Multiple parameters can be specified using `RequireHost` or `[Host]`.</span></span> <span data-ttu-id="ba1ea-791">Omezení odpovídá hostitelům platným pro libovolný parametr.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-791">The constraint  matches hosts valid for any of the parameters.</span></span> <span data-ttu-id="ba1ea-792">Například `[Host("domain.com", "*.domain.com")]` `domain.com`shody `www.domain.com`, `subdomain.domain.com`a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-792">For example, `[Host("domain.com", "*.domain.com")]` matches `domain.com`, `www.domain.com`, and `subdomain.domain.com`.</span></span>

<span data-ttu-id="ba1ea-793">Následující kód `RequireHost` používá vyžadovat zadaného hostitele na trase:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-793">The following code uses `RequireHost` to require the specified host on the route:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRequireHost.cs?name=snippet)]

<span data-ttu-id="ba1ea-794">Následující kód používá `[Host]` atribut na řadiči vyžadovat některý ze zadaných hostitelů:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-794">The following code uses the `[Host]` attribute on the controller to require any of the specified hosts:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/ProductController.cs?name=snippet)]

<span data-ttu-id="ba1ea-795">Pokud `[Host]` je atribut použit na řadič i metodu akce:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-795">When the `[Host]` attribute is applied to both the controller and action method:</span></span>

* <span data-ttu-id="ba1ea-796">Atribut akce se používá.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-796">The attribute on the action is used.</span></span>
* <span data-ttu-id="ba1ea-797">Atribut řadiče je ignorován.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-797">The controller attribute is ignored.</span></span>

## <a name="performance-guidance-for-routing"></a><span data-ttu-id="ba1ea-798">Pokyny pro výkon pro směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-798">Performance guidance for routing</span></span>

<span data-ttu-id="ba1ea-799">Většina směrování byla aktualizována v ASP.NET Core 3.0 pro zvýšení výkonu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-799">Most of routing was updated in ASP.NET Core 3.0 to increase performance.</span></span>

<span data-ttu-id="ba1ea-800">Pokud má aplikace problémy s výkonem, je jako problém často podezření na směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-800">When an app has performance problems, routing is often suspected as the problem.</span></span> <span data-ttu-id="ba1ea-801">Důvod, proč je podezření na směrování je, že rozhraní jako řadiče a Razor Pages sestavy množství času stráveného uvnitř rozhraní v jejich protokolování zpráv.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-801">The reason routing is suspected is that frameworks like controllers and Razor Pages report the amount of time spent inside the framework in their logging messages.</span></span> <span data-ttu-id="ba1ea-802">Pokud existuje významný rozdíl mezi časem hlášeným řadiči a celkovým časem požadavku:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-802">When there's a significant difference between the time reported by controllers and the total time of the request:</span></span>

* <span data-ttu-id="ba1ea-803">Vývojáři eliminují kód aplikace jako zdroj problému.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-803">Developers eliminate their app code as the source of the problem.</span></span>
* <span data-ttu-id="ba1ea-804">Je běžné předpokládat, že směrování je příčinou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-804">It's common to assume routing is the cause.</span></span>

<span data-ttu-id="ba1ea-805">Směrování je testován o výkonu pomocí tisíců koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-805">Routing is performance tested using thousands of endpoints.</span></span> <span data-ttu-id="ba1ea-806">Je nepravděpodobné, že typická aplikace narazí na problém s výkonem právě tím, že je příliš velká.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-806">It's unlikely that a typical app will encounter a performance problem just by being too large.</span></span> <span data-ttu-id="ba1ea-807">Nejběžnější hlavní příčinou pomalého výkonu směrování je obvykle špatně se chovající vlastní middleware.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-807">The most common root cause of slow routing performance is usually a badly-behaving custom middleware.</span></span>

<span data-ttu-id="ba1ea-808">Tato následující ukázka kódu ukazuje základní techniku pro zúžení zdroje zpoždění:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-808">This following code sample demonstrates a basic technique for narrowing down the source of delay:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupDelay.cs?name=snippet)]

<span data-ttu-id="ba1ea-809">Na časové směrování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-809">To time routing:</span></span>

* <span data-ttu-id="ba1ea-810">Propojit každý middleware s kopií časování middleware je uvedeno v předchozím kódu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-810">Interleave each middleware with a copy of the timing middleware shown in the preceding code.</span></span>
* <span data-ttu-id="ba1ea-811">Přidejte jedinečný identifikátor, který koreluje data časování s kódem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-811">Add a unique identifier to correlate the timing data with the code.</span></span>

<span data-ttu-id="ba1ea-812">Jedná se o základní způsob, jak zúžit zpoždění, když `10ms`je to významné, například více než .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-812">This is a basic way to narrow down the delay when it's significant, for example, more than `10ms`.</span></span>  <span data-ttu-id="ba1ea-813">Odečtením `Time 2` `Time 1` času stráveného uvnitř `UseRouting` middlewaru od zpráv.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-813">Subtracting `Time 2` from `Time 1` reports the time spent inside the `UseRouting` middleware.</span></span>

<span data-ttu-id="ba1ea-814">Následující kód používá kompaktnější přístup k předchozímu kódu časování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-814">The following code uses a more compact approach to the preceding timing code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippetSW)]

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippet)]

### <a name="potentially-expensive-routing-features"></a><span data-ttu-id="ba1ea-815">Potenciálně nákladné funkce směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-815">Potentially expensive routing features</span></span>

<span data-ttu-id="ba1ea-816">Následující seznam obsahuje určitý přehled o funkcích směrování, které jsou poměrně nákladné ve srovnání se základními šablonami tras:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-816">The following list provides some insight into routing features that are relatively expensive compared with basic route templates:</span></span>

* <span data-ttu-id="ba1ea-817">Regulární výrazy: Je možné psát regulární výrazy, které jsou složité nebo mají dlouhou provozní dobu s malým množstvím vstupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-817">Regular expressions: It's possible to write regular expressions that are complex, or have long running time with a small amount of input.</span></span>

* <span data-ttu-id="ba1ea-818">Komplexní segmenty`{x}-{y}-{z}`( ):</span><span class="sxs-lookup"><span data-stu-id="ba1ea-818">Complex segments (`{x}-{y}-{z}`):</span></span> 
  * <span data-ttu-id="ba1ea-819">Jsou výrazně dražší než analýza pravidelného segmentu cesty URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-819">Are significantly more expensive than parsing a regular URL path segment.</span></span>
  * <span data-ttu-id="ba1ea-820">Výsledkem je přidělení mnoha dalších podřetězců.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-820">Result in many more substrings being allocated.</span></span>
  * <span data-ttu-id="ba1ea-821">Logika složitého segmentu nebyla aktualizována v ASP.NET aktualizaci výkonu směrování Jádra 3.0.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-821">The complex segment logic was not updated in ASP.NET Core 3.0 routing performance update.</span></span>

* <span data-ttu-id="ba1ea-822">Synchronní přístup k datům: Mnoho složitých aplikací má přístup k databázi jako součást jejich směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-822">Synchronous data access: Many complex apps have database access as part of their routing.</span></span> <span data-ttu-id="ba1ea-823">ASP.NET core 2.2 a starší směrování nemusí poskytovat správné body rozšiřitelnosti pro podporu směrování přístupu k databázi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-823">ASP.NET Core 2.2 and earlier routing might not provide the right extensibility points to support database access routing.</span></span> <span data-ttu-id="ba1ea-824">Například <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> a jsou synchronní.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-824">For example, <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, and <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> are synchronous.</span></span> <span data-ttu-id="ba1ea-825">Rozšiřitelnost body, <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> jako <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> jsou a asynchronní.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-825">Extensibility points such as <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> and <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> are asynchronous.</span></span>

## <a name="guidance-for-library-authors"></a><span data-ttu-id="ba1ea-826">Pokyny pro autory knihovny</span><span class="sxs-lookup"><span data-stu-id="ba1ea-826">Guidance for library authors</span></span>

<span data-ttu-id="ba1ea-827">Tato část obsahuje pokyny pro autory knihovny, kteří jsou na základě směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-827">This section contains guidance for library authors building on top of routing.</span></span> <span data-ttu-id="ba1ea-828">Tyto podrobnosti jsou určeny k zajištění, že vývojáři aplikací mají dobré zkušenosti s používáním knihoven a architektur, které rozšiřují směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-828">These details are intended to ensure that app developers have a good experience using libraries and frameworks that extend routing.</span></span>

### <a name="define-endpoints"></a><span data-ttu-id="ba1ea-829">Definování koncových bodů</span><span class="sxs-lookup"><span data-stu-id="ba1ea-829">Define endpoints</span></span>

<span data-ttu-id="ba1ea-830">Chcete-li vytvořit rámec, který používá směrování pro porovnávání adres URL, <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>začněte definováním uživatelského prostředí, které vychází nad .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-830">To create a framework that uses routing for URL matching, start by defining a user experience that builds on top of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>

<span data-ttu-id="ba1ea-831">**DO** stavět na <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>vrcholu .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-831">**DO** build on top of <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span> <span data-ttu-id="ba1ea-832">To umožňuje uživatelům vytvořit rámec s jinými funkcemi ASP.NET Core bez záměny.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-832">This allows users to compose your framework with other ASP.NET Core features without confusion.</span></span> <span data-ttu-id="ba1ea-833">Každá šablona ASP.NET Core obsahuje směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-833">Every ASP.NET Core template includes routing.</span></span> <span data-ttu-id="ba1ea-834">Předpokládejme, že směrování je k dispozici a známé pro uživatele.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-834">Assume routing is present and familiar for users.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="ba1ea-835">**DO** vrátit zapečetěný typ betonu <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>z volání, které implementuje `MapMyFramework(...)` .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-835">**DO** return a sealed concrete type from a call to `MapMyFramework(...)` that implements <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>.</span></span> <span data-ttu-id="ba1ea-836">Většina `Map...` metod rozhraní se řídí tímto vzorem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-836">Most framework `Map...` methods follow this pattern.</span></span> <span data-ttu-id="ba1ea-837">Rozhraní: `IEndpointConventionBuilder`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-837">The `IEndpointConventionBuilder` interface:</span></span>

* <span data-ttu-id="ba1ea-838">Umožňuje komosability metadat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-838">Allows composability of metadata.</span></span>
* <span data-ttu-id="ba1ea-839">Je zaměřena na různé metody rozšíření.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-839">Is targeted by a variety of extension methods.</span></span>

<span data-ttu-id="ba1ea-840">Deklarování vlastní typ umožňuje přidat vlastní funkce specifické pro architekturu tvůrce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-840">Declaring your own type allows you to add your own framework-specific functionality to the builder.</span></span> <span data-ttu-id="ba1ea-841">Je v pořádku zabalit tvůrce deklarované ho rámcem a předávat mu hovory.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-841">It's ok to wrap a framework-declared builder and forward calls to it.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequrireAuthorization()
                                 .WithMyFrameworkFeature(awesome: true);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="ba1ea-842">**Zvažte** psaní <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>vlastní .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-842">**CONSIDER** writing your own <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>.</span></span> <span data-ttu-id="ba1ea-843">`EndpointDataSource`je primitivní základní úroveň nižší úrovně pro deklarování a aktualizaci kolekce koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-843">`EndpointDataSource` is the low-level primitive for declaring and updating a collection of endpoints.</span></span> <span data-ttu-id="ba1ea-844">`EndpointDataSource`je výkonné rozhraní API používané řadiči a Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-844">`EndpointDataSource` is a powerful API used by controllers and Razor Pages.</span></span>

<span data-ttu-id="ba1ea-845">Testy směrování mají [základní příklad](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) neaktualaktua zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-845">The routing tests have a [basic example](https://github.com/aspnet/AspNetCore/blob/master/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) of a non-updating data source.</span></span>

<span data-ttu-id="ba1ea-846">**NEPOKOUŠEJTE** se `EndpointDataSource` zaregistrovat ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-846">**DO NOT** attempt to register an `EndpointDataSource` by default.</span></span> <span data-ttu-id="ba1ea-847">Vyžadovat, aby uživatelé <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>registrovali váš rámec v aplikaci .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-847">Require users to register your framework in <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span> <span data-ttu-id="ba1ea-848">Filozofie směrování je, že nic není zahrnuta ve výchozím nastavení, a to `UseEndpoints` je místo pro registraci koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-848">The philosophy of routing is that nothing is included by default, and that `UseEndpoints` is the place to register endpoints.</span></span>

### <a name="creating-routing-integrated-middleware"></a><span data-ttu-id="ba1ea-849">Vytváření middlewaru integrovaného s směrováním</span><span class="sxs-lookup"><span data-stu-id="ba1ea-849">Creating routing-integrated middleware</span></span>

<span data-ttu-id="ba1ea-850">**Zvažte** definování typů metadat jako rozhraní.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-850">**CONSIDER** defining metadata types as an interface.</span></span>

<span data-ttu-id="ba1ea-851">**DO** umožňují používat typy metadat jako atribut na třídy a metody.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-851">**DO** make it possible to use metadata types as an attribute on classes and methods.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet2)]

<span data-ttu-id="ba1ea-852">Architektury, jako jsou řadiče a Razor Pages podporují použití atributy metadat typy a metody.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-852">Frameworks like controllers and Razor Pages support applying metadata attributes to types and methods.</span></span> <span data-ttu-id="ba1ea-853">Pokud deklarujete typy metadat:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-853">If you declare metadata types:</span></span>

* <span data-ttu-id="ba1ea-854">Zpřístupněte je jako [atributy](/dotnet/csharp/programming-guide/concepts/attributes/).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-854">Make them accessible as [attributes](/dotnet/csharp/programming-guide/concepts/attributes/).</span></span>
* <span data-ttu-id="ba1ea-855">Většina uživatelů je obeznámena s použitím atributů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-855">Most users are familiar with applying attributes.</span></span>

<span data-ttu-id="ba1ea-856">Deklarování typu metadat jako rozhraní přidává další vrstvu flexibility:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-856">Declaring a metadata type as an interface adds another layer of flexibility:</span></span>

* <span data-ttu-id="ba1ea-857">Rozhraní lze skládat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-857">Interfaces are composable.</span></span>
* <span data-ttu-id="ba1ea-858">Vývojáři mohou deklarovat své vlastní typy, které kombinují více zásad.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-858">Developers can declare their own types that combine multiple policies.</span></span>

<span data-ttu-id="ba1ea-859">**Do** umožňují přepsat metadata, jak je znázorněno v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-859">**DO** make it possible to override metadata, as shown in the following example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet)]

<span data-ttu-id="ba1ea-860">Nejlepší způsob, jak postupovat podle těchto pokynů, je vyhnout se definování **metadat značek**:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-860">The best way to follow these guidelines is to avoid defining **marker metadata**:</span></span>

* <span data-ttu-id="ba1ea-861">Nehledejte pouze přítomnost typu metadat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-861">Don't just look for the presence of a metadata type.</span></span>
* <span data-ttu-id="ba1ea-862">Definujte vlastnost metadat a zkontrolujte vlastnost.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-862">Define a property on the metadata and check the property.</span></span>

<span data-ttu-id="ba1ea-863">Kolekce metadat je seřazena a podporuje přepsání podle priority.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-863">The metadata collection is ordered and supports overriding by priority.</span></span> <span data-ttu-id="ba1ea-864">V případě řadičů metadata na metodu akce je nejkonkrétnější.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-864">In the case of controllers, metadata on the action method is most specific.</span></span>

<span data-ttu-id="ba1ea-865">**DO,** aby middleware užitečné s a bez směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-865">**DO** make middleware useful with and without routing.</span></span>

```csharp
app.UseRouting();

app.UseAuthorization(new AuthorizationPolicy() { ... });

app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequrireAuthorization();
});
```

<span data-ttu-id="ba1ea-866">Jako příklad tohoto pokynu `UseAuthorization` zvažte middleware.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-866">As an example of this guideline, consider the `UseAuthorization` middleware.</span></span> <span data-ttu-id="ba1ea-867">Autorizace middleware umožňuje předat záložní politiky.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-867">The authorization middleware allows you to pass in a fallback policy.</span></span> <!-- shown where?  (shown here) --> <span data-ttu-id="ba1ea-868">Záložní zásady, pokud jsou zadány, platí pro oba:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-868">The fallback policy, if specified, applies to both:</span></span>

* <span data-ttu-id="ba1ea-869">Koncové body bez zadané zásady.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-869">Endpoints without a specified policy.</span></span>
* <span data-ttu-id="ba1ea-870">Požadavky, které neodpovídají koncovému bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-870">Requests that don't match an endpoint.</span></span>

<span data-ttu-id="ba1ea-871">Díky autorizaci middleware užitečné mimo kontext směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-871">This makes the authorization middleware useful outside of the context of routing.</span></span> <span data-ttu-id="ba1ea-872">Autorizace middleware může být použit pro tradiční middleware programování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-872">The authorization middleware can be used for traditional middleware programming.</span></span>

[!INCLUDE[](~/includes/dbg-route.md)]

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="ba1ea-873">Směrování je zodpovědný za mapování požadavků NA ADRESY URI na koncové body a odesílání příchozích požadavků na tyto koncové body.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-873">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="ba1ea-874">Trasy jsou definovány v aplikaci a nakonfigurovány při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-874">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="ba1ea-875">Trasa může volitelně extrahovat hodnoty z adresy URL obsažené v požadavku a tyto hodnoty lze pak použít pro zpracování požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-875">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="ba1ea-876">Pomocí informací o trase z aplikace, směrování je také schopen generovat adresy URL, které mapují na koncové body.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-876">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="ba1ea-877">Chcete-li použít nejnovější scénáře směrování v ASP.NET jádrem 2.2, zadejte [verzi kompatibility](xref:mvc/compatibility-version) s registrací služeb MVC v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-877">To use the latest routing scenarios in ASP.NET Core 2.2, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="ba1ea-878">Tato <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> možnost určuje, zda směrování by měl interně <xref:Microsoft.AspNetCore.Routing.IRouter>používat logiku založenou na koncovém bodu nebo logiku založenou na ASP.NET jádra 2.1 nebo staršího.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-878">The <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> option determines if routing should internally use endpoint-based logic or the <xref:Microsoft.AspNetCore.Routing.IRouter>-based logic of ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="ba1ea-879">Pokud je verze kompatibility nastavena na hodnotu `true`2.2 nebo novější, je výchozí hodnota .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-879">When the compatibility version is set to 2.2 or later, the default value is `true`.</span></span> <span data-ttu-id="ba1ea-880">Nastavte hodnotu `false` tak, aby používala logiku předchozího směrování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-880">Set the value to `false` to use the prior routing logic:</span></span>

```csharp
// Use the routing logic of ASP.NET Core 2.1 or earlier:
services.AddMvc(options => options.EnableEndpointRouting = false)
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="ba1ea-881">Další informace <xref:Microsoft.AspNetCore.Routing.IRouter>o směrování na základě této informace naleznete v [ASP.NET verzi tohoto tématu Core 2.1](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-881">For more information on <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, see the [ASP.NET Core 2.1 version of this topic](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ba1ea-882">Tento dokument se týká nízkoúrovňového ASP.NET směrování Jádra.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-882">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="ba1ea-883">Informace o směrování Core MVC <xref:mvc/controllers/routing>ASP.NET naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-883">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="ba1ea-884">Informace o konvencích směrování <xref:razor-pages/razor-pages-conventions>v nástroji Razor Pages naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-884">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ba1ea-885">[Zobrazit nebo stáhnout ukázkový kód](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) [(jak stáhnout)](xref:index#how-to-download-a-sample)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-885">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="ba1ea-886">Základy směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-886">Routing basics</span></span>

<span data-ttu-id="ba1ea-887">Většina aplikací by měla zvolit základní a popisné schéma směrování, aby byly adresy URL čitelné a smysluplné.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-887">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="ba1ea-888">Výchozí konvenční `{controller=Home}/{action=Index}/{id?}`trasa :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-888">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="ba1ea-889">Podporuje základní a popisné schéma směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-889">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="ba1ea-890">Je užitečným výchozím bodem pro aplikace založené na uznatého.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-890">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="ba1ea-891">Vývojáři obvykle přidávají další trasy do oblastí s vysokým provozem aplikace ve specializovaných situacích pomocí [směrování atributů](xref:mvc/controllers/routing#attribute-routing) nebo vyhrazených konvenčních tras.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-891">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span> <span data-ttu-id="ba1ea-892">Mezi příklady specializovaných situací patří koncové body blogu a elektronického obchodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-892">Specialized situations examples include, blog and ecommerce endpoints.</span></span>

<span data-ttu-id="ba1ea-893">Webová api by měla používat směrování atributů k modelování funkčnosti aplikace jako sadu prostředků, kde jsou operace reprezentovány slovesy HTTP.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-893">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="ba1ea-894">To znamená, že mnoho operací, například GET a POST, na stejném logickém prostředku používá stejnou adresu URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-894">This means that many operations, for example, GET, and POST, on the same logical resource use the same URL.</span></span> <span data-ttu-id="ba1ea-895">Směrování atributů poskytuje úroveň řízení, která je potřeba pečlivě navrhnout rozložení veřejného koncového bodu rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-895">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="ba1ea-896">Aplikace Razor Pages používají výchozí konvenční směrování k zobrazování pojmenovaných prostředků ve složce *Stránky* aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-896">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="ba1ea-897">K dispozici jsou další konvence, které umožňují přizpůsobit chování směrování Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-897">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="ba1ea-898">Další informace naleznete v tématech <xref:razor-pages/index> a <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-898">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ba1ea-899">Podpora generování adres URL umožňuje aplikaci vyvíjet bez pevných kódovacích adres URL, které aplikaci spojují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-899">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="ba1ea-900">Tato podpora umožňuje začít s základní konfiguraci směrování a úpravy tras po určení rozložení prostředků aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-900">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="ba1ea-901">Směrování používá koncové`Endpoint` *body* ( ) k reprezentaci logických koncových bodů v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-901">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="ba1ea-902">Koncový bod definuje delegáta pro zpracování požadavků a kolekci libovolných metadat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-902">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="ba1ea-903">Metadata se používá implementovat průřezové obavy založené na zásadách a konfiguraci připojené ke každému koncovému bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-903">The metadata is used implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="ba1ea-904">Systém směrování má následující charakteristiky:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-904">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="ba1ea-905">Syntaxe šablony trasy se používá k definování tras s tokenizovanými parametry trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-905">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="ba1ea-906">Konfigurace koncového bodu konvenčního stylu a atributu je povolena.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-906">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="ba1ea-907"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint>se používá k určení, zda parametr URL obsahuje platnou hodnotu pro dané omezení koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-907"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="ba1ea-908">Modely aplikací, jako jsou stránky MVC/Razor, registrují všechny své koncové body, které mají předvídatelnou implementaci scénářů směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-908">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="ba1ea-909">Implementace směrování umožňuje rozhodování směrování, kdykoli je to požadováno v kanálu middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-909">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="ba1ea-910">Middleware, který se zobrazí po směrování Middleware můžete zkontrolovat výsledek rozhodnutí směrování Middleware koncového bodu rozhodnutí pro daný požadavek URI.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-910">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="ba1ea-911">Je možné vytvořit výčet všech koncových bodů v aplikaci kdekoli v kanálu middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-911">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="ba1ea-912">Aplikace může pomocí směrování generovat adresy URL (například pro přesměrování nebo odkazy) na základě informací o koncovém bodu a vyhnout se tak pevně zakódovaným adresám URL, což pomáhá udržovatelnost.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-912">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="ba1ea-913">Generování adres URL je založeno na adresách, které podporují libovolnou rozšiřitelnost:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-913">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="ba1ea-914">Rozhraní API generátoru odkazů (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) lze vyřešit kdekoli pomocí vkládání [závislostí (DI)](xref:fundamentals/dependency-injection) pro generování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-914">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="ba1ea-915">Kde rozhraní API generátoru propojení není <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> k dispozici prostřednictvím DI, nabízí metody pro vytváření adres URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-915">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="ba1ea-916">S vydáním směrování koncových bodů v ASP.NET Core 2.2 je propojení koncových bodů omezeno na akce a stránky MVC/Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-916">With the release of endpoint routing in ASP.NET Core 2.2, endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="ba1ea-917">Rozšíření možností propojení koncových bodů je plánováno pro budoucí verze.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-917">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="ba1ea-918">Směrování je připojeno k [middlewarovému](xref:fundamentals/middleware/index) kanálu třídou. <xref:Microsoft.AspNetCore.Builder.RouterMiddleware></span><span class="sxs-lookup"><span data-stu-id="ba1ea-918">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="ba1ea-919">[ASP.NET Core MVC](xref:mvc/overview) přidává směrování do middlewarového kanálu jako součást své konfigurace a zpracovává směrování v aplikacích MVC a Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-919">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="ba1ea-920">Informace o tom, jak používat směrování jako samostatnou součást, naleznete v části [Použití middlewaru směrování.](#use-routing-middleware)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-920">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="ba1ea-921">Párování adres URL</span><span class="sxs-lookup"><span data-stu-id="ba1ea-921">URL matching</span></span>

<span data-ttu-id="ba1ea-922">Porovnávání adres URL je proces, kterým směrování odesílá příchozí požadavek do *koncového bodu*.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-922">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="ba1ea-923">Tento proces je založen na datech v cestě url, ale může být rozšířen tak, aby zvážil všechna data v požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-923">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="ba1ea-924">Možnost odesílat požadavky na samostatné obslužné rutiny je klíčem k škálování velikosti a složitosti aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-924">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="ba1ea-925">Systém směrování v směrování koncových bodů je zodpovědný za všechna rozhodnutí o odeslání.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-925">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="ba1ea-926">Vzhledem k tomu, že middleware používá zásady založené na vybraném koncovém bodu, je důležité, aby jakékoli rozhodnutí, které může ovlivnit odesílání nebo použití zásad zabezpečení, bylo provedeno uvnitř systému směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-926">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="ba1ea-927">Při spuštění delegáta koncového bodu vlastnosti [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) jsou nastaveny na příslušné hodnoty na základě zpracování požadavku provádí tak daleko.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-927">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="ba1ea-928">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) je slovník *hodnot trasy* vytvořených z trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-928">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="ba1ea-929">Tyto hodnoty jsou obvykle určeny tokenizací adresy URL a lze je použít k přijetí vstupu uživatele nebo k dalším rozhodnutím o odesílání uvnitř aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-929">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="ba1ea-930">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) je vlastnost taška další chdatné trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-930">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="ba1ea-931"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*>jsou k dispozici pro podporu asociace dat stavu s každou trasu tak, aby aplikace může rozhodovat na základě které trasy uzavřeno.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-931"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="ba1ea-932">Tyto hodnoty jsou definovány vývojářem a žádným způsobem **neovlivňují** chování směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-932">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="ba1ea-933">Navíc hodnoty ukrytýv [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) může být libovolného typu, na rozdíl od [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), které musí být převoditelné do a z řetězců.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-933">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="ba1ea-934">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) je seznam tras, které se podílely na úspěšném porovnání požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-934">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="ba1ea-935">Trasy mohou být vnořeny uvnitř sebe.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-935">Routes can be nested inside of one another.</span></span> <span data-ttu-id="ba1ea-936">Vlastnost <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> odráží cestu přes logický strom tras, které vedly ke shodě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-936">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="ba1ea-937">Obecně platí, že <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> první položka v je kolekce tras a by měla být použita pro generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-937">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="ba1ea-938">Poslední položka <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> v je obslužná rutina postupu, která odpovídá.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-938">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="ba1ea-939">Generování adres URL pomocí linkgenerátoru</span><span class="sxs-lookup"><span data-stu-id="ba1ea-939">URL generation with LinkGenerator</span></span>

<span data-ttu-id="ba1ea-940">Generování adresy URL je proces, kterým může směrování vytvořit cestu URL na základě sady hodnot trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-940">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="ba1ea-941">To umožňuje logické oddělení mezi koncovými body a adresy URL, které k nim přistupují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-941">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="ba1ea-942">Směrování koncového bodu zahrnuje<xref:Microsoft.AspNetCore.Routing.LinkGenerator>rozhraní API generátoru propojení ( ).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-942">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="ba1ea-943"><xref:Microsoft.AspNetCore.Routing.LinkGenerator>je singleton služba, která může být načtena z [DI](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-943"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="ba1ea-944">Rozhraní API lze použít mimo kontext vykonávajícího požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-944">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="ba1ea-945">MVC <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> a scénáře, které <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>spoléhají na , jako jsou tag [helpery](xref:mvc/views/tag-helpers/intro), HTML helpery a [výsledky akcí](xref:mvc/controllers/actions), použijte generátor odkazů poskytnout možnosti generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-945">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="ba1ea-946">Generátor propojení je podpořen konceptem schémat *adres* a *adres*.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-946">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="ba1ea-947">Schéma adresy je způsob, jak určit koncové body, které by měly být považovány za generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-947">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="ba1ea-948">Například scénáře název trasy a hodnoty trasy, které mnoho uživatelů zná ze stránek MVC/Razor, jsou implementovány jako schéma adres.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-948">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="ba1ea-949">Odkaz generátor může odkaz na MVC / Razor Stránky akce a stránky prostřednictvím následujících metod rozšíření:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-949">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="ba1ea-950">Přetížení těchto metod přijímá argumenty, `HttpContext`které zahrnují .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-950">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="ba1ea-951">Tyto metody jsou funkčně rovnocenné `Url.Action` a `Url.Page` nabízejí však další flexibilitu a možnosti.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-951">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="ba1ea-952">Metody `GetPath*` jsou nejvíce `Url.Action` podobné `Url.Page` a v tom, že generují identifikátor URI obsahující absolutní cestu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-952">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="ba1ea-953">Metody `GetUri*` vždy generovat absolutní URI obsahující schéma a hostitele.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-953">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="ba1ea-954">Metody, které `HttpContext` přijímají generovat identifikátor URI v kontextu vykonávajícího požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-954">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="ba1ea-955">Hodnoty trasy okolí, základní cesta URL, schéma a hostitel z vykonávajícího požadavku se používají, pokud nejsou přepsány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-955">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="ba1ea-956"><xref:Microsoft.AspNetCore.Routing.LinkGenerator>je volána s adresou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-956"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="ba1ea-957">Generování identifikátoru URI probíhá ve dvou krocích:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-957">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="ba1ea-958">Adresa je vázána na seznam koncových bodů, které odpovídají adrese.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-958">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="ba1ea-959">Každý koncový bod `RoutePattern` je vyhodnocen, dokud není nalezen vzorek postupu, který odpovídá zadaným hodnotám.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-959">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="ba1ea-960">Výsledný výstup je kombinován s ostatními částmi URI dodanými do generátoru propojení a vráceny.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-960">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="ba1ea-961">Metody poskytované <xref:Microsoft.AspNetCore.Routing.LinkGenerator> podporou standardních možností generování propojení pro jakýkoli typ adresy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-961">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="ba1ea-962">Nejpohodlnější způsob, jak používat generátor propojení je prostřednictvím rozšíření metody, které provádějí operace pro určitý typ adresy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-962">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="ba1ea-963">Metoda rozšíření</span><span class="sxs-lookup"><span data-stu-id="ba1ea-963">Extension Method</span></span>   | <span data-ttu-id="ba1ea-964">Popis</span><span class="sxs-lookup"><span data-stu-id="ba1ea-964">Description</span></span>                                                         |
| ------------------ | ------------------------------------------------------------------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="ba1ea-965">Generuje identifikátor URI s absolutní cestou na základě zadaných hodnot.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-965">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="ba1ea-966">Generuje absolutní identifikátor URI na základě zadaných hodnot.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-966">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="ba1ea-967">Věnujte pozornost následujícím <xref:Microsoft.AspNetCore.Routing.LinkGenerator> důsledkům volání metod:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-967">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="ba1ea-968">V `GetUri*` konfiguraci aplikace, která neověřuje `Host` záhlaví příchozích požadavků, používejte metody rozšíření opatrně.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-968">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="ba1ea-969">Pokud `Host` záhlaví příchozích požadavků není ověřeno, nelze klientovi odeslat zpět do klienta v zobrazení nebo na stránce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-969">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="ba1ea-970">Doporučujeme, aby všechny produkční aplikace `Host` nakonfigurovaly svůj server tak, aby ověřoval záhlaví proti známým platným hodnotám.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-970">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="ba1ea-971">Používejte <xref:Microsoft.AspNetCore.Routing.LinkGenerator> s opatrností v `Map` middleware v kombinaci s nebo `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-971">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="ba1ea-972">`Map*`změní základní cestu vykonávajícího požadavku, což má vliv na výstup generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-972">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="ba1ea-973">Všechna <xref:Microsoft.AspNetCore.Routing.LinkGenerator> api umožňují určení základní cesty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-973">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="ba1ea-974">Vždy zadejte prázdnou základní `Map*`cestu, která má vrátit vliv na generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-974">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="ba1ea-975">Rozdíly od předchozích verzí směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-975">Differences from earlier versions of routing</span></span>

<span data-ttu-id="ba1ea-976">Existuje několik rozdílů mezi směrováním koncových bodů v ASP.NET core 2.2 nebo novějšía a starší verze směrování v ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-976">A few differences exist between endpoint routing in ASP.NET Core 2.2 or later and earlier versions of routing in ASP.NET Core:</span></span>

* <span data-ttu-id="ba1ea-977">Systém směrování koncových bodů <xref:Microsoft.AspNetCore.Routing.IRouter>nepodporuje rozšiřitelnost založenou na <xref:Microsoft.AspNetCore.Routing.Route>vlastnostech, včetně dědění z .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-977">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="ba1ea-978">Směrování koncových bodů nepodporuje [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-978">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="ba1ea-979">Chcete-li`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`pokračovat [compatibility version](xref:mvc/compatibility-version) v používání kompatibilní hospo-</span><span class="sxs-lookup"><span data-stu-id="ba1ea-979">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="ba1ea-980">Směrování koncových bodů má při použití konvenčních tras odlišné chování pro caseing generovaných identifikátorů URI.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-980">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="ba1ea-981">Zvažte následující výchozí šablonu trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-981">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="ba1ea-982">Předpokládejme, že vygenerujete odkaz na akci pomocí následující trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-982">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="ba1ea-983">S <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, tento kód `/blog/ReadPost/17`generuje IDENTIFIKÁTOR URI , který respektuje velká a malá písmena zapředpokladu hodnotu postupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-983">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="ba1ea-984">Směrování koncových bodů v ASP.NET jádrem `/Blog/ReadPost/17` 2.2 nebo novějším ("Blog" je velkými písmeny).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-984">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="ba1ea-985">Směrování koncových `IOutboundParameterTransformer` bodů poskytuje rozhraní, které lze použít k přizpůsobení tohoto chování globálně nebo k použití různých konvencí pro mapování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-985">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="ba1ea-986">Další informace naleznete v [části Reference parametrtransformátoru.](#parameter-transformer-reference)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-986">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="ba1ea-987">Generování odkazů používané stránkami MVC/Razor pages s konvenčními trasami se při pokusu o propojení s řadičem nebo akcí nebo stránkou, která neexistuje, chová jinak.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-987">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="ba1ea-988">Zvažte následující výchozí šablonu trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-988">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="ba1ea-989">Předpokládejme, že vygenerujete odkaz na akci pomocí výchozí šablony s následujícími:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-989">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="ba1ea-990">S `IRouter`-based routing, výsledek `/Blog/ReadPost/17`je vždy `BlogController` , i v případě, `ReadPost` že neexistuje nebo nemá metodu akce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-990">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="ba1ea-991">Podle očekávání směrování koncových bodů v ASP.NET Core `/Blog/ReadPost/17` 2.2 nebo novější vytváří, pokud existuje metoda akce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-991">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="ba1ea-992">*Směrování koncového bodu však vytvoří prázdný řetězec, pokud akce neexistuje.*</span><span class="sxs-lookup"><span data-stu-id="ba1ea-992">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="ba1ea-993">Koncepčně směrování koncových bodů nepředpokládá, že koncový bod existuje, pokud akce neexistuje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-993">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="ba1ea-994">*Algoritmus zneplatnění okolní hodnoty* generování propojení se při použití se směrováním koncového bodu chová jinak.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-994">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="ba1ea-995">*Zneplatnění okolní hodnoty* je algoritmus, který rozhoduje o tom, které hodnoty trasy z aktuálně spuštěný požadavek (okolní hodnoty) lze použít v operacích generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-995">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="ba1ea-996">Konvenční směrování vždy zneplatnilo další hodnoty trasy při propojení s jinou akcí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-996">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="ba1ea-997">Směrování atributů nemělto chování před vydáním ASP.NET Core 2.2.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-997">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="ba1ea-998">V dřívějších verzích ASP.NET Core, odkazy na jinou akci, které používají stejné názvy parametrů trasy za následek chyby generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-998">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="ba1ea-999">V ASP.NET jádrem 2.2 nebo novějším, obě formy směrování zneplatňují hodnoty při propojení s jinou akcí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-999">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="ba1ea-1000">Vezměme si následující příklad v ASP.NET jádrem 2.1 nebo starším.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1000">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="ba1ea-1001">Při propojení s jinou akcí (nebo jinou stránkou) lze hodnoty trasy znovu použít nežádoucími způsoby.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1001">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="ba1ea-1002">V */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1002">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="ba1ea-1003">V */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1003">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="ba1ea-1004">Pokud je `/Store/Product/18` identifikátor URI v ASP.NET jádrem 2.1 nebo starším, `@Url.Page("/Login")` `/Login/18`je odkaz generovaný na stránce Store/Info od .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1004">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="ba1ea-1005">Hodnota `id` 18 je znovu použita, i když cíl odkazu je zcela odlišná část aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1005">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="ba1ea-1006">Hodnota `id` postupu v kontextu `/Login` stránky je pravděpodobně hodnota ID uživatele, nikoli hodnota ID produktu úložiště.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1006">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="ba1ea-1007">V směrování koncového bodu s ASP.NET jádrem `/Login`2.2 nebo novějším je výsledkem .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1007">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="ba1ea-1008">Hodnoty okolí se znovu nepoužijí, pokud je propojený cíl jinou akcí nebo stránkou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1008">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="ba1ea-1009">Syntaxe parametru trasy round-tripping: Lomítka se nekóduje při`**`použití syntaxe parametru catch-all s dvojitou hvězdičkou ( ).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1009">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="ba1ea-1010">Během generování propojení systém směrování zakóduje hodnotu zachycenou v`**`parametru double-asterisk `{**myparametername}`( ) catch-all (například) s výjimkou lomítka.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1010">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="ba1ea-1011">Double-hvězdička catch-all je podporován `IRouter`a založené směrování v ASP.NET Core 2.2 nebo novější.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1011">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="ba1ea-1012">Jedna syntaxe parametru catch-all v předchozích verzích ASP.NET Core (`{*myparametername}`) zůstává podporována a lomítka jsou kódována.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1012">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="ba1ea-1013">Trasa</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1013">Route</span></span>              | <span data-ttu-id="ba1ea-1014">Propojení generované pomocí</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1014">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="ba1ea-1015">`/search/admin%2Fproducts`(lomítko je zakódováno)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1015">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="ba1ea-1016">Middleware příklad</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1016">Middleware example</span></span>

<span data-ttu-id="ba1ea-1017">V následujícím příkladu middleware <xref:Microsoft.AspNetCore.Routing.LinkGenerator> používá rozhraní API k vytvoření odkazu na metodu akce, která uvádí seznam produktů úložiště.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1017">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="ba1ea-1018">Pomocí generátoru odkazů vstřikováním `GenerateLink` do třídy a volání je k dispozici pro všechny třídy v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1018">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="ba1ea-1019">Vytvoření tras</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1019">Create routes</span></span>

<span data-ttu-id="ba1ea-1020">Většina aplikací vytváří <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> trasy voláním nebo jednou <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>z podobných metod rozšíření definovaných na .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1020">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="ba1ea-1021">Všechny metody <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> rozšíření vytvořit instanci <xref:Microsoft.AspNetCore.Routing.Route> a přidat do kolekce tras.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1021">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="ba1ea-1022"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>nepřijímá parametr obslužné rutiny trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1022"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="ba1ea-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>přidá pouze trasy, které <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>jsou zpracovány .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="ba1ea-1024">Další informace o směrování v MVC naleznete v tématu <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1024">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="ba1ea-1025">Následující příklad kódu je příkladem <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> volání používaného typickou ASP.NET definici trasy Core MVC:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1025">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ba1ea-1026">Tato šablona odpovídá cestě URL a extrahuje hodnoty trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1026">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="ba1ea-1027">Cesta například `/Products/Details/17` generuje následující hodnoty trasy: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1027">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="ba1ea-1028">Hodnoty trasy jsou určeny rozdělením cesty URL do segmentů a porovnáním každého segmentu s názvem *parametru trasy* v šabloně trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1028">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="ba1ea-1029">Parametry trasy jsou pojmenovány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1029">Route parameters are named.</span></span> <span data-ttu-id="ba1ea-1030">Parametry definované uzavřením názvu parametru `{ ... }`do složených závorek .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1030">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="ba1ea-1031">Předchozí šablona může také odpovídat cestě `/` `{ controller = Home, action = Index }`URL a vytvářet hodnoty .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1031">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="ba1ea-1032">K tomu `{controller}` dochází, `{action}` protože parametry a `id` a mají výchozí hodnoty a parametr trasy je volitelný.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1032">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="ba1ea-1033">Znaménko`=`rovná se ( ) následované hodnotou za názvem parametru trasy definuje výchozí hodnotu parametru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1033">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="ba1ea-1034">Otazník`?`( ) za názvem parametru trasy definuje volitelný parametr.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1034">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="ba1ea-1035">Parametry trasy s výchozí hodnotou *vždy* vytvoří hodnotu trasy, když se trasa shoduje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1035">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="ba1ea-1036">Volitelné parametry nevytvářejí hodnotu trasy, pokud neexistuje odpovídající segment cesty URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1036">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="ba1ea-1037">V části [Odkaz na šablonu trasy](#route-template-reference) naleznete důkladný popis scénářů a syntaxe šablony trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1037">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="ba1ea-1038">V následujícím příkladu definuje `{id:int}` definice parametru trasy `id` omezení [trasy](#route-constraint-reference) pro parametr trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1038">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="ba1ea-1039">Tato šablona odpovídá `/Products/Details/17` cestě `/Products/Details/Apples`URL, jako je, ale ne .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1039">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="ba1ea-1040">Omezení trasy <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementují a kontrolují hodnoty postupu, abyste je ověřili.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1040">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="ba1ea-1041">V tomto příkladu `id` musí být hodnota trasy převoditelná na celé číslo.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1041">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="ba1ea-1042">Viz [odkaz na omezení trasy](#route-constraint-reference) pro vysvětlení omezení postupu poskytované rámcem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1042">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="ba1ea-1043">Další přetížení <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> hodnot accept `constraints` `dataTokens`pro `defaults`, a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1043">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="ba1ea-1044">Typické použití těchto parametrů je předat anonymně zadaný objekt, kde názvy vlastností anonymní typ odpovídají názvům parametrů postupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1044">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="ba1ea-1045">Následující <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> příklady vytvářejí ekvivalentní trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1045">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="ba1ea-1046">Vložková syntaxe pro definování omezení a výchozích hodnot může být vhodná pro jednoduché trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1046">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="ba1ea-1047">Existují však scénáře, jako jsou datové tokeny, které nejsou podporovány vložená syntaxe.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1047">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="ba1ea-1048">Následující příklad ukazuje několik dalších scénářů:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1048">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="ba1ea-1049">Předchozí šablona odpovídá cestě `/Blog/All-About-Routing/Introduction` URL jako a `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`extrahuje hodnoty .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1049">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="ba1ea-1050">Výchozí hodnoty postupu `controller` `action` a jsou vytvořeny postupem, i když v šabloně nejsou žádné odpovídající parametry trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1050">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="ba1ea-1051">Výchozí hodnoty lze zadat v šabloně postupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1051">Default values can be specified in the route template.</span></span> <span data-ttu-id="ba1ea-1052">Parametr `article` trasy je definován jako *catch-all* vzhledem dvojité hvězdičky (`**`) před názvem parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1052">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="ba1ea-1053">Catch-all parametry trasy zachytit zbytek cesty URL a může také odpovídat prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1053">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="ba1ea-1054">Následující příklad přidá omezení trasy a datové tokeny:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1054">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="ba1ea-1055">Předchozí šablona odpovídá cestě `/en-US/Products/5` URL jako a `{ controller = Products, action = Details, id = 5 }` extrahuje `{ locale = en-US }`hodnoty a datové tokeny .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1055">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Místní Windows tokeny](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="ba1ea-1057">Generování adresy URL třídy trasy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1057">Route class URL generation</span></span>

<span data-ttu-id="ba1ea-1058">Třída <xref:Microsoft.AspNetCore.Routing.Route> může také provádět generování adres URL kombinací sady hodnot trasy se šablonou trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1058">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="ba1ea-1059">Toto je logicky opačný proces odpovídající cestě URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1059">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="ba1ea-1060">Chcete-li lépe porozumět generování adresy URL, představte si, jakou adresu URL chcete vygenerovat, a pak přemýšlejte o tom, jak by šablona trasy odpovídala této adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1060">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="ba1ea-1061">Jaké hodnoty by byly vyrobeny?</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1061">What values would be produced?</span></span> <span data-ttu-id="ba1ea-1062">Toto je hrubý ekvivalent, jak <xref:Microsoft.AspNetCore.Routing.Route> funguje generování adresy URL ve třídě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1062">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="ba1ea-1063">Následující příklad používá obecnou výchozí trasu ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1063">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ba1ea-1064">S hodnotami `{ controller = Products, action = List }`trasy `/Products/List` je generována adresa URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1064">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="ba1ea-1065">Hodnoty trasy jsou nahrazeny odpovídajícími parametry trasy a tvoří cestu URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1065">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="ba1ea-1066">Vzhledem k tomu, `id` že je volitelný parametr trasy, `id`je adresa URL úspěšně generována bez hodnoty pro .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1066">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="ba1ea-1067">S hodnotami `{ controller = Home, action = Index }`trasy `/` je generována adresa URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1067">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="ba1ea-1068">Zakalené hodnoty trasy odpovídají výchozím hodnotám a segmenty odpovídající výchozím hodnotám jsou bezpečně vynechány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1068">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="ba1ea-1069">Obě adresy URL generované round-trip s následující`/Home/Index` `/`definicí trasy ( a ) vytvářejí stejné hodnoty trasy, které byly použity ke generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1069">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="ba1ea-1070">Aplikace využívající ASP.NET Core MVC by měla používat <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> ke generování adres URL namísto volání do směrování přímo.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1070">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="ba1ea-1071">Další informace o generování adres URL naleznete v části odkaz na [generování adres URL.](#url-generation-reference)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1071">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="ba1ea-1072">Použití middlewaru směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1072">Use Routing Middleware</span></span>

<span data-ttu-id="ba1ea-1073">Odkaz na [metabalíček Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) v souboru projektu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1073">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="ba1ea-1074">Přidání směrování do servisního kontejneru v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1074">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="ba1ea-1075">Trasy musí být konfigurovány v metodě. `Startup.Configure`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1075">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="ba1ea-1076">Ukázková aplikace používá následující api:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1076">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="ba1ea-1077"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>&ndash; Odpovídá pouze požadavkům HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1077"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="ba1ea-1078">V následující tabulce jsou uvedeny odpovědi s danými identifikátory URI.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1078">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="ba1ea-1079">Identifikátor URI</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1079">URI</span></span>                    | <span data-ttu-id="ba1ea-1080">Odpověď</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1080">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="ba1ea-1081">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1081">Hello!</span></span> <span data-ttu-id="ba1ea-1082">Hodnoty postupu: [operace, vytvoření], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1082">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="ba1ea-1083">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1083">Hello!</span></span> <span data-ttu-id="ba1ea-1084">Hodnoty trasy: [provoz, trať], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1084">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="ba1ea-1085">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1085">Hello!</span></span> <span data-ttu-id="ba1ea-1086">Hodnoty trasy: [provoz, trať], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1086">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="ba1ea-1087">Žádost neprojde, žádná shoda.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1087">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="ba1ea-1088">Ahoj, Joe!</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1088">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="ba1ea-1089">Požadavek spadá přes, odpovídá pouze HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1089">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="ba1ea-1090">Žádost neprojde, žádná shoda.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1090">The request falls through, no match.</span></span>              |

<span data-ttu-id="ba1ea-1091">Rámec poskytuje sadu rozšiřujících metod pro<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>vytváření tras ( ):</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1091">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="ba1ea-1092">Metody `Map[Verb]` používají omezení k omezení trasy na sloveso HTTP v názvu metody.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1092">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="ba1ea-1093">Viz například <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1093">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="ba1ea-1094">Odkaz na šablonu trasy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1094">Route template reference</span></span>

<span data-ttu-id="ba1ea-1095">Tokeny v rámci složených závorek (`{ ... }`) definují parametry trasy, které jsou *vázány,* pokud je trasa spárována.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1095">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="ba1ea-1096">V segmentu trasy můžete definovat více než jeden parametr trasy, ale musí být odděleny hodnotou literálu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1096">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="ba1ea-1097">Například `{controller=Home}{action=Index}` není platná trasa, protože neexistuje žádná hodnota `{controller}` literálu mezi a `{action}`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1097">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="ba1ea-1098">Tyto parametry trasy musí mít název a mohou mít další atributy zadané.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1098">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="ba1ea-1099">Doslovný text jiný než parametry `{id}`trasy (například) a oddělovač `/` cesty se musí shodovat s textem v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1099">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="ba1ea-1100">Porovnávání textu nerozlišuje malá a velká písmena a je založena na dekódované reprezentaci cesty url.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1100">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="ba1ea-1101">Chcete-li porovnat oddělovač parametrů`{` `}`oddělovač parametrů doslovné trasy`{{` `}}`( nebo ), unikne oddělovači opakováním znaku ( nebo ).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1101">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="ba1ea-1102">Další důležité informace mají vzory adres URL, které se pokoušejí zachytit název souboru s volitelnou příponou souboru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1102">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="ba1ea-1103">Zvažte například `files/{filename}.{ext?}`šablonu .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1103">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="ba1ea-1104">Pokud jsou `filename` hodnoty `ext` pro oba a existují, jsou vyplněny obě hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1104">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="ba1ea-1105">Pokud v adrese `filename` URL existuje pouze hodnota pro, trasa`.`se shoduje, protože koncové období ( ) je volitelné.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1105">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="ba1ea-1106">Následující adresy URL odpovídají této trase:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1106">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="ba1ea-1107">Hvězdičku (`*`) nebo dvojitou hvězdičku`**`( ) můžete použít jako předponu parametru trasy k vazbě na zbytek identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1107">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="ba1ea-1108">Tyto parametry se nazývají *catch-all.*</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1108">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="ba1ea-1109">Například `blog/{**slug}` odpovídá všem identifikátorům `/blog` URI, který začíná a má `slug` za ním libovolnou hodnotu, která je přiřazena hodnotě postupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1109">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="ba1ea-1110">Catch-all parametry mohou také odpovídat prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1110">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="ba1ea-1111">Parametr catch-all unikne příslušným znakům, když je trasa použita`/`ke generování adresy URL, včetně znaků oddělovače cest ( ).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1111">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="ba1ea-1112">Například trasa `foo/{*path}` s `{ path = "my/path" }` hodnotami `foo/my%2Fpath`trasy generuje .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1112">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="ba1ea-1113">Všimněte si uvozené lomítko.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1113">Note the escaped forward slash.</span></span> <span data-ttu-id="ba1ea-1114">K oddělovacím znakům cesty `**` okolení použijte předponu parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1114">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="ba1ea-1115">Trasa `foo/{**path}` `{ path = "my/path" }` s `foo/my/path`generuje .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1115">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="ba1ea-1116">Parametry postupu mohou mít *výchozí hodnoty* určené zadáním výchozí hodnoty za názvem`=`parametru odděleným znaménkem rovná se ( ).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1116">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="ba1ea-1117">Definuje například `{controller=Home}` `Home` jako výchozí hodnotu pro `controller`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1117">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="ba1ea-1118">Výchozí hodnota se používá, pokud v adrese URL parametru není žádná hodnota.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1118">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="ba1ea-1119">Parametry trasy jsou volitelné připojením otazníku (`?`) na konec `id?`názvu parametru, jako v .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1119">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="ba1ea-1120">Rozdíl mezi volitelnými hodnotami a výchozími parametry postupu spoá,&mdash;že parametr trasy s výchozí hodnotou vždy vytvoří hodnotu, volitelný parametr má hodnotu pouze v případě, že hodnota je poskytnuta adresou URL požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1120">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="ba1ea-1121">Parametry trasy mohou mít omezení, která musí odpovídat hodnotě trasy vázané z adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1121">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="ba1ea-1122">Přidání dvojtečky (`:`) a názvu omezení za název parametru trasy určuje *vsazené omezení* parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1122">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="ba1ea-1123">Pokud omezení vyžaduje argumenty, jsou uzavřeny v závorcích (`(...)`) za názvem omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1123">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="ba1ea-1124">Vícevřádkových omezení lze zadat připojením`:`jinédvojtečky ( ) a názvu omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1124">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="ba1ea-1125">Název omezení a argumenty jsou <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> předány službě <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> k vytvoření instance pro použití při zpracování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1125">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="ba1ea-1126">Například šablona `blog/{article:minlength(10)}` trasy určuje `minlength` omezení s `10`argumentem .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1126">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="ba1ea-1127">Další informace o omezeních postupu a seznam omezení poskytovaných rámcem naleznete v referenční části [omezení trasy.](#route-constraint-reference)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1127">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="ba1ea-1128">Parametry trasy mohou mít také parametrové transformátory, které transformují hodnotu parametru při generování odkazů a odpovídajících akcí a stránek na adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1128">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="ba1ea-1129">Podobně jako omezení mohou být transformátory parametrů přidány do parametru trasy přidáním dvojtečky (`:`) a názvu transformátoru za název parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1129">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="ba1ea-1130">Například šablona `blog/{article:slugify}` trasy určuje `slugify` transformátor.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1130">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="ba1ea-1131">Další informace o transformátorech parametrů naleznete v [části Reference parametrtransformátoru.](#parameter-transformer-reference)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1131">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="ba1ea-1132">Následující tabulka ukazuje ukázkové šablony tras a jejich chování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1132">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="ba1ea-1133">Šablona postupu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1133">Route Template</span></span>                           | <span data-ttu-id="ba1ea-1134">Příklad odpovídajícího identifikátoru URI</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1134">Example Matching URI</span></span>    | <span data-ttu-id="ba1ea-1135">Identifikátor URI požadavku&hellip;</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1135">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="ba1ea-1136">Odpovídá pouze jedné `/hello`cestě .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1136">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="ba1ea-1137">Odpovídá a `Page` `Home`nastavuje na .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1137">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="ba1ea-1138">Odpovídá a `Page` `Contact`nastavuje na .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1138">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="ba1ea-1139">Mapuje `Products` na `List` ovladač a akci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1139">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="ba1ea-1140">Mapy k `Products` ovladači `Details` `id` a akci (nastaveno na 123).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1140">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="ba1ea-1141">Mapy na `Home` řadič `Index` a`id` metodu (je ignorována).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1141">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="ba1ea-1142">Použití šablony je obecně nejjednodušší přístup k směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1142">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="ba1ea-1143">Omezení a výchozí hodnoty lze zadat také mimo šablonu trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1143">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="ba1ea-1144">Povolte [protokolování,](xref:fundamentals/logging/index) abyste viděli, jak integrované <xref:Microsoft.AspNetCore.Routing.Route>implementace směrování, například , shodu jsou požadavky na shodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1144">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="ba1ea-1145">Rezervované názvy směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1145">Reserved routing names</span></span>

<span data-ttu-id="ba1ea-1146">Následující klíčová slova jsou vyhrazené názvy a nelze je použít jako názvy nebo parametry trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1146">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="ba1ea-1147">Odkaz na omezení postupu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1147">Route constraint reference</span></span>

<span data-ttu-id="ba1ea-1148">Omezení trasy se spustí, když došlo ke shodě s příchozí adresou URL a cesta url je tokenizována na hodnoty trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1148">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="ba1ea-1149">Omezení postupu obvykle kontrolují hodnotu postupu přidruženou prostřednictvím šablony postupu a rozhodují o tom, zda je hodnota přijatelná.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1149">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="ba1ea-1150">Některá omezení postupu používají data mimo hodnotu postupu k posouzení, zda lze požadavek směrovat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1150">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="ba1ea-1151">Například <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> může přijmout nebo odmítnout požadavek na základě jeho slovesa HTTP.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1151">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="ba1ea-1152">Omezení se používají v požadavcích na směrování a generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1152">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="ba1ea-1153">Nepoužívejte omezení pro **ověření vstupu**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1153">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="ba1ea-1154">Pokud omezení se používají pro **ověření vstupu**, neplatné vstupní výsledky v *404 - nebyl nalezen* odpověď namísto *400 - chybný požadavek* s příslušnou chybovou zprávu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1154">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="ba1ea-1155">Omezení trasy se používají k **rozdvojení** podobných tras, nikoli k ověření vstupů pro určitou trasu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1155">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="ba1ea-1156">Následující tabulka ukazuje ukázková omezení trasy a jejich očekávané chování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1156">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="ba1ea-1157">omezení</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1157">constraint</span></span> | <span data-ttu-id="ba1ea-1158">Příklad</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1158">Example</span></span> | <span data-ttu-id="ba1ea-1159">Příklady shod</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1159">Example Matches</span></span> | <span data-ttu-id="ba1ea-1160">Poznámky</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1160">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="ba1ea-1161">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1161">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ba1ea-1162">Odpovídá libovolnému celému číselníku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1162">Matches any integer.</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="ba1ea-1163">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1163">`true`, `FALSE`</span></span> | <span data-ttu-id="ba1ea-1164">Shody `true` nebo 'false.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1164">Matches `true` or \`false.</span></span> <span data-ttu-id="ba1ea-1165">Case-insensitive.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1165">Case-insensitive.</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="ba1ea-1166">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1166">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="ba1ea-1167">Odpovídá platné `DateTime` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1167">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-1168">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1168">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="ba1ea-1169">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1169">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="ba1ea-1170">Odpovídá platné `decimal` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1170">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-1171">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1171">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="ba1ea-1172">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1172">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ba1ea-1173">Odpovídá platné `double` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1173">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-1174">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1174">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="ba1ea-1175">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1175">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ba1ea-1176">Odpovídá platné `float` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1176">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-1177">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1177">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="ba1ea-1178">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1178">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="ba1ea-1179">Odpovídá platné `Guid` hodnotě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1179">Matches a valid `Guid` value.</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="ba1ea-1180">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1180">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ba1ea-1181">Odpovídá platné `long` hodnotě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1181">Matches a valid `long` value.</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="ba1ea-1182">Řetězec musí být alespoň 4 znaky.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1182">String must be at least 4 characters.</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="ba1ea-1183">Řetězec má maximálně 8 znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1183">String has maximum of 8 characters.</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="ba1ea-1184">Řetězec musí mít přesně 12 znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1184">String must be exactly 12 characters long.</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="ba1ea-1185">Řetězec musí být alespoň 8 a má maximálně 16 znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1185">String must be at least 8 and has maximum of 16 characters.</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="ba1ea-1186">Hodnota celého čísla musí být alespoň 18.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1186">Integer value must be at least 18.</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="ba1ea-1187">Celá hodnota celkem 120.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1187">Integer value maximum of 120.</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="ba1ea-1188">Hodnota celého čísla musí být alespoň 18 a maximálně 120.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1188">Integer value must be at least 18 and maximum of 120.</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="ba1ea-1189">Řetězec se musí skládat z `a` - `z`jednoho nebo více abecedních znaků .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1189">String must consist of one or more alphabetical characters `a`-`z`.</span></span>  <span data-ttu-id="ba1ea-1190">Case-insensitive.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1190">Case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="ba1ea-1191">Řetězec musí odpovídat regulárnímu výrazu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1191">String must match the regular expression.</span></span> <span data-ttu-id="ba1ea-1192">Podívejte se na tipy pro definici regulárního výrazu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1192">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="ba1ea-1193">Slouží k vynucení, že hodnota neparametr je k dispozici během generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1193">Used to enforce that a non-parameter value is present during URL generation.</span></span> |

<span data-ttu-id="ba1ea-1194">Na jeden parametr lze použít více omezení oddělených dvojtečkou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1194">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="ba1ea-1195">Například následující omezení omezuje parametr na celou hodnotu 1 nebo vyšší:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1195">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="ba1ea-1196">Omezení trasy, která ověřují adresu URL a jsou `int` `DateTime`převedena na typ CLR (například nebo ) vždy používají invariantní jazykovou verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1196">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="ba1ea-1197">Tato omezení předpokládají, že adresu URL je nelokalizovatelné.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1197">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="ba1ea-1198">Omezení trasy poskytovaná rámcem nemění hodnoty uložené v hodnotách trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1198">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="ba1ea-1199">Všechny hodnoty trasy analyzované z adresy URL jsou uloženy jako řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1199">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="ba1ea-1200">Například `float` omezení se pokusí převést hodnotu trasy na float, ale převedená hodnota se používá pouze k ověření, že může být převedena na float.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1200">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="ba1ea-1201">Regulární výrazy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1201">Regular expressions</span></span>

<span data-ttu-id="ba1ea-1202">Rozhraní ASP.NET Core `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` přidává k konstruktoru regulárního výrazu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1202">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="ba1ea-1203">Viz <xref:System.Text.RegularExpressions.RegexOptions> popis těchto členů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1203">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="ba1ea-1204">Regulární výrazy používají oddělovače a tokeny podobné těm, které používají směrování a jazyk C#.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1204">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="ba1ea-1205">Tokeny regulárního výrazu musí být uvozeny.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1205">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="ba1ea-1206">Použití regulárního výrazu `^\d{3}-\d{2}-\d{4}$` v směrování:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1206">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing:</span></span>

* <span data-ttu-id="ba1ea-1207">Výraz musí mít jednotlivé `\` znaky zpětného lomítka `\\` uvedené v řetězci jako dvojité znaky zpětného lomítka ve zdrojovém kódu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1207">The expression must have the single backslash `\` characters provided in the string as double backslash `\\` characters in the source code.</span></span>
* <span data-ttu-id="ba1ea-1208">Regulární výraz `\\` nás musí `\` uniknout znak uzamykat řetězec.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1208">The regular expression must us `\\` in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="ba1ea-1209">Regulární výraz nevyžaduje `\\` při použití [doslovných řetězcových literál](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1209">The regular expression doesn't require `\\` when using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="ba1ea-1210">Chcete-li uniknout znakům `{` `}`oddělovače parametrů směrování `{{`, `}` `[[`, `]]` `[`, `]`zdvojnásobte znaky ve výrazu , , .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1210">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression `{{`, `}`, `[[`, `]]`.</span></span> <span data-ttu-id="ba1ea-1211">V následující tabulce je uveden regulární výraz a uvozená verze:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1211">The following table shows a regular expression and the escaped version:</span></span>

| <span data-ttu-id="ba1ea-1212">Regulární výraz</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1212">Regular Expression</span></span>    | <span data-ttu-id="ba1ea-1213">Uvozené regulární výraz</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1213">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="ba1ea-1214">Regulární výrazy používané při směrování `^` často začínají znakem stříšky a shodují se s počáteční pozicí řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1214">Regular expressions used in routing often start with the caret `^` character and match starting position of the string.</span></span> <span data-ttu-id="ba1ea-1215">Výrazy často končí `$` znakem dolaru a shodují se na konci řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1215">The expressions often end with the dollar sign `$` character and match end of the string.</span></span> <span data-ttu-id="ba1ea-1216">Znaky `^` `$` a zajišťují, že regulární výraz odpovídá celé hodnotě parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1216">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="ba1ea-1217">Bez `^` znaků `$` a regulární výraz odpovídá libovolnému podřetězci v řetězci, což je často nežádoucí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1217">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="ba1ea-1218">V následující tabulce jsou uvedeny příklady a vysvětleny, proč se shodují nebo neshodují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1218">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="ba1ea-1219">Expression</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1219">Expression</span></span>   | <span data-ttu-id="ba1ea-1220">Řetězec</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1220">String</span></span>    | <span data-ttu-id="ba1ea-1221">Shoda</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1221">Match</span></span> | <span data-ttu-id="ba1ea-1222">Poznámka</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1222">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-1223">hello</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1223">hello</span></span>     | <span data-ttu-id="ba1ea-1224">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1224">Yes</span></span>   | <span data-ttu-id="ba1ea-1225">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1225">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-1226">123abc456</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1226">123abc456</span></span> | <span data-ttu-id="ba1ea-1227">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1227">Yes</span></span>   | <span data-ttu-id="ba1ea-1228">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1228">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-1229">Mz</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1229">mz</span></span>        | <span data-ttu-id="ba1ea-1230">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1230">Yes</span></span>   | <span data-ttu-id="ba1ea-1231">Odpovídá výrazu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1231">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-1232">MZ</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1232">MZ</span></span>        | <span data-ttu-id="ba1ea-1233">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1233">Yes</span></span>   | <span data-ttu-id="ba1ea-1234">Neuznačují malá a velká písmen</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1234">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="ba1ea-1235">hello</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1235">hello</span></span>     | <span data-ttu-id="ba1ea-1236">Ne</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1236">No</span></span>    | <span data-ttu-id="ba1ea-1237">Viz `^` `$` a výše</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1237">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="ba1ea-1238">123abc456</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1238">123abc456</span></span> | <span data-ttu-id="ba1ea-1239">Ne</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1239">No</span></span>    | <span data-ttu-id="ba1ea-1240">Viz `^` `$` a výše</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1240">See `^` and `$` above</span></span> |

<span data-ttu-id="ba1ea-1241">Další informace o syntaxi regulárních výrazů naleznete [v tématu .NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1241">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="ba1ea-1242">Chcete-li omezit parametr na známou sadu možných hodnot, použijte regulární výraz.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1242">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="ba1ea-1243">Například `{action:regex(^(list|get|create)$)}` pouze odpovídá `action` hodnotě `list` `get`trasy `create`do , , nebo .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1243">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="ba1ea-1244">Pokud je předán do slovníku `^(list|get|create)$` omezení, řetězec je ekvivalentní.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1244">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="ba1ea-1245">Omezení, která jsou předána ve slovníku omezení (není vnímák v rámci šablony), které neodpovídají jedné ze známých omezení, jsou také považovány za regulární výrazy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1245">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="ba1ea-1246">Vlastní omezení trasy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1246">Custom route constraints</span></span>

<span data-ttu-id="ba1ea-1247">Kromě předdefinovaných omezení trasy lze implementací <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> rozhraní vytvořit omezení vlastní trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1247">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="ba1ea-1248">Rozhraní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> obsahuje jednu `Match`metodu `true` , která vrátí, `false` pokud je splněna omezení a jinak.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1248">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="ba1ea-1249">Chcete-li <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>použít vlastní , musí být typ omezení <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> postupu registrován u aplikace v kontejneru služeb aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1249">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="ba1ea-1250">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> je slovník, který mapuje <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> klíče omezení trasy na implementace, které tato omezení ověřují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1250">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="ba1ea-1251">Aplikace <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> lze aktualizovat buď `Startup.ConfigureServices` jako součást [služby. AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) volání nebo <xref:Microsoft.AspNetCore.Routing.RouteOptions> konfigurací `services.Configure<RouteOptions>`přímo s .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1251">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="ba1ea-1252">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1252">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="ba1ea-1253">Omezení pak lze použít na trasy obvyklým způsobem pomocí názvu určeného při registraci typu omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1253">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="ba1ea-1254">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1254">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="ba1ea-1255">Odkaz na parametr transformátor</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1255">Parameter transformer reference</span></span>

<span data-ttu-id="ba1ea-1256">Parametrické transformátory:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1256">Parameter transformers:</span></span>

* <span data-ttu-id="ba1ea-1257">Spustit při generování propojení <xref:Microsoft.AspNetCore.Routing.Route>pro .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1257">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="ba1ea-1258">Implementovat `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1258">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="ba1ea-1259">Jsou konfigurovány pomocí <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1259">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="ba1ea-1260">Vezměte hodnotu trasy parametru a transformujte ji na novou hodnotu řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1260">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="ba1ea-1261">Výsledkem je použití transformované hodnoty ve generovaném propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1261">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="ba1ea-1262">`slugify` Například vlastní parametr transformátor `blog\{article:slugify}` ve `Url.Action(new { article = "MyTestArticle" })` vzoru `blog\my-test-article`trasy s generuje .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1262">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="ba1ea-1263">Chcete-li použít parametrový transformátor ve <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> vzoru `Startup.ConfigureServices`trasy, nakonfigurujte jej nejprve pomocí aplikace :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1263">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="ba1ea-1264">Parametr transformátory jsou používány v rámci transformovat URI, kde se řeší koncový bod.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1264">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="ba1ea-1265">Například ASP.NET Core MVC používá parametr transformátory k `area`transformaci `controller` `action`hodnoty `page`trasy použité tak, aby odpovídala , , a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1265">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="ba1ea-1266">S předchozí trasou je `SubscriptionManagementController.GetAll` akce spárována `/subscription-management/get-all`s identifikátorem URI .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1266">With the preceding route, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="ba1ea-1267">Transformátor parametrů nezmění hodnoty trasy použité ke generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1267">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="ba1ea-1268">Například `Url.Action("GetAll", "SubscriptionManagement")` výstupy `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1268">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="ba1ea-1269">ASP.NET Core poskytuje konvencí rozhraní API pro použití parametrových transformátorů s generovanými trasami:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1269">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="ba1ea-1270">ASP.NET Core MVC `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` má konvenci rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1270">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="ba1ea-1271">Tato konvence platí zadaný parametr transformátor u všech tras atributů v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1271">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="ba1ea-1272">Parametr transformer transformuje atribut route tokeny jako jsou nahrazeny.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1272">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="ba1ea-1273">Další informace naleznete [v tématu Použití transformátoru parametrů k přizpůsobení nahrazení tokenu](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1273">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="ba1ea-1274">Razor Pages `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` má konvenci rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1274">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="ba1ea-1275">Tato konvence aplikuje zadaný parametr transformátoru na všechny automaticky zjištěné Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1275">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="ba1ea-1276">Parametr transformer transformuje segmenty názvů složek a souborů tras Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1276">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="ba1ea-1277">Další informace naleznete [v tématu Použití transformátoru parametrů k přizpůsobení tras stránek](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1277">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="ba1ea-1278">Odkaz na generování adresy URL</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1278">URL generation reference</span></span>

<span data-ttu-id="ba1ea-1279">Následující příklad ukazuje, jak vygenerovat propojení s trasou danou <xref:Microsoft.AspNetCore.Routing.RouteCollection>slovníkem hodnot trasy a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1279">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="ba1ea-1280">Generované <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> na konci předchozího vzorku je `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1280">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="ba1ea-1281">Slovník poskytuje hodnoty `operation` trasy `id` a v šabloně "Track `package/{operation}/{id}`Package Route" .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1281">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="ba1ea-1282">Podrobnosti naleznete v ukázkovém kódu v části [Use Routing Middleware](#use-routing-middleware) nebo v [ukázkové aplikaci](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1282">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="ba1ea-1283">Druhý parametr konstruktoru <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> je kolekce *okolních hodnot*.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1283">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="ba1ea-1284">Okolní hodnoty jsou vhodné použít, protože omezují počet hodnot, které musí vývojář zadat v kontextu požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1284">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="ba1ea-1285">Aktuální hodnoty trasy aktuálního požadavku jsou považovány za okolní hodnoty pro generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1285">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="ba1ea-1286">V ASP.NET `About` akce aplikace Core MVC `HomeController`aplikace , není nutné zadat hodnotu trasy `Index` kontroléru pro propojení s akcí,&mdash;která `Home` se používá okolní hodnota.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1286">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="ba1ea-1287">Hodnoty okolí, které neodpovídají parametru, jsou ignorovány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1287">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="ba1ea-1288">Okolní hodnoty jsou také ignorovány, když explicitně zadaný hodnota přepíše hodnotu okolí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1288">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="ba1ea-1289">Párování probíhá zleva doprava v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1289">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="ba1ea-1290">Hodnoty explicitně zadaných, ale které neodpovídají segmentu trasy, jsou přidány do řetězce dotazu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1290">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="ba1ea-1291">V následující tabulce je uveden výsledek `{controller}/{action}/{id?}`při použití šablony trasy .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1291">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="ba1ea-1292">Okolní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1292">Ambient Values</span></span>                     | <span data-ttu-id="ba1ea-1293">Explicitní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1293">Explicit Values</span></span>                        | <span data-ttu-id="ba1ea-1294">Výsledek</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1294">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="ba1ea-1295">regulátor = "Domů"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1295">controller = "Home"</span></span>                | <span data-ttu-id="ba1ea-1296">akce = "O"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1296">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ba1ea-1297">regulátor = "Domů"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1297">controller = "Home"</span></span>                | <span data-ttu-id="ba1ea-1298">controller = "Objednávka", akce = "O"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1298">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="ba1ea-1299">regulátor = "Domů", barva = "Červená"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1299">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="ba1ea-1300">akce = "O"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1300">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ba1ea-1301">regulátor = "Domů"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1301">controller = "Home"</span></span>                | <span data-ttu-id="ba1ea-1302">akce = "O", barva = "Červená"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1302">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="ba1ea-1303">Pokud má trasa výchozí hodnotu, která neodpovídá parametru, a tato hodnota je explicitně poskytnuta, musí odpovídat výchozí hodnotě:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1303">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="ba1ea-1304">Generování propojení generuje propojení pouze pro tuto trasu, pokud jsou k dispozici odpovídající hodnoty pro `controller` a `action` jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1304">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="ba1ea-1305">Složité segmenty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1305">Complex segments</span></span>

<span data-ttu-id="ba1ea-1306">Složité segmenty (například) `[Route("/x{token}y")]`jsou zpracovány porovnáním literály zprava doleva nechamtivým způsobem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1306">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="ba1ea-1307">Podrobné vysvětlení, jak jsou složité segmenty spárovány, naleznete v [tomto kódu.](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1307">See [this code](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="ba1ea-1308">[Ukázka kódu](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) není používán ASP.NET Core, ale poskytuje dobré vysvětlení složitých segmentů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1308">The [code sample](https://github.com/dotnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/dotnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="ba1ea-1309">Směrování je zodpovědný za mapování požadavků NA IDENTIFIKÁTORY URI na obslužné rutiny trasy a odeslání příchozích požadavků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1309">Routing is responsible for mapping request URIs to route handlers and dispatching an incoming requests.</span></span> <span data-ttu-id="ba1ea-1310">Trasy jsou definovány v aplikaci a nakonfigurovány při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1310">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="ba1ea-1311">Trasa může volitelně extrahovat hodnoty z adresy URL obsažené v požadavku a tyto hodnoty lze pak použít pro zpracování požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1311">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="ba1ea-1312">Pomocí nakonfigurovaných tras z aplikace je směrování schopno generovat adresy URL, které se mapují na obslužné rutiny trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1312">Using configured routes from the app, routing is able to generate URLs that map to route handlers.</span></span>

<span data-ttu-id="ba1ea-1313">Chcete-li použít nejnovější scénáře směrování v ASP.NET jádrem 2.1, zadejte [verzi kompatibility](xref:mvc/compatibility-version) s registrací služeb MVC v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1313">To use the latest routing scenarios in ASP.NET Core 2.1, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
```

> [!IMPORTANT]
> <span data-ttu-id="ba1ea-1314">Tento dokument se týká nízkoúrovňového ASP.NET směrování Jádra.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1314">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="ba1ea-1315">Informace o směrování Core MVC <xref:mvc/controllers/routing>ASP.NET naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1315">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="ba1ea-1316">Informace o konvencích směrování <xref:razor-pages/razor-pages-conventions>v nástroji Razor Pages naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1316">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ba1ea-1317">[Zobrazit nebo stáhnout ukázkový kód](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) [(jak stáhnout)](xref:index#how-to-download-a-sample)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1317">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="ba1ea-1318">Základy směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1318">Routing basics</span></span>

<span data-ttu-id="ba1ea-1319">Většina aplikací by měla zvolit základní a popisné schéma směrování, aby byly adresy URL čitelné a smysluplné.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1319">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="ba1ea-1320">Výchozí konvenční `{controller=Home}/{action=Index}/{id?}`trasa :</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1320">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="ba1ea-1321">Podporuje základní a popisné schéma směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1321">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="ba1ea-1322">Je užitečným výchozím bodem pro aplikace založené na uznatého.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1322">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="ba1ea-1323">Vývojáři obvykle přidávají další trasy do oblastí s vysokým provozem aplikace ve specializovaných situacích (například koncové body blogu a elektronického obchodu) pomocí [směrování atributů](xref:mvc/controllers/routing#attribute-routing) nebo vyhrazených konvenčních tras.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1323">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="ba1ea-1324">Webová api by měla používat směrování atributů k modelování funkčnosti aplikace jako sadu prostředků, kde jsou operace reprezentovány slovesy HTTP.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1324">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="ba1ea-1325">To znamená, že mnoho operací (například GET, POST) na stejném logickém prostředku bude používat stejnou adresu URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1325">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="ba1ea-1326">Směrování atributů poskytuje úroveň řízení, která je potřeba pečlivě navrhnout rozložení veřejného koncového bodu rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1326">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="ba1ea-1327">Aplikace Razor Pages používají výchozí konvenční směrování k zobrazování pojmenovaných prostředků ve složce *Stránky* aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1327">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="ba1ea-1328">K dispozici jsou další konvence, které umožňují přizpůsobit chování směrování Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1328">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="ba1ea-1329">Další informace naleznete v tématech <xref:razor-pages/index> a <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1329">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ba1ea-1330">Podpora generování adres URL umožňuje aplikaci vyvíjet bez pevných kódovacích adres URL, které aplikaci spojují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1330">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="ba1ea-1331">Tato podpora umožňuje začít s základní konfiguraci směrování a úpravy tras po určení rozložení prostředků aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1331">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="ba1ea-1332">Směrování používá implementace <xref:Microsoft.AspNetCore.Routing.IRouter> postupů:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1332">Routing uses routes implementations of <xref:Microsoft.AspNetCore.Routing.IRouter> to:</span></span>

* <span data-ttu-id="ba1ea-1333">Mapuje příchozí požadavky na *obslužné rutiny*trasy .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1333">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="ba1ea-1334">Vygenerujte adresy URL použité v odpovědích.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1334">Generate the URLs used in responses.</span></span>

<span data-ttu-id="ba1ea-1335">Ve výchozím nastavení má aplikace jednu kolekci tras.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1335">By default, an app has a single collection of routes.</span></span> <span data-ttu-id="ba1ea-1336">Při doručení požadavku jsou trasy v kolekci zpracovány v pořadí, v jakém existují v kolekci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1336">When a request arrives, the routes in the collection are processed in the order that they exist in the collection.</span></span> <span data-ttu-id="ba1ea-1337">Rozhraní framework se pokusí porovnat adresu URL příchozího požadavku s <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> postupem v kolekci voláním metody na každé trase v kolekci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1337">The framework attempts to match an incoming request URL to a route in the collection by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in the collection.</span></span> <span data-ttu-id="ba1ea-1338">Odpověď může použít směrování ke generování adres URL (například pro přesměrování nebo propojení) na základě informací o postupu a vyhnout se tak pevně zakódovaným adresám URL, což pomáhá udržovatelnost.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1338">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>

<span data-ttu-id="ba1ea-1339">Systém směrování má následující charakteristiky:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1339">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="ba1ea-1340">Syntaxe šablony trasy se používá k definování tras s tokenizovanými parametry trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1340">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="ba1ea-1341">Konfigurace koncového bodu konvenčního stylu a atributu je povolena.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1341">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="ba1ea-1342"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint>se používá k určení, zda parametr URL obsahuje platnou hodnotu pro dané omezení koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1342"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="ba1ea-1343">Modely aplikací, jako jsou stránky MVC/Razor, registrují všechny jejich trasy, které mají předvídatelnou implementaci scénářů směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1343">App models, such as MVC/Razor Pages, register all of their routes, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="ba1ea-1344">Odpověď může použít směrování ke generování adres URL (například pro přesměrování nebo propojení) na základě informací o postupu a vyhnout se tak pevně zakódovaným adresám URL, což pomáhá udržovatelnost.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1344">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="ba1ea-1345">Generování adresy URL je založeno na trasách, které podporují libovolnou rozšiřitelnost.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1345">URL generation is based on routes, which support arbitrary extensibility.</span></span> <span data-ttu-id="ba1ea-1346"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper>nabízí metody vytváření adres URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1346"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>
<!-- fix [middleware](xref:fundamentals/middleware/index) -->
<span data-ttu-id="ba1ea-1347">Směrování je připojeno k [middlewarovému](xref:fundamentals/middleware/index) kanálu třídou. <xref:Microsoft.AspNetCore.Builder.RouterMiddleware></span><span class="sxs-lookup"><span data-stu-id="ba1ea-1347">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="ba1ea-1348">[ASP.NET Core MVC](xref:mvc/overview) přidává směrování do middlewarového kanálu jako součást své konfigurace a zpracovává směrování v aplikacích MVC a Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1348">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="ba1ea-1349">Informace o tom, jak používat směrování jako samostatnou součást, naleznete v části [Použití middlewaru směrování.](#use-routing-middleware)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1349">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="ba1ea-1350">Párování adres URL</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1350">URL matching</span></span>

<span data-ttu-id="ba1ea-1351">Porovnávání adres URL je proces, kterým směrování odešle příchozí požadavek na *obslužnou rutinu*.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1351">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="ba1ea-1352">Tento proces je založen na datech v cestě url, ale může být rozšířen tak, aby zvážil všechna data v požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1352">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="ba1ea-1353">Možnost odesílat požadavky na samostatné obslužné rutiny je klíčem k škálování velikosti a složitosti aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1353">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="ba1ea-1354">Příchozí požadavky zadají <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, který <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> volá metodu na každé trase v pořadí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1354">Incoming requests enter the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="ba1ea-1355">Instance <xref:Microsoft.AspNetCore.Routing.IRouter> zvolí, zda *zpracovat* požadavek nastavením [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) <xref:Microsoft.AspNetCore.Http.RequestDelegate>na non-null .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1355">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="ba1ea-1356">Pokud trasa nastaví obslužnou rutinu pro požadavek, zpracování trasy se zastaví a obslužná rutina je vyvolána ke zpracování požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1356">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="ba1ea-1357">Pokud není nalezena žádná obslužná rutina trasy pro zpracování požadavku, middleware předá požadavek na další middleware v kanálu požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1357">If no route handler is found to process the request, the middleware hands the request off to the next middleware in the request pipeline.</span></span>

<span data-ttu-id="ba1ea-1358">Primární vstup <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> do je [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) spojené s aktuální požadavek.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1358">The primary input to <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="ba1ea-1359">[RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) a [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) jsou výstupy nastavené po shody trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1359">The [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route is matched.</span></span>

<span data-ttu-id="ba1ea-1360">Shoda, která <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> volá také nastaví vlastnosti [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) na příslušné hodnoty na základě zpracování požadavku provedeného tak daleko.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1360">A match that calls <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> also sets the properties of the [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="ba1ea-1361">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) je slovník *hodnot trasy* vytvořených z trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1361">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="ba1ea-1362">Tyto hodnoty jsou obvykle určeny tokenizací adresy URL a lze je použít k přijetí vstupu uživatele nebo k dalším rozhodnutím o odesílání uvnitř aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1362">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="ba1ea-1363">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) je vlastnost taška další chdatné trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1363">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="ba1ea-1364"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*>jsou k dispozici pro podporu asociace dat stavu s každou trasu tak, aby aplikace může rozhodovat na základě které trasy uzavřeno.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1364"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="ba1ea-1365">Tyto hodnoty jsou definovány vývojářem a žádným způsobem **neovlivňují** chování směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1365">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="ba1ea-1366">Navíc hodnoty ukrytýv [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) může být libovolného typu, na rozdíl od [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), které musí být převoditelné do a z řetězců.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1366">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="ba1ea-1367">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) je seznam tras, které se podílely na úspěšném porovnání požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1367">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="ba1ea-1368">Trasy mohou být vnořeny uvnitř sebe.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1368">Routes can be nested inside of one another.</span></span> <span data-ttu-id="ba1ea-1369">Vlastnost <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> odráží cestu přes logický strom tras, které vedly ke shodě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1369">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="ba1ea-1370">Obecně platí, že <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> první položka v je kolekce tras a by měla být použita pro generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1370">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="ba1ea-1371">Poslední položka <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> v je obslužná rutina postupu, která odpovídá.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1371">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation"></a><span data-ttu-id="ba1ea-1372">Generování adresy URL</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1372">URL generation</span></span>

<span data-ttu-id="ba1ea-1373">Generování adresy URL je proces, kterým může směrování vytvořit cestu URL na základě sady hodnot trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1373">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="ba1ea-1374">To umožňuje logické oddělení mezi obslužnými rutinami trasy a adresy URL, které k nim přistupují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1374">This allows for a logical separation between route handlers and the URLs that access them.</span></span>

<span data-ttu-id="ba1ea-1375">Generování adres URL následuje podobný iterativní proces, ale začíná voláním uživatelského nebo rámcového kódu do <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> metody kolekce tras.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1375">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="ba1ea-1376">Každá *trasa* má svou <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> metodu volánou postupně, dokud není vrácena hodnota non-null. <xref:Microsoft.AspNetCore.Routing.VirtualPathData></span><span class="sxs-lookup"><span data-stu-id="ba1ea-1376">Each *route* has its <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="ba1ea-1377">Primární vstupy <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> jsou:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1377">The primary inputs to <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> are:</span></span>

* [<span data-ttu-id="ba1ea-1378">VirtualPathContext.httpContext</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1378">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext)
* [<span data-ttu-id="ba1ea-1379">VirtualPathContext.Values</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1379">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values)
* [<span data-ttu-id="ba1ea-1380">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1380">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues)

<span data-ttu-id="ba1ea-1381">Trasy primárně používají hodnoty trasy <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> poskytnuté <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> a rozhodnout, zda je možné generovat adresu URL a jaké hodnoty zahrnout.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1381">Routes primarily use the route values provided by <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> and <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="ba1ea-1382">Jsou <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> sada hodnot postupu, které byly vytvořeny z odpovídající aktuální požadavek.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1382">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> are the set of route values that were produced from matching the current request.</span></span> <span data-ttu-id="ba1ea-1383">Naopak jsou <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> hodnoty trasy, které určují, jak generovat požadovanou adresu URL pro aktuální operaci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1383">In contrast, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="ba1ea-1384">Poskytuje <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> se v případě, že by trasa měla získat služby nebo další údaje spojené s aktuálním kontextem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1384">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> is provided in case a route should obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="ba1ea-1385">Představte si [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) jako sadu přepsání pro [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1385">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="ba1ea-1386">Generování adresy URL se pokouší znovu použít hodnoty trasy z aktuálního požadavku ke generování adres URL pro propojení pomocí stejných hodnot trasy nebo trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1386">URL generation attempts to reuse route values from the current request to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="ba1ea-1387">Výstup <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> je <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1387">The output of <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is a <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span></span> <span data-ttu-id="ba1ea-1388"><xref:Microsoft.AspNetCore.Routing.VirtualPathData>je paralelou <xref:Microsoft.AspNetCore.Routing.RouteData>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1388"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> is a parallel of <xref:Microsoft.AspNetCore.Routing.RouteData>.</span></span> <span data-ttu-id="ba1ea-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData>obsahuje <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> pro výstupní adresu URL a některé další vlastnosti, které by měly být nastaveny podle trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contains the <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="ba1ea-1390">Vlastnost [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) obsahuje *virtuální cestu* vytvořenou trasou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1390">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="ba1ea-1391">V závislosti na vašich potřebách může být nutné cestu dále zpracovat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1391">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="ba1ea-1392">Pokud chcete vykreslit vygenerovanou adresu URL v HTML, předložte základní cestu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1392">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="ba1ea-1393">[VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) je odkaz na trasu, která úspěšně vygenerovala adresu URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1393">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="ba1ea-1394">Vlastnosti [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) jsou slovníkem dalších dat souvisejících s postupem, který vygeneroval adresu URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1394">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="ba1ea-1395">Toto je paralela [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1395">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="create-routes"></a><span data-ttu-id="ba1ea-1396">Vytvoření tras</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1396">Create routes</span></span>

<span data-ttu-id="ba1ea-1397">Směrování poskytuje <xref:Microsoft.AspNetCore.Routing.Route> třídu jako <xref:Microsoft.AspNetCore.Routing.IRouter>standardní implementaci .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1397">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="ba1ea-1398"><xref:Microsoft.AspNetCore.Routing.Route>Používá syntaxi *šablony trasy* k definování vzorů tak, aby odpovídaly cestě URL při <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> volání.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1398"><xref:Microsoft.AspNetCore.Routing.Route> uses the *route template* syntax to define patterns to match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="ba1ea-1399"><xref:Microsoft.AspNetCore.Routing.Route>používá stejnou šablonu trasy ke <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> generování adresy URL při volání.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1399"><xref:Microsoft.AspNetCore.Routing.Route> uses the same route template to generate a URL when <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is called.</span></span>

<span data-ttu-id="ba1ea-1400">Většina aplikací vytváří <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> trasy voláním nebo jednou <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>z podobných metod rozšíření definovaných na .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1400">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="ba1ea-1401">Všechny metody <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> rozšíření vytvořit instanci <xref:Microsoft.AspNetCore.Routing.Route> a přidat do kolekce tras.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1401">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="ba1ea-1402"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>nepřijímá parametr obslužné rutiny trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1402"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="ba1ea-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*>přidá pouze trasy, které <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>jsou zpracovány .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="ba1ea-1404">Výchozí obslužná rutina `IRouter`je a obslužná rutina nemusí požadavek zpracovat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1404">The default handler is an `IRouter`, and the handler might not handle the request.</span></span> <span data-ttu-id="ba1ea-1405">Například ASP.NET Core MVC je obvykle nakonfigurován jako výchozí obslužná rutina, která zpracovává pouze požadavky, které odpovídají dostupnému řadiči a akci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1405">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="ba1ea-1406">Další informace o směrování v MVC naleznete v tématu <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1406">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="ba1ea-1407">Následující příklad kódu je příkladem <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> volání používaného typickou ASP.NET definici trasy Core MVC:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1407">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ba1ea-1408">Tato šablona odpovídá cestě URL a extrahuje hodnoty trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1408">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="ba1ea-1409">Cesta například `/Products/Details/17` generuje následující hodnoty trasy: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1409">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="ba1ea-1410">Hodnoty trasy jsou určeny rozdělením cesty URL do segmentů a porovnáním každého segmentu s názvem *parametru trasy* v šabloně trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1410">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="ba1ea-1411">Parametry trasy jsou pojmenovány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1411">Route parameters are named.</span></span> <span data-ttu-id="ba1ea-1412">Parametry definované uzavřením názvu parametru `{ ... }`do složených závorek .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1412">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="ba1ea-1413">Předchozí šablona může také odpovídat cestě `/` `{ controller = Home, action = Index }`URL a vytvářet hodnoty .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1413">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="ba1ea-1414">K tomu `{controller}` dochází, `{action}` protože parametry a `id` a mají výchozí hodnoty a parametr trasy je volitelný.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1414">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="ba1ea-1415">Znaménko`=`rovná se ( ) následované hodnotou za názvem parametru trasy definuje výchozí hodnotu parametru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1415">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="ba1ea-1416">Otazník`?`( ) za názvem parametru trasy definuje volitelný parametr.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1416">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="ba1ea-1417">Parametry trasy s výchozí hodnotou *vždy* vytvoří hodnotu trasy, když se trasa shoduje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1417">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="ba1ea-1418">Volitelné parametry nevytvářejí hodnotu trasy, pokud neexistuje odpovídající segment cesty URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1418">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="ba1ea-1419">V části [Odkaz na šablonu trasy](#route-template-reference) naleznete důkladný popis scénářů a syntaxe šablony trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1419">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="ba1ea-1420">V následujícím příkladu definuje `{id:int}` definice parametru trasy `id` omezení [trasy](#route-constraint-reference) pro parametr trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1420">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="ba1ea-1421">Tato šablona odpovídá `/Products/Details/17` cestě `/Products/Details/Apples`URL, jako je, ale ne .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1421">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="ba1ea-1422">Omezení trasy <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementují a kontrolují hodnoty postupu, abyste je ověřili.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1422">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="ba1ea-1423">V tomto příkladu `id` musí být hodnota trasy převoditelná na celé číslo.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1423">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="ba1ea-1424">Viz [odkaz na omezení trasy](#route-constraint-reference) pro vysvětlení omezení postupu poskytované rámcem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1424">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="ba1ea-1425">Další přetížení <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> hodnot accept `constraints` `dataTokens`pro `defaults`, a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1425">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="ba1ea-1426">Typické použití těchto parametrů je předat anonymně zadaný objekt, kde názvy vlastností anonymní typ odpovídají názvům parametrů postupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1426">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="ba1ea-1427">Následující <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> příklady vytvářejí ekvivalentní trasy:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1427">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="ba1ea-1428">Vložková syntaxe pro definování omezení a výchozích hodnot může být vhodná pro jednoduché trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1428">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="ba1ea-1429">Existují však scénáře, jako jsou datové tokeny, které nejsou podporovány vložená syntaxe.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1429">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="ba1ea-1430">Následující příklad ukazuje několik dalších scénářů:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1430">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="ba1ea-1431">Předchozí šablona odpovídá cestě `/Blog/All-About-Routing/Introduction` URL jako a `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`extrahuje hodnoty .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1431">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="ba1ea-1432">Výchozí hodnoty postupu `controller` `action` a jsou vytvořeny postupem, i když v šabloně nejsou žádné odpovídající parametry trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1432">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="ba1ea-1433">Výchozí hodnoty lze zadat v šabloně postupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1433">Default values can be specified in the route template.</span></span> <span data-ttu-id="ba1ea-1434">Parametr `article` trasy je definován jako *catch-all* vzhledem hvězdičky`*`( ) před názvem parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1434">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk (`*`) before the route parameter name.</span></span> <span data-ttu-id="ba1ea-1435">Catch-all parametry trasy zachytit zbytek cesty URL a může také odpovídat prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1435">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="ba1ea-1436">Následující příklad přidá omezení trasy a datové tokeny:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1436">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="ba1ea-1437">Předchozí šablona odpovídá cestě `/en-US/Products/5` URL jako a `{ controller = Products, action = Details, id = 5 }` extrahuje `{ locale = en-US }`hodnoty a datové tokeny .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1437">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Místní Windows tokeny](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="ba1ea-1439">Generování adresy URL třídy trasy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1439">Route class URL generation</span></span>

<span data-ttu-id="ba1ea-1440">Třída <xref:Microsoft.AspNetCore.Routing.Route> může také provádět generování adres URL kombinací sady hodnot trasy se šablonou trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1440">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="ba1ea-1441">Toto je logicky opačný proces odpovídající cestě URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1441">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="ba1ea-1442">Chcete-li lépe porozumět generování adresy URL, představte si, jakou adresu URL chcete vygenerovat, a pak přemýšlejte o tom, jak by šablona trasy odpovídala této adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1442">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="ba1ea-1443">Jaké hodnoty by byly vyrobeny?</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1443">What values would be produced?</span></span> <span data-ttu-id="ba1ea-1444">Toto je hrubý ekvivalent, jak <xref:Microsoft.AspNetCore.Routing.Route> funguje generování adresy URL ve třídě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1444">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="ba1ea-1445">Následující příklad používá obecnou výchozí trasu ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1445">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ba1ea-1446">S hodnotami `{ controller = Products, action = List }`trasy `/Products/List` je generována adresa URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1446">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="ba1ea-1447">Hodnoty trasy jsou nahrazeny odpovídajícími parametry trasy a tvoří cestu URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1447">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="ba1ea-1448">Vzhledem k tomu, `id` že je volitelný parametr trasy, `id`je adresa URL úspěšně generována bez hodnoty pro .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1448">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="ba1ea-1449">S hodnotami `{ controller = Home, action = Index }`trasy `/` je generována adresa URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1449">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="ba1ea-1450">Zakalené hodnoty trasy odpovídají výchozím hodnotám a segmenty odpovídající výchozím hodnotám jsou bezpečně vynechány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1450">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="ba1ea-1451">Obě adresy URL generované round-trip s následující`/Home/Index` `/`definicí trasy ( a ) vytvářejí stejné hodnoty trasy, které byly použity ke generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1451">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="ba1ea-1452">Aplikace využívající ASP.NET Core MVC by měla používat <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> ke generování adres URL namísto volání do směrování přímo.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1452">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="ba1ea-1453">Další informace o generování adres URL naleznete v části odkaz na [generování adres URL.](#url-generation-reference)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1453">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="ba1ea-1454">Použití middlewaru směrování</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1454">Use routing middleware</span></span>

<span data-ttu-id="ba1ea-1455">Odkaz na [metabalíček Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) v souboru projektu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1455">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="ba1ea-1456">Přidání směrování do servisního kontejneru v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1456">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="ba1ea-1457">Trasy musí být konfigurovány v metodě. `Startup.Configure`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1457">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="ba1ea-1458">Ukázková aplikace používá následující api:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1458">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="ba1ea-1459"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>&ndash; Odpovídá pouze požadavkům HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1459"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="ba1ea-1460">V následující tabulce jsou uvedeny odpovědi s danými identifikátory URI.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1460">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="ba1ea-1461">Identifikátor URI</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1461">URI</span></span>                    | <span data-ttu-id="ba1ea-1462">Odpověď</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1462">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="ba1ea-1463">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1463">Hello!</span></span> <span data-ttu-id="ba1ea-1464">Hodnoty postupu: [operace, vytvoření], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1464">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="ba1ea-1465">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1465">Hello!</span></span> <span data-ttu-id="ba1ea-1466">Hodnoty trasy: [provoz, trať], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1466">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="ba1ea-1467">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1467">Hello!</span></span> <span data-ttu-id="ba1ea-1468">Hodnoty trasy: [provoz, trať], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1468">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="ba1ea-1469">Žádost neprojde, žádná shoda.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1469">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="ba1ea-1470">Ahoj, Joe!</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1470">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="ba1ea-1471">Požadavek spadá přes, odpovídá pouze HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1471">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="ba1ea-1472">Žádost neprojde, žádná shoda.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1472">The request falls through, no match.</span></span>              |

<span data-ttu-id="ba1ea-1473">Pokud konfigurujete jednu <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> trasu, volání předávání v instanci. `IRouter`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1473">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="ba1ea-1474">Nebudete muset používat <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1474">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="ba1ea-1475">Rámec poskytuje sadu rozšiřujících metod pro<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>vytváření tras ( ):</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1475">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="ba1ea-1476">Některé z uvedených <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>metod, <xref:Microsoft.AspNetCore.Http.RequestDelegate>například , vyžadují .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1476">Some of listed methods, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, require a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="ba1ea-1477">Používá <xref:Microsoft.AspNetCore.Http.RequestDelegate> se jako *obslužná rutina postupu,* když se trasa shoduje.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1477">The <xref:Microsoft.AspNetCore.Http.RequestDelegate> is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="ba1ea-1478">Jiné metody v této rodině umožňují konfiguraci kanálu middlewaru pro použití jako obslužná rutina trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1478">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="ba1ea-1479">Pokud `Map*` metoda nepřijímá obslužnou <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>rutinu, <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>například , používá .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1479">If the `Map*` method doesn't accept a handler, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="ba1ea-1480">Metody `Map[Verb]` používají omezení k omezení trasy na sloveso HTTP v názvu metody.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1480">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="ba1ea-1481">Viz například <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1481">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="ba1ea-1482">Odkaz na šablonu trasy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1482">Route template reference</span></span>

<span data-ttu-id="ba1ea-1483">Tokeny v rámci složených závorek (`{ ... }`) definují parametry trasy, které jsou *vázány,* pokud je trasa spárována.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1483">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="ba1ea-1484">V segmentu trasy můžete definovat více než jeden parametr trasy, ale musí být odděleny hodnotou literálu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1484">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="ba1ea-1485">Například `{controller=Home}{action=Index}` není platná trasa, protože neexistuje žádná hodnota `{controller}` literálu mezi a `{action}`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1485">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="ba1ea-1486">Tyto parametry trasy musí mít název a mohou mít další atributy zadané.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1486">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="ba1ea-1487">Doslovný text jiný než parametry `{id}`trasy (například) a oddělovač `/` cesty se musí shodovat s textem v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1487">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="ba1ea-1488">Porovnávání textu nerozlišuje malá a velká písmena a je založena na dekódované reprezentaci cesty url.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1488">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="ba1ea-1489">Chcete-li porovnat oddělovač parametrů`{` `}`oddělovač parametrů doslovné trasy`{{` `}}`( nebo ), unikne oddělovači opakováním znaku ( nebo ).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1489">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="ba1ea-1490">Další důležité informace mají vzory adres URL, které se pokoušejí zachytit název souboru s volitelnou příponou souboru.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1490">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="ba1ea-1491">Zvažte například `files/{filename}.{ext?}`šablonu .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1491">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="ba1ea-1492">Pokud jsou `filename` hodnoty `ext` pro oba a existují, jsou vyplněny obě hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1492">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="ba1ea-1493">Pokud v adrese `filename` URL existuje pouze hodnota pro, trasa`.`se shoduje, protože koncové období ( ) je volitelné.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1493">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="ba1ea-1494">Následující adresy URL odpovídají této trase:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1494">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="ba1ea-1495">Hvězdičku (`*`) můžete použít jako předponu parametru trasy k vytvoření vazby na zbytek identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1495">You can use the asterisk (`*`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="ba1ea-1496">Tento parametr se nazývá *catch-all.*</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1496">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="ba1ea-1497">Například `blog/{*slug}` odpovídá všem identifikátorům `/blog` URI, který začíná a má `slug` za ním libovolnou hodnotu, která je přiřazena hodnotě postupu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1497">For example, `blog/{*slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="ba1ea-1498">Catch-all parametry mohou také odpovídat prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1498">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="ba1ea-1499">Parametr catch-all unikne příslušným znakům, když je trasa použita`/`ke generování adresy URL, včetně znaků oddělovače cest ( ).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1499">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="ba1ea-1500">Například trasa `foo/{*path}` s `{ path = "my/path" }` hodnotami `foo/my%2Fpath`trasy generuje .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1500">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="ba1ea-1501">Všimněte si uvozené lomítko.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1501">Note the escaped forward slash.</span></span>

<span data-ttu-id="ba1ea-1502">Parametry postupu mohou mít *výchozí hodnoty* určené zadáním výchozí hodnoty za názvem`=`parametru odděleným znaménkem rovná se ( ).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1502">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="ba1ea-1503">Definuje například `{controller=Home}` `Home` jako výchozí hodnotu pro `controller`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1503">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="ba1ea-1504">Výchozí hodnota se používá, pokud v adrese URL parametru není žádná hodnota.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1504">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="ba1ea-1505">Parametry trasy jsou volitelné připojením otazníku (`?`) na konec `id?`názvu parametru, jako v .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1505">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="ba1ea-1506">Rozdíl mezi volitelnými hodnotami a výchozími parametry postupu spoá,&mdash;že parametr trasy s výchozí hodnotou vždy vytvoří hodnotu, volitelný parametr má hodnotu pouze v případě, že hodnota je poskytnuta adresou URL požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1506">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="ba1ea-1507">Parametry trasy mohou mít omezení, která musí odpovídat hodnotě trasy vázané z adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1507">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="ba1ea-1508">Přidání dvojtečky (`:`) a názvu omezení za název parametru trasy určuje *vsazené omezení* parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1508">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="ba1ea-1509">Pokud omezení vyžaduje argumenty, jsou uzavřeny v závorcích (`(...)`) za názvem omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1509">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="ba1ea-1510">Vícevřádkových omezení lze zadat připojením`:`jinédvojtečky ( ) a názvu omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1510">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="ba1ea-1511">Název omezení a argumenty jsou <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> předány službě <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> k vytvoření instance pro použití při zpracování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1511">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="ba1ea-1512">Například šablona `blog/{article:minlength(10)}` trasy určuje `minlength` omezení s `10`argumentem .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1512">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="ba1ea-1513">Další informace o omezeních postupu a seznam omezení poskytovaných rámcem naleznete v referenční části [omezení trasy.](#route-constraint-reference)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1513">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="ba1ea-1514">Následující tabulka ukazuje ukázkové šablony tras a jejich chování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1514">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="ba1ea-1515">Šablona postupu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1515">Route Template</span></span>                           | <span data-ttu-id="ba1ea-1516">Příklad odpovídajícího identifikátoru URI</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1516">Example Matching URI</span></span>    | <span data-ttu-id="ba1ea-1517">Identifikátor URI požadavku&hellip;</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1517">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="ba1ea-1518">Odpovídá pouze jedné `/hello`cestě .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1518">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="ba1ea-1519">Odpovídá a `Page` `Home`nastavuje na .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1519">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="ba1ea-1520">Odpovídá a `Page` `Contact`nastavuje na .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1520">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="ba1ea-1521">Mapuje `Products` na `List` ovladač a akci.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1521">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="ba1ea-1522">Mapy k `Products` ovladači `Details` `id` a akci (nastaveno na 123).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1522">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="ba1ea-1523">Mapy na `Home` řadič `Index` a`id` metodu (je ignorována).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1523">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="ba1ea-1524">Použití šablony je obecně nejjednodušší přístup k směrování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1524">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="ba1ea-1525">Omezení a výchozí hodnoty lze zadat také mimo šablonu trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1525">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="ba1ea-1526">Povolte [protokolování,](xref:fundamentals/logging/index) abyste viděli, jak integrované <xref:Microsoft.AspNetCore.Routing.Route>implementace směrování, například , shodu jsou požadavky na shodu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1526">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="ba1ea-1527">Odkaz na omezení postupu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1527">Route constraint reference</span></span>

<span data-ttu-id="ba1ea-1528">Omezení trasy se spustí, když došlo ke shodě s příchozí adresou URL a cesta url je tokenizována na hodnoty trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1528">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="ba1ea-1529">Omezení postupu obvykle kontrolují hodnotu postupu přidruženou prostřednictvím šablony postupu a rozhodují o tom, zda je hodnota přijatelná.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1529">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="ba1ea-1530">Některá omezení postupu používají data mimo hodnotu postupu k posouzení, zda lze požadavek směrovat.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1530">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="ba1ea-1531">Například <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> může přijmout nebo odmítnout požadavek na základě jeho slovesa HTTP.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1531">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="ba1ea-1532">Omezení se používají v požadavcích na směrování a generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1532">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="ba1ea-1533">Nepoužívejte omezení pro **ověření vstupu**.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1533">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="ba1ea-1534">Pokud omezení se používají pro **ověření vstupu**, neplatné vstupní výsledky v *404 - nebyl nalezen* odpověď namísto *400 - chybný požadavek* s příslušnou chybovou zprávu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1534">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="ba1ea-1535">Omezení trasy se používají k **rozdvojení** podobných tras, nikoli k ověření vstupů pro určitou trasu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1535">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="ba1ea-1536">Následující tabulka ukazuje ukázková omezení trasy a jejich očekávané chování.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1536">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="ba1ea-1537">omezení</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1537">constraint</span></span> | <span data-ttu-id="ba1ea-1538">Příklad</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1538">Example</span></span> | <span data-ttu-id="ba1ea-1539">Příklady shod</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1539">Example Matches</span></span> | <span data-ttu-id="ba1ea-1540">Poznámky</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1540">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="ba1ea-1541">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1541">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ba1ea-1542">Shoduje se s libovolným celéčíslo</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1542">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="ba1ea-1543">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1543">`true`, `FALSE`</span></span> | <span data-ttu-id="ba1ea-1544">`true` Shody `false` nebo (malá a velká písmena)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1544">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="ba1ea-1545">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1545">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="ba1ea-1546">Odpovídá platné `DateTime` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1546">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-1547">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1547">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="ba1ea-1548">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1548">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="ba1ea-1549">Odpovídá platné `decimal` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1549">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-1550">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1550">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="ba1ea-1551">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1551">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ba1ea-1552">Odpovídá platné `double` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1552">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-1553">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1553">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="ba1ea-1554">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1554">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ba1ea-1555">Odpovídá platné `float` hodnotě v invariantní jazykové verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1555">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="ba1ea-1556">Viz předchozí upozornění.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1556">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="ba1ea-1557">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1557">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="ba1ea-1558">Odpovídá platné `Guid` hodnotě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1558">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="ba1ea-1559">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1559">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ba1ea-1560">Odpovídá platné `long` hodnotě.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1560">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="ba1ea-1561">Řetězec musí mít alespoň 4 znaky.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1561">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="ba1ea-1562">Řetězec nesmí být větší než 8 znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1562">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="ba1ea-1563">Řetězec musí mít přesně 12 znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1563">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="ba1ea-1564">Řetězec musí mít alespoň 8 a nesmí mít přes 16 znaků.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1564">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="ba1ea-1565">Hodnota celého čísla musí být alespoň 18</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1565">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="ba1ea-1566">Celá hodnota nesmí být větší než 120</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1566">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="ba1ea-1567">Hodnota celého čísla musí být alespoň 18, ale ne větší než 120</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1567">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="ba1ea-1568">Řetězec se musí skládat z`a`-`z`jednoho nebo více abecedních znaků ( , bez rozlišování velkých a malých písmen)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1568">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="ba1ea-1569">Řetězec musí odpovídat regulárnímu výrazu (viz tipy k definování regulárního výrazu)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1569">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="ba1ea-1570">Slouží k vynucení, že hodnota neparametrje přítomna během generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1570">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="ba1ea-1571">Na jeden parametr lze použít více omezení oddělených dvojtečkou.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1571">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="ba1ea-1572">Například následující omezení omezuje parametr na celou hodnotu 1 nebo vyšší:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1572">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="ba1ea-1573">Omezení trasy, která ověřují adresu URL a jsou `int` `DateTime`převedena na typ CLR (například nebo ) vždy používají invariantní jazykovou verzi.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1573">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="ba1ea-1574">Tato omezení předpokládají, že adresu URL je nelokalizovatelné.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1574">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="ba1ea-1575">Omezení trasy poskytovaná rámcem nemění hodnoty uložené v hodnotách trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1575">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="ba1ea-1576">Všechny hodnoty trasy analyzované z adresy URL jsou uloženy jako řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1576">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="ba1ea-1577">Například `float` omezení se pokusí převést hodnotu trasy na float, ale převedená hodnota se používá pouze k ověření, že může být převedena na float.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1577">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="ba1ea-1578">Regulární výrazy</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1578">Regular expressions</span></span>

<span data-ttu-id="ba1ea-1579">Rozhraní ASP.NET Core `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` přidává k konstruktoru regulárního výrazu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1579">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="ba1ea-1580">Viz <xref:System.Text.RegularExpressions.RegexOptions> popis těchto členů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1580">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="ba1ea-1581">Regulární výrazy používají oddělovače a tokeny podobné těm, které používá Směrování a jazyk C#.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1581">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="ba1ea-1582">Tokeny regulárního výrazu musí být uvozeny.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1582">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="ba1ea-1583">Chcete-li použít `^\d{3}-\d{2}-\d{4}$` regulární výraz v `\` směrování, musí mít výraz znaky `\\` (jedno zpětné lomítko) uvedené v řetězci `\` jako (dvojité zpětné lomítko) znaky ve zdrojovém souboru C#, aby se vyhnuly řídicímu znaku řetězce (pokud nepoužijete [doslovné literály řetězce).](/dotnet/csharp/language-reference/keywords/string)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1583">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="ba1ea-1584">Chcete-li uniknout znaky oddělovače`{`parametrů směrování ( , `}` `}`, `[[` `[` `]`), zdvojnásobte znaky ve výrazu (`{{`, , ). `]]`</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1584">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="ba1ea-1585">V následující tabulce je uveden regulární výraz a uvozená verze.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1585">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="ba1ea-1586">Regulární výraz</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1586">Regular Expression</span></span>    | <span data-ttu-id="ba1ea-1587">Uvozené regulární výraz</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1587">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="ba1ea-1588">Regulární výrazy používané při směrování`^`často začínají znakem stříšky ( ) a shodují se s počáteční pozicí řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1588">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="ba1ea-1589">Výrazy často končí znakem`$`dolaru ( ) a shodují se na konci řetězce.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1589">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="ba1ea-1590">Znaky `^` `$` a zajišťují, že regulární výraz odpovídá celé hodnotě parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1590">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="ba1ea-1591">Bez `^` znaků `$` a regulární výraz odpovídá libovolnému podřetězci v řetězci, což je často nežádoucí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1591">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="ba1ea-1592">V následující tabulce jsou uvedeny příklady a vysvětleny, proč se shodují nebo neshodují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1592">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="ba1ea-1593">Expression</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1593">Expression</span></span>   | <span data-ttu-id="ba1ea-1594">Řetězec</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1594">String</span></span>    | <span data-ttu-id="ba1ea-1595">Shoda</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1595">Match</span></span> | <span data-ttu-id="ba1ea-1596">Poznámka</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1596">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-1597">hello</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1597">hello</span></span>     | <span data-ttu-id="ba1ea-1598">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1598">Yes</span></span>   | <span data-ttu-id="ba1ea-1599">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1599">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-1600">123abc456</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1600">123abc456</span></span> | <span data-ttu-id="ba1ea-1601">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1601">Yes</span></span>   | <span data-ttu-id="ba1ea-1602">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1602">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-1603">Mz</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1603">mz</span></span>        | <span data-ttu-id="ba1ea-1604">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1604">Yes</span></span>   | <span data-ttu-id="ba1ea-1605">Odpovídá výrazu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1605">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="ba1ea-1606">MZ</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1606">MZ</span></span>        | <span data-ttu-id="ba1ea-1607">Ano</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1607">Yes</span></span>   | <span data-ttu-id="ba1ea-1608">Neuznačují malá a velká písmen</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1608">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="ba1ea-1609">hello</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1609">hello</span></span>     | <span data-ttu-id="ba1ea-1610">Ne</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1610">No</span></span>    | <span data-ttu-id="ba1ea-1611">Viz `^` `$` a výše</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1611">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="ba1ea-1612">123abc456</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1612">123abc456</span></span> | <span data-ttu-id="ba1ea-1613">Ne</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1613">No</span></span>    | <span data-ttu-id="ba1ea-1614">Viz `^` `$` a výše</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1614">See `^` and `$` above</span></span> |

<span data-ttu-id="ba1ea-1615">Další informace o syntaxi regulárních výrazů naleznete [v tématu .NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1615">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="ba1ea-1616">Chcete-li omezit parametr na známou sadu možných hodnot, použijte regulární výraz.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1616">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="ba1ea-1617">Například `{action:regex(^(list|get|create)$)}` pouze odpovídá `action` hodnotě `list` `get`trasy `create`do , , nebo .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1617">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="ba1ea-1618">Pokud je předán do slovníku `^(list|get|create)$` omezení, řetězec je ekvivalentní.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1618">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="ba1ea-1619">Omezení, která jsou předána ve slovníku omezení (není vnímák v rámci šablony), které neodpovídají jedné ze známých omezení, jsou také považovány za regulární výrazy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1619">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="ba1ea-1620">Vlastní omezení postupu</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1620">Custom Route Constraints</span></span>

<span data-ttu-id="ba1ea-1621">Kromě předdefinovaných omezení trasy lze implementací <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> rozhraní vytvořit omezení vlastní trasy.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1621">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="ba1ea-1622">Rozhraní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> obsahuje jednu `Match`metodu `true` , která vrátí, `false` pokud je splněna omezení a jinak.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1622">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="ba1ea-1623">Chcete-li <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>použít vlastní , musí být typ omezení <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> postupu registrován u aplikace v kontejneru služeb aplikace.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1623">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="ba1ea-1624">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> je slovník, který mapuje <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> klíče omezení trasy na implementace, které tato omezení ověřují.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1624">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="ba1ea-1625">Aplikace <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> lze aktualizovat buď `Startup.ConfigureServices` jako součást [služby. AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) volání nebo <xref:Microsoft.AspNetCore.Routing.RouteOptions> konfigurací `services.Configure<RouteOptions>`přímo s .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1625">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="ba1ea-1626">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1626">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="ba1ea-1627">Omezení pak lze použít na trasy obvyklým způsobem pomocí názvu určeného při registraci typu omezení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1627">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="ba1ea-1628">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1628">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="url-generation-reference"></a><span data-ttu-id="ba1ea-1629">Odkaz na generování adresy URL</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1629">URL generation reference</span></span>

<span data-ttu-id="ba1ea-1630">Následující příklad ukazuje, jak vygenerovat propojení s trasou danou <xref:Microsoft.AspNetCore.Routing.RouteCollection>slovníkem hodnot trasy a .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1630">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="ba1ea-1631">Generované <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> na konci předchozího vzorku je `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1631">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="ba1ea-1632">Slovník poskytuje hodnoty `operation` trasy `id` a v šabloně "Track `package/{operation}/{id}`Package Route" .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1632">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="ba1ea-1633">Podrobnosti naleznete v ukázkovém kódu v části [Use Routing Middleware](#use-routing-middleware) nebo v [ukázkové aplikaci](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1633">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="ba1ea-1634">Druhý parametr konstruktoru <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> je kolekce *okolních hodnot*.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1634">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="ba1ea-1635">Okolní hodnoty jsou vhodné použít, protože omezují počet hodnot, které musí vývojář zadat v kontextu požadavku.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1635">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="ba1ea-1636">Aktuální hodnoty trasy aktuálního požadavku jsou považovány za okolní hodnoty pro generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1636">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="ba1ea-1637">V ASP.NET `About` akce aplikace Core MVC `HomeController`aplikace , není nutné zadat hodnotu trasy `Index` kontroléru pro propojení s akcí,&mdash;která `Home` se používá okolní hodnota.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1637">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="ba1ea-1638">Hodnoty okolí, které neodpovídají parametru, jsou ignorovány.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1638">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="ba1ea-1639">Okolní hodnoty jsou také ignorovány, když explicitně zadaný hodnota přepíše hodnotu okolí.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1639">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="ba1ea-1640">Párování probíhá zleva doprava v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1640">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="ba1ea-1641">Hodnoty explicitně zadaných, ale které neodpovídají segmentu trasy, jsou přidány do řetězce dotazu.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1641">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="ba1ea-1642">V následující tabulce je uveden výsledek `{controller}/{action}/{id?}`při použití šablony trasy .</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1642">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="ba1ea-1643">Okolní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1643">Ambient Values</span></span>                     | <span data-ttu-id="ba1ea-1644">Explicitní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1644">Explicit Values</span></span>                        | <span data-ttu-id="ba1ea-1645">Výsledek</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1645">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="ba1ea-1646">regulátor = "Domů"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1646">controller = "Home"</span></span>                | <span data-ttu-id="ba1ea-1647">akce = "O"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1647">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ba1ea-1648">regulátor = "Domů"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1648">controller = "Home"</span></span>                | <span data-ttu-id="ba1ea-1649">controller = "Objednávka", akce = "O"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1649">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="ba1ea-1650">regulátor = "Domů", barva = "Červená"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1650">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="ba1ea-1651">akce = "O"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1651">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ba1ea-1652">regulátor = "Domů"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1652">controller = "Home"</span></span>                | <span data-ttu-id="ba1ea-1653">akce = "O", barva = "Červená"</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1653">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="ba1ea-1654">Pokud má trasa výchozí hodnotu, která neodpovídá parametru, a tato hodnota je explicitně poskytnuta, musí odpovídat výchozí hodnotě:</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1654">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="ba1ea-1655">Generování propojení generuje propojení pouze pro tuto trasu, pokud jsou k dispozici odpovídající hodnoty pro `controller` a `action` jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1655">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="ba1ea-1656">Složité segmenty</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1656">Complex segments</span></span>

<span data-ttu-id="ba1ea-1657">Složité segmenty (například) `[Route("/x{token}y")]`jsou zpracovány porovnáním literály zprava doleva nechamtivým způsobem.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1657">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="ba1ea-1658">Podrobné vysvětlení, jak jsou složité segmenty spárovány, naleznete v [tomto kódu.](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293)</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1658">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="ba1ea-1659">[Ukázka kódu](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) není používán ASP.NET Core, ale poskytuje dobré vysvětlení složitých segmentů.</span><span class="sxs-lookup"><span data-stu-id="ba1ea-1659">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>

::: moniker-end
