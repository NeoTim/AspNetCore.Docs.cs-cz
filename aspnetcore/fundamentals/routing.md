---
title: Směrování v ASP.NET Core
author: rick-anderson
description: Seznamte se s tím, jak ASP.NET Core směrování zodpovídá za mapování identifikátorů URI požadavků na selektory koncových bodů a odesílání příchozích požadavků do koncových bodů.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 09/24/2019
uid: fundamentals/routing
ms.openlocfilehash: be4493cc927bd5437a2c9dab00b6a555756195bb
ms.sourcegitcommit: eb2fe5ad2e82fab86ca952463af8d017ba659b25
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/01/2019
ms.locfileid: "73416139"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="ee8de-103">Směrování v ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="ee8de-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="ee8de-104">Pomocí nástroje [Ryan Nowak](https://github.com/rynowak), [Steve Smith](https://ardalis.com/)a [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="ee8de-104">By [Ryan Nowak](https://github.com/rynowak), [Steve Smith](https://ardalis.com/), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="ee8de-105">Směrování zodpovídá za mapování identifikátorů URI požadavků na koncové body a odesílání příchozích požadavků do těchto koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-105">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="ee8de-106">Trasy jsou v aplikaci definované a nakonfigurované při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-106">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="ee8de-107">Trasa může volitelně extrahovat hodnoty z adresy URL obsažené v žádosti a tyto hodnoty pak lze použít pro zpracování požadavků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-107">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="ee8de-108">Směrování pomocí informací o trasách z aplikace taky umožňuje generovat adresy URL, které se mapují na koncové body.</span><span class="sxs-lookup"><span data-stu-id="ee8de-108">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ee8de-109">Tento dokument popisuje směrování ASP.NET Core nízké úrovně.</span><span class="sxs-lookup"><span data-stu-id="ee8de-109">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="ee8de-110">Informace o ASP.NET Core směrování MVC najdete v tématu <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-110">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="ee8de-111">Informace o konvencích směrování v Razor Pages najdete v tématu <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-111">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ee8de-112">[Zobrazit nebo stáhnout ukázkový kód](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([Jak stáhnout](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="ee8de-112">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="ee8de-113">Základy směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-113">Routing basics</span></span>

<span data-ttu-id="ee8de-114">Většina aplikací by měla zvolit základní a popisné schéma směrování, aby byly adresy URL čitelné a smysluplné.</span><span class="sxs-lookup"><span data-stu-id="ee8de-114">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="ee8de-115">Výchozí konvenční trasa `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-115">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="ee8de-116">Podporuje základní a popisné schéma směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-116">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="ee8de-117">Je užitečným výchozím bodem pro aplikace založené na uživatelském rozhraní.</span><span class="sxs-lookup"><span data-stu-id="ee8de-117">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="ee8de-118">Vývojáři obvykle přidávají další stručný trasy do oblastí s vysokým provozem v aplikaci ve zvláštních situacích (například koncové body blogu a elektronického obchodování) pomocí [Směrování atributů](xref:mvc/controllers/routing#attribute-routing) nebo vyhrazených konvenčních tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-118">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="ee8de-119">Webové rozhraní API by mělo používat směrování atributů k modelování funkcí aplikace jako sady prostředků, ve kterých jsou operace reprezentované příkazy HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee8de-119">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="ee8de-120">To znamená, že mnoho operací (například GET, POST) na stejném logickém prostředku bude používat stejnou adresu URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-120">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="ee8de-121">Směrování atributů poskytuje úroveň řízení, která je nutná k pečlivému návrhu rozložení veřejného koncového bodu rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ee8de-121">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="ee8de-122">Aplikace Razor Pages používají výchozí konvenční směrování pro obsluhu pojmenovaných prostředků ve složce *Pages* v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-122">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="ee8de-123">K dispozici jsou další konvence, které vám umožní přizpůsobit Razor Pages chování směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-123">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="ee8de-124">Další informace naleznete v tématu <xref:razor-pages/index> a <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-124">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ee8de-125">Podpora generování adresy URL umožňuje, aby se aplikace vyvinula bez adres URL s pevným kódováním, aby bylo možné propojit aplikaci dohromady.</span><span class="sxs-lookup"><span data-stu-id="ee8de-125">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="ee8de-126">Tato podpora umožňuje začít se základní konfigurací směrování a upravovat trasy po určení rozložení prostředků aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-126">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="ee8de-127">Směrování používá pro reprezentaci logických koncových bodů v aplikaci *koncové body* (`Endpoint`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-127">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="ee8de-128">Koncový bod definuje delegáta pro zpracování požadavků a kolekci libovolných metadat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-128">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="ee8de-129">Metadata se používají k implementaci průřezových obav na základě zásad a konfigurace připojených ke každému koncovému bodu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-129">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="ee8de-130">Systém směrování má následující vlastnosti:</span><span class="sxs-lookup"><span data-stu-id="ee8de-130">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="ee8de-131">Syntaxe šablony směrování se používá k definování tras s tokeny parametrů trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-131">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="ee8de-132">Konfigurace koncového bodu stylů a stylu atributu je povolena.</span><span class="sxs-lookup"><span data-stu-id="ee8de-132">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="ee8de-133"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> slouží k určení, zda parametr adresy URL obsahuje platnou hodnotu pro dané omezení koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-133"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="ee8de-134">Modely aplikací, jako je MVC/Razor Pages, registrují všechny své koncové body, které mají předvídatelné implementaci scénářů směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-134">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="ee8de-135">Implementace směrování provádí rozhodování o směrování všude, kde je to požadováno v kanálu middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-135">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="ee8de-136">Middleware, který se zobrazí po vytvoření middlewaru směrování, může zkontrolovat výsledek rozhodnutí koncového bodu middleware směrování pro daný identifikátor URI žádosti.</span><span class="sxs-lookup"><span data-stu-id="ee8de-136">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="ee8de-137">Je možné vytvořit výčet všech koncových bodů v aplikaci kdekoli v kanálu middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-137">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="ee8de-138">Aplikace může používat směrování k vygenerování adres URL (například pro přesměrování nebo propojení) na základě informací o koncových bodech, takže se vyhnete pevně zakódovaným adresám URL, které pomáhají zachovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-138">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="ee8de-139">Generování adresy URL vychází z adres, které podporují libovolné rozšíření:</span><span class="sxs-lookup"><span data-stu-id="ee8de-139">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="ee8de-140">Rozhraní API generátoru odkazů (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) je možné vyřešit kdekoli pomocí [vkládání závislostí (di)](xref:fundamentals/dependency-injection) pro generování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-140">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="ee8de-141">Pokud rozhraní API generátoru odkazů není k dispozici prostřednictvím DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> nabízí metody pro sestavování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-141">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="ee8de-142">Propojení koncových bodů je omezené na akce a stránky MVC/Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ee8de-142">Endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="ee8de-143">Pro budoucí verze jsou plánovány rozšíření funkcí pro propojení koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-143">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="ee8de-144">Směrování je připojené k kanálu [middlewaru](xref:fundamentals/middleware/index) pomocí třídy <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-144">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="ee8de-145">[ASP.NET Core MVC](xref:mvc/overview) v rámci své konfigurace přidává směrování do kanálu middlewaru a zpracovává směrování v MVC a Razor Pages aplikacích.</span><span class="sxs-lookup"><span data-stu-id="ee8de-145">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="ee8de-146">Informace o tom, jak používat směrování jako samostatnou součást, najdete v části [použití middlewaru pro směrování](#use-routing-middleware) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-146">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="ee8de-147">Shoda adresy URL</span><span class="sxs-lookup"><span data-stu-id="ee8de-147">URL matching</span></span>

<span data-ttu-id="ee8de-148">Shoda adresy URL je proces, podle kterého směrování odešle příchozí požadavek na *koncový bod*.</span><span class="sxs-lookup"><span data-stu-id="ee8de-148">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="ee8de-149">Tento proces je založený na datech v cestě URL, ale dá se rozšířit, aby v žádosti mohla být považovat všechna data.</span><span class="sxs-lookup"><span data-stu-id="ee8de-149">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="ee8de-150">Schopnost odesílat žádosti na samostatné obslužné rutiny je klíč pro škálování velikosti a složitosti aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-150">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="ee8de-151">Když middleware směrování spustí, nastaví koncový bod (`Endpoint`) a hodnoty směrování na funkci v <xref:Microsoft.AspNetCore.Http.HttpContext>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-151">When a Routing Middleware executes, it sets an endpoint (`Endpoint`) and route values to a feature on the <xref:Microsoft.AspNetCore.Http.HttpContext>.</span></span> <span data-ttu-id="ee8de-152">Pro aktuální požadavek:</span><span class="sxs-lookup"><span data-stu-id="ee8de-152">For the current request:</span></span>

* <span data-ttu-id="ee8de-153">Volání `HttpContext.GetEndpoint` získá koncový bod.</span><span class="sxs-lookup"><span data-stu-id="ee8de-153">Calling `HttpContext.GetEndpoint` gets the endpoint.</span></span>
* <span data-ttu-id="ee8de-154">`HttpRequest.RouteValues` Získá kolekci hodnot tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-154">`HttpRequest.RouteValues` gets the collection of route values.</span></span>

<span data-ttu-id="ee8de-155">Middleware spuštěný poté, co middleware směrování uvidí koncový bod a provede akci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-155">Middleware running after the Routing Middleware can see the endpoint and take action.</span></span> <span data-ttu-id="ee8de-156">Middleware autorizace může například dotazování kolekci metadat koncového bodu pro zásadu autorizace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-156">For example, an Authorization Middleware can interrogate the endpoint's metadata collection for an authorization policy.</span></span> <span data-ttu-id="ee8de-157">Po spuštění všech middlewarů v kanálu zpracování požadavků je vyvolán delegát vybraného koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-157">After all of the middleware in the request processing pipeline is executed, the selected endpoint's delegate is invoked.</span></span>

<span data-ttu-id="ee8de-158">Systém směrování v rámci směrování koncových bodů zodpovídá za všechna rozhodnutí o odesílání.</span><span class="sxs-lookup"><span data-stu-id="ee8de-158">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="ee8de-159">Vzhledem k tomu, že middleware používá zásady na základě vybraného koncového bodu, je důležité, aby jakékoli rozhodnutí, které může ovlivnit odesílání nebo použití zásad zabezpečení, bylo provedeno v rámci systému směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-159">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="ee8de-160">Po spuštění delegáta koncového bodu jsou vlastnosti [RouteContext. parametr RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) nastaveny na odpovídající hodnoty na základě dosud provedeného zpracování požadavků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-160">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="ee8de-161">[Parametr RouteData. Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) je slovník *hodnot tras* vytvořených z trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-161">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="ee8de-162">Tyto hodnoty se obvykle určují pomocí tokenizací adresy URL a dají se použít k přijetí vstupu uživatele nebo k dalšímu odesílání rozhodnutí v rámci aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-162">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="ee8de-163">[Parametr RouteData. DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) je kontejner objektů a dat pro další data související s odpovídající trasou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-163">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="ee8de-164"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> jsou k dispozici pro podporu přidružování dat o stavu k jednotlivým cestám, aby aplikace mohla učinit rozhodnutí na základě toho, na které trase odpovídá.</span><span class="sxs-lookup"><span data-stu-id="ee8de-164"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="ee8de-165">Tyto hodnoty jsou definované vývojářem a **neovlivňují chování** směrování jakýmkoli způsobem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-165">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="ee8de-166">Kromě toho hodnoty dočasně ukládané v [parametr RouteData. Datatokeny](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) můžou být libovolného typu, na rozdíl od [parametr RouteData. Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), které musí být převoditelné na a z řetězců.</span><span class="sxs-lookup"><span data-stu-id="ee8de-166">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="ee8de-167">[Parametr RouteData. routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) je seznam tras, které byly součástí úspěšného porovnání požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-167">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="ee8de-168">Trasy mohou být vnořeny do sebe navzájem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-168">Routes can be nested inside of one another.</span></span> <span data-ttu-id="ee8de-169">Vlastnost <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> odráží cestu v logickém stromu tras, jejichž výsledkem byla shoda.</span><span class="sxs-lookup"><span data-stu-id="ee8de-169">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="ee8de-170">Obecně platí, že první položka v <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> je kolekce tras a měla by se používat pro generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-170">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="ee8de-171">Poslední položka v <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> je obslužná rutina trasy, která se shoduje.</span><span class="sxs-lookup"><span data-stu-id="ee8de-171">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="ee8de-172">Generování adresy URL pomocí LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="ee8de-172">URL generation with LinkGenerator</span></span>

<span data-ttu-id="ee8de-173">Generování adresy URL je proces, podle kterého směrování může vytvořit cestu adresy URL na základě sady hodnot tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-173">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="ee8de-174">To umožňuje logické oddělení mezi vašimi koncovými body a adresami URL, které k nim mají přístup.</span><span class="sxs-lookup"><span data-stu-id="ee8de-174">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="ee8de-175">Směrování koncového bodu zahrnuje rozhraní API generátoru odkazů (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="ee8de-175">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="ee8de-176"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> je služba typu Singleton, kterou lze načíst z DI.</span><span class="sxs-lookup"><span data-stu-id="ee8de-176"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from DI.</span></span> <span data-ttu-id="ee8de-177">Rozhraní API lze použít mimo kontext vykonávajícího požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-177">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="ee8de-178"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> a scénáře MVC, které spoléhají na <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, jako jsou například [pomocníky značek](xref:mvc/views/tag-helpers/intro), HTML a [výsledky akcí](xref:mvc/controllers/actions), používají generátor propojení k poskytování možností vytváření odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-178">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="ee8de-179">Generátor propojení se zálohuje konceptem *adres* a *schémat adres*.</span><span class="sxs-lookup"><span data-stu-id="ee8de-179">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="ee8de-180">Schéma adres je způsob, jak určit koncové body, které by měly být považovány za vytváření odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-180">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="ee8de-181">Například název trasy a hodnoty tras vycházejí z MVC/Razor Pages jsou implementovány jako schéma adres.</span><span class="sxs-lookup"><span data-stu-id="ee8de-181">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="ee8de-182">Generátor propojení může propojit s akcemi MVC/Razor Pages a stránkami prostřednictvím následujících rozšiřujících metod:</span><span class="sxs-lookup"><span data-stu-id="ee8de-182">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="ee8de-183">Přetížení těchto metod akceptuje argumenty, které zahrnují `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-183">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="ee8de-184">Tyto metody jsou funkčně ekvivalentní `Url.Action` a `Url.Page`, ale nabízejí další flexibilitu a možnosti.</span><span class="sxs-lookup"><span data-stu-id="ee8de-184">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="ee8de-185">Metody `GetPath*` jsou nejvíce podobné `Url.Action` a `Url.Page` v tom, že generují identifikátor URI obsahující absolutní cestu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-185">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="ee8de-186">Metody `GetUri*` vždy generují absolutní identifikátor URI obsahující schéma a hostitele.</span><span class="sxs-lookup"><span data-stu-id="ee8de-186">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="ee8de-187">Metody, které přijímají `HttpContext` generují identifikátor URI v kontextu zpracovávaného požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-187">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="ee8de-188">Použijí se hodnoty tras, základní cesta, schéma a hostitel z zpracovávaného požadavku, pokud nejsou přepsány.</span><span class="sxs-lookup"><span data-stu-id="ee8de-188">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="ee8de-189"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> se volá s adresou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-189"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="ee8de-190">K vygenerování identifikátoru URI dochází ve dvou krocích:</span><span class="sxs-lookup"><span data-stu-id="ee8de-190">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="ee8de-191">Adresa je svázána se seznamem koncových bodů, které odpovídají dané adrese.</span><span class="sxs-lookup"><span data-stu-id="ee8de-191">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="ee8de-192">`RoutePattern` každého koncového bodu se vyhodnotí, dokud se nenajde vzor směrování, který odpovídá zadaným hodnotám.</span><span class="sxs-lookup"><span data-stu-id="ee8de-192">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="ee8de-193">Výsledný výstup je v kombinaci s ostatními částmi identifikátoru URI dodanými generátorem odkazů a vrácenými.</span><span class="sxs-lookup"><span data-stu-id="ee8de-193">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="ee8de-194">Metody poskytované <xref:Microsoft.AspNetCore.Routing.LinkGenerator> podporují možnosti generování standardních odkazů pro jakýkoli typ adresy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-194">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="ee8de-195">Nejpohodlnější způsob použití generátoru odkazů je prostřednictvím metod rozšíření, které provádějí operace pro konkrétní typ adresy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-195">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="ee8de-196">Metoda rozšíření</span><span class="sxs-lookup"><span data-stu-id="ee8de-196">Extension Method</span></span> | <span data-ttu-id="ee8de-197">Popis</span><span class="sxs-lookup"><span data-stu-id="ee8de-197">Description</span></span> |
| ---------------- | ----------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="ee8de-198">Vygeneruje identifikátor URI s absolutní cestou na základě zadaných hodnot.</span><span class="sxs-lookup"><span data-stu-id="ee8de-198">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="ee8de-199">Vygeneruje absolutní identifikátor URI na základě zadaných hodnot.</span><span class="sxs-lookup"><span data-stu-id="ee8de-199">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="ee8de-200">Věnujte pozornost následujícím důsledkům při volání <xref:Microsoft.AspNetCore.Routing.LinkGenerator>ch metod:</span><span class="sxs-lookup"><span data-stu-id="ee8de-200">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="ee8de-201">Používejte `GetUri*` rozšiřujících metod s opatrností v konfiguraci aplikace, která neověřuje `Host` hlavičku příchozích požadavků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-201">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="ee8de-202">Pokud `Host` záhlaví příchozích požadavků není ověřeno, lze nedůvěryhodný vstup žádosti poslat zpátky klientovi v identifikátorech URI na stránce zobrazení nebo stránky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-202">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="ee8de-203">Doporučujeme, aby všechny produkční aplikace nakonfigurovaly server tak, aby ověřili `Host` hlavičku se známými platnými hodnotami.</span><span class="sxs-lookup"><span data-stu-id="ee8de-203">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="ee8de-204">Používejte <xref:Microsoft.AspNetCore.Routing.LinkGenerator> s opatrností v middleware v kombinaci s `Map` nebo `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-204">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="ee8de-205">`Map*` změní základní cestu spouštěné žádosti, která má vliv na výstup generace propojení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-205">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="ee8de-206">Všechna rozhraní <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API umožňují zadat základní cestu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-206">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="ee8de-207">Vždy zadat prázdnou základní cestu pro vrácení zpět `Map*`vlivu na generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-207">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="endpoint-routing-differences-from-earlier-versions-of-routing"></a><span data-ttu-id="ee8de-208">Rozdíly v směrování koncových bodů ze starších verzí směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-208">Endpoint routing differences from earlier versions of routing</span></span>

<span data-ttu-id="ee8de-209">Mezi směrováním koncových bodů a verzemi směrování starších než v ASP.NET Core 2,2 existuje několik rozdílů:</span><span class="sxs-lookup"><span data-stu-id="ee8de-209">A few differences exist between endpoint routing and versions of routing earlier than in ASP.NET Core 2.2:</span></span>

* <span data-ttu-id="ee8de-210">Systém směrování koncových bodů nepodporuje rozšíření na základě <xref:Microsoft.AspNetCore.Routing.IRouter>, včetně dědění z <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-210">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="ee8de-211">Směrování koncového bodu nepodporuje [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="ee8de-211">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="ee8de-212">Chcete-li pokračovat v používání překrytí kompatibility, použijte [verzi kompatibility](xref:mvc/compatibility-version) 2,1 (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-212">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="ee8de-213">Směrování koncového bodu má pro velká a malá písmena vygenerovaných identifikátorů URI při použití konvenčních tras jiné chování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-213">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="ee8de-214">Vezměte v úvahu následující výchozí šablonu trasy:</span><span class="sxs-lookup"><span data-stu-id="ee8de-214">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="ee8de-215">Předpokládejme, že jste vygenerovali odkaz na akci pomocí následujícího postupu:</span><span class="sxs-lookup"><span data-stu-id="ee8de-215">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="ee8de-216">Při směrování na základě <xref:Microsoft.AspNetCore.Routing.IRouter>tento kód generuje identifikátor URI `/blog/ReadPost/17`, který respektuje velká a malá písmena zadané hodnoty trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-216">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="ee8de-217">Směrování koncových bodů v ASP.NET Core 2,2 nebo novějším vytvoří `/Blog/ReadPost/17` ("blog" je na velká písmena).</span><span class="sxs-lookup"><span data-stu-id="ee8de-217">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="ee8de-218">Směrování koncových bodů poskytuje `IOutboundParameterTransformer` rozhraní, které se dá použít k globálnímu přizpůsobení tohoto chování, nebo k aplikování různých konvencí pro mapování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-218">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="ee8de-219">Další informace najdete v části [referenční informace pro parametry transformátoru](#parameter-transformer-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-219">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="ee8de-220">Generace odkazů, kterou používá MVC/Razor Pages, se při pokusu o připojení ke kontroléru nebo akci nebo stránce, která neexistuje, chová jinak.</span><span class="sxs-lookup"><span data-stu-id="ee8de-220">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="ee8de-221">Vezměte v úvahu následující výchozí šablonu trasy:</span><span class="sxs-lookup"><span data-stu-id="ee8de-221">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="ee8de-222">Předpokládejme, že jste vygenerovali odkaz na akci s použitím výchozí šablony s následujícím:</span><span class="sxs-lookup"><span data-stu-id="ee8de-222">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="ee8de-223">Při směrování založeném na `IRouter`je výsledek vždy `/Blog/ReadPost/17`, i když `BlogController` neexistuje nebo nemá metodu `ReadPost` Action.</span><span class="sxs-lookup"><span data-stu-id="ee8de-223">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="ee8de-224">Podle očekávání, směrování koncového bodu v ASP.NET Core 2,2 nebo novější vytvoří `/Blog/ReadPost/17`, pokud existuje metoda akce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-224">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="ee8de-225">*Směrování koncových bodů ale vytvoří prázdný řetězec, pokud akce neexistuje.*</span><span class="sxs-lookup"><span data-stu-id="ee8de-225">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="ee8de-226">V koncepčním případě směrování koncového bodu nepředpokládá, že koncový bod existuje, pokud akce neexistuje.</span><span class="sxs-lookup"><span data-stu-id="ee8de-226">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="ee8de-227">Při použití s směrováním koncových bodů se *algoritmus neplatných v okolí* generování propojení chová jinak.</span><span class="sxs-lookup"><span data-stu-id="ee8de-227">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="ee8de-228">*Neplatnost okolní hodnoty* je algoritmus, který určuje, které hodnoty směrování z aktuálně prováděné žádosti (okolní hodnoty) se dají použít při operacích generování odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-228">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="ee8de-229">Konvenční směrování vždy neověřené hodnoty dodatečné trasy při propojení s jinou akcí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-229">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="ee8de-230">Směrování atributů neobsahovalo toto chování před vydáním ASP.NET Core 2,2.</span><span class="sxs-lookup"><span data-stu-id="ee8de-230">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="ee8de-231">V dřívějších verzích ASP.NET Core odkazy na jinou akci, která používá stejné názvy parametrů trasy, způsobily chyby generování odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-231">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="ee8de-232">V ASP.NET Core 2,2 nebo novějších, obě formy směrování při propojování s jinou akcí zruší hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ee8de-232">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="ee8de-233">Vezměte v úvahu následující příklad ASP.NET Core 2,1 nebo starší verze.</span><span class="sxs-lookup"><span data-stu-id="ee8de-233">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="ee8de-234">Při propojení s jinou akcí (nebo jinou stránkou) lze hodnoty směrování znovu použít nežádoucím způsobem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-234">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="ee8de-235">V */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="ee8de-235">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="ee8de-236">V */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="ee8de-236">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="ee8de-237">Pokud je identifikátor URI `/Store/Product/18` v ASP.NET Core 2,1 nebo starším, odkaz vygenerovaný na stránce úložiště/informace podle `@Url.Page("/Login")` je `/Login/18`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-237">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="ee8de-238">Hodnota `id` 18 se znovu použije, i když je cíl propojení jinou součástí aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-238">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="ee8de-239">Hodnota `id` trasy v kontextu stránky `/Login` je pravděpodobně hodnota ID uživatele, nikoli hodnota ID produktu úložiště.</span><span class="sxs-lookup"><span data-stu-id="ee8de-239">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="ee8de-240">V rámci směrování koncového bodu s ASP.NET Core 2,2 nebo novějším je výsledek `/Login`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-240">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="ee8de-241">Okolní hodnoty se znovu nepoužijí, pokud je cíl propojení jinou akcí nebo stránkou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-241">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="ee8de-242">Syntaxe parametru trasy s kulatým Trip: lomítka nejsou zakódována při použití syntaxe parametru catch-All (`**`) s dvojitou hvězdičkou ().</span><span class="sxs-lookup"><span data-stu-id="ee8de-242">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="ee8de-243">Během generování propojení systém směrování zakóduje hodnotu zachycenou v parametru zachycení s dvojitou hvězdičkou (`**`) (například `{**myparametername}`) s výjimkou lomítek.</span><span class="sxs-lookup"><span data-stu-id="ee8de-243">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="ee8de-244">U `IRouter`ho směrování v ASP.NET Core 2,2 nebo novějších se podporuje také zachycení pomocí dvojité hvězdičky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-244">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="ee8de-245">V předchozích verzích ASP.NET Core (`{*myparametername}`) zůstane podporovaná jednoduchá hvězdička All – syntaxe parametrů a lomítka jsou zakódovaná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-245">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="ee8de-246">Cestě</span><span class="sxs-lookup"><span data-stu-id="ee8de-246">Route</span></span>              | <span data-ttu-id="ee8de-247">Odkaz vygeneroval s</span><span class="sxs-lookup"><span data-stu-id="ee8de-247">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="ee8de-248">`/search/admin%2Fproducts` (lomítko je zakódováno)</span><span class="sxs-lookup"><span data-stu-id="ee8de-248">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="ee8de-249">Příklad middlewaru</span><span class="sxs-lookup"><span data-stu-id="ee8de-249">Middleware example</span></span>

<span data-ttu-id="ee8de-250">V následujícím příkladu middleware používá rozhraní <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API k vytvoření odkazu na metodu akce, která obsahuje produkty pro Store.</span><span class="sxs-lookup"><span data-stu-id="ee8de-250">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="ee8de-251">Použití generátoru odkazů vložením do třídy a volání `GenerateLink` je k dispozici pro libovolnou třídu v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-251">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="ee8de-252">Vytváření tras</span><span class="sxs-lookup"><span data-stu-id="ee8de-252">Create routes</span></span>

<span data-ttu-id="ee8de-253">Většina aplikací vytváří trasy voláním <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> nebo jedné z podobných metod rozšíření definovaných v <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-253">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="ee8de-254">Kterákoli z rozšiřujících metod <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> vytvoří instanci <xref:Microsoft.AspNetCore.Routing.Route> a přidá ji do kolekce tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-254">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="ee8de-255"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> nepřijímá parametr obslužné rutiny trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-255"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="ee8de-256"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> pouze přidá trasy, které jsou zpracovávány <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-256"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="ee8de-257">Další informace o směrování v MVC najdete v tématu <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-257">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="ee8de-258">Následující příklad kódu je příkladem <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> volání využívaného typickou ASP.NET Core definice trasy MVC:</span><span class="sxs-lookup"><span data-stu-id="ee8de-258">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ee8de-259">Tato šablona odpovídá cestě URL a extrahuje hodnoty tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-259">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="ee8de-260">Například cesta `/Products/Details/17` generuje následující hodnoty trasy: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-260">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="ee8de-261">Hodnoty tras se určují rozdělením cesty URL na segmenty a porovnáním jednotlivých segmentů s názvem *parametru trasy* v šabloně směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-261">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="ee8de-262">Parametry směrování jsou pojmenovány.</span><span class="sxs-lookup"><span data-stu-id="ee8de-262">Route parameters are named.</span></span> <span data-ttu-id="ee8de-263">Parametry definované ohraničujícím název parametru v závorkách `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-263">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="ee8de-264">Předchozí šablona může také odpovídat cestě URL `/` a vydávat hodnoty `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-264">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="ee8de-265">K tomu dochází, protože parametry směrování `{controller}` a `{action}` mají výchozí hodnoty a parametr trasy `id` je volitelný.</span><span class="sxs-lookup"><span data-stu-id="ee8de-265">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="ee8de-266">Znak rovná se (`=`) následovaný hodnotou za názvem parametru trasy definuje výchozí hodnotu parametru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-266">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="ee8de-267">Otazník (`?`) po názvu parametru trasy definuje volitelný parametr.</span><span class="sxs-lookup"><span data-stu-id="ee8de-267">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="ee8de-268">Parametry směrování s výchozí hodnotou *vždy* vytvoří hodnotu trasy, když odpovídá trasa.</span><span class="sxs-lookup"><span data-stu-id="ee8de-268">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="ee8de-269">Volitelné parametry neposkytují hodnotu trasy, pokud nebyl nalezen žádný odpovídající segment cesty URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-269">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span> <span data-ttu-id="ee8de-270">Podrobný popis scénářů a syntaxe šablon směrování najdete v části referenční dokumentace k [šabloně směrování](#route-template-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-270">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="ee8de-271">V následujícím příkladu definice parametru trasy `{id:int}` definuje [omezení trasy](#route-constraint-reference) pro parametr trasy `id`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-271">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="ee8de-272">Tato šablona odpovídá cestě URL, jako je `/Products/Details/17`, ale ne `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-272">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="ee8de-273">Omezení tras implementují <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> a kontrolují hodnoty směrování a ověřují je.</span><span class="sxs-lookup"><span data-stu-id="ee8de-273">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="ee8de-274">V tomto příkladu musí být hodnota trasy `id` převoditelná na celé číslo.</span><span class="sxs-lookup"><span data-stu-id="ee8de-274">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="ee8de-275">Vysvětlení omezení trasy poskytovaných rozhraním naleznete v tématu [Route-Constraint-reference](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-275">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="ee8de-276">Další přetížení <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> akceptují hodnoty pro `constraints`, `dataTokens`a `defaults`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-276">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="ee8de-277">Typické použití těchto parametrů je předání anonymního typu objektu, kde názvy vlastností anonymního typu odpovídají názvům parametrů tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-277">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="ee8de-278">Následující příklady <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> vytvořit ekvivalentní trasy:</span><span class="sxs-lookup"><span data-stu-id="ee8de-278">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="ee8de-279">Vložená syntaxe pro definování omezení a výchozích hodnot může být vhodná pro jednoduché trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-279">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="ee8de-280">Existují však scénáře, jako jsou například datové tokeny, které nejsou podporovány vloženou syntaxí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-280">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="ee8de-281">Následující příklad ukazuje několik dalších scénářů:</span><span class="sxs-lookup"><span data-stu-id="ee8de-281">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="ee8de-282">Předchozí šablona odpovídá cestě URL jako `/Blog/All-About-Routing/Introduction` a extrahuje hodnoty `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-282">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="ee8de-283">Výchozí hodnoty trasy pro `controller` a `action` jsou vytvářeny trasou, i když v šabloně nejsou odpovídající parametry směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-283">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="ee8de-284">V šabloně směrování lze zadat výchozí hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ee8de-284">Default values can be specified in the route template.</span></span> <span data-ttu-id="ee8de-285">Parametr trasy `article` je definován jako *catch-All* pomocí vzhledu dvojité hvězdičky (`**`) před názvem parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-285">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="ee8de-286">Catch – všechny parametry tras zaznamenávají zbytek cesty URL a můžou taky odpovídat prázdnému řetězci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-286">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="ee8de-287">Následující příklad přidá omezení trasy a datové tokeny:</span><span class="sxs-lookup"><span data-stu-id="ee8de-287">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="ee8de-288">Předchozí šablona odpovídá cestě URL jako `/en-US/Products/5` a extrahuje hodnoty `{ controller = Products, action = Details, id = 5 }` a `{ locale = en-US }`datových tokenů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-288">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokeny systému Windows pro národní prostředí](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="ee8de-290">Generování adresy URL třídy směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-290">Route class URL generation</span></span>

<span data-ttu-id="ee8de-291">Třída <xref:Microsoft.AspNetCore.Routing.Route> může také provádět generování adresy URL kombinováním sady hodnot směrování se šablonou směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-291">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="ee8de-292">Toto je logicky obrácený proces, který odpovídá cestě URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-292">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="ee8de-293">Chcete-li lépe pochopit generování adresy URL, Představte si, jakou adresu URL chcete vygenerovat, a pak se zamyslete nad tím, jak šablona trasy odpovídá této adrese</span><span class="sxs-lookup"><span data-stu-id="ee8de-293">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="ee8de-294">Jaké hodnoty by se vytvořily?</span><span class="sxs-lookup"><span data-stu-id="ee8de-294">What values would be produced?</span></span> <span data-ttu-id="ee8de-295">Toto je hrubý ekvivalent způsobu, jak generování adresy URL funguje ve třídě <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-295">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="ee8de-296">V následujícím příkladu je použita obecná výchozí trasa ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="ee8de-296">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ee8de-297">Při `{ controller = Products, action = List }`hodnoty trasy je vygenerována adresa URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-297">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="ee8de-298">Hodnoty tras se nahradí odpovídajícími parametry tras, aby bylo možné vytvořit cestu k adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-298">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="ee8de-299">Vzhledem k tomu, že `id` je volitelný parametr trasy, adresa URL se úspěšně vygenerovala bez hodnoty pro `id`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-299">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="ee8de-300">Při `{ controller = Home, action = Index }`hodnoty trasy je vygenerována adresa URL `/`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-300">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="ee8de-301">Zadané hodnoty trasy odpovídají výchozím hodnotám a jsou bezpečně vynechány segmenty odpovídající výchozím hodnotám.</span><span class="sxs-lookup"><span data-stu-id="ee8de-301">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="ee8de-302">Obě adresy URL vygenerovaly zpáteční cestu pomocí následující definice trasy (`/Home/Index` a `/`) vytvoří stejné hodnoty trasy, které se použily k vygenerování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-302">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="ee8de-303">Aplikace, která používá ASP.NET Core MVC, by měla používat <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> k vygenerování adres URL namísto volání přímo do směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-303">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="ee8de-304">Další informace o generování adresy URL najdete v části [Reference pro generování adresy URL](#url-generation-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-304">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="ee8de-305">Použití middlewaru pro směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-305">Use Routing Middleware</span></span>

<span data-ttu-id="ee8de-306">Odkaz na [Microsoft. AspNetCore. app Metapackage](xref:fundamentals/metapackage-app) v souboru projektu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-306">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="ee8de-307">Přidání směrování do kontejneru služby v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-307">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="ee8de-308">Trasy musí být nakonfigurovány v metodě `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-308">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="ee8de-309">Ukázková aplikace používá následující rozhraní API:</span><span class="sxs-lookup"><span data-stu-id="ee8de-309">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="ee8de-310"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; odpovídá pouze požadavkům HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ee8de-310"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="ee8de-311">V následující tabulce jsou uvedeny odpovědi s danými identifikátory URI.</span><span class="sxs-lookup"><span data-stu-id="ee8de-311">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="ee8de-312">Identifikátor URI</span><span class="sxs-lookup"><span data-stu-id="ee8de-312">URI</span></span>                    | <span data-ttu-id="ee8de-313">Základě</span><span class="sxs-lookup"><span data-stu-id="ee8de-313">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="ee8de-314">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ee8de-314">Hello!</span></span> <span data-ttu-id="ee8de-315">Hodnoty směrování: [operace, vytvořit], [ID, 3]</span><span class="sxs-lookup"><span data-stu-id="ee8de-315">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="ee8de-316">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ee8de-316">Hello!</span></span> <span data-ttu-id="ee8de-317">Hodnoty směrování: [operace, stopa], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="ee8de-317">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="ee8de-318">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ee8de-318">Hello!</span></span> <span data-ttu-id="ee8de-319">Hodnoty směrování: [operace, stopa], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="ee8de-319">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="ee8de-320">Požadavek spadá do, bez shody.</span><span class="sxs-lookup"><span data-stu-id="ee8de-320">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="ee8de-321">Dobrý den, Jana!</span><span class="sxs-lookup"><span data-stu-id="ee8de-321">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="ee8de-322">Požadavek spadá do, odpovídá pouze HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ee8de-322">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="ee8de-323">Požadavek spadá do, bez shody.</span><span class="sxs-lookup"><span data-stu-id="ee8de-323">The request falls through, no match.</span></span>              |

<span data-ttu-id="ee8de-324">Rozhraní poskytuje sadu metod rozšíření pro vytváření tras (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="ee8de-324">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="ee8de-325">Metody `Map[Verb]` používají omezení k omezení trasy na příkaz HTTP v názvu metody.</span><span class="sxs-lookup"><span data-stu-id="ee8de-325">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="ee8de-326">Například viz <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> a <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-326">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="ee8de-327">Odkaz na šablonu směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-327">Route template reference</span></span>

<span data-ttu-id="ee8de-328">Tokeny ve složených závorkách (`{ ... }`) definují *parametry trasy* , které jsou svázané, pokud je trasa shodná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-328">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="ee8de-329">V segmentu směrování můžete definovat více než jeden parametr trasy, ale musí být oddělený literálovou hodnotou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-329">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="ee8de-330">Například `{controller=Home}{action=Index}` není platná trasa, protože žádná hodnota literálu není mezi `{controller}` a `{action}`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-330">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="ee8de-331">Tyto parametry tras musí mít název a můžou mít zadané další atributy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-331">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="ee8de-332">Textový literál jiný než parametry směrování (například `{id}`) a oddělovač cest `/` musí odpovídat textu v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-332">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="ee8de-333">U porovnávání textu se nerozlišují malá a velká písmena a na základě dekódovat reprezentace cesty URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-333">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="ee8de-334">Chcete-li spárovat oddělovač parametrů trasy (`{` nebo `}`), vydejte znak oddělovače opakováním znaku (`{{` nebo `}}`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-334">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="ee8de-335">Vzory adres URL, které se pokoušejí zachytit název souboru s volitelnou příponou souboru, mají další požadavky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-335">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="ee8de-336">Představte si třeba šablonu `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-336">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="ee8de-337">Pokud existují hodnoty pro `filename` i `ext`, naplní se obě hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ee8de-337">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="ee8de-338">Pokud se v adrese URL vyskytuje jenom hodnota `filename`, odpovídá trasa, protože koncová tečka (`.`) je volitelná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-338">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="ee8de-339">Tuto trasu odpovídají následujícím adresám URL:</span><span class="sxs-lookup"><span data-stu-id="ee8de-339">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="ee8de-340">Pomocí hvězdičky (`*`) nebo dvojité hvězdičky (`**`) můžete jako předpony parametru Route vytvořit vazby na zbytek identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="ee8de-340">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="ee8de-341">Tyto parametry se nazývají *catch-All* .</span><span class="sxs-lookup"><span data-stu-id="ee8de-341">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="ee8de-342">`blog/{**slug}` například odpovídá jakémukoli identifikátoru URI, který začíná na `/blog` a má libovolnou hodnotu, která je za ní přiřazena hodnota `slug` trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-342">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="ee8de-343">Catch – všechny parametry můžou odpovídat také prázdnému řetězci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-343">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="ee8de-344">Parametr catch-All řídí příslušné znaky, pokud je použita cesta pro vygenerování adresy URL, včetně oddělovače cest (`/`) znaků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-344">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="ee8de-345">Například trasa `foo/{*path}` s hodnotami trasy `{ path = "my/path" }` generuje `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-345">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="ee8de-346">Všimněte si řídicího znaku lomítka.</span><span class="sxs-lookup"><span data-stu-id="ee8de-346">Note the escaped forward slash.</span></span> <span data-ttu-id="ee8de-347">Do oddělovacích znaků cesty pro přenos cest použijte předponu parametru `**` Route.</span><span class="sxs-lookup"><span data-stu-id="ee8de-347">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="ee8de-348">`foo/{**path}` trasy s `{ path = "my/path" }` generuje `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-348">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="ee8de-349">Parametry směrování můžou mít *výchozí hodnoty* určené zadáním výchozí hodnoty za názvem parametru odděleným symbolem rovná se (`=`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-349">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="ee8de-350">Například `{controller=Home}` definuje `Home` jako výchozí hodnotu pro `controller`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-350">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="ee8de-351">Výchozí hodnota se použije v případě, že v adrese URL parametru není k dispozici žádná hodnota.</span><span class="sxs-lookup"><span data-stu-id="ee8de-351">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="ee8de-352">Parametry směrování jsou nepovinné tím, že se k konci názvu parametru připojí otazník (`?`), jako v `id?`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-352">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="ee8de-353">Rozdíl mezi volitelnými hodnotami a výchozími parametry směrování je, že parametr trasy s výchozí hodnotou vždy vytvoří hodnotu&mdash;volitelný parametr má hodnotu pouze v případě, že adresa URL požadavku poskytne hodnotu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-353">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="ee8de-354">Parametry směrování můžou mít omezení, která se musí shodovat s hodnotou trasy svázanou z adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-354">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="ee8de-355">Přidání dvojtečky (`:`) a názvu omezení za názvem parametru trasy Určuje *vložené omezení* pro parametr trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-355">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="ee8de-356">Pokud omezení vyžaduje argumenty, jsou po názvu omezení uzavřeny do závorek (`(...)`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-356">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="ee8de-357">Přidáním dalších dvojtečk (`:`) a názvu omezení lze zadat více vložených omezení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-357">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="ee8de-358">Název omezení a argumenty jsou předány službě <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver>, aby se vytvořila instance <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, která se má použít při zpracování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-358">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="ee8de-359">Například šablona trasy `blog/{article:minlength(10)}` určuje omezení `minlength` s argumentem `10`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-359">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="ee8de-360">Další informace o omezeních tras a seznam omezení poskytovaných rozhraním najdete v části [referenční informace k omezením trasy](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-360">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="ee8de-361">Parametry směrování můžou mít také transformaci parametrů, které transformují hodnotu parametru při generování odkazů a porovnání akcí a stránek s adresami URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-361">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="ee8de-362">Podobně jako omezení můžou být transformátory parametrů přidány do parametru trasy, a to přidáním dvojtečky (`:`) a názvu transformátoru za názvem parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-362">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="ee8de-363">Například šablona trasy `blog/{article:slugify}` určuje `slugify` transformátor.</span><span class="sxs-lookup"><span data-stu-id="ee8de-363">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="ee8de-364">Další informace o transformačních parametrech naleznete v části [Referenční příručka pro parametry](#parameter-transformer-reference) transformátoru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-364">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="ee8de-365">Následující tabulka ukazuje příklady šablon směrování a jejich chování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-365">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="ee8de-366">Šablona směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-366">Route Template</span></span>                           | <span data-ttu-id="ee8de-367">Příklad odpovídajícího identifikátoru URI</span><span class="sxs-lookup"><span data-stu-id="ee8de-367">Example Matching URI</span></span>    | <span data-ttu-id="ee8de-368">Identifikátor URI žádosti&hellip;</span><span class="sxs-lookup"><span data-stu-id="ee8de-368">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="ee8de-369">Odpovídá pouze jedné cestě `/hello`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-369">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="ee8de-370">Porovná a nastaví `Page` k `Home`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-370">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="ee8de-371">Porovná a nastaví `Page` k `Contact`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-371">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="ee8de-372">Provede mapování na kontroler `Products` a `List` akci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-372">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="ee8de-373">Provede mapování na řadič `Products` a akci `Details` (`id` nastaveno na 123).</span><span class="sxs-lookup"><span data-stu-id="ee8de-373">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="ee8de-374">Provede mapování na řadič `Home` a metodu `Index` (`id` je ignorováno).</span><span class="sxs-lookup"><span data-stu-id="ee8de-374">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="ee8de-375">Použití šablony je obecně nejjednodušší přístup ke směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-375">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="ee8de-376">Omezení a výchozí hodnoty je možné zadat i mimo šablonu směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-376">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="ee8de-377">Povolte [protokolování](xref:fundamentals/logging/index) , abyste viděli, jak se zabudovaná implementace směrování, například <xref:Microsoft.AspNetCore.Routing.Route>, odpovídá požadavkům.</span><span class="sxs-lookup"><span data-stu-id="ee8de-377">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="ee8de-378">Názvy rezervovaných směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-378">Reserved routing names</span></span>

<span data-ttu-id="ee8de-379">Následující klíčová slova jsou vyhrazená jména a nelze je použít jako názvy a parametry směrování:</span><span class="sxs-lookup"><span data-stu-id="ee8de-379">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="ee8de-380">Odkaz na omezení trasy</span><span class="sxs-lookup"><span data-stu-id="ee8de-380">Route constraint reference</span></span>

<span data-ttu-id="ee8de-381">Omezení trasy se spustí, když došlo ke shodě s příchozí adresou URL a cesta URL je zavedená do hodnot tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-381">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="ee8de-382">Omezení tras obvykle kontrolují hodnotu trasy přidruženou prostřednictvím šablony trasy a učiní ano/bez rozhodnutí o tom, zda je tato hodnota přijatelná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-382">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="ee8de-383">Některá omezení tras používají data mimo hodnotu trasy k zvážení toho, zda je možné požadavek směrovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-383">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="ee8de-384"><xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> například může přijmout nebo odmítnout požadavek na základě jeho příkazu HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee8de-384">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="ee8de-385">Omezení se používají při směrování požadavků a vytváření propojení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-385">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="ee8de-386">Nepoužívejte omezení pro **ověřování vstupu**.</span><span class="sxs-lookup"><span data-stu-id="ee8de-386">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="ee8de-387">Pokud se pro **ověřování vstupu**používají omezení, neplatné výsledky vstupu v *404 – nenalezené* odpovědi namísto *400 – Chybný požadavek* s příslušnou chybovou zprávou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-387">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="ee8de-388">Omezení tras slouží k jednoznačnému **rozlišení podobných tras** , nikoli k ověření vstupů konkrétní trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-388">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="ee8de-389">Následující tabulka ukazuje příklad omezení trasy a jejich očekávané chování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-389">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="ee8de-390">omezení</span><span class="sxs-lookup"><span data-stu-id="ee8de-390">constraint</span></span> | <span data-ttu-id="ee8de-391">Příklad</span><span class="sxs-lookup"><span data-stu-id="ee8de-391">Example</span></span> | <span data-ttu-id="ee8de-392">Příklady shody</span><span class="sxs-lookup"><span data-stu-id="ee8de-392">Example Matches</span></span> | <span data-ttu-id="ee8de-393">Poznámky</span><span class="sxs-lookup"><span data-stu-id="ee8de-393">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="ee8de-394">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ee8de-394">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ee8de-395">Odpovídá jakémukoli celému číslu</span><span class="sxs-lookup"><span data-stu-id="ee8de-395">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="ee8de-396">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="ee8de-396">`true`, `FALSE`</span></span> | <span data-ttu-id="ee8de-397">Odpovídá `true` nebo `false` (bez rozlišení velkých a malých písmen)</span><span class="sxs-lookup"><span data-stu-id="ee8de-397">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="ee8de-398">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="ee8de-398">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="ee8de-399">Odpovídá platné hodnotě `DateTime` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-399">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="ee8de-400">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="ee8de-400">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="ee8de-401">Odpovídá platné hodnotě `decimal` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-401">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="ee8de-402">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ee8de-402">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ee8de-403">Odpovídá platné hodnotě `double` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-403">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="ee8de-404">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ee8de-404">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ee8de-405">Odpovídá platné hodnotě `float` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-405">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="ee8de-406">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="ee8de-406">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="ee8de-407">Odpovídá platnému hodnotě `Guid`</span><span class="sxs-lookup"><span data-stu-id="ee8de-407">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="ee8de-408">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ee8de-408">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ee8de-409">Odpovídá platnému hodnotě `long`</span><span class="sxs-lookup"><span data-stu-id="ee8de-409">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="ee8de-410">Řetězec musí mít minimálně 4 znaky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-410">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="ee8de-411">Řetězec nesmí být delší než 8 znaků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-411">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="ee8de-412">Řetězec musí být přesně 12 znaků dlouhý.</span><span class="sxs-lookup"><span data-stu-id="ee8de-412">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="ee8de-413">Řetězec musí mít aspoň 8 znaků a nesmí být delší než 16 znaků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-413">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="ee8de-414">Celočíselná hodnota musí být minimálně 18.</span><span class="sxs-lookup"><span data-stu-id="ee8de-414">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="ee8de-415">Hodnota typu Integer nesmí být větší než 120.</span><span class="sxs-lookup"><span data-stu-id="ee8de-415">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="ee8de-416">Celočíselná hodnota musí být minimálně 18, ale ne víc než 120.</span><span class="sxs-lookup"><span data-stu-id="ee8de-416">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="ee8de-417">Řetězec musí obsahovat jeden nebo více abecedních znaků (`a`-`z`, nerozlišuje velká a malá písmena).</span><span class="sxs-lookup"><span data-stu-id="ee8de-417">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="ee8de-418">Řetězec musí odpovídat regulárnímu výrazu (viz Tipy k definování regulárního výrazu).</span><span class="sxs-lookup"><span data-stu-id="ee8de-418">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="ee8de-419">Slouží k vykonání, že při generování adresy URL je přítomna hodnota bez parametru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-419">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="ee8de-420">V jednom parametru lze použít více omezení s oddělovači.</span><span class="sxs-lookup"><span data-stu-id="ee8de-420">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="ee8de-421">Například následující omezení omezuje parametr na celočíselnou hodnotu 1 nebo vyšší:</span><span class="sxs-lookup"><span data-stu-id="ee8de-421">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="ee8de-422">Omezení směrování, která ověřují adresu URL a jsou převedena na typ CLR (například `int` nebo `DateTime`) vždy používají invariantní jazykovou verzi.</span><span class="sxs-lookup"><span data-stu-id="ee8de-422">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="ee8de-423">Tato omezení předpokládají, že adresa URL nelze lokalizovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-423">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="ee8de-424">Omezení tras poskytovaných rozhraním nemění hodnoty uložené v hodnotách tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-424">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="ee8de-425">Všechny hodnoty tras přeložené z adresy URL se ukládají jako řetězce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-425">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="ee8de-426">Například omezení `float` se pokusí převést hodnotu trasy na typ float, ale převedená hodnota se používá pouze k ověření, že je možné ji převést na typ float.</span><span class="sxs-lookup"><span data-stu-id="ee8de-426">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="ee8de-427">Regulární výrazy</span><span class="sxs-lookup"><span data-stu-id="ee8de-427">Regular expressions</span></span>

<span data-ttu-id="ee8de-428">Rozhraní ASP.NET Core Framework přidá `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` do konstruktoru regulárního výrazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-428">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="ee8de-429">Popis těchto členů naleznete v tématu <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-429">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="ee8de-430">Regulární výrazy používají oddělovače a tokeny podobné těm, které používá směrování a C# jazyk.</span><span class="sxs-lookup"><span data-stu-id="ee8de-430">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="ee8de-431">Tokeny regulárního výrazu musí být uvozeny řídicími znaky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-431">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="ee8de-432">Chcete-li použít regulární výraz `^\d{3}-\d{2}-\d{4}$` ve směrování, musí mít výraz `\` (jedno zpětné lomítko), které je zadáno v řetězci jako `\\` (Dvojitá zpětná lomítka C# ) ve zdrojovém souboru, aby mohl řídicí znak `\`. znak (Pokud nepoužíváte [doslovné řetězce literálů](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="ee8de-432">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="ee8de-433">Chcete-li řídicí znaky oddělovače parametrů směrování (`{`, `}`, `[`, `]`), poklikejte na znaky ve výrazu (`{{`, `}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-433">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="ee8de-434">V následující tabulce je uveden regulární výraz a verze s řídicím znakem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-434">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="ee8de-435">Regulární výraz</span><span class="sxs-lookup"><span data-stu-id="ee8de-435">Regular Expression</span></span>    | <span data-ttu-id="ee8de-436">Regulární výraz s řídicím znakem</span><span class="sxs-lookup"><span data-stu-id="ee8de-436">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="ee8de-437">Regulární výrazy používané v směrování často začínají znakem stříšky (`^`) a odpovídají počáteční pozici řetězce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-437">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="ee8de-438">Výrazy často končí znakem dolaru (`$`) a koncem řetězce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-438">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="ee8de-439">Znaky `^` a `$` zajišťují, že regulární výraz odpovídá celé hodnotě parametru Route.</span><span class="sxs-lookup"><span data-stu-id="ee8de-439">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="ee8de-440">Bez `^` a `$` znaků regulární výraz odpovídá jakémukoli podřetězci v řetězci, což je často nežádoucí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-440">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="ee8de-441">Následující tabulka obsahuje příklady a vysvětlení, proč se shodují nebo neshodují.</span><span class="sxs-lookup"><span data-stu-id="ee8de-441">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="ee8de-442">Výraz</span><span class="sxs-lookup"><span data-stu-id="ee8de-442">Expression</span></span>   | <span data-ttu-id="ee8de-443">String</span><span class="sxs-lookup"><span data-stu-id="ee8de-443">String</span></span>    | <span data-ttu-id="ee8de-444">Shoda</span><span class="sxs-lookup"><span data-stu-id="ee8de-444">Match</span></span> | <span data-ttu-id="ee8de-445">Komentář</span><span class="sxs-lookup"><span data-stu-id="ee8de-445">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-446">Dobrý den</span><span class="sxs-lookup"><span data-stu-id="ee8de-446">hello</span></span>     | <span data-ttu-id="ee8de-447">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-447">Yes</span></span>   | <span data-ttu-id="ee8de-448">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ee8de-448">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-449">123abc456</span><span class="sxs-lookup"><span data-stu-id="ee8de-449">123abc456</span></span> | <span data-ttu-id="ee8de-450">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-450">Yes</span></span>   | <span data-ttu-id="ee8de-451">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ee8de-451">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-452">MZ</span><span class="sxs-lookup"><span data-stu-id="ee8de-452">mz</span></span>        | <span data-ttu-id="ee8de-453">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-453">Yes</span></span>   | <span data-ttu-id="ee8de-454">Výraz shody</span><span class="sxs-lookup"><span data-stu-id="ee8de-454">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-455">MZ</span><span class="sxs-lookup"><span data-stu-id="ee8de-455">MZ</span></span>        | <span data-ttu-id="ee8de-456">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-456">Yes</span></span>   | <span data-ttu-id="ee8de-457">Nerozlišuje velká a malá písmena</span><span class="sxs-lookup"><span data-stu-id="ee8de-457">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="ee8de-458">Dobrý den</span><span class="sxs-lookup"><span data-stu-id="ee8de-458">hello</span></span>     | <span data-ttu-id="ee8de-459">Ne</span><span class="sxs-lookup"><span data-stu-id="ee8de-459">No</span></span>    | <span data-ttu-id="ee8de-460">Viz `^` a `$` výše.</span><span class="sxs-lookup"><span data-stu-id="ee8de-460">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="ee8de-461">123abc456</span><span class="sxs-lookup"><span data-stu-id="ee8de-461">123abc456</span></span> | <span data-ttu-id="ee8de-462">Ne</span><span class="sxs-lookup"><span data-stu-id="ee8de-462">No</span></span>    | <span data-ttu-id="ee8de-463">Viz `^` a `$` výše.</span><span class="sxs-lookup"><span data-stu-id="ee8de-463">See `^` and `$` above</span></span> |

<span data-ttu-id="ee8de-464">Další informace o syntaxi regulárního výrazu naleznete v tématu [.NET Framework regulární výrazy](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="ee8de-464">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="ee8de-465">Chcete-li omezit parametr na známou sadu možných hodnot, použijte regulární výraz.</span><span class="sxs-lookup"><span data-stu-id="ee8de-465">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="ee8de-466">`{action:regex(^(list|get|create)$)}` například odpovídá pouze hodnotě `action` trasy `list`, `get`nebo `create`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-466">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="ee8de-467">Pokud se předává do slovníku omezení, `^(list|get|create)$` řetězec je ekvivalentní.</span><span class="sxs-lookup"><span data-stu-id="ee8de-467">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="ee8de-468">Omezení, která jsou předána do slovníku omezení (nejsou vložena v rámci šablony), která neodpovídají jednomu ze známých omezení, jsou také považována za regulární výrazy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-468">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="ee8de-469">Vlastní omezení trasy</span><span class="sxs-lookup"><span data-stu-id="ee8de-469">Custom Route Constraints</span></span>

<span data-ttu-id="ee8de-470">Kromě předdefinovaných omezení trasy je možné vytvořit vlastní omezení trasy implementací rozhraní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-470">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="ee8de-471">Rozhraní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> obsahuje jedinou metodu, `Match`, která vrací `true`, pokud je omezení splněno a `false` jinak.</span><span class="sxs-lookup"><span data-stu-id="ee8de-471">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="ee8de-472">Pokud chcete použít vlastní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, musí být typ omezení trasy zaregistrovaný v <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> aplikace v kontejneru služby aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-472">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="ee8de-473"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> je slovník, který mapuje klíče omezení tras na <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementace, které tyto omezení ověřují.</span><span class="sxs-lookup"><span data-stu-id="ee8de-473">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="ee8de-474"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> aplikace lze v `Startup.ConfigureServices` aktualizovat buď jako součást [služeb. AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) volání nebo konfigurací <xref:Microsoft.AspNetCore.Routing.RouteOptions> přímo pomocí `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-474">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="ee8de-475">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ee8de-475">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="ee8de-476">Omezení lze následně použít na trasy obvyklým způsobem pomocí názvu zadaného při registraci typu omezení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-476">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="ee8de-477">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ee8de-477">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="ee8de-478">Odkaz na transformátor – parametr</span><span class="sxs-lookup"><span data-stu-id="ee8de-478">Parameter transformer reference</span></span>

<span data-ttu-id="ee8de-479">Transformátory parametrů:</span><span class="sxs-lookup"><span data-stu-id="ee8de-479">Parameter transformers:</span></span>

* <span data-ttu-id="ee8de-480">Provede se při generování odkazu pro <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-480">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="ee8de-481">Implementujte `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-481">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="ee8de-482">Jsou nakonfigurovány pomocí <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-482">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="ee8de-483">Převeďte hodnotu trasy parametru a Transformujte ji na novou řetězcovou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-483">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="ee8de-484">Výsledkem použití transformované hodnoty ve vygenerovaném odkazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-484">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="ee8de-485">Například vlastní parametr `slugify` Transformer ve vzoru směrování `blog\{article:slugify}` s `Url.Action(new { article = "MyTestArticle" })` generuje `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-485">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="ee8de-486">Chcete-li použít transformující parametr ve schématu směrování, nakonfigurujte jej nejprve pomocí <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-486">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="ee8de-487">Transformátory parametrů používá rozhraní k transformaci identifikátoru URI, kde se Endpoint vyřeší.</span><span class="sxs-lookup"><span data-stu-id="ee8de-487">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="ee8de-488">ASP.NET Core MVC například používá transformaci parametrů k transformaci hodnoty trasy používané pro shodu `area`, `controller`, `action`a `page`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-488">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="ee8de-489">U předchozí trasy se `SubscriptionManagementController.GetAll()` akce shodují s identifikátorem URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-489">With the preceding route, the action `SubscriptionManagementController.GetAll()` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="ee8de-490">Transformující parametr nemění hodnoty trasy použité k vygenerování odkazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-490">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="ee8de-491">Například `Url.Action("GetAll", "SubscriptionManagement")` výstupy `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-491">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="ee8de-492">ASP.NET Core poskytuje konvence rozhraní API pro použití parametrů Transformers s vygenerovanými trasami:</span><span class="sxs-lookup"><span data-stu-id="ee8de-492">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="ee8de-493">ASP.NET Core MVC má `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention`ou konvenci rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ee8de-493">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="ee8de-494">Tato konvence aplikuje na všechny trasy atributů v aplikaci zadaného parametru Transformer.</span><span class="sxs-lookup"><span data-stu-id="ee8de-494">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="ee8de-495">Parametr Transformer transformuje tokeny, když jsou nahrazeny.</span><span class="sxs-lookup"><span data-stu-id="ee8de-495">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="ee8de-496">Další informace najdete v tématu [Použití transformátoru parametrů k přizpůsobení náhrady tokenu](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="ee8de-496">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="ee8de-497">Razor Pages má `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` konvence rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ee8de-497">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="ee8de-498">Tato konvence u všech automaticky zjištěných Razor Pages aplikuje zadaný transformátor parametrů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-498">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="ee8de-499">Parametr Transformer přetransformuje segmenty složky a názvu souboru na trasy Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ee8de-499">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="ee8de-500">Další informace najdete v tématu [Použití transformátoru parametrů k přizpůsobení cest stránky](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="ee8de-500">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="ee8de-501">Odkaz na generování adresy URL</span><span class="sxs-lookup"><span data-stu-id="ee8de-501">URL generation reference</span></span>

<span data-ttu-id="ee8de-502">Následující příklad ukazuje, jak vygenerovat odkaz na trasu s ohledem na slovník hodnot směrování a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-502">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="ee8de-503"><xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> vygenerované na konci předchozí ukázky je `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-503">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="ee8de-504">Slovník poskytuje `operation` a `id` hodnoty trasy pro šablonu sledování trasy balíčku `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-504">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="ee8de-505">Podrobnosti najdete v ukázkovém kódu v části [použití middleware pro směrování](#use-routing-middleware) nebo v [ukázkové aplikaci](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="ee8de-505">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="ee8de-506">Druhý parametr pro konstruktor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> je kolekcí *hodnot okolí*.</span><span class="sxs-lookup"><span data-stu-id="ee8de-506">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="ee8de-507">Okolní hodnoty jsou vhodné k použití, protože omezují počet hodnot, které vývojář musí určit v rámci kontextu požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-507">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="ee8de-508">Aktuální hodnoty trasy aktuálního požadavku jsou považovány za okolní hodnoty pro generování odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-508">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="ee8de-509">V akci `About` `HomeController`aplikace ASP.NET Core MVC není nutné zadávat hodnotu trasy kontroleru, která se má propojit s `Index` akcí&mdash;je použita ambientní hodnota `Home`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-509">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="ee8de-510">Okolní hodnoty, které se neshodují s parametrem, se ignorují.</span><span class="sxs-lookup"><span data-stu-id="ee8de-510">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="ee8de-511">Okolní hodnoty jsou také ignorovány, pokud explicitně poskytnutá hodnota Přepisuje hodnotu okolí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-511">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="ee8de-512">K shodě dojde zleva doprava v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-512">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="ee8de-513">Hodnoty jsou výslovně poskytnuty, ale neodpovídají segmentu trasy, jsou přidány do řetězce dotazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-513">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="ee8de-514">V následující tabulce je uveden výsledek při použití `{controller}/{action}/{id?}`šablony směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-514">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="ee8de-515">Okolní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ee8de-515">Ambient Values</span></span>                     | <span data-ttu-id="ee8de-516">Explicitní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ee8de-516">Explicit Values</span></span>                        | <span data-ttu-id="ee8de-517">Výsledek</span><span class="sxs-lookup"><span data-stu-id="ee8de-517">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="ee8de-518">Controller = "domů"</span><span class="sxs-lookup"><span data-stu-id="ee8de-518">controller = "Home"</span></span>                | <span data-ttu-id="ee8de-519">Action = "o"</span><span class="sxs-lookup"><span data-stu-id="ee8de-519">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ee8de-520">Controller = "domů"</span><span class="sxs-lookup"><span data-stu-id="ee8de-520">controller = "Home"</span></span>                | <span data-ttu-id="ee8de-521">Controller = "objednávka"; Action = "o"</span><span class="sxs-lookup"><span data-stu-id="ee8de-521">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="ee8de-522">Controller = "Home"; Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="ee8de-522">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="ee8de-523">Action = "o"</span><span class="sxs-lookup"><span data-stu-id="ee8de-523">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ee8de-524">Controller = "domů"</span><span class="sxs-lookup"><span data-stu-id="ee8de-524">controller = "Home"</span></span>                | <span data-ttu-id="ee8de-525">Action = "o", Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="ee8de-525">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="ee8de-526">Pokud má trasa výchozí hodnotu, která neodpovídá parametru a tato hodnota je explicitně poskytnutá, musí se shodovat s výchozí hodnotou:</span><span class="sxs-lookup"><span data-stu-id="ee8de-526">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="ee8de-527">Generace odkazů generuje odkaz pro tuto trasu, pokud jsou k dispozici hodnoty pro `controller` a `action`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-527">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="ee8de-528">Komplexní segmenty</span><span class="sxs-lookup"><span data-stu-id="ee8de-528">Complex segments</span></span>

<span data-ttu-id="ee8de-529">Komplexní segmenty (například `[Route("/x{token}y")]`) jsou zpracovávány porovnáním koncových literálů zprava doleva nehladým způsobem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-529">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="ee8de-530">Podrobné vysvětlení, jak se shodují komplexní segmenty, najdete v [tomto kódu](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-530">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="ee8de-531">[Ukázka kódu](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) není používána ASP.NET Core, ale poskytuje dobré vysvětlení složitých segmentů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-531">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/aspnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

## <a name="configuring-endpoint-metadata"></a><span data-ttu-id="ee8de-532">Konfigurace metadat koncového bodu</span><span class="sxs-lookup"><span data-stu-id="ee8de-532">Configuring endpoint metadata</span></span>

<span data-ttu-id="ee8de-533">Následující odkazy obsahují informace o konfiguraci metadat koncového bodu:</span><span class="sxs-lookup"><span data-stu-id="ee8de-533">The following links provide information on configuring endpoint metadata:</span></span>

* [<span data-ttu-id="ee8de-534">Povolení CORS s směrováním koncových bodů</span><span class="sxs-lookup"><span data-stu-id="ee8de-534">Enable Cors with endpoint routing</span></span>](xref:security/cors#enable-cors-with-endpoint-routing)
* <span data-ttu-id="ee8de-535">[Ukázka IAuthorizationPolicyProvider](https://github.com/aspnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) s použitím vlastního atributu `[MinimumAgeAuthorize]`</span><span class="sxs-lookup"><span data-stu-id="ee8de-535">[IAuthorizationPolicyProvider sample](https://github.com/aspnet/AspNetCore/tree/release/3.0/src/Security/samples/CustomPolicyProvider) using a custom `[MinimumAgeAuthorize]` attribute</span></span>
* <span data-ttu-id="ee8de-536">[Test ověřování pomocí atributu [autorizovat]](xref:security/authentication/identity#test-identity)</span><span class="sxs-lookup"><span data-stu-id="ee8de-536">[Test authentication with the [Authorize] attribute](xref:security/authentication/identity#test-identity)</span></span>
* <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*>
* <span data-ttu-id="ee8de-537">[Výběr schématu pomocí atributu [autorizovat]](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span><span class="sxs-lookup"><span data-stu-id="ee8de-537">[Selecting the scheme with the [Authorize] attribute](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span></span>
* <span data-ttu-id="ee8de-538">[Použití zásad pomocí atributu [autorizační]](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span><span class="sxs-lookup"><span data-stu-id="ee8de-538">[Applying policies using the [Authorize] attribute](xref:security/authorization/policies#applying-policies-to-mvc-controllers)</span></span>
* <xref:security/authorization/roles>

<a name="hostmatch"></a>

## <a name="host-matching-in-routes-with-requirehost"></a><span data-ttu-id="ee8de-539">Přiřazení hostitelů v cestách pomocí RequireHost</span><span class="sxs-lookup"><span data-stu-id="ee8de-539">Host matching in routes with RequireHost</span></span>

<span data-ttu-id="ee8de-540">`RequireHost` aplikuje omezení na trasu, která vyžaduje zadaného hostitele.</span><span class="sxs-lookup"><span data-stu-id="ee8de-540">`RequireHost` applies a constraint to the route which requires the specified host.</span></span> <span data-ttu-id="ee8de-541">Parametr `RequireHost` nebo `[Host]` může být:</span><span class="sxs-lookup"><span data-stu-id="ee8de-541">The `RequireHost` or `[Host]` parameter can be:</span></span>

* <span data-ttu-id="ee8de-542">Hostitel: `www.domain.com` (odpovídá `www.domain.com` s libovolným portem)</span><span class="sxs-lookup"><span data-stu-id="ee8de-542">Host: `www.domain.com` (matches `www.domain.com` with any port)</span></span>
* <span data-ttu-id="ee8de-543">Hostitel se zástupnými znaky: `*.domain.com` (odpovídá `www.domain.com`, `subdomain.domain.com`nebo `www.subdomain.domain.com` na jakémkoli portu)</span><span class="sxs-lookup"><span data-stu-id="ee8de-543">Host with wildcard: `*.domain.com` (matches `www.domain.com`, `subdomain.domain.com`, or `www.subdomain.domain.com` on any port)</span></span>
* <span data-ttu-id="ee8de-544">Port: `*:5000` (odpovídá portu 5000 s jakýmkoli hostitelem)</span><span class="sxs-lookup"><span data-stu-id="ee8de-544">Port: `*:5000` (matches port 5000 with any host)</span></span>
* <span data-ttu-id="ee8de-545">Hostitel a port: `www.domain.com:5000`, `*.domain.com:5000` (odpovídá hostiteli a portu)</span><span class="sxs-lookup"><span data-stu-id="ee8de-545">Host and port: `www.domain.com:5000`, `*.domain.com:5000` (matches host and port)</span></span>

<span data-ttu-id="ee8de-546">Pomocí `RequireHost` nebo `[Host]`lze zadat více parametrů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-546">Multiple parameters can be specified using `RequireHost` or `[Host]`.</span></span> <span data-ttu-id="ee8de-547">Omezení bude odpovídat hostitelům platným pro libovolný parametr.</span><span class="sxs-lookup"><span data-stu-id="ee8de-547">The constraint will match hosts valid for any of the parameters.</span></span> <span data-ttu-id="ee8de-548">Například `[Host("domain.com", "*.domain.com")]` bude odpovídat `domain.com`, `www.domain.com`nebo `subdomain.domain.com`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-548">For example, `[Host("domain.com", "*.domain.com")]` will match `domain.com`, `www.domain.com`, or `subdomain.domain.com`.</span></span>

<span data-ttu-id="ee8de-549">Následující kód používá `RequireHost` pro vyžadování zadaného hostitele v trase:</span><span class="sxs-lookup"><span data-stu-id="ee8de-549">The following code uses `RequireHost` to require the specified host on the route:</span></span>

```csharp
public void Configure(IApplicationBuilder app)
{
    app.UseRouting();

    app.UseEndpoints(endpoints =>
    {
        endpoints.MapGet("/", context => context.Response.WriteAsync("Hi Contoso!"))
            .RequireHost("contoso.com");
        endpoints.MapGet("/", context => context.Response.WriteAsync("Hi AdventureWorks!"))
            .RequireHost("adventure-works.com");
        endpoints.MapHealthChecks("/healthz").RequireHost("*:8080");
    });
}
```

<span data-ttu-id="ee8de-550">Následující kód používá atribut `[Host]` pro vyžadování zadaného hostitele na řadiči:</span><span class="sxs-lookup"><span data-stu-id="ee8de-550">The following code uses the `[Host]` attribute to require the specified host on the controller:</span></span>

```csharp
[Host("contoso.com", "adventure-works.com")]
public class HomeController : Controller
{
    private readonly ILogger<HomeController> _logger;

    public HomeController(ILogger<HomeController> logger)
    {
        _logger = logger;
    }

    public IActionResult Index()
    {
        return View();
    }

    [Host("example.com:8080")]
    public IActionResult Privacy()
    {
        return View();
    }

}
```

<span data-ttu-id="ee8de-551">Při použití atributu `[Host]` pro metodu Controller i Action:</span><span class="sxs-lookup"><span data-stu-id="ee8de-551">When the `[Host]` attribute is applied to both the controller and action method:</span></span>

* <span data-ttu-id="ee8de-552">Atribut akce je použit.</span><span class="sxs-lookup"><span data-stu-id="ee8de-552">The attribute on the action is used.</span></span>
* <span data-ttu-id="ee8de-553">Atribut kontroleru se ignoruje.</span><span class="sxs-lookup"><span data-stu-id="ee8de-553">The controller attribute is ignored.</span></span>

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="ee8de-554">Směrování zodpovídá za mapování identifikátorů URI požadavků na koncové body a odesílání příchozích požadavků do těchto koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-554">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="ee8de-555">Trasy jsou v aplikaci definované a nakonfigurované při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-555">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="ee8de-556">Trasa může volitelně extrahovat hodnoty z adresy URL obsažené v žádosti a tyto hodnoty pak lze použít pro zpracování požadavků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-556">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="ee8de-557">Směrování pomocí informací o trasách z aplikace taky umožňuje generovat adresy URL, které se mapují na koncové body.</span><span class="sxs-lookup"><span data-stu-id="ee8de-557">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="ee8de-558">Pokud chcete použít nejnovější scénáře směrování v ASP.NET Core 2,2, zadejte [verzi kompatibility](xref:mvc/compatibility-version) pro registraci služby MVC v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-558">To use the latest routing scenarios in ASP.NET Core 2.2, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="ee8de-559">Možnost <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> určuje, zda má směrování interně používat logiku založenou na koncovém bodu nebo logiku založenou na <xref:Microsoft.AspNetCore.Routing.IRouter>ch ASP.NET Core 2,1 nebo starší verze.</span><span class="sxs-lookup"><span data-stu-id="ee8de-559">The <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> option determines if routing should internally use endpoint-based logic or the <xref:Microsoft.AspNetCore.Routing.IRouter>-based logic of ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="ee8de-560">Pokud je verze kompatibility nastavená na 2,2 nebo novější, výchozí hodnota je `true`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-560">When the compatibility version is set to 2.2 or later, the default value is `true`.</span></span> <span data-ttu-id="ee8de-561">Nastavte hodnotu na `false`, aby se použila předchozí logika směrování:</span><span class="sxs-lookup"><span data-stu-id="ee8de-561">Set the value to `false` to use the prior routing logic:</span></span>

```csharp
// Use the routing logic of ASP.NET Core 2.1 or earlier:
services.AddMvc(options => options.EnableEndpointRouting = false)
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="ee8de-562">Další informace o směrování na základě <xref:Microsoft.AspNetCore.Routing.IRouter>najdete v [tomto tématu v ASP.NET Core 2,1 verze tohoto tématu](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="ee8de-562">For more information on <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, see the [ASP.NET Core 2.1 version of this topic](/aspnet/core/fundamentals/routing?view=aspnetcore-2.1).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ee8de-563">Tento dokument popisuje směrování ASP.NET Core nízké úrovně.</span><span class="sxs-lookup"><span data-stu-id="ee8de-563">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="ee8de-564">Informace o ASP.NET Core směrování MVC najdete v tématu <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-564">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="ee8de-565">Informace o konvencích směrování v Razor Pages najdete v tématu <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-565">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ee8de-566">[Zobrazit nebo stáhnout ukázkový kód](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([Jak stáhnout](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="ee8de-566">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="ee8de-567">Základy směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-567">Routing basics</span></span>

<span data-ttu-id="ee8de-568">Většina aplikací by měla zvolit základní a popisné schéma směrování, aby byly adresy URL čitelné a smysluplné.</span><span class="sxs-lookup"><span data-stu-id="ee8de-568">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="ee8de-569">Výchozí konvenční trasa `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-569">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="ee8de-570">Podporuje základní a popisné schéma směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-570">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="ee8de-571">Je užitečným výchozím bodem pro aplikace založené na uživatelském rozhraní.</span><span class="sxs-lookup"><span data-stu-id="ee8de-571">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="ee8de-572">Vývojáři obvykle přidávají další stručný trasy do oblastí s vysokým provozem v aplikaci ve zvláštních situacích (například koncové body blogu a elektronického obchodování) pomocí [Směrování atributů](xref:mvc/controllers/routing#attribute-routing) nebo vyhrazených konvenčních tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-572">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="ee8de-573">Webové rozhraní API by mělo používat směrování atributů k modelování funkcí aplikace jako sady prostředků, ve kterých jsou operace reprezentované příkazy HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee8de-573">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="ee8de-574">To znamená, že mnoho operací (například GET, POST) na stejném logickém prostředku bude používat stejnou adresu URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-574">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="ee8de-575">Směrování atributů poskytuje úroveň řízení, která je nutná k pečlivému návrhu rozložení veřejného koncového bodu rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ee8de-575">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="ee8de-576">Aplikace Razor Pages používají výchozí konvenční směrování pro obsluhu pojmenovaných prostředků ve složce *Pages* v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-576">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="ee8de-577">K dispozici jsou další konvence, které vám umožní přizpůsobit Razor Pages chování směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-577">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="ee8de-578">Další informace naleznete v tématu <xref:razor-pages/index> a <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-578">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ee8de-579">Podpora generování adresy URL umožňuje, aby se aplikace vyvinula bez adres URL s pevným kódováním, aby bylo možné propojit aplikaci dohromady.</span><span class="sxs-lookup"><span data-stu-id="ee8de-579">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="ee8de-580">Tato podpora umožňuje začít se základní konfigurací směrování a upravovat trasy po určení rozložení prostředků aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-580">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="ee8de-581">Směrování používá pro reprezentaci logických koncových bodů v aplikaci *koncové body* (`Endpoint`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-581">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="ee8de-582">Koncový bod definuje delegáta pro zpracování požadavků a kolekci libovolných metadat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-582">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="ee8de-583">Metadata se používají k implementaci průřezů na základě zásad a konfigurace připojených ke každému koncovému bodu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-583">The metadata is used implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="ee8de-584">Systém směrování má následující vlastnosti:</span><span class="sxs-lookup"><span data-stu-id="ee8de-584">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="ee8de-585">Syntaxe šablony směrování se používá k definování tras s tokeny parametrů trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-585">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="ee8de-586">Konfigurace koncového bodu stylů a stylu atributu je povolena.</span><span class="sxs-lookup"><span data-stu-id="ee8de-586">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="ee8de-587"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> slouží k určení, zda parametr adresy URL obsahuje platnou hodnotu pro dané omezení koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-587"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="ee8de-588">Modely aplikací, jako je MVC/Razor Pages, registrují všechny své koncové body, které mají předvídatelné implementaci scénářů směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-588">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="ee8de-589">Implementace směrování provádí rozhodování o směrování všude, kde je to požadováno v kanálu middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-589">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="ee8de-590">Middleware, který se zobrazí po vytvoření middlewaru směrování, může zkontrolovat výsledek rozhodnutí koncového bodu middleware směrování pro daný identifikátor URI žádosti.</span><span class="sxs-lookup"><span data-stu-id="ee8de-590">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="ee8de-591">Je možné vytvořit výčet všech koncových bodů v aplikaci kdekoli v kanálu middlewaru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-591">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="ee8de-592">Aplikace může používat směrování k vygenerování adres URL (například pro přesměrování nebo propojení) na základě informací o koncových bodech, takže se vyhnete pevně zakódovaným adresám URL, které pomáhají zachovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-592">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="ee8de-593">Generování adresy URL vychází z adres, které podporují libovolné rozšíření:</span><span class="sxs-lookup"><span data-stu-id="ee8de-593">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="ee8de-594">Rozhraní API generátoru odkazů (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) je možné vyřešit kdekoli pomocí [vkládání závislostí (di)](xref:fundamentals/dependency-injection) pro generování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-594">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="ee8de-595">Pokud rozhraní API generátoru odkazů není k dispozici prostřednictvím DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> nabízí metody pro sestavování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-595">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="ee8de-596">S vydáním směrování koncových bodů v ASP.NET Core 2,2 je propojení koncových bodů omezené na akce a stránky MVC/Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ee8de-596">With the release of endpoint routing in ASP.NET Core 2.2, endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="ee8de-597">Pro budoucí verze jsou plánovány rozšíření funkcí pro propojení koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-597">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="ee8de-598">Směrování je připojené k kanálu [middlewaru](xref:fundamentals/middleware/index) pomocí třídy <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-598">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="ee8de-599">[ASP.NET Core MVC](xref:mvc/overview) v rámci své konfigurace přidává směrování do kanálu middlewaru a zpracovává směrování v MVC a Razor Pages aplikacích.</span><span class="sxs-lookup"><span data-stu-id="ee8de-599">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="ee8de-600">Informace o tom, jak používat směrování jako samostatnou součást, najdete v části [použití middlewaru pro směrování](#use-routing-middleware) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-600">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="ee8de-601">Shoda adresy URL</span><span class="sxs-lookup"><span data-stu-id="ee8de-601">URL matching</span></span>

<span data-ttu-id="ee8de-602">Shoda adresy URL je proces, podle kterého směrování odešle příchozí požadavek na *koncový bod*.</span><span class="sxs-lookup"><span data-stu-id="ee8de-602">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="ee8de-603">Tento proces je založený na datech v cestě URL, ale dá se rozšířit, aby v žádosti mohla být považovat všechna data.</span><span class="sxs-lookup"><span data-stu-id="ee8de-603">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="ee8de-604">Schopnost odesílat žádosti na samostatné obslužné rutiny je klíč pro škálování velikosti a složitosti aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-604">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="ee8de-605">Systém směrování v rámci směrování koncových bodů zodpovídá za všechna rozhodnutí o odesílání.</span><span class="sxs-lookup"><span data-stu-id="ee8de-605">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="ee8de-606">Vzhledem k tomu, že middleware používá zásady na základě vybraného koncového bodu, je důležité, aby jakékoli rozhodnutí, které může ovlivnit odesílání nebo použití zásad zabezpečení, bylo provedeno v rámci systému směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-606">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="ee8de-607">Po spuštění delegáta koncového bodu jsou vlastnosti [RouteContext. parametr RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) nastaveny na odpovídající hodnoty na základě dosud provedeného zpracování požadavků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-607">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="ee8de-608">[Parametr RouteData. Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) je slovník *hodnot tras* vytvořených z trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-608">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="ee8de-609">Tyto hodnoty se obvykle určují pomocí tokenizací adresy URL a dají se použít k přijetí vstupu uživatele nebo k dalšímu odesílání rozhodnutí v rámci aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-609">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="ee8de-610">[Parametr RouteData. DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) je kontejner objektů a dat pro další data související s odpovídající trasou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-610">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="ee8de-611"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> jsou k dispozici pro podporu přidružování dat o stavu k jednotlivým cestám, aby aplikace mohla učinit rozhodnutí na základě toho, na které trase odpovídá.</span><span class="sxs-lookup"><span data-stu-id="ee8de-611"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="ee8de-612">Tyto hodnoty jsou definované vývojářem a **neovlivňují chování** směrování jakýmkoli způsobem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-612">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="ee8de-613">Kromě toho hodnoty dočasně ukládané v [parametr RouteData. Datatokeny](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) můžou být libovolného typu, na rozdíl od [parametr RouteData. Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), které musí být převoditelné na a z řetězců.</span><span class="sxs-lookup"><span data-stu-id="ee8de-613">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="ee8de-614">[Parametr RouteData. routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) je seznam tras, které byly součástí úspěšného porovnání požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-614">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="ee8de-615">Trasy mohou být vnořeny do sebe navzájem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-615">Routes can be nested inside of one another.</span></span> <span data-ttu-id="ee8de-616">Vlastnost <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> odráží cestu v logickém stromu tras, jejichž výsledkem byla shoda.</span><span class="sxs-lookup"><span data-stu-id="ee8de-616">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="ee8de-617">Obecně platí, že první položka v <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> je kolekce tras a měla by se používat pro generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-617">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="ee8de-618">Poslední položka v <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> je obslužná rutina trasy, která se shoduje.</span><span class="sxs-lookup"><span data-stu-id="ee8de-618">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="ee8de-619">Generování adresy URL pomocí LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="ee8de-619">URL generation with LinkGenerator</span></span>

<span data-ttu-id="ee8de-620">Generování adresy URL je proces, podle kterého směrování může vytvořit cestu adresy URL na základě sady hodnot tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-620">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="ee8de-621">To umožňuje logické oddělení mezi vašimi koncovými body a adresami URL, které k nim mají přístup.</span><span class="sxs-lookup"><span data-stu-id="ee8de-621">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="ee8de-622">Směrování koncového bodu zahrnuje rozhraní API generátoru odkazů (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span><span class="sxs-lookup"><span data-stu-id="ee8de-622">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="ee8de-623"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> je služba typu Singleton, kterou lze načíst z DI.</span><span class="sxs-lookup"><span data-stu-id="ee8de-623"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from DI.</span></span> <span data-ttu-id="ee8de-624">Rozhraní API lze použít mimo kontext vykonávajícího požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-624">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="ee8de-625"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> a scénáře MVC, které spoléhají na <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, jako jsou například [pomocníky značek](xref:mvc/views/tag-helpers/intro), HTML a [výsledky akcí](xref:mvc/controllers/actions), používají generátor propojení k poskytování možností vytváření odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-625">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="ee8de-626">Generátor propojení se zálohuje konceptem *adres* a *schémat adres*.</span><span class="sxs-lookup"><span data-stu-id="ee8de-626">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="ee8de-627">Schéma adres je způsob, jak určit koncové body, které by měly být považovány za vytváření odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-627">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="ee8de-628">Například název trasy a hodnoty tras vycházejí z MVC/Razor Pages jsou implementovány jako schéma adres.</span><span class="sxs-lookup"><span data-stu-id="ee8de-628">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="ee8de-629">Generátor propojení může propojit s akcemi MVC/Razor Pages a stránkami prostřednictvím následujících rozšiřujících metod:</span><span class="sxs-lookup"><span data-stu-id="ee8de-629">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="ee8de-630">Přetížení těchto metod akceptuje argumenty, které zahrnují `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-630">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="ee8de-631">Tyto metody jsou funkčně ekvivalentní `Url.Action` a `Url.Page`, ale nabízejí další flexibilitu a možnosti.</span><span class="sxs-lookup"><span data-stu-id="ee8de-631">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="ee8de-632">Metody `GetPath*` jsou nejvíce podobné `Url.Action` a `Url.Page` v tom, že generují identifikátor URI obsahující absolutní cestu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-632">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="ee8de-633">Metody `GetUri*` vždy generují absolutní identifikátor URI obsahující schéma a hostitele.</span><span class="sxs-lookup"><span data-stu-id="ee8de-633">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="ee8de-634">Metody, které přijímají `HttpContext` generují identifikátor URI v kontextu zpracovávaného požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-634">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="ee8de-635">Použijí se hodnoty tras, základní cesta, schéma a hostitel z zpracovávaného požadavku, pokud nejsou přepsány.</span><span class="sxs-lookup"><span data-stu-id="ee8de-635">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="ee8de-636"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> se volá s adresou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-636"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="ee8de-637">K vygenerování identifikátoru URI dochází ve dvou krocích:</span><span class="sxs-lookup"><span data-stu-id="ee8de-637">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="ee8de-638">Adresa je svázána se seznamem koncových bodů, které odpovídají dané adrese.</span><span class="sxs-lookup"><span data-stu-id="ee8de-638">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="ee8de-639">`RoutePattern` každého koncového bodu se vyhodnotí, dokud se nenajde vzor směrování, který odpovídá zadaným hodnotám.</span><span class="sxs-lookup"><span data-stu-id="ee8de-639">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="ee8de-640">Výsledný výstup je v kombinaci s ostatními částmi identifikátoru URI dodanými generátorem odkazů a vrácenými.</span><span class="sxs-lookup"><span data-stu-id="ee8de-640">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="ee8de-641">Metody poskytované <xref:Microsoft.AspNetCore.Routing.LinkGenerator> podporují možnosti generování standardních odkazů pro jakýkoli typ adresy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-641">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="ee8de-642">Nejpohodlnější způsob použití generátoru odkazů je prostřednictvím metod rozšíření, které provádějí operace pro konkrétní typ adresy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-642">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="ee8de-643">Metoda rozšíření</span><span class="sxs-lookup"><span data-stu-id="ee8de-643">Extension Method</span></span>   | <span data-ttu-id="ee8de-644">Popis</span><span class="sxs-lookup"><span data-stu-id="ee8de-644">Description</span></span>                                                         |
| ------------------ | ------------------------------------------------------------------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="ee8de-645">Vygeneruje identifikátor URI s absolutní cestou na základě zadaných hodnot.</span><span class="sxs-lookup"><span data-stu-id="ee8de-645">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="ee8de-646">Vygeneruje absolutní identifikátor URI na základě zadaných hodnot.</span><span class="sxs-lookup"><span data-stu-id="ee8de-646">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="ee8de-647">Věnujte pozornost následujícím důsledkům při volání <xref:Microsoft.AspNetCore.Routing.LinkGenerator>ch metod:</span><span class="sxs-lookup"><span data-stu-id="ee8de-647">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="ee8de-648">Používejte `GetUri*` rozšiřujících metod s opatrností v konfiguraci aplikace, která neověřuje `Host` hlavičku příchozích požadavků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-648">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="ee8de-649">Pokud `Host` záhlaví příchozích požadavků není ověřeno, lze nedůvěryhodný vstup žádosti poslat zpátky klientovi v identifikátorech URI na stránce zobrazení nebo stránky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-649">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="ee8de-650">Doporučujeme, aby všechny produkční aplikace nakonfigurovaly server tak, aby ověřili `Host` hlavičku se známými platnými hodnotami.</span><span class="sxs-lookup"><span data-stu-id="ee8de-650">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="ee8de-651">Používejte <xref:Microsoft.AspNetCore.Routing.LinkGenerator> s opatrností v middleware v kombinaci s `Map` nebo `MapWhen`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-651">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="ee8de-652">`Map*` změní základní cestu spouštěné žádosti, která má vliv na výstup generace propojení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-652">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="ee8de-653">Všechna rozhraní <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API umožňují zadat základní cestu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-653">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="ee8de-654">Vždy zadat prázdnou základní cestu pro vrácení zpět `Map*`vlivu na generování propojení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-654">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="ee8de-655">Rozdíly oproti starším verzím směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-655">Differences from earlier versions of routing</span></span>

<span data-ttu-id="ee8de-656">Mezi směrováním koncových bodů existuje několik rozdílů v ASP.NET Core 2,2 nebo novějším a starších verzích směrování v ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="ee8de-656">A few differences exist between endpoint routing in ASP.NET Core 2.2 or later and earlier versions of routing in ASP.NET Core:</span></span>

* <span data-ttu-id="ee8de-657">Systém směrování koncových bodů nepodporuje rozšíření na základě <xref:Microsoft.AspNetCore.Routing.IRouter>, včetně dědění z <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-657">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="ee8de-658">Směrování koncového bodu nepodporuje [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="ee8de-658">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="ee8de-659">Chcete-li pokračovat v používání překrytí kompatibility, použijte [verzi kompatibility](xref:mvc/compatibility-version) 2,1 (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-659">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="ee8de-660">Směrování koncového bodu má pro velká a malá písmena vygenerovaných identifikátorů URI při použití konvenčních tras jiné chování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-660">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="ee8de-661">Vezměte v úvahu následující výchozí šablonu trasy:</span><span class="sxs-lookup"><span data-stu-id="ee8de-661">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="ee8de-662">Předpokládejme, že jste vygenerovali odkaz na akci pomocí následujícího postupu:</span><span class="sxs-lookup"><span data-stu-id="ee8de-662">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="ee8de-663">Při směrování na základě <xref:Microsoft.AspNetCore.Routing.IRouter>tento kód generuje identifikátor URI `/blog/ReadPost/17`, který respektuje velká a malá písmena zadané hodnoty trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-663">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="ee8de-664">Směrování koncových bodů v ASP.NET Core 2,2 nebo novějším vytvoří `/Blog/ReadPost/17` ("blog" je na velká písmena).</span><span class="sxs-lookup"><span data-stu-id="ee8de-664">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="ee8de-665">Směrování koncových bodů poskytuje `IOutboundParameterTransformer` rozhraní, které se dá použít k globálnímu přizpůsobení tohoto chování, nebo k aplikování různých konvencí pro mapování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-665">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="ee8de-666">Další informace najdete v části [referenční informace pro parametry transformátoru](#parameter-transformer-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-666">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="ee8de-667">Generace odkazů, kterou používá MVC/Razor Pages, se při pokusu o připojení ke kontroléru nebo akci nebo stránce, která neexistuje, chová jinak.</span><span class="sxs-lookup"><span data-stu-id="ee8de-667">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="ee8de-668">Vezměte v úvahu následující výchozí šablonu trasy:</span><span class="sxs-lookup"><span data-stu-id="ee8de-668">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="ee8de-669">Předpokládejme, že jste vygenerovali odkaz na akci s použitím výchozí šablony s následujícím:</span><span class="sxs-lookup"><span data-stu-id="ee8de-669">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="ee8de-670">Při směrování založeném na `IRouter`je výsledek vždy `/Blog/ReadPost/17`, i když `BlogController` neexistuje nebo nemá metodu `ReadPost` Action.</span><span class="sxs-lookup"><span data-stu-id="ee8de-670">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="ee8de-671">Podle očekávání, směrování koncového bodu v ASP.NET Core 2,2 nebo novější vytvoří `/Blog/ReadPost/17`, pokud existuje metoda akce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-671">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="ee8de-672">*Směrování koncových bodů ale vytvoří prázdný řetězec, pokud akce neexistuje.*</span><span class="sxs-lookup"><span data-stu-id="ee8de-672">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="ee8de-673">V koncepčním případě směrování koncového bodu nepředpokládá, že koncový bod existuje, pokud akce neexistuje.</span><span class="sxs-lookup"><span data-stu-id="ee8de-673">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="ee8de-674">Při použití s směrováním koncových bodů se *algoritmus neplatných v okolí* generování propojení chová jinak.</span><span class="sxs-lookup"><span data-stu-id="ee8de-674">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="ee8de-675">*Neplatnost okolní hodnoty* je algoritmus, který určuje, které hodnoty směrování z aktuálně prováděné žádosti (okolní hodnoty) se dají použít při operacích generování odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-675">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="ee8de-676">Konvenční směrování vždy neověřené hodnoty dodatečné trasy při propojení s jinou akcí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-676">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="ee8de-677">Směrování atributů neobsahovalo toto chování před vydáním ASP.NET Core 2,2.</span><span class="sxs-lookup"><span data-stu-id="ee8de-677">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="ee8de-678">V dřívějších verzích ASP.NET Core odkazy na jinou akci, která používá stejné názvy parametrů trasy, způsobily chyby generování odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-678">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="ee8de-679">V ASP.NET Core 2,2 nebo novějších, obě formy směrování při propojování s jinou akcí zruší hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ee8de-679">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="ee8de-680">Vezměte v úvahu následující příklad ASP.NET Core 2,1 nebo starší verze.</span><span class="sxs-lookup"><span data-stu-id="ee8de-680">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="ee8de-681">Při propojení s jinou akcí (nebo jinou stránkou) lze hodnoty směrování znovu použít nežádoucím způsobem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-681">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="ee8de-682">V */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="ee8de-682">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="ee8de-683">V */Pages/Login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="ee8de-683">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="ee8de-684">Pokud je identifikátor URI `/Store/Product/18` v ASP.NET Core 2,1 nebo starším, odkaz vygenerovaný na stránce úložiště/informace podle `@Url.Page("/Login")` je `/Login/18`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-684">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="ee8de-685">Hodnota `id` 18 se znovu použije, i když je cíl propojení jinou součástí aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-685">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="ee8de-686">Hodnota `id` trasy v kontextu stránky `/Login` je pravděpodobně hodnota ID uživatele, nikoli hodnota ID produktu úložiště.</span><span class="sxs-lookup"><span data-stu-id="ee8de-686">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="ee8de-687">V rámci směrování koncového bodu s ASP.NET Core 2,2 nebo novějším je výsledek `/Login`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-687">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="ee8de-688">Okolní hodnoty se znovu nepoužijí, pokud je cíl propojení jinou akcí nebo stránkou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-688">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="ee8de-689">Syntaxe parametru trasy s kulatým Trip: lomítka nejsou zakódována při použití syntaxe parametru catch-All (`**`) s dvojitou hvězdičkou ().</span><span class="sxs-lookup"><span data-stu-id="ee8de-689">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="ee8de-690">Během generování propojení systém směrování zakóduje hodnotu zachycenou v parametru zachycení s dvojitou hvězdičkou (`**`) (například `{**myparametername}`) s výjimkou lomítek.</span><span class="sxs-lookup"><span data-stu-id="ee8de-690">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="ee8de-691">U `IRouter`ho směrování v ASP.NET Core 2,2 nebo novějších se podporuje také zachycení pomocí dvojité hvězdičky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-691">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="ee8de-692">V předchozích verzích ASP.NET Core (`{*myparametername}`) zůstane podporovaná jednoduchá hvězdička All – syntaxe parametrů a lomítka jsou zakódovaná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-692">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="ee8de-693">Cestě</span><span class="sxs-lookup"><span data-stu-id="ee8de-693">Route</span></span>              | <span data-ttu-id="ee8de-694">Odkaz vygeneroval s</span><span class="sxs-lookup"><span data-stu-id="ee8de-694">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="ee8de-695">`/search/admin%2Fproducts` (lomítko je zakódováno)</span><span class="sxs-lookup"><span data-stu-id="ee8de-695">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="ee8de-696">Příklad middlewaru</span><span class="sxs-lookup"><span data-stu-id="ee8de-696">Middleware example</span></span>

<span data-ttu-id="ee8de-697">V následujícím příkladu middleware používá rozhraní <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API k vytvoření odkazu na metodu akce, která obsahuje produkty pro Store.</span><span class="sxs-lookup"><span data-stu-id="ee8de-697">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="ee8de-698">Použití generátoru odkazů vložením do třídy a volání `GenerateLink` je k dispozici pro libovolnou třídu v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-698">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="ee8de-699">Vytváření tras</span><span class="sxs-lookup"><span data-stu-id="ee8de-699">Create routes</span></span>

<span data-ttu-id="ee8de-700">Většina aplikací vytváří trasy voláním <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> nebo jedné z podobných metod rozšíření definovaných v <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-700">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="ee8de-701">Kterákoli z rozšiřujících metod <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> vytvoří instanci <xref:Microsoft.AspNetCore.Routing.Route> a přidá ji do kolekce tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-701">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="ee8de-702"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> nepřijímá parametr obslužné rutiny trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-702"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="ee8de-703"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> pouze přidá trasy, které jsou zpracovávány <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-703"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="ee8de-704">Další informace o směrování v MVC najdete v tématu <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-704">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="ee8de-705">Následující příklad kódu je příkladem <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> volání využívaného typickou ASP.NET Core definice trasy MVC:</span><span class="sxs-lookup"><span data-stu-id="ee8de-705">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ee8de-706">Tato šablona odpovídá cestě URL a extrahuje hodnoty tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-706">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="ee8de-707">Například cesta `/Products/Details/17` generuje následující hodnoty trasy: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-707">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="ee8de-708">Hodnoty tras se určují rozdělením cesty URL na segmenty a porovnáním jednotlivých segmentů s názvem *parametru trasy* v šabloně směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-708">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="ee8de-709">Parametry směrování jsou pojmenovány.</span><span class="sxs-lookup"><span data-stu-id="ee8de-709">Route parameters are named.</span></span> <span data-ttu-id="ee8de-710">Parametry definované ohraničujícím název parametru v závorkách `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-710">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="ee8de-711">Předchozí šablona může také odpovídat cestě URL `/` a vydávat hodnoty `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-711">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="ee8de-712">K tomu dochází, protože parametry směrování `{controller}` a `{action}` mají výchozí hodnoty a parametr trasy `id` je volitelný.</span><span class="sxs-lookup"><span data-stu-id="ee8de-712">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="ee8de-713">Znak rovná se (`=`) následovaný hodnotou za názvem parametru trasy definuje výchozí hodnotu parametru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-713">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="ee8de-714">Otazník (`?`) po názvu parametru trasy definuje volitelný parametr.</span><span class="sxs-lookup"><span data-stu-id="ee8de-714">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="ee8de-715">Parametry směrování s výchozí hodnotou *vždy* vytvoří hodnotu trasy, když odpovídá trasa.</span><span class="sxs-lookup"><span data-stu-id="ee8de-715">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="ee8de-716">Volitelné parametry neposkytují hodnotu trasy, pokud nebyl nalezen žádný odpovídající segment cesty URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-716">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span> <span data-ttu-id="ee8de-717">Podrobný popis scénářů a syntaxe šablon směrování najdete v části referenční dokumentace k [šabloně směrování](#route-template-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-717">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="ee8de-718">V následujícím příkladu definice parametru trasy `{id:int}` definuje [omezení trasy](#route-constraint-reference) pro parametr trasy `id`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-718">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="ee8de-719">Tato šablona odpovídá cestě URL, jako je `/Products/Details/17`, ale ne `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-719">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="ee8de-720">Omezení tras implementují <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> a kontrolují hodnoty směrování a ověřují je.</span><span class="sxs-lookup"><span data-stu-id="ee8de-720">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="ee8de-721">V tomto příkladu musí být hodnota trasy `id` převoditelná na celé číslo.</span><span class="sxs-lookup"><span data-stu-id="ee8de-721">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="ee8de-722">Vysvětlení omezení trasy poskytovaných rozhraním naleznete v tématu [Route-Constraint-reference](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-722">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="ee8de-723">Další přetížení <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> akceptují hodnoty pro `constraints`, `dataTokens`a `defaults`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-723">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="ee8de-724">Typické použití těchto parametrů je předání anonymního typu objektu, kde názvy vlastností anonymního typu odpovídají názvům parametrů tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-724">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="ee8de-725">Následující příklady <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> vytvořit ekvivalentní trasy:</span><span class="sxs-lookup"><span data-stu-id="ee8de-725">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="ee8de-726">Vložená syntaxe pro definování omezení a výchozích hodnot může být vhodná pro jednoduché trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-726">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="ee8de-727">Existují však scénáře, jako jsou například datové tokeny, které nejsou podporovány vloženou syntaxí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-727">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="ee8de-728">Následující příklad ukazuje několik dalších scénářů:</span><span class="sxs-lookup"><span data-stu-id="ee8de-728">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="ee8de-729">Předchozí šablona odpovídá cestě URL jako `/Blog/All-About-Routing/Introduction` a extrahuje hodnoty `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-729">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="ee8de-730">Výchozí hodnoty trasy pro `controller` a `action` jsou vytvářeny trasou, i když v šabloně nejsou odpovídající parametry směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-730">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="ee8de-731">V šabloně směrování lze zadat výchozí hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ee8de-731">Default values can be specified in the route template.</span></span> <span data-ttu-id="ee8de-732">Parametr trasy `article` je definován jako *catch-All* pomocí vzhledu dvojité hvězdičky (`**`) před názvem parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-732">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="ee8de-733">Catch – všechny parametry tras zaznamenávají zbytek cesty URL a můžou taky odpovídat prázdnému řetězci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-733">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="ee8de-734">Následující příklad přidá omezení trasy a datové tokeny:</span><span class="sxs-lookup"><span data-stu-id="ee8de-734">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="ee8de-735">Předchozí šablona odpovídá cestě URL jako `/en-US/Products/5` a extrahuje hodnoty `{ controller = Products, action = Details, id = 5 }` a `{ locale = en-US }`datových tokenů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-735">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokeny systému Windows pro národní prostředí](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="ee8de-737">Generování adresy URL třídy směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-737">Route class URL generation</span></span>

<span data-ttu-id="ee8de-738">Třída <xref:Microsoft.AspNetCore.Routing.Route> může také provádět generování adresy URL kombinováním sady hodnot směrování se šablonou směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-738">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="ee8de-739">Toto je logicky obrácený proces, který odpovídá cestě URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-739">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="ee8de-740">Chcete-li lépe pochopit generování adresy URL, Představte si, jakou adresu URL chcete vygenerovat, a pak se zamyslete nad tím, jak šablona trasy odpovídá této adrese</span><span class="sxs-lookup"><span data-stu-id="ee8de-740">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="ee8de-741">Jaké hodnoty by se vytvořily?</span><span class="sxs-lookup"><span data-stu-id="ee8de-741">What values would be produced?</span></span> <span data-ttu-id="ee8de-742">Toto je hrubý ekvivalent způsobu, jak generování adresy URL funguje ve třídě <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-742">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="ee8de-743">V následujícím příkladu je použita obecná výchozí trasa ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="ee8de-743">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ee8de-744">Při `{ controller = Products, action = List }`hodnoty trasy je vygenerována adresa URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-744">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="ee8de-745">Hodnoty tras se nahradí odpovídajícími parametry tras, aby bylo možné vytvořit cestu k adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-745">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="ee8de-746">Vzhledem k tomu, že `id` je volitelný parametr trasy, adresa URL se úspěšně vygenerovala bez hodnoty pro `id`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-746">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="ee8de-747">Při `{ controller = Home, action = Index }`hodnoty trasy je vygenerována adresa URL `/`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-747">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="ee8de-748">Zadané hodnoty trasy odpovídají výchozím hodnotám a jsou bezpečně vynechány segmenty odpovídající výchozím hodnotám.</span><span class="sxs-lookup"><span data-stu-id="ee8de-748">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="ee8de-749">Obě adresy URL vygenerovaly zpáteční cestu pomocí následující definice trasy (`/Home/Index` a `/`) vytvoří stejné hodnoty trasy, které se použily k vygenerování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-749">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="ee8de-750">Aplikace, která používá ASP.NET Core MVC, by měla používat <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> k vygenerování adres URL namísto volání přímo do směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-750">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="ee8de-751">Další informace o generování adresy URL najdete v části [Reference pro generování adresy URL](#url-generation-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-751">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="ee8de-752">Použití middlewaru pro směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-752">Use Routing Middleware</span></span>

<span data-ttu-id="ee8de-753">Odkaz na [Microsoft. AspNetCore. app Metapackage](xref:fundamentals/metapackage-app) v souboru projektu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-753">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="ee8de-754">Přidání směrování do kontejneru služby v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-754">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="ee8de-755">Trasy musí být nakonfigurovány v metodě `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-755">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="ee8de-756">Ukázková aplikace používá následující rozhraní API:</span><span class="sxs-lookup"><span data-stu-id="ee8de-756">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="ee8de-757"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; odpovídá pouze požadavkům HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ee8de-757"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="ee8de-758">V následující tabulce jsou uvedeny odpovědi s danými identifikátory URI.</span><span class="sxs-lookup"><span data-stu-id="ee8de-758">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="ee8de-759">Identifikátor URI</span><span class="sxs-lookup"><span data-stu-id="ee8de-759">URI</span></span>                    | <span data-ttu-id="ee8de-760">Základě</span><span class="sxs-lookup"><span data-stu-id="ee8de-760">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="ee8de-761">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ee8de-761">Hello!</span></span> <span data-ttu-id="ee8de-762">Hodnoty směrování: [operace, vytvořit], [ID, 3]</span><span class="sxs-lookup"><span data-stu-id="ee8de-762">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="ee8de-763">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ee8de-763">Hello!</span></span> <span data-ttu-id="ee8de-764">Hodnoty směrování: [operace, stopa], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="ee8de-764">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="ee8de-765">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ee8de-765">Hello!</span></span> <span data-ttu-id="ee8de-766">Hodnoty směrování: [operace, stopa], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="ee8de-766">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="ee8de-767">Požadavek spadá do, bez shody.</span><span class="sxs-lookup"><span data-stu-id="ee8de-767">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="ee8de-768">Dobrý den, Jana!</span><span class="sxs-lookup"><span data-stu-id="ee8de-768">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="ee8de-769">Požadavek spadá do, odpovídá pouze HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ee8de-769">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="ee8de-770">Požadavek spadá do, bez shody.</span><span class="sxs-lookup"><span data-stu-id="ee8de-770">The request falls through, no match.</span></span>              |

<span data-ttu-id="ee8de-771">Rozhraní poskytuje sadu metod rozšíření pro vytváření tras (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="ee8de-771">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="ee8de-772">Metody `Map[Verb]` používají omezení k omezení trasy na příkaz HTTP v názvu metody.</span><span class="sxs-lookup"><span data-stu-id="ee8de-772">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="ee8de-773">Například viz <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> a <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-773">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="ee8de-774">Odkaz na šablonu směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-774">Route template reference</span></span>

<span data-ttu-id="ee8de-775">Tokeny ve složených závorkách (`{ ... }`) definují *parametry trasy* , které jsou svázané, pokud je trasa shodná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-775">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="ee8de-776">V segmentu směrování můžete definovat více než jeden parametr trasy, ale musí být oddělený literálovou hodnotou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-776">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="ee8de-777">Například `{controller=Home}{action=Index}` není platná trasa, protože žádná hodnota literálu není mezi `{controller}` a `{action}`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-777">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="ee8de-778">Tyto parametry tras musí mít název a můžou mít zadané další atributy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-778">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="ee8de-779">Textový literál jiný než parametry směrování (například `{id}`) a oddělovač cest `/` musí odpovídat textu v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-779">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="ee8de-780">U porovnávání textu se nerozlišují malá a velká písmena a na základě dekódovat reprezentace cesty URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-780">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="ee8de-781">Chcete-li spárovat oddělovač parametrů trasy (`{` nebo `}`), vydejte znak oddělovače opakováním znaku (`{{` nebo `}}`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-781">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="ee8de-782">Vzory adres URL, které se pokoušejí zachytit název souboru s volitelnou příponou souboru, mají další požadavky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-782">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="ee8de-783">Představte si třeba šablonu `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-783">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="ee8de-784">Pokud existují hodnoty pro `filename` i `ext`, naplní se obě hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ee8de-784">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="ee8de-785">Pokud se v adrese URL vyskytuje jenom hodnota `filename`, odpovídá trasa, protože koncová tečka (`.`) je volitelná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-785">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="ee8de-786">Tuto trasu odpovídají následujícím adresám URL:</span><span class="sxs-lookup"><span data-stu-id="ee8de-786">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="ee8de-787">Pomocí hvězdičky (`*`) nebo dvojité hvězdičky (`**`) můžete jako předpony parametru Route vytvořit vazby na zbytek identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="ee8de-787">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="ee8de-788">Tyto parametry se nazývají *catch-All* .</span><span class="sxs-lookup"><span data-stu-id="ee8de-788">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="ee8de-789">`blog/{**slug}` například odpovídá jakémukoli identifikátoru URI, který začíná na `/blog` a má libovolnou hodnotu, která je za ní přiřazena hodnota `slug` trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-789">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="ee8de-790">Catch – všechny parametry můžou odpovídat také prázdnému řetězci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-790">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="ee8de-791">Parametr catch-All řídí příslušné znaky, pokud je použita cesta pro vygenerování adresy URL, včetně oddělovače cest (`/`) znaků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-791">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="ee8de-792">Například trasa `foo/{*path}` s hodnotami trasy `{ path = "my/path" }` generuje `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-792">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="ee8de-793">Všimněte si řídicího znaku lomítka.</span><span class="sxs-lookup"><span data-stu-id="ee8de-793">Note the escaped forward slash.</span></span> <span data-ttu-id="ee8de-794">Do oddělovacích znaků cesty pro přenos cest použijte předponu parametru `**` Route.</span><span class="sxs-lookup"><span data-stu-id="ee8de-794">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="ee8de-795">`foo/{**path}` trasy s `{ path = "my/path" }` generuje `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-795">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="ee8de-796">Parametry směrování můžou mít *výchozí hodnoty* určené zadáním výchozí hodnoty za názvem parametru odděleným symbolem rovná se (`=`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-796">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="ee8de-797">Například `{controller=Home}` definuje `Home` jako výchozí hodnotu pro `controller`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-797">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="ee8de-798">Výchozí hodnota se použije v případě, že v adrese URL parametru není k dispozici žádná hodnota.</span><span class="sxs-lookup"><span data-stu-id="ee8de-798">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="ee8de-799">Parametry směrování jsou nepovinné tím, že se k konci názvu parametru připojí otazník (`?`), jako v `id?`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-799">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="ee8de-800">Rozdíl mezi volitelnými hodnotami a výchozími parametry směrování je, že parametr trasy s výchozí hodnotou vždy vytvoří hodnotu&mdash;volitelný parametr má hodnotu pouze v případě, že adresa URL požadavku poskytne hodnotu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-800">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="ee8de-801">Parametry směrování můžou mít omezení, která se musí shodovat s hodnotou trasy svázanou z adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-801">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="ee8de-802">Přidání dvojtečky (`:`) a názvu omezení za názvem parametru trasy Určuje *vložené omezení* pro parametr trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-802">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="ee8de-803">Pokud omezení vyžaduje argumenty, jsou po názvu omezení uzavřeny do závorek (`(...)`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-803">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="ee8de-804">Přidáním dalších dvojtečk (`:`) a názvu omezení lze zadat více vložených omezení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-804">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="ee8de-805">Název omezení a argumenty jsou předány službě <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver>, aby se vytvořila instance <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, která se má použít při zpracování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-805">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="ee8de-806">Například šablona trasy `blog/{article:minlength(10)}` určuje omezení `minlength` s argumentem `10`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-806">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="ee8de-807">Další informace o omezeních tras a seznam omezení poskytovaných rozhraním najdete v části [referenční informace k omezením trasy](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-807">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="ee8de-808">Parametry směrování můžou mít také transformaci parametrů, které transformují hodnotu parametru při generování odkazů a porovnání akcí a stránek s adresami URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-808">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="ee8de-809">Podobně jako omezení můžou být transformátory parametrů přidány do parametru trasy, a to přidáním dvojtečky (`:`) a názvu transformátoru za názvem parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-809">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="ee8de-810">Například šablona trasy `blog/{article:slugify}` určuje `slugify` transformátor.</span><span class="sxs-lookup"><span data-stu-id="ee8de-810">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="ee8de-811">Další informace o transformačních parametrech naleznete v části [Referenční příručka pro parametry](#parameter-transformer-reference) transformátoru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-811">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="ee8de-812">Následující tabulka ukazuje příklady šablon směrování a jejich chování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-812">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="ee8de-813">Šablona směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-813">Route Template</span></span>                           | <span data-ttu-id="ee8de-814">Příklad odpovídajícího identifikátoru URI</span><span class="sxs-lookup"><span data-stu-id="ee8de-814">Example Matching URI</span></span>    | <span data-ttu-id="ee8de-815">Identifikátor URI žádosti&hellip;</span><span class="sxs-lookup"><span data-stu-id="ee8de-815">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="ee8de-816">Odpovídá pouze jedné cestě `/hello`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-816">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="ee8de-817">Porovná a nastaví `Page` k `Home`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-817">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="ee8de-818">Porovná a nastaví `Page` k `Contact`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-818">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="ee8de-819">Provede mapování na kontroler `Products` a `List` akci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-819">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="ee8de-820">Provede mapování na řadič `Products` a akci `Details` (`id` nastaveno na 123).</span><span class="sxs-lookup"><span data-stu-id="ee8de-820">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="ee8de-821">Provede mapování na řadič `Home` a metodu `Index` (`id` je ignorováno).</span><span class="sxs-lookup"><span data-stu-id="ee8de-821">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="ee8de-822">Použití šablony je obecně nejjednodušší přístup ke směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-822">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="ee8de-823">Omezení a výchozí hodnoty je možné zadat i mimo šablonu směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-823">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="ee8de-824">Povolte [protokolování](xref:fundamentals/logging/index) , abyste viděli, jak se zabudovaná implementace směrování, například <xref:Microsoft.AspNetCore.Routing.Route>, odpovídá požadavkům.</span><span class="sxs-lookup"><span data-stu-id="ee8de-824">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="ee8de-825">Názvy rezervovaných směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-825">Reserved routing names</span></span>

<span data-ttu-id="ee8de-826">Následující klíčová slova jsou vyhrazená jména a nelze je použít jako názvy a parametry směrování:</span><span class="sxs-lookup"><span data-stu-id="ee8de-826">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="ee8de-827">Odkaz na omezení trasy</span><span class="sxs-lookup"><span data-stu-id="ee8de-827">Route constraint reference</span></span>

<span data-ttu-id="ee8de-828">Omezení trasy se spustí, když došlo ke shodě s příchozí adresou URL a cesta URL je zavedená do hodnot tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-828">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="ee8de-829">Omezení tras obvykle kontrolují hodnotu trasy přidruženou prostřednictvím šablony trasy a učiní ano/bez rozhodnutí o tom, zda je tato hodnota přijatelná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-829">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="ee8de-830">Některá omezení tras používají data mimo hodnotu trasy k zvážení toho, zda je možné požadavek směrovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-830">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="ee8de-831"><xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> například může přijmout nebo odmítnout požadavek na základě jeho příkazu HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee8de-831">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="ee8de-832">Omezení se používají při směrování požadavků a vytváření propojení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-832">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="ee8de-833">Nepoužívejte omezení pro **ověřování vstupu**.</span><span class="sxs-lookup"><span data-stu-id="ee8de-833">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="ee8de-834">Pokud se pro **ověřování vstupu**používají omezení, neplatné výsledky vstupu v *404 – nenalezené* odpovědi namísto *400 – Chybný požadavek* s příslušnou chybovou zprávou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-834">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="ee8de-835">Omezení tras slouží k jednoznačnému **rozlišení podobných tras** , nikoli k ověření vstupů konkrétní trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-835">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="ee8de-836">Následující tabulka ukazuje příklad omezení trasy a jejich očekávané chování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-836">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="ee8de-837">omezení</span><span class="sxs-lookup"><span data-stu-id="ee8de-837">constraint</span></span> | <span data-ttu-id="ee8de-838">Příklad</span><span class="sxs-lookup"><span data-stu-id="ee8de-838">Example</span></span> | <span data-ttu-id="ee8de-839">Příklady shody</span><span class="sxs-lookup"><span data-stu-id="ee8de-839">Example Matches</span></span> | <span data-ttu-id="ee8de-840">Poznámky</span><span class="sxs-lookup"><span data-stu-id="ee8de-840">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="ee8de-841">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ee8de-841">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ee8de-842">Odpovídá jakémukoli celému číslu</span><span class="sxs-lookup"><span data-stu-id="ee8de-842">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="ee8de-843">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="ee8de-843">`true`, `FALSE`</span></span> | <span data-ttu-id="ee8de-844">Odpovídá `true` nebo `false` (bez rozlišení velkých a malých písmen)</span><span class="sxs-lookup"><span data-stu-id="ee8de-844">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="ee8de-845">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="ee8de-845">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="ee8de-846">Odpovídá platné hodnotě `DateTime` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-846">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="ee8de-847">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="ee8de-847">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="ee8de-848">Odpovídá platné hodnotě `decimal` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-848">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="ee8de-849">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ee8de-849">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ee8de-850">Odpovídá platné hodnotě `double` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-850">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="ee8de-851">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ee8de-851">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ee8de-852">Odpovídá platné hodnotě `float` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-852">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="ee8de-853">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="ee8de-853">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="ee8de-854">Odpovídá platnému hodnotě `Guid`</span><span class="sxs-lookup"><span data-stu-id="ee8de-854">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="ee8de-855">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ee8de-855">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ee8de-856">Odpovídá platnému hodnotě `long`</span><span class="sxs-lookup"><span data-stu-id="ee8de-856">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="ee8de-857">Řetězec musí mít minimálně 4 znaky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-857">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="ee8de-858">Řetězec nesmí být delší než 8 znaků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-858">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="ee8de-859">Řetězec musí být přesně 12 znaků dlouhý.</span><span class="sxs-lookup"><span data-stu-id="ee8de-859">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="ee8de-860">Řetězec musí mít aspoň 8 znaků a nesmí být delší než 16 znaků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-860">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="ee8de-861">Celočíselná hodnota musí být minimálně 18.</span><span class="sxs-lookup"><span data-stu-id="ee8de-861">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="ee8de-862">Hodnota typu Integer nesmí být větší než 120.</span><span class="sxs-lookup"><span data-stu-id="ee8de-862">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="ee8de-863">Celočíselná hodnota musí být minimálně 18, ale ne víc než 120.</span><span class="sxs-lookup"><span data-stu-id="ee8de-863">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="ee8de-864">Řetězec musí obsahovat jeden nebo více abecedních znaků (`a`-`z`, nerozlišuje velká a malá písmena).</span><span class="sxs-lookup"><span data-stu-id="ee8de-864">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="ee8de-865">Řetězec musí odpovídat regulárnímu výrazu (viz Tipy k definování regulárního výrazu).</span><span class="sxs-lookup"><span data-stu-id="ee8de-865">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="ee8de-866">Slouží k vykonání, že při generování adresy URL je přítomna hodnota bez parametru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-866">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="ee8de-867">V jednom parametru lze použít více omezení s oddělovači.</span><span class="sxs-lookup"><span data-stu-id="ee8de-867">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="ee8de-868">Například následující omezení omezuje parametr na celočíselnou hodnotu 1 nebo vyšší:</span><span class="sxs-lookup"><span data-stu-id="ee8de-868">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="ee8de-869">Omezení směrování, která ověřují adresu URL a jsou převedena na typ CLR (například `int` nebo `DateTime`) vždy používají invariantní jazykovou verzi.</span><span class="sxs-lookup"><span data-stu-id="ee8de-869">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="ee8de-870">Tato omezení předpokládají, že adresa URL nelze lokalizovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-870">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="ee8de-871">Omezení tras poskytovaných rozhraním nemění hodnoty uložené v hodnotách tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-871">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="ee8de-872">Všechny hodnoty tras přeložené z adresy URL se ukládají jako řetězce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-872">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="ee8de-873">Například omezení `float` se pokusí převést hodnotu trasy na typ float, ale převedená hodnota se používá pouze k ověření, že je možné ji převést na typ float.</span><span class="sxs-lookup"><span data-stu-id="ee8de-873">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="ee8de-874">Regulární výrazy</span><span class="sxs-lookup"><span data-stu-id="ee8de-874">Regular expressions</span></span>

<span data-ttu-id="ee8de-875">Rozhraní ASP.NET Core Framework přidá `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` do konstruktoru regulárního výrazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-875">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="ee8de-876">Popis těchto členů naleznete v tématu <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-876">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="ee8de-877">Regulární výrazy používají oddělovače a tokeny podobné těm, které používá směrování a C# jazyk.</span><span class="sxs-lookup"><span data-stu-id="ee8de-877">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="ee8de-878">Tokeny regulárního výrazu musí být uvozeny řídicími znaky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-878">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="ee8de-879">Chcete-li použít regulární výraz `^\d{3}-\d{2}-\d{4}$` ve směrování, musí mít výraz `\` (jedno zpětné lomítko), které je zadáno v řetězci jako `\\` (Dvojitá zpětná lomítka C# ) ve zdrojovém souboru, aby mohl řídicí znak `\`. znak (Pokud nepoužíváte [doslovné řetězce literálů](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="ee8de-879">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="ee8de-880">Chcete-li řídicí znaky oddělovače parametrů směrování (`{`, `}`, `[`, `]`), poklikejte na znaky ve výrazu (`{{`, `}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-880">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="ee8de-881">V následující tabulce je uveden regulární výraz a verze s řídicím znakem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-881">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="ee8de-882">Regulární výraz</span><span class="sxs-lookup"><span data-stu-id="ee8de-882">Regular Expression</span></span>    | <span data-ttu-id="ee8de-883">Regulární výraz s řídicím znakem</span><span class="sxs-lookup"><span data-stu-id="ee8de-883">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="ee8de-884">Regulární výrazy používané v směrování často začínají znakem stříšky (`^`) a odpovídají počáteční pozici řetězce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-884">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="ee8de-885">Výrazy často končí znakem dolaru (`$`) a koncem řetězce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-885">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="ee8de-886">Znaky `^` a `$` zajišťují, že regulární výraz odpovídá celé hodnotě parametru Route.</span><span class="sxs-lookup"><span data-stu-id="ee8de-886">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="ee8de-887">Bez `^` a `$` znaků regulární výraz odpovídá jakémukoli podřetězci v řetězci, což je často nežádoucí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-887">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="ee8de-888">Následující tabulka obsahuje příklady a vysvětlení, proč se shodují nebo neshodují.</span><span class="sxs-lookup"><span data-stu-id="ee8de-888">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="ee8de-889">Výraz</span><span class="sxs-lookup"><span data-stu-id="ee8de-889">Expression</span></span>   | <span data-ttu-id="ee8de-890">String</span><span class="sxs-lookup"><span data-stu-id="ee8de-890">String</span></span>    | <span data-ttu-id="ee8de-891">Shoda</span><span class="sxs-lookup"><span data-stu-id="ee8de-891">Match</span></span> | <span data-ttu-id="ee8de-892">Komentář</span><span class="sxs-lookup"><span data-stu-id="ee8de-892">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-893">Dobrý den</span><span class="sxs-lookup"><span data-stu-id="ee8de-893">hello</span></span>     | <span data-ttu-id="ee8de-894">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-894">Yes</span></span>   | <span data-ttu-id="ee8de-895">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ee8de-895">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-896">123abc456</span><span class="sxs-lookup"><span data-stu-id="ee8de-896">123abc456</span></span> | <span data-ttu-id="ee8de-897">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-897">Yes</span></span>   | <span data-ttu-id="ee8de-898">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ee8de-898">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-899">MZ</span><span class="sxs-lookup"><span data-stu-id="ee8de-899">mz</span></span>        | <span data-ttu-id="ee8de-900">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-900">Yes</span></span>   | <span data-ttu-id="ee8de-901">Výraz shody</span><span class="sxs-lookup"><span data-stu-id="ee8de-901">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-902">MZ</span><span class="sxs-lookup"><span data-stu-id="ee8de-902">MZ</span></span>        | <span data-ttu-id="ee8de-903">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-903">Yes</span></span>   | <span data-ttu-id="ee8de-904">Nerozlišuje velká a malá písmena</span><span class="sxs-lookup"><span data-stu-id="ee8de-904">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="ee8de-905">Dobrý den</span><span class="sxs-lookup"><span data-stu-id="ee8de-905">hello</span></span>     | <span data-ttu-id="ee8de-906">Ne</span><span class="sxs-lookup"><span data-stu-id="ee8de-906">No</span></span>    | <span data-ttu-id="ee8de-907">Viz `^` a `$` výše.</span><span class="sxs-lookup"><span data-stu-id="ee8de-907">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="ee8de-908">123abc456</span><span class="sxs-lookup"><span data-stu-id="ee8de-908">123abc456</span></span> | <span data-ttu-id="ee8de-909">Ne</span><span class="sxs-lookup"><span data-stu-id="ee8de-909">No</span></span>    | <span data-ttu-id="ee8de-910">Viz `^` a `$` výše.</span><span class="sxs-lookup"><span data-stu-id="ee8de-910">See `^` and `$` above</span></span> |

<span data-ttu-id="ee8de-911">Další informace o syntaxi regulárního výrazu naleznete v tématu [.NET Framework regulární výrazy](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="ee8de-911">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="ee8de-912">Chcete-li omezit parametr na známou sadu možných hodnot, použijte regulární výraz.</span><span class="sxs-lookup"><span data-stu-id="ee8de-912">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="ee8de-913">`{action:regex(^(list|get|create)$)}` například odpovídá pouze hodnotě `action` trasy `list`, `get`nebo `create`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-913">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="ee8de-914">Pokud se předává do slovníku omezení, `^(list|get|create)$` řetězec je ekvivalentní.</span><span class="sxs-lookup"><span data-stu-id="ee8de-914">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="ee8de-915">Omezení, která jsou předána do slovníku omezení (nejsou vložena v rámci šablony), která neodpovídají jednomu ze známých omezení, jsou také považována za regulární výrazy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-915">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="ee8de-916">Vlastní omezení trasy</span><span class="sxs-lookup"><span data-stu-id="ee8de-916">Custom Route Constraints</span></span>

<span data-ttu-id="ee8de-917">Kromě předdefinovaných omezení trasy je možné vytvořit vlastní omezení trasy implementací rozhraní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-917">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="ee8de-918">Rozhraní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> obsahuje jedinou metodu, `Match`, která vrací `true`, pokud je omezení splněno a `false` jinak.</span><span class="sxs-lookup"><span data-stu-id="ee8de-918">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="ee8de-919">Pokud chcete použít vlastní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, musí být typ omezení trasy zaregistrovaný v <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> aplikace v kontejneru služby aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-919">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="ee8de-920"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> je slovník, který mapuje klíče omezení tras na <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementace, které tyto omezení ověřují.</span><span class="sxs-lookup"><span data-stu-id="ee8de-920">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="ee8de-921"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> aplikace lze v `Startup.ConfigureServices` aktualizovat buď jako součást [služeb. AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) volání nebo konfigurací <xref:Microsoft.AspNetCore.Routing.RouteOptions> přímo pomocí `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-921">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="ee8de-922">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ee8de-922">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="ee8de-923">Omezení lze následně použít na trasy obvyklým způsobem pomocí názvu zadaného při registraci typu omezení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-923">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="ee8de-924">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ee8de-924">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="ee8de-925">Odkaz na transformátor – parametr</span><span class="sxs-lookup"><span data-stu-id="ee8de-925">Parameter transformer reference</span></span>

<span data-ttu-id="ee8de-926">Transformátory parametrů:</span><span class="sxs-lookup"><span data-stu-id="ee8de-926">Parameter transformers:</span></span>

* <span data-ttu-id="ee8de-927">Provede se při generování odkazu pro <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-927">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="ee8de-928">Implementujte `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-928">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="ee8de-929">Jsou nakonfigurovány pomocí <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-929">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="ee8de-930">Převeďte hodnotu trasy parametru a Transformujte ji na novou řetězcovou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-930">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="ee8de-931">Výsledkem použití transformované hodnoty ve vygenerovaném odkazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-931">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="ee8de-932">Například vlastní parametr `slugify` Transformer ve vzoru směrování `blog\{article:slugify}` s `Url.Action(new { article = "MyTestArticle" })` generuje `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-932">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="ee8de-933">Chcete-li použít transformující parametr ve schématu směrování, nakonfigurujte jej nejprve pomocí <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-933">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="ee8de-934">Transformátory parametrů používá rozhraní k transformaci identifikátoru URI, kde se Endpoint vyřeší.</span><span class="sxs-lookup"><span data-stu-id="ee8de-934">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="ee8de-935">ASP.NET Core MVC například používá transformaci parametrů k transformaci hodnoty trasy používané pro shodu `area`, `controller`, `action`a `page`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-935">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="ee8de-936">U předchozí trasy se `SubscriptionManagementController.GetAll()` akce shodují s identifikátorem URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-936">With the preceding route, the action `SubscriptionManagementController.GetAll()` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="ee8de-937">Transformující parametr nemění hodnoty trasy použité k vygenerování odkazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-937">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="ee8de-938">Například `Url.Action("GetAll", "SubscriptionManagement")` výstupy `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-938">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="ee8de-939">ASP.NET Core poskytuje konvence rozhraní API pro použití parametrů Transformers s vygenerovanými trasami:</span><span class="sxs-lookup"><span data-stu-id="ee8de-939">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="ee8de-940">ASP.NET Core MVC má `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention`ou konvenci rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ee8de-940">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="ee8de-941">Tato konvence aplikuje na všechny trasy atributů v aplikaci zadaného parametru Transformer.</span><span class="sxs-lookup"><span data-stu-id="ee8de-941">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="ee8de-942">Parametr Transformer transformuje tokeny, když jsou nahrazeny.</span><span class="sxs-lookup"><span data-stu-id="ee8de-942">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="ee8de-943">Další informace najdete v tématu [Použití transformátoru parametrů k přizpůsobení náhrady tokenu](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="ee8de-943">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="ee8de-944">Razor Pages má `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` konvence rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ee8de-944">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="ee8de-945">Tato konvence u všech automaticky zjištěných Razor Pages aplikuje zadaný transformátor parametrů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-945">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="ee8de-946">Parametr Transformer přetransformuje segmenty složky a názvu souboru na trasy Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="ee8de-946">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="ee8de-947">Další informace najdete v tématu [Použití transformátoru parametrů k přizpůsobení cest stránky](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="ee8de-947">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="ee8de-948">Odkaz na generování adresy URL</span><span class="sxs-lookup"><span data-stu-id="ee8de-948">URL generation reference</span></span>

<span data-ttu-id="ee8de-949">Následující příklad ukazuje, jak vygenerovat odkaz na trasu s ohledem na slovník hodnot směrování a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-949">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="ee8de-950"><xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> vygenerované na konci předchozí ukázky je `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-950">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="ee8de-951">Slovník poskytuje `operation` a `id` hodnoty trasy pro šablonu sledování trasy balíčku `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-951">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="ee8de-952">Podrobnosti najdete v ukázkovém kódu v části [použití middleware pro směrování](#use-routing-middleware) nebo v [ukázkové aplikaci](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="ee8de-952">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="ee8de-953">Druhý parametr pro konstruktor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> je kolekcí *hodnot okolí*.</span><span class="sxs-lookup"><span data-stu-id="ee8de-953">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="ee8de-954">Okolní hodnoty jsou vhodné k použití, protože omezují počet hodnot, které vývojář musí určit v rámci kontextu požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-954">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="ee8de-955">Aktuální hodnoty trasy aktuálního požadavku jsou považovány za okolní hodnoty pro generování odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-955">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="ee8de-956">V akci `About` `HomeController`aplikace ASP.NET Core MVC není nutné zadávat hodnotu trasy kontroleru, která se má propojit s `Index` akcí&mdash;je použita ambientní hodnota `Home`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-956">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="ee8de-957">Okolní hodnoty, které se neshodují s parametrem, se ignorují.</span><span class="sxs-lookup"><span data-stu-id="ee8de-957">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="ee8de-958">Okolní hodnoty jsou také ignorovány, pokud explicitně poskytnutá hodnota Přepisuje hodnotu okolí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-958">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="ee8de-959">K shodě dojde zleva doprava v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-959">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="ee8de-960">Hodnoty jsou výslovně poskytnuty, ale neodpovídají segmentu trasy, jsou přidány do řetězce dotazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-960">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="ee8de-961">V následující tabulce je uveden výsledek při použití `{controller}/{action}/{id?}`šablony směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-961">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="ee8de-962">Okolní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ee8de-962">Ambient Values</span></span>                     | <span data-ttu-id="ee8de-963">Explicitní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ee8de-963">Explicit Values</span></span>                        | <span data-ttu-id="ee8de-964">Výsledek</span><span class="sxs-lookup"><span data-stu-id="ee8de-964">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="ee8de-965">Controller = "domů"</span><span class="sxs-lookup"><span data-stu-id="ee8de-965">controller = "Home"</span></span>                | <span data-ttu-id="ee8de-966">Action = "o"</span><span class="sxs-lookup"><span data-stu-id="ee8de-966">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ee8de-967">Controller = "domů"</span><span class="sxs-lookup"><span data-stu-id="ee8de-967">controller = "Home"</span></span>                | <span data-ttu-id="ee8de-968">Controller = "objednávka"; Action = "o"</span><span class="sxs-lookup"><span data-stu-id="ee8de-968">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="ee8de-969">Controller = "Home"; Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="ee8de-969">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="ee8de-970">Action = "o"</span><span class="sxs-lookup"><span data-stu-id="ee8de-970">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ee8de-971">Controller = "domů"</span><span class="sxs-lookup"><span data-stu-id="ee8de-971">controller = "Home"</span></span>                | <span data-ttu-id="ee8de-972">Action = "o", Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="ee8de-972">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="ee8de-973">Pokud má trasa výchozí hodnotu, která neodpovídá parametru a tato hodnota je explicitně poskytnutá, musí se shodovat s výchozí hodnotou:</span><span class="sxs-lookup"><span data-stu-id="ee8de-973">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="ee8de-974">Generace odkazů generuje odkaz pro tuto trasu, pokud jsou k dispozici hodnoty pro `controller` a `action`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-974">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="ee8de-975">Komplexní segmenty</span><span class="sxs-lookup"><span data-stu-id="ee8de-975">Complex segments</span></span>

<span data-ttu-id="ee8de-976">Komplexní segmenty (například `[Route("/x{token}y")]`) jsou zpracovávány porovnáním koncových literálů zprava doleva nehladým způsobem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-976">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="ee8de-977">Podrobné vysvětlení, jak se shodují komplexní segmenty, najdete v [tomto kódu](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-977">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="ee8de-978">[Ukázka kódu](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) není používána ASP.NET Core, ale poskytuje dobré vysvětlení složitých segmentů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-978">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/aspnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="ee8de-979">Směrování zodpovídá za mapování identifikátorů URI požadavků na obslužné rutiny směrování a odesílání příchozích požadavků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-979">Routing is responsible for mapping request URIs to route handlers and dispatching an incoming requests.</span></span> <span data-ttu-id="ee8de-980">Trasy jsou v aplikaci definované a nakonfigurované při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-980">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="ee8de-981">Trasa může volitelně extrahovat hodnoty z adresy URL obsažené v žádosti a tyto hodnoty pak lze použít pro zpracování požadavků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-981">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="ee8de-982">Směrování pomocí nakonfigurovaných tras z aplikace dokáže vygenerovat adresy URL, které se mapují na obslužné rutiny tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-982">Using configured routes from the app, routing is able to generate URLs that map to route handlers.</span></span>

<span data-ttu-id="ee8de-983">Pokud chcete použít nejnovější scénáře směrování v ASP.NET Core 2,1, zadejte [verzi kompatibility](xref:mvc/compatibility-version) pro registraci služby MVC v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-983">To use the latest routing scenarios in ASP.NET Core 2.1, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
```

> [!IMPORTANT]
> <span data-ttu-id="ee8de-984">Tento dokument popisuje směrování ASP.NET Core nízké úrovně.</span><span class="sxs-lookup"><span data-stu-id="ee8de-984">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="ee8de-985">Informace o ASP.NET Core směrování MVC najdete v tématu <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-985">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="ee8de-986">Informace o konvencích směrování v Razor Pages najdete v tématu <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-986">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ee8de-987">[Zobrazit nebo stáhnout ukázkový kód](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([Jak stáhnout](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="ee8de-987">[View or download sample code](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="ee8de-988">Základy směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-988">Routing basics</span></span>

<span data-ttu-id="ee8de-989">Většina aplikací by měla zvolit základní a popisné schéma směrování, aby byly adresy URL čitelné a smysluplné.</span><span class="sxs-lookup"><span data-stu-id="ee8de-989">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="ee8de-990">Výchozí konvenční trasa `{controller=Home}/{action=Index}/{id?}`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-990">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="ee8de-991">Podporuje základní a popisné schéma směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-991">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="ee8de-992">Je užitečným výchozím bodem pro aplikace založené na uživatelském rozhraní.</span><span class="sxs-lookup"><span data-stu-id="ee8de-992">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="ee8de-993">Vývojáři obvykle přidávají další stručný trasy do oblastí s vysokým provozem v aplikaci ve zvláštních situacích (například koncové body blogu a elektronického obchodování) pomocí [Směrování atributů](xref:mvc/controllers/routing#attribute-routing) nebo vyhrazených konvenčních tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-993">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="ee8de-994">Webové rozhraní API by mělo používat směrování atributů k modelování funkcí aplikace jako sady prostředků, ve kterých jsou operace reprezentované příkazy HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee8de-994">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="ee8de-995">To znamená, že mnoho operací (například GET, POST) na stejném logickém prostředku bude používat stejnou adresu URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-995">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="ee8de-996">Směrování atributů poskytuje úroveň řízení, která je nutná k pečlivému návrhu rozložení veřejného koncového bodu rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="ee8de-996">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="ee8de-997">Aplikace Razor Pages používají výchozí konvenční směrování pro obsluhu pojmenovaných prostředků ve složce *Pages* v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-997">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="ee8de-998">K dispozici jsou další konvence, které vám umožní přizpůsobit Razor Pages chování směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-998">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="ee8de-999">Další informace naleznete v tématu <xref:razor-pages/index> a <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-999">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="ee8de-1000">Podpora generování adresy URL umožňuje, aby se aplikace vyvinula bez adres URL s pevným kódováním, aby bylo možné propojit aplikaci dohromady.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1000">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="ee8de-1001">Tato podpora umožňuje začít se základní konfigurací směrování a upravovat trasy po určení rozložení prostředků aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1001">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="ee8de-1002">Směrování používá *trasy* (implementace <xref:Microsoft.AspNetCore.Routing.IRouter>) k těmto akcím:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1002">Routing uses *routes* (implementations of <xref:Microsoft.AspNetCore.Routing.IRouter>) to:</span></span>

* <span data-ttu-id="ee8de-1003">Mapování příchozích požadavků na *obslužné rutiny tras*</span><span class="sxs-lookup"><span data-stu-id="ee8de-1003">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="ee8de-1004">Vygenerujte adresy URL používané v odpovědích.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1004">Generate the URLs used in responses.</span></span>

<span data-ttu-id="ee8de-1005">Ve výchozím nastavení má aplikace jednu kolekci tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1005">By default, an app has a single collection of routes.</span></span> <span data-ttu-id="ee8de-1006">Po doručení žádosti jsou trasy v kolekci zpracovávány v pořadí, v jakém existují v kolekci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1006">When a request arrives, the routes in the collection are processed in the order that they exist in the collection.</span></span> <span data-ttu-id="ee8de-1007">Rozhraní se pokusí porovnat adresu URL příchozího požadavku s trasou v kolekci voláním metody <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> v každé trase v kolekci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1007">The framework attempts to match an incoming request URL to a route in the collection by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in the collection.</span></span> <span data-ttu-id="ee8de-1008">Odpověď může používat směrování k vygenerování adres URL (například pro přesměrování nebo propojení) na základě informací o trasách, takže se vyhnete pevně zakódovaným adresám URL, které pomáhají zachovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1008">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>

<span data-ttu-id="ee8de-1009">Systém směrování má následující vlastnosti:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1009">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="ee8de-1010">Syntaxe šablony směrování se používá k definování tras s tokeny parametrů trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1010">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="ee8de-1011">Konfigurace koncového bodu stylů a stylu atributu je povolena.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1011">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="ee8de-1012"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> slouží k určení, zda parametr adresy URL obsahuje platnou hodnotu pro dané omezení koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1012"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="ee8de-1013">Modely aplikací, jako je MVC/Razor Pages, registrují všechny své trasy, které mají předvídatelné implementaci scénářů směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1013">App models, such as MVC/Razor Pages, register all of their routes, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="ee8de-1014">Odpověď může používat směrování k vygenerování adres URL (například pro přesměrování nebo propojení) na základě informací o trasách, takže se vyhnete pevně zakódovaným adresám URL, které pomáhají zachovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1014">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="ee8de-1015">Generování adresy URL vychází z tras, které podporují libovolné rozšíření.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1015">URL generation is based on routes, which support arbitrary extensibility.</span></span> <span data-ttu-id="ee8de-1016"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> nabízí metody pro sestavování adres URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1016"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

<span data-ttu-id="ee8de-1017">Směrování je připojené k kanálu [middlewaru](xref:fundamentals/middleware/index) pomocí třídy <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1017">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="ee8de-1018">[ASP.NET Core MVC](xref:mvc/overview) v rámci své konfigurace přidává směrování do kanálu middlewaru a zpracovává směrování v MVC a Razor Pages aplikacích.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1018">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="ee8de-1019">Informace o tom, jak používat směrování jako samostatnou součást, najdete v části [použití middlewaru pro směrování](#use-routing-middleware) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-1019">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="ee8de-1020">Shoda adresy URL</span><span class="sxs-lookup"><span data-stu-id="ee8de-1020">URL matching</span></span>

<span data-ttu-id="ee8de-1021">Shoda adresy URL je proces, podle kterého směrování odesílá příchozí požadavek *obslužné rutině*.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1021">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="ee8de-1022">Tento proces je založený na datech v cestě URL, ale dá se rozšířit, aby v žádosti mohla být považovat všechna data.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1022">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="ee8de-1023">Schopnost odesílat žádosti na samostatné obslužné rutiny je klíč pro škálování velikosti a složitosti aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1023">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="ee8de-1024">Příchozí požadavky vstupují do <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, která volá metodu <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> na každé trase v sekvenci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1024">Incoming requests enter the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="ee8de-1025">Instance <xref:Microsoft.AspNetCore.Routing.IRouter> zvolí, zda má být žádost *zpracována* , nastavením [RouteContext. Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) na <xref:Microsoft.AspNetCore.Http.RequestDelegate>, který není null.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1025">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="ee8de-1026">Pokud trasa nastaví obslužnou rutinu pro požadavek, zpracování směrování se zastaví a obslužná rutina se vyvolá pro zpracování žádosti.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1026">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="ee8de-1027">Pokud se pro zpracování požadavku nenajde žádná obslužná rutina tras, middleware si požadavek doplní k dalšímu middlewaru v kanálu žádosti.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1027">If no route handler is found to process the request, the middleware hands the request off to the next middleware in the request pipeline.</span></span>

<span data-ttu-id="ee8de-1028">Primárním vstupem pro <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> je [RouteContext. HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) přidružený k aktuální žádosti.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1028">The primary input to <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="ee8de-1029">[RouteContext. Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) a [RouteContext. parametr RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) jsou nastaveny výstupy po porovnání trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1029">The [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route is matched.</span></span>

<span data-ttu-id="ee8de-1030">Shoda, která volá <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> také nastaví vlastnosti [RouteContext. parametr RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) na příslušné hodnoty na základě dosud provedeného zpracování požadavků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1030">A match that calls <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> also sets the properties of the [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="ee8de-1031">[Parametr RouteData. Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) je slovník *hodnot tras* vytvořených z trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1031">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="ee8de-1032">Tyto hodnoty se obvykle určují pomocí tokenizací adresy URL a dají se použít k přijetí vstupu uživatele nebo k dalšímu odesílání rozhodnutí v rámci aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1032">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="ee8de-1033">[Parametr RouteData. DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) je kontejner objektů a dat pro další data související s odpovídající trasou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1033">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="ee8de-1034"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> jsou k dispozici pro podporu přidružování dat o stavu k jednotlivým cestám, aby aplikace mohla učinit rozhodnutí na základě toho, na které trase odpovídá.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1034"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="ee8de-1035">Tyto hodnoty jsou definované vývojářem a **neovlivňují chování** směrování jakýmkoli způsobem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1035">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="ee8de-1036">Kromě toho hodnoty dočasně ukládané v [parametr RouteData. Datatokeny](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) můžou být libovolného typu, na rozdíl od [parametr RouteData. Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), které musí být převoditelné na a z řetězců.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1036">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="ee8de-1037">[Parametr RouteData. routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) je seznam tras, které byly součástí úspěšného porovnání požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1037">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="ee8de-1038">Trasy mohou být vnořeny do sebe navzájem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1038">Routes can be nested inside of one another.</span></span> <span data-ttu-id="ee8de-1039">Vlastnost <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> odráží cestu v logickém stromu tras, jejichž výsledkem byla shoda.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1039">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="ee8de-1040">Obecně platí, že první položka v <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> je kolekce tras a měla by se používat pro generování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1040">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="ee8de-1041">Poslední položka v <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> je obslužná rutina trasy, která se shoduje.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1041">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation"></a><span data-ttu-id="ee8de-1042">Generování adresy URL</span><span class="sxs-lookup"><span data-stu-id="ee8de-1042">URL generation</span></span>

<span data-ttu-id="ee8de-1043">Generování adresy URL je proces, podle kterého směrování může vytvořit cestu adresy URL na základě sady hodnot tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1043">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="ee8de-1044">To umožňuje logické oddělení mezi obslužnými rutinami tras a adresami URL, které k nim mají přístup.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1044">This allows for a logical separation between route handlers and the URLs that access them.</span></span>

<span data-ttu-id="ee8de-1045">Generování adresy URL následuje po podobném iterativním procesu, ale začíná kódem uživatele nebo rozhraním, který volá metodu <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> kolekce tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1045">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="ee8de-1046">Každá *trasa* má svou <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> metodu nazvanou v sekvenci, dokud není vrácena <xref:Microsoft.AspNetCore.Routing.VirtualPathData>, která není null.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1046">Each *route* has its <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="ee8de-1047">Primární vstupy pro <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> jsou:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1047">The primary inputs to <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> are:</span></span>

* [<span data-ttu-id="ee8de-1048">VirtualPathContext. HttpContext</span><span class="sxs-lookup"><span data-stu-id="ee8de-1048">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext)
* [<span data-ttu-id="ee8de-1049">VirtualPathContext. Values</span><span class="sxs-lookup"><span data-stu-id="ee8de-1049">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values)
* [<span data-ttu-id="ee8de-1050">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="ee8de-1050">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues)

<span data-ttu-id="ee8de-1051">Trasy primárně používají hodnoty tras poskytované <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> a <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> k rozhodnutí, zda je možné vygenerovat adresu URL a jaké hodnoty mají být zahrnuty.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1051">Routes primarily use the route values provided by <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> and <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="ee8de-1052"><xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> jsou sady hodnot tras, které byly vytvořeny z porovnání s aktuálním požadavkem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1052">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> are the set of route values that were produced from matching the current request.</span></span> <span data-ttu-id="ee8de-1053">Naproti tomu <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> hodnoty tras, které určují, jak se má pro aktuální operaci generovat požadovaná adresa URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1053">In contrast, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="ee8de-1054"><xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> je k dispozici v případě, že trasa má získat služby nebo další data přidružená k aktuálnímu kontextu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1054">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> is provided in case a route should obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="ee8de-1055">[VirtualPathContext. Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) se považuje za sadu přepsání pro [VirtualPathContext. AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1055">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="ee8de-1056">Generování adresy URL se pokusí znovu použít hodnoty směrování z aktuální žádosti, aby se vygenerovaly adresy URL pro odkazy pomocí stejné trasy nebo hodnoty tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1056">URL generation attempts to reuse route values from the current request to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="ee8de-1057">Výstupem <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> je <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1057">The output of <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is a <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span></span> <span data-ttu-id="ee8de-1058"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> je paralelně <xref:Microsoft.AspNetCore.Routing.RouteData>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1058"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> is a parallel of <xref:Microsoft.AspNetCore.Routing.RouteData>.</span></span> <span data-ttu-id="ee8de-1059"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> obsahuje <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> pro výstupní adresu URL a některé další vlastnosti, které by měly být nastavené trasou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1059"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contains the <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="ee8de-1060">Vlastnost [VirtualPathData. VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) obsahuje *virtuální cestu* vytvořenou trasou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1060">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="ee8de-1061">V závislosti na vašich potřebách možná budete muset zpracovat cestu dále.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1061">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="ee8de-1062">Pokud chcete vygenerovanou adresu URL vykreslit ve formátu HTML, předřaďte základní cestu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1062">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="ee8de-1063">[VirtualPathData. router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) je odkaz na trasu, která adresu URL úspěšně vygenerovala.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1063">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="ee8de-1064">Vlastnosti [VirtualPathData. DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) je slovník dalších dat souvisejících s trasou, která adresu URL vygenerovala.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1064">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="ee8de-1065">To je paralelní pro [parametr RouteData. Datatokeny](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1065">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="create-routes"></a><span data-ttu-id="ee8de-1066">Vytváření tras</span><span class="sxs-lookup"><span data-stu-id="ee8de-1066">Create routes</span></span>

<span data-ttu-id="ee8de-1067">Směrování poskytuje třídu <xref:Microsoft.AspNetCore.Routing.Route> jako standardní implementaci <xref:Microsoft.AspNetCore.Routing.IRouter>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1067">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="ee8de-1068"><xref:Microsoft.AspNetCore.Routing.Route> používá syntaxi *šablony směrování* k definování vzorů, které se budou shodovat s cestou URL při volání <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1068"><xref:Microsoft.AspNetCore.Routing.Route> uses the *route template* syntax to define patterns to match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="ee8de-1069"><xref:Microsoft.AspNetCore.Routing.Route> používá stejnou šablonu trasy k vygenerování adresy URL při volání <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1069"><xref:Microsoft.AspNetCore.Routing.Route> uses the same route template to generate a URL when <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is called.</span></span>

<span data-ttu-id="ee8de-1070">Většina aplikací vytváří trasy voláním <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> nebo jedné z podobných metod rozšíření definovaných v <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1070">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="ee8de-1071">Kterákoli z rozšiřujících metod <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> vytvoří instanci <xref:Microsoft.AspNetCore.Routing.Route> a přidá ji do kolekce tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1071">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="ee8de-1072"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> nepřijímá parametr obslužné rutiny trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1072"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="ee8de-1073"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> pouze přidá trasy, které jsou zpracovávány <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1073"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="ee8de-1074">Výchozí obslužná rutina je `IRouter`a obslužná rutina nemusí požadavek zpracovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1074">The default handler is an `IRouter`, and the handler might not handle the request.</span></span> <span data-ttu-id="ee8de-1075">Například ASP.NET Core MVC je obvykle nakonfigurován jako výchozí obslužná rutina, která zpracovává pouze požadavky, které odpovídají dostupnému kontroleru a akci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1075">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="ee8de-1076">Další informace o směrování v MVC najdete v tématu <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1076">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="ee8de-1077">Následující příklad kódu je příkladem <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> volání využívaného typickou ASP.NET Core definice trasy MVC:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1077">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ee8de-1078">Tato šablona odpovídá cestě URL a extrahuje hodnoty tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1078">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="ee8de-1079">Například cesta `/Products/Details/17` generuje následující hodnoty trasy: `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1079">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="ee8de-1080">Hodnoty tras se určují rozdělením cesty URL na segmenty a porovnáním jednotlivých segmentů s názvem *parametru trasy* v šabloně směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1080">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="ee8de-1081">Parametry směrování jsou pojmenovány.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1081">Route parameters are named.</span></span> <span data-ttu-id="ee8de-1082">Parametry definované ohraničujícím název parametru v závorkách `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1082">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="ee8de-1083">Předchozí šablona může také odpovídat cestě URL `/` a vydávat hodnoty `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1083">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="ee8de-1084">K tomu dochází, protože parametry směrování `{controller}` a `{action}` mají výchozí hodnoty a parametr trasy `id` je volitelný.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1084">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="ee8de-1085">Znak rovná se (`=`) následovaný hodnotou za názvem parametru trasy definuje výchozí hodnotu parametru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1085">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="ee8de-1086">Otazník (`?`) po názvu parametru trasy definuje volitelný parametr.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1086">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="ee8de-1087">Parametry směrování s výchozí hodnotou *vždy* vytvoří hodnotu trasy, když odpovídá trasa.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1087">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="ee8de-1088">Volitelné parametry neposkytují hodnotu trasy, pokud nebyl nalezen žádný odpovídající segment cesty URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1088">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span> <span data-ttu-id="ee8de-1089">Podrobný popis scénářů a syntaxe šablon směrování najdete v části referenční dokumentace k [šabloně směrování](#route-template-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-1089">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="ee8de-1090">V následujícím příkladu definice parametru trasy `{id:int}` definuje [omezení trasy](#route-constraint-reference) pro parametr trasy `id`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1090">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="ee8de-1091">Tato šablona odpovídá cestě URL, jako je `/Products/Details/17`, ale ne `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1091">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="ee8de-1092">Omezení tras implementují <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> a kontrolují hodnoty směrování a ověřují je.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1092">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="ee8de-1093">V tomto příkladu musí být hodnota trasy `id` převoditelná na celé číslo.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1093">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="ee8de-1094">Vysvětlení omezení trasy poskytovaných rozhraním naleznete v tématu [Route-Constraint-reference](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-1094">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="ee8de-1095">Další přetížení <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> akceptují hodnoty pro `constraints`, `dataTokens`a `defaults`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1095">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="ee8de-1096">Typické použití těchto parametrů je předání anonymního typu objektu, kde názvy vlastností anonymního typu odpovídají názvům parametrů tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1096">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="ee8de-1097">Následující příklady <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> vytvořit ekvivalentní trasy:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1097">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="ee8de-1098">Vložená syntaxe pro definování omezení a výchozích hodnot může být vhodná pro jednoduché trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1098">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="ee8de-1099">Existují však scénáře, jako jsou například datové tokeny, které nejsou podporovány vloženou syntaxí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1099">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="ee8de-1100">Následující příklad ukazuje několik dalších scénářů:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1100">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="ee8de-1101">Předchozí šablona odpovídá cestě URL jako `/Blog/All-About-Routing/Introduction` a extrahuje hodnoty `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1101">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="ee8de-1102">Výchozí hodnoty trasy pro `controller` a `action` jsou vytvářeny trasou, i když v šabloně nejsou odpovídající parametry směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1102">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="ee8de-1103">V šabloně směrování lze zadat výchozí hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1103">Default values can be specified in the route template.</span></span> <span data-ttu-id="ee8de-1104">Parametr trasy `article` je definován jako *catch-All* pomocí vzhledu hvězdičky (`*`) před názvem parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1104">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk (`*`) before the route parameter name.</span></span> <span data-ttu-id="ee8de-1105">Catch – všechny parametry tras zaznamenávají zbytek cesty URL a můžou taky odpovídat prázdnému řetězci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1105">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="ee8de-1106">Následující příklad přidá omezení trasy a datové tokeny:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1106">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="ee8de-1107">Předchozí šablona odpovídá cestě URL jako `/en-US/Products/5` a extrahuje hodnoty `{ controller = Products, action = Details, id = 5 }` a `{ locale = en-US }`datových tokenů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1107">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Tokeny systému Windows pro národní prostředí](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="ee8de-1109">Generování adresy URL třídy směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-1109">Route class URL generation</span></span>

<span data-ttu-id="ee8de-1110">Třída <xref:Microsoft.AspNetCore.Routing.Route> může také provádět generování adresy URL kombinováním sady hodnot směrování se šablonou směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1110">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="ee8de-1111">Toto je logicky obrácený proces, který odpovídá cestě URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1111">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="ee8de-1112">Chcete-li lépe pochopit generování adresy URL, Představte si, jakou adresu URL chcete vygenerovat, a pak se zamyslete nad tím, jak šablona trasy odpovídá této adrese</span><span class="sxs-lookup"><span data-stu-id="ee8de-1112">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="ee8de-1113">Jaké hodnoty by se vytvořily?</span><span class="sxs-lookup"><span data-stu-id="ee8de-1113">What values would be produced?</span></span> <span data-ttu-id="ee8de-1114">Toto je hrubý ekvivalent způsobu, jak generování adresy URL funguje ve třídě <xref:Microsoft.AspNetCore.Routing.Route>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1114">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="ee8de-1115">V následujícím příkladu je použita obecná výchozí trasa ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1115">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ee8de-1116">Při `{ controller = Products, action = List }`hodnoty trasy je vygenerována adresa URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1116">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="ee8de-1117">Hodnoty tras se nahradí odpovídajícími parametry tras, aby bylo možné vytvořit cestu k adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1117">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="ee8de-1118">Vzhledem k tomu, že `id` je volitelný parametr trasy, adresa URL se úspěšně vygenerovala bez hodnoty pro `id`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1118">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="ee8de-1119">Při `{ controller = Home, action = Index }`hodnoty trasy je vygenerována adresa URL `/`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1119">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="ee8de-1120">Zadané hodnoty trasy odpovídají výchozím hodnotám a jsou bezpečně vynechány segmenty odpovídající výchozím hodnotám.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1120">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="ee8de-1121">Obě adresy URL vygenerovaly zpáteční cestu pomocí následující definice trasy (`/Home/Index` a `/`) vytvoří stejné hodnoty trasy, které se použily k vygenerování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1121">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="ee8de-1122">Aplikace, která používá ASP.NET Core MVC, by měla používat <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> k vygenerování adres URL namísto volání přímo do směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1122">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="ee8de-1123">Další informace o generování adresy URL najdete v části [Reference pro generování adresy URL](#url-generation-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-1123">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="ee8de-1124">Použití middlewaru pro směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-1124">Use Routing Middleware</span></span>

<span data-ttu-id="ee8de-1125">Odkaz na [Microsoft. AspNetCore. app Metapackage](xref:fundamentals/metapackage-app) v souboru projektu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1125">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="ee8de-1126">Přidání směrování do kontejneru služby v `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1126">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="ee8de-1127">Trasy musí být nakonfigurovány v metodě `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1127">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="ee8de-1128">Ukázková aplikace používá následující rozhraní API:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1128">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="ee8de-1129"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; odpovídá pouze požadavkům HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1129"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> &ndash; Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="ee8de-1130">V následující tabulce jsou uvedeny odpovědi s danými identifikátory URI.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1130">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="ee8de-1131">Identifikátor URI</span><span class="sxs-lookup"><span data-stu-id="ee8de-1131">URI</span></span>                    | <span data-ttu-id="ee8de-1132">Základě</span><span class="sxs-lookup"><span data-stu-id="ee8de-1132">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="ee8de-1133">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ee8de-1133">Hello!</span></span> <span data-ttu-id="ee8de-1134">Hodnoty směrování: [operace, vytvořit], [ID, 3]</span><span class="sxs-lookup"><span data-stu-id="ee8de-1134">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="ee8de-1135">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ee8de-1135">Hello!</span></span> <span data-ttu-id="ee8de-1136">Hodnoty směrování: [operace, stopa], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="ee8de-1136">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="ee8de-1137">Dobrý den!</span><span class="sxs-lookup"><span data-stu-id="ee8de-1137">Hello!</span></span> <span data-ttu-id="ee8de-1138">Hodnoty směrování: [operace, stopa], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="ee8de-1138">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="ee8de-1139">Požadavek spadá do, bez shody.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1139">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="ee8de-1140">Dobrý den, Jana!</span><span class="sxs-lookup"><span data-stu-id="ee8de-1140">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="ee8de-1141">Požadavek spadá do, odpovídá pouze HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1141">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="ee8de-1142">Požadavek spadá do, bez shody.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1142">The request falls through, no match.</span></span>              |

<span data-ttu-id="ee8de-1143">Pokud konfigurujete jednu trasu, zavolejte <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> předání v instanci `IRouter`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1143">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="ee8de-1144">Nebudete muset používat <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1144">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="ee8de-1145">Rozhraní poskytuje sadu metod rozšíření pro vytváření tras (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span><span class="sxs-lookup"><span data-stu-id="ee8de-1145">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="ee8de-1146">Některé z uvedených metod, například <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, vyžadují <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1146">Some of listed methods, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, require a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="ee8de-1147"><xref:Microsoft.AspNetCore.Http.RequestDelegate> se používá jako *obslužná rutina trasy* při porovnání trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1147">The <xref:Microsoft.AspNetCore.Http.RequestDelegate> is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="ee8de-1148">Jiné metody v této rodině umožňují konfigurovat kanál middlewaru pro použití jako obslužná rutina trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1148">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="ee8de-1149">Pokud metoda `Map*` nepřijímá obslužnou rutinu, jako je například <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, používá <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1149">If the `Map*` method doesn't accept a handler, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="ee8de-1150">Metody `Map[Verb]` používají omezení k omezení trasy na příkaz HTTP v názvu metody.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1150">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="ee8de-1151">Například viz <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> a <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1151">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="ee8de-1152">Odkaz na šablonu směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-1152">Route template reference</span></span>

<span data-ttu-id="ee8de-1153">Tokeny ve složených závorkách (`{ ... }`) definují *parametry trasy* , které jsou svázané, pokud je trasa shodná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1153">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="ee8de-1154">V segmentu směrování můžete definovat více než jeden parametr trasy, ale musí být oddělený literálovou hodnotou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1154">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="ee8de-1155">Například `{controller=Home}{action=Index}` není platná trasa, protože žádná hodnota literálu není mezi `{controller}` a `{action}`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1155">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="ee8de-1156">Tyto parametry tras musí mít název a můžou mít zadané další atributy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1156">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="ee8de-1157">Textový literál jiný než parametry směrování (například `{id}`) a oddělovač cest `/` musí odpovídat textu v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1157">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="ee8de-1158">U porovnávání textu se nerozlišují malá a velká písmena a na základě dekódovat reprezentace cesty URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1158">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="ee8de-1159">Chcete-li spárovat oddělovač parametrů trasy (`{` nebo `}`), vydejte znak oddělovače opakováním znaku (`{{` nebo `}}`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1159">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="ee8de-1160">Vzory adres URL, které se pokoušejí zachytit název souboru s volitelnou příponou souboru, mají další požadavky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1160">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="ee8de-1161">Představte si třeba šablonu `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1161">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="ee8de-1162">Pokud existují hodnoty pro `filename` i `ext`, naplní se obě hodnoty.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1162">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="ee8de-1163">Pokud se v adrese URL vyskytuje jenom hodnota `filename`, odpovídá trasa, protože koncová tečka (`.`) je volitelná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1163">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="ee8de-1164">Tuto trasu odpovídají následujícím adresám URL:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1164">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="ee8de-1165">Můžete použít hvězdičku (`*`) jako předponu parametru Route pro vytvoření vazby na zbytek identifikátoru URI.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1165">You can use the asterisk (`*`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="ee8de-1166">Tento parametr se nazývá *catch-All* .</span><span class="sxs-lookup"><span data-stu-id="ee8de-1166">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="ee8de-1167">`blog/{*slug}` například odpovídá jakémukoli identifikátoru URI, který začíná na `/blog` a má libovolnou hodnotu, která je za ní přiřazena hodnota `slug` trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1167">For example, `blog/{*slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="ee8de-1168">Catch – všechny parametry můžou odpovídat také prázdnému řetězci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1168">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="ee8de-1169">Parametr catch-All řídí příslušné znaky, pokud je použita cesta pro vygenerování adresy URL, včetně oddělovače cest (`/`) znaků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1169">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="ee8de-1170">Například trasa `foo/{*path}` s hodnotami trasy `{ path = "my/path" }` generuje `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1170">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="ee8de-1171">Všimněte si řídicího znaku lomítka.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1171">Note the escaped forward slash.</span></span>

<span data-ttu-id="ee8de-1172">Parametry směrování můžou mít *výchozí hodnoty* určené zadáním výchozí hodnoty za názvem parametru odděleným symbolem rovná se (`=`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1172">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="ee8de-1173">Například `{controller=Home}` definuje `Home` jako výchozí hodnotu pro `controller`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1173">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="ee8de-1174">Výchozí hodnota se použije v případě, že v adrese URL parametru není k dispozici žádná hodnota.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1174">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="ee8de-1175">Parametry směrování jsou nepovinné tím, že se k konci názvu parametru připojí otazník (`?`), jako v `id?`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1175">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="ee8de-1176">Rozdíl mezi volitelnými hodnotami a výchozími parametry směrování je, že parametr trasy s výchozí hodnotou vždy vytvoří hodnotu&mdash;volitelný parametr má hodnotu pouze v případě, že adresa URL požadavku poskytne hodnotu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1176">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="ee8de-1177">Parametry směrování můžou mít omezení, která se musí shodovat s hodnotou trasy svázanou z adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1177">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="ee8de-1178">Přidání dvojtečky (`:`) a názvu omezení za názvem parametru trasy Určuje *vložené omezení* pro parametr trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1178">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="ee8de-1179">Pokud omezení vyžaduje argumenty, jsou po názvu omezení uzavřeny do závorek (`(...)`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1179">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="ee8de-1180">Přidáním dalších dvojtečk (`:`) a názvu omezení lze zadat více vložených omezení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1180">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="ee8de-1181">Název omezení a argumenty jsou předány službě <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver>, aby se vytvořila instance <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, která se má použít při zpracování adresy URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1181">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="ee8de-1182">Například šablona trasy `blog/{article:minlength(10)}` určuje omezení `minlength` s argumentem `10`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1182">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="ee8de-1183">Další informace o omezeních tras a seznam omezení poskytovaných rozhraním najdete v části [referenční informace k omezením trasy](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-1183">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="ee8de-1184">Následující tabulka ukazuje příklady šablon směrování a jejich chování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1184">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="ee8de-1185">Šablona směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-1185">Route Template</span></span>                           | <span data-ttu-id="ee8de-1186">Příklad odpovídajícího identifikátoru URI</span><span class="sxs-lookup"><span data-stu-id="ee8de-1186">Example Matching URI</span></span>    | <span data-ttu-id="ee8de-1187">Identifikátor URI žádosti&hellip;</span><span class="sxs-lookup"><span data-stu-id="ee8de-1187">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="ee8de-1188">Odpovídá pouze jedné cestě `/hello`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1188">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="ee8de-1189">Porovná a nastaví `Page` k `Home`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1189">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="ee8de-1190">Porovná a nastaví `Page` k `Contact`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1190">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="ee8de-1191">Provede mapování na kontroler `Products` a `List` akci.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1191">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="ee8de-1192">Provede mapování na řadič `Products` a akci `Details` (`id` nastaveno na 123).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1192">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="ee8de-1193">Provede mapování na řadič `Home` a metodu `Index` (`id` je ignorováno).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1193">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="ee8de-1194">Použití šablony je obecně nejjednodušší přístup ke směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1194">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="ee8de-1195">Omezení a výchozí hodnoty je možné zadat i mimo šablonu směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1195">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="ee8de-1196">Povolte [protokolování](xref:fundamentals/logging/index) , abyste viděli, jak se zabudovaná implementace směrování, například <xref:Microsoft.AspNetCore.Routing.Route>, odpovídá požadavkům.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1196">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="ee8de-1197">Názvy rezervovaných směrování</span><span class="sxs-lookup"><span data-stu-id="ee8de-1197">Reserved routing names</span></span>

<span data-ttu-id="ee8de-1198">Následující klíčová slova jsou vyhrazená jména a nelze je použít jako názvy a parametry směrování:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1198">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="ee8de-1199">Odkaz na omezení trasy</span><span class="sxs-lookup"><span data-stu-id="ee8de-1199">Route constraint reference</span></span>

<span data-ttu-id="ee8de-1200">Omezení trasy se spustí, když došlo ke shodě s příchozí adresou URL a cesta URL je zavedená do hodnot tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1200">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="ee8de-1201">Omezení tras obvykle kontrolují hodnotu trasy přidruženou prostřednictvím šablony trasy a učiní ano/bez rozhodnutí o tom, zda je tato hodnota přijatelná.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1201">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="ee8de-1202">Některá omezení tras používají data mimo hodnotu trasy k zvážení toho, zda je možné požadavek směrovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1202">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="ee8de-1203"><xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> například může přijmout nebo odmítnout požadavek na základě jeho příkazu HTTP.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1203">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="ee8de-1204">Omezení se používají při směrování požadavků a vytváření propojení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1204">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="ee8de-1205">Nepoužívejte omezení pro **ověřování vstupu**.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1205">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="ee8de-1206">Pokud se pro **ověřování vstupu**používají omezení, neplatné výsledky vstupu v *404 – nenalezené* odpovědi namísto *400 – Chybný požadavek* s příslušnou chybovou zprávou.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1206">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="ee8de-1207">Omezení tras slouží k jednoznačnému **rozlišení podobných tras** , nikoli k ověření vstupů konkrétní trasy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1207">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="ee8de-1208">Následující tabulka ukazuje příklad omezení trasy a jejich očekávané chování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1208">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="ee8de-1209">omezení</span><span class="sxs-lookup"><span data-stu-id="ee8de-1209">constraint</span></span> | <span data-ttu-id="ee8de-1210">Příklad</span><span class="sxs-lookup"><span data-stu-id="ee8de-1210">Example</span></span> | <span data-ttu-id="ee8de-1211">Příklady shody</span><span class="sxs-lookup"><span data-stu-id="ee8de-1211">Example Matches</span></span> | <span data-ttu-id="ee8de-1212">Poznámky</span><span class="sxs-lookup"><span data-stu-id="ee8de-1212">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="ee8de-1213">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1213">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ee8de-1214">Odpovídá jakémukoli celému číslu</span><span class="sxs-lookup"><span data-stu-id="ee8de-1214">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="ee8de-1215">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1215">`true`, `FALSE`</span></span> | <span data-ttu-id="ee8de-1216">Odpovídá `true` nebo `false` (bez rozlišení velkých a malých písmen)</span><span class="sxs-lookup"><span data-stu-id="ee8de-1216">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="ee8de-1217">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1217">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="ee8de-1218">Odpovídá platné hodnotě `DateTime` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-1218">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="ee8de-1219">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1219">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="ee8de-1220">Odpovídá platné hodnotě `decimal` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-1220">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="ee8de-1221">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1221">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ee8de-1222">Odpovídá platné hodnotě `double` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-1222">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="ee8de-1223">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1223">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ee8de-1224">Odpovídá platné hodnotě `float` (v neutrální jazykové verzi – viz upozornění)</span><span class="sxs-lookup"><span data-stu-id="ee8de-1224">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="ee8de-1225">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1225">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="ee8de-1226">Odpovídá platnému hodnotě `Guid`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1226">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="ee8de-1227">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1227">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ee8de-1228">Odpovídá platnému hodnotě `long`</span><span class="sxs-lookup"><span data-stu-id="ee8de-1228">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="ee8de-1229">Řetězec musí mít minimálně 4 znaky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1229">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="ee8de-1230">Řetězec nesmí být delší než 8 znaků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1230">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="ee8de-1231">Řetězec musí být přesně 12 znaků dlouhý.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1231">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="ee8de-1232">Řetězec musí mít aspoň 8 znaků a nesmí být delší než 16 znaků.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1232">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="ee8de-1233">Celočíselná hodnota musí být minimálně 18.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1233">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="ee8de-1234">Hodnota typu Integer nesmí být větší než 120.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1234">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="ee8de-1235">Celočíselná hodnota musí být minimálně 18, ale ne víc než 120.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1235">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="ee8de-1236">Řetězec musí obsahovat jeden nebo více abecedních znaků (`a`-`z`, nerozlišuje velká a malá písmena).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1236">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="ee8de-1237">Řetězec musí odpovídat regulárnímu výrazu (viz Tipy k definování regulárního výrazu).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1237">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="ee8de-1238">Slouží k vykonání, že při generování adresy URL je přítomna hodnota bez parametru.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1238">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="ee8de-1239">V jednom parametru lze použít více omezení s oddělovači.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1239">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="ee8de-1240">Například následující omezení omezuje parametr na celočíselnou hodnotu 1 nebo vyšší:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1240">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="ee8de-1241">Omezení směrování, která ověřují adresu URL a jsou převedena na typ CLR (například `int` nebo `DateTime`) vždy používají invariantní jazykovou verzi.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1241">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="ee8de-1242">Tato omezení předpokládají, že adresa URL nelze lokalizovat.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1242">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="ee8de-1243">Omezení tras poskytovaných rozhraním nemění hodnoty uložené v hodnotách tras.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1243">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="ee8de-1244">Všechny hodnoty tras přeložené z adresy URL se ukládají jako řetězce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1244">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="ee8de-1245">Například omezení `float` se pokusí převést hodnotu trasy na typ float, ale převedená hodnota se používá pouze k ověření, že je možné ji převést na typ float.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1245">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="ee8de-1246">Regulární výrazy</span><span class="sxs-lookup"><span data-stu-id="ee8de-1246">Regular expressions</span></span>

<span data-ttu-id="ee8de-1247">Rozhraní ASP.NET Core Framework přidá `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` do konstruktoru regulárního výrazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1247">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="ee8de-1248">Popis těchto členů naleznete v tématu <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1248">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="ee8de-1249">Regulární výrazy používají oddělovače a tokeny podobné těm, které používá směrování a C# jazyk.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1249">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="ee8de-1250">Tokeny regulárního výrazu musí být uvozeny řídicími znaky.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1250">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="ee8de-1251">Chcete-li použít regulární výraz `^\d{3}-\d{2}-\d{4}$` ve směrování, musí mít výraz `\` (jedno zpětné lomítko), které je zadáno v řetězci jako `\\` (Dvojitá zpětná lomítka C# ) ve zdrojovém souboru, aby mohl řídicí znak `\`. znak (Pokud nepoužíváte [doslovné řetězce literálů](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1251">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="ee8de-1252">Chcete-li řídicí znaky oddělovače parametrů směrování (`{`, `}`, `[`, `]`), poklikejte na znaky ve výrazu (`{{`, `}`, `[[`, `]]`).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1252">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="ee8de-1253">V následující tabulce je uveden regulární výraz a verze s řídicím znakem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1253">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="ee8de-1254">Regulární výraz</span><span class="sxs-lookup"><span data-stu-id="ee8de-1254">Regular Expression</span></span>    | <span data-ttu-id="ee8de-1255">Regulární výraz s řídicím znakem</span><span class="sxs-lookup"><span data-stu-id="ee8de-1255">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="ee8de-1256">Regulární výrazy používané v směrování často začínají znakem stříšky (`^`) a odpovídají počáteční pozici řetězce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1256">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="ee8de-1257">Výrazy často končí znakem dolaru (`$`) a koncem řetězce.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1257">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="ee8de-1258">Znaky `^` a `$` zajišťují, že regulární výraz odpovídá celé hodnotě parametru Route.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1258">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="ee8de-1259">Bez `^` a `$` znaků regulární výraz odpovídá jakémukoli podřetězci v řetězci, což je často nežádoucí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1259">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="ee8de-1260">Následující tabulka obsahuje příklady a vysvětlení, proč se shodují nebo neshodují.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1260">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="ee8de-1261">Výraz</span><span class="sxs-lookup"><span data-stu-id="ee8de-1261">Expression</span></span>   | <span data-ttu-id="ee8de-1262">String</span><span class="sxs-lookup"><span data-stu-id="ee8de-1262">String</span></span>    | <span data-ttu-id="ee8de-1263">Shoda</span><span class="sxs-lookup"><span data-stu-id="ee8de-1263">Match</span></span> | <span data-ttu-id="ee8de-1264">Komentář</span><span class="sxs-lookup"><span data-stu-id="ee8de-1264">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-1265">Dobrý den</span><span class="sxs-lookup"><span data-stu-id="ee8de-1265">hello</span></span>     | <span data-ttu-id="ee8de-1266">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-1266">Yes</span></span>   | <span data-ttu-id="ee8de-1267">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ee8de-1267">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-1268">123abc456</span><span class="sxs-lookup"><span data-stu-id="ee8de-1268">123abc456</span></span> | <span data-ttu-id="ee8de-1269">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-1269">Yes</span></span>   | <span data-ttu-id="ee8de-1270">Shody podřetězců</span><span class="sxs-lookup"><span data-stu-id="ee8de-1270">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-1271">MZ</span><span class="sxs-lookup"><span data-stu-id="ee8de-1271">mz</span></span>        | <span data-ttu-id="ee8de-1272">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-1272">Yes</span></span>   | <span data-ttu-id="ee8de-1273">Výraz shody</span><span class="sxs-lookup"><span data-stu-id="ee8de-1273">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="ee8de-1274">MZ</span><span class="sxs-lookup"><span data-stu-id="ee8de-1274">MZ</span></span>        | <span data-ttu-id="ee8de-1275">Ano</span><span class="sxs-lookup"><span data-stu-id="ee8de-1275">Yes</span></span>   | <span data-ttu-id="ee8de-1276">Nerozlišuje velká a malá písmena</span><span class="sxs-lookup"><span data-stu-id="ee8de-1276">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="ee8de-1277">Dobrý den</span><span class="sxs-lookup"><span data-stu-id="ee8de-1277">hello</span></span>     | <span data-ttu-id="ee8de-1278">Ne</span><span class="sxs-lookup"><span data-stu-id="ee8de-1278">No</span></span>    | <span data-ttu-id="ee8de-1279">Viz `^` a `$` výše.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1279">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="ee8de-1280">123abc456</span><span class="sxs-lookup"><span data-stu-id="ee8de-1280">123abc456</span></span> | <span data-ttu-id="ee8de-1281">Ne</span><span class="sxs-lookup"><span data-stu-id="ee8de-1281">No</span></span>    | <span data-ttu-id="ee8de-1282">Viz `^` a `$` výše.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1282">See `^` and `$` above</span></span> |

<span data-ttu-id="ee8de-1283">Další informace o syntaxi regulárního výrazu naleznete v tématu [.NET Framework regulární výrazy](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1283">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="ee8de-1284">Chcete-li omezit parametr na známou sadu možných hodnot, použijte regulární výraz.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1284">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="ee8de-1285">`{action:regex(^(list|get|create)$)}` například odpovídá pouze hodnotě `action` trasy `list`, `get`nebo `create`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1285">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="ee8de-1286">Pokud se předává do slovníku omezení, `^(list|get|create)$` řetězec je ekvivalentní.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1286">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="ee8de-1287">Omezení, která jsou předána do slovníku omezení (nejsou vložena v rámci šablony), která neodpovídají jednomu ze známých omezení, jsou také považována za regulární výrazy.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1287">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="ee8de-1288">Vlastní omezení trasy</span><span class="sxs-lookup"><span data-stu-id="ee8de-1288">Custom Route Constraints</span></span>

<span data-ttu-id="ee8de-1289">Kromě předdefinovaných omezení trasy je možné vytvořit vlastní omezení trasy implementací rozhraní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1289">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="ee8de-1290">Rozhraní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> obsahuje jedinou metodu, `Match`, která vrací `true`, pokud je omezení splněno a `false` jinak.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1290">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="ee8de-1291">Pokud chcete použít vlastní <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, musí být typ omezení trasy zaregistrovaný v <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> aplikace v kontejneru služby aplikace.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1291">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="ee8de-1292"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> je slovník, který mapuje klíče omezení tras na <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementace, které tyto omezení ověřují.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1292">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="ee8de-1293"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> aplikace lze v `Startup.ConfigureServices` aktualizovat buď jako součást [služeb. AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) volání nebo konfigurací <xref:Microsoft.AspNetCore.Routing.RouteOptions> přímo pomocí `services.Configure<RouteOptions>`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1293">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="ee8de-1294">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1294">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="ee8de-1295">Omezení lze následně použít na trasy obvyklým způsobem pomocí názvu zadaného při registraci typu omezení.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1295">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="ee8de-1296">Příklad:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1296">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="url-generation-reference"></a><span data-ttu-id="ee8de-1297">Odkaz na generování adresy URL</span><span class="sxs-lookup"><span data-stu-id="ee8de-1297">URL generation reference</span></span>

<span data-ttu-id="ee8de-1298">Následující příklad ukazuje, jak vygenerovat odkaz na trasu s ohledem na slovník hodnot směrování a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1298">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="ee8de-1299"><xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> vygenerované na konci předchozí ukázky je `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1299">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="ee8de-1300">Slovník poskytuje `operation` a `id` hodnoty trasy pro šablonu sledování trasy balíčku `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1300">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="ee8de-1301">Podrobnosti najdete v ukázkovém kódu v části [použití middleware pro směrování](#use-routing-middleware) nebo v [ukázkové aplikaci](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="ee8de-1301">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/aspnet/AspNetCore.Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="ee8de-1302">Druhý parametr pro konstruktor <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> je kolekcí *hodnot okolí*.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1302">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="ee8de-1303">Okolní hodnoty jsou vhodné k použití, protože omezují počet hodnot, které vývojář musí určit v rámci kontextu požadavku.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1303">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="ee8de-1304">Aktuální hodnoty trasy aktuálního požadavku jsou považovány za okolní hodnoty pro generování odkazů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1304">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="ee8de-1305">V akci `About` `HomeController`aplikace ASP.NET Core MVC není nutné zadávat hodnotu trasy kontroleru, která se má propojit s `Index` akcí&mdash;je použita ambientní hodnota `Home`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1305">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="ee8de-1306">Okolní hodnoty, které se neshodují s parametrem, se ignorují.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1306">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="ee8de-1307">Okolní hodnoty jsou také ignorovány, pokud explicitně poskytnutá hodnota Přepisuje hodnotu okolí.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1307">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="ee8de-1308">K shodě dojde zleva doprava v adrese URL.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1308">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="ee8de-1309">Hodnoty jsou výslovně poskytnuty, ale neodpovídají segmentu trasy, jsou přidány do řetězce dotazu.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1309">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="ee8de-1310">V následující tabulce je uveden výsledek při použití `{controller}/{action}/{id?}`šablony směrování.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1310">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="ee8de-1311">Okolní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ee8de-1311">Ambient Values</span></span>                     | <span data-ttu-id="ee8de-1312">Explicitní hodnoty</span><span class="sxs-lookup"><span data-stu-id="ee8de-1312">Explicit Values</span></span>                        | <span data-ttu-id="ee8de-1313">Výsledek</span><span class="sxs-lookup"><span data-stu-id="ee8de-1313">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="ee8de-1314">Controller = "domů"</span><span class="sxs-lookup"><span data-stu-id="ee8de-1314">controller = "Home"</span></span>                | <span data-ttu-id="ee8de-1315">Action = "o"</span><span class="sxs-lookup"><span data-stu-id="ee8de-1315">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ee8de-1316">Controller = "domů"</span><span class="sxs-lookup"><span data-stu-id="ee8de-1316">controller = "Home"</span></span>                | <span data-ttu-id="ee8de-1317">Controller = "objednávka"; Action = "o"</span><span class="sxs-lookup"><span data-stu-id="ee8de-1317">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="ee8de-1318">Controller = "Home"; Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="ee8de-1318">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="ee8de-1319">Action = "o"</span><span class="sxs-lookup"><span data-stu-id="ee8de-1319">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="ee8de-1320">Controller = "domů"</span><span class="sxs-lookup"><span data-stu-id="ee8de-1320">controller = "Home"</span></span>                | <span data-ttu-id="ee8de-1321">Action = "o", Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="ee8de-1321">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="ee8de-1322">Pokud má trasa výchozí hodnotu, která neodpovídá parametru a tato hodnota je explicitně poskytnutá, musí se shodovat s výchozí hodnotou:</span><span class="sxs-lookup"><span data-stu-id="ee8de-1322">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="ee8de-1323">Generace odkazů generuje odkaz pro tuto trasu, pokud jsou k dispozici hodnoty pro `controller` a `action`.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1323">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="ee8de-1324">Komplexní segmenty</span><span class="sxs-lookup"><span data-stu-id="ee8de-1324">Complex segments</span></span>

<span data-ttu-id="ee8de-1325">Komplexní segmenty (například `[Route("/x{token}y")]`) jsou zpracovávány porovnáním koncových literálů zprava doleva nehladým způsobem.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1325">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="ee8de-1326">Podrobné vysvětlení, jak se shodují komplexní segmenty, najdete v [tomto kódu](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) .</span><span class="sxs-lookup"><span data-stu-id="ee8de-1326">See [this code](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="ee8de-1327">[Ukázka kódu](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) není používána ASP.NET Core, ale poskytuje dobré vysvětlení složitých segmentů.</span><span class="sxs-lookup"><span data-stu-id="ee8de-1327">The [code sample](https://github.com/aspnet/AspNetCore/blob/release/2.2/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/aspnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end
