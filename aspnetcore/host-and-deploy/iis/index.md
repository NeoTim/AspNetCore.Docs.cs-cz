---
title: Hostování ASP.NET jádra ve službě Windows se službou IIS
author: rick-anderson
description: Přečtěte si, jak hostovat aplikace ASP.NET Core v Internetové informační službě (IIS) systému Windows Server.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 04/17/2020
uid: host-and-deploy/iis/index
ms.openlocfilehash: 77f07ba89de4449c6d13006a5fd61499cb5cdfc0
ms.sourcegitcommit: 3d07e21868dafc503530ecae2cfa18a7490b58a6
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/18/2020
ms.locfileid: "81642752"
---
# <a name="host-aspnet-core-on-windows-with-iis"></a><span data-ttu-id="c4614-103">Hostování ASP.NET jádra ve službě Windows se službou IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-103">Host ASP.NET Core on Windows with IIS</span></span>

<!-- 

    NOTE FOR 5.0
    
    When making the 5.0 version of this topic, remove the Hosting Bundle
    direct download section from the (new) <5.0 & >2.2 version and modify 
    the text and heading for the *Earlier versions of the installer* 
    section. See the 2.2 version for an example.
    
-->

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="c4614-104">Výukové prostředí o publikování aplikace ASP.NET Core na server <xref:tutorials/publish-to-iis>služby IIS naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-104">For a tutorial experience on publishing an ASP.NET Core app to an IIS server, see <xref:tutorials/publish-to-iis>.</span></span>

[<span data-ttu-id="c4614-105">Instalace balíčku hostingu jádra .NET</span><span class="sxs-lookup"><span data-stu-id="c4614-105">Install the .NET Core Hosting Bundle</span></span>](#install-the-net-core-hosting-bundle)

## <a name="supported-operating-systems"></a><span data-ttu-id="c4614-106">Podporované operační systémy</span><span class="sxs-lookup"><span data-stu-id="c4614-106">Supported operating systems</span></span>

<span data-ttu-id="c4614-107">Podporovány jsou následující operační systémy:</span><span class="sxs-lookup"><span data-stu-id="c4614-107">The following operating systems are supported:</span></span>

* <span data-ttu-id="c4614-108">Windows 7 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-108">Windows 7 or later</span></span>
* <span data-ttu-id="c4614-109">Windows Server 2012 R2 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-109">Windows Server 2012 R2 or later</span></span>

<span data-ttu-id="c4614-110">[Server HTTP.sys](xref:fundamentals/servers/httpsys) (dříve nazývaný WebListener) nefunguje v konfiguraci reverzního proxy serveru se službou IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-110">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called WebListener) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="c4614-111">Použijte [server Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="c4614-111">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="c4614-112">Informace o hostování v <xref:host-and-deploy/azure-apps/index>Azure najdete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-112">For information on hosting in Azure, see <xref:host-and-deploy/azure-apps/index>.</span></span>

<span data-ttu-id="c4614-113">Pokyny pro řešení <xref:test/troubleshoot>potíží naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-113">For troubleshooting guidance, see <xref:test/troubleshoot>.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="c4614-114">Podporované platformy</span><span class="sxs-lookup"><span data-stu-id="c4614-114">Supported platforms</span></span>

<span data-ttu-id="c4614-115">Podporovány jsou aplikace publikované pro 32bitové (x86) nebo 64bitové (x64) nasazení.</span><span class="sxs-lookup"><span data-stu-id="c4614-115">Apps published for 32-bit (x86) or 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="c4614-116">Nasazení 32bitové aplikace s 32bitovou sadou .NET Core SDK, pokud ji ne:</span><span class="sxs-lookup"><span data-stu-id="c4614-116">Deploy a 32-bit app with a 32-bit (x86) .NET Core SDK unless the app:</span></span>

* <span data-ttu-id="c4614-117">Vyžaduje větší adresní prostor virtuální paměti, který je k dispozici pro 64bitovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-117">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="c4614-118">Vyžaduje větší velikost zásobníku iis.</span><span class="sxs-lookup"><span data-stu-id="c4614-118">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="c4614-119">Má 64bitové nativní závislosti.</span><span class="sxs-lookup"><span data-stu-id="c4614-119">Has 64-bit native dependencies.</span></span>

<span data-ttu-id="c4614-120">K publikování 64bitové sady SDK jádra (x64) použijte 64bitovou sadu .NET Core SDK.</span><span class="sxs-lookup"><span data-stu-id="c4614-120">Use a 64-bit (x64) .NET Core SDK to publish a 64-bit app.</span></span> <span data-ttu-id="c4614-121">V hostitelském systému musí být k dispozici 64bitový běhový čas.</span><span class="sxs-lookup"><span data-stu-id="c4614-121">A 64-bit runtime must be present on the host system.</span></span>

## <a name="hosting-models"></a><span data-ttu-id="c4614-122">Modely hostingu</span><span class="sxs-lookup"><span data-stu-id="c4614-122">Hosting models</span></span>

### <a name="in-process-hosting-model"></a><span data-ttu-id="c4614-123">Model hostování v procesu</span><span class="sxs-lookup"><span data-stu-id="c4614-123">In-process hosting model</span></span>

<span data-ttu-id="c4614-124">Pomocí hostování v rámci procesu běží aplikace ASP.NET Core ve stejném procesu jako pracovní proces služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-124">Using in-process hosting, an ASP.NET Core app runs in the same process as its IIS worker process.</span></span> <span data-ttu-id="c4614-125">Hostování v procesu poskytuje lepší výkon než mimoproceshosting, protože požadavky nejsou proxied přes adaptér zpětné smyčky, síťové rozhraní, které vrací odchozí síťový provoz zpět do stejného počítače.</span><span class="sxs-lookup"><span data-stu-id="c4614-125">In-process hosting provides improved performance over out-of-process hosting because requests aren't proxied over the loopback adapter, a network interface that returns outgoing network traffic back to the same machine.</span></span> <span data-ttu-id="c4614-126">Služba IIS zpracovává správu procesů pomocí [služby aktivace procesů systému Windows (WAS).](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was)</span><span class="sxs-lookup"><span data-stu-id="c4614-126">IIS handles process management with the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="c4614-127">Základní [modul ASP.NET](xref:host-and-deploy/aspnet-core-module):</span><span class="sxs-lookup"><span data-stu-id="c4614-127">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module):</span></span>

* <span data-ttu-id="c4614-128">Provede inicializaci aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-128">Performs app initialization.</span></span>
  * <span data-ttu-id="c4614-129">Načte [CoreCLR](/dotnet/standard/glossary#coreclr).</span><span class="sxs-lookup"><span data-stu-id="c4614-129">Loads the [CoreCLR](/dotnet/standard/glossary#coreclr).</span></span>
  * <span data-ttu-id="c4614-130">Volání `Program.Main`.</span><span class="sxs-lookup"><span data-stu-id="c4614-130">Calls `Program.Main`.</span></span>
* <span data-ttu-id="c4614-131">Zpracovává životnost nativního požadavku služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-131">Handles the lifetime of the IIS native request.</span></span>

<span data-ttu-id="c4614-132">Model hostování v procesu není podporován pro aplikace ASP.NET Core, které cílí na rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c4614-132">The in-process hosting model isn't supported for ASP.NET Core apps that target the .NET Framework.</span></span>

<span data-ttu-id="c4614-133">Následující diagram znázorňuje vztah mezi iis, ASP.NET základní modul a aplikace hostované v procesu:</span><span class="sxs-lookup"><span data-stu-id="c4614-133">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted in-process:</span></span>

![ASP.NET core modul ve scénáři hostování v procesu](index/_static/ancm-inprocess.png)

<span data-ttu-id="c4614-135">Požadavek přichází z webu na ovladač HTTP.sys v režimu jádra.</span><span class="sxs-lookup"><span data-stu-id="c4614-135">A request arrives from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="c4614-136">Řidič směruje nativní požadavek do služby IIS na nakonfigurovaném portu webu, obvykle 80 (HTTP) nebo 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="c4614-136">The driver routes the native request to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="c4614-137">Základní modul ASP.NET obdrží nativní požadavek a předá`IISHttpServer`jej serveru HTTP služby IIS ( ).</span><span class="sxs-lookup"><span data-stu-id="c4614-137">The ASP.NET Core Module receives the native request and passes it to IIS HTTP Server (`IISHttpServer`).</span></span> <span data-ttu-id="c4614-138">Server HTTP služby IIS je implementace serveru v procesu pro službu IIS, která převádí požadavek z nativního na spravovaný.</span><span class="sxs-lookup"><span data-stu-id="c4614-138">IIS HTTP Server is an in-process server implementation for IIS that converts the request from native to managed.</span></span>

<span data-ttu-id="c4614-139">Po zpracování požadavku serverem HTTP služby IIS je požadavek odeslán do kanálu middlewaru ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-139">After the IIS HTTP Server processes the request, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="c4614-140">Middleware kanálu zpracovává požadavek a předá `HttpContext` jej jako instanci logiky aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-140">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="c4614-141">Odpověď aplikace je předána zpět do služby IIS prostřednictvím serveru HTTP služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-141">The app's response is passed back to IIS through IIS HTTP Server.</span></span> <span data-ttu-id="c4614-142">Služba IIS odešle odpověď klientovi, který požadavek inicioval.</span><span class="sxs-lookup"><span data-stu-id="c4614-142">IIS sends the response to the client that initiated the request.</span></span>

<span data-ttu-id="c4614-143">Hostování v procesu je přihlášení pro stávající aplikace, ale [dotnet nové](/dotnet/core/tools/dotnet-new) šablony výchozí v procesu hostování modelu pro všechny scénáře služby IIS a IIS Express.</span><span class="sxs-lookup"><span data-stu-id="c4614-143">In-process hosting is opt-in for existing apps, but [dotnet new](/dotnet/core/tools/dotnet-new) templates default to the in-process hosting model for all IIS and IIS Express scenarios.</span></span>

<span data-ttu-id="c4614-144">`CreateDefaultBuilder`přidá <xref:Microsoft.AspNetCore.Hosting.Server.IServer> instanci <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS*> voláním metody pro spuštění [coreclru](/dotnet/standard/glossary#coreclr) a hostování aplikace uvnitř pracovního procesu služby IIS (*w3wp.exe* nebo *iisexpress.exe*).</span><span class="sxs-lookup"><span data-stu-id="c4614-144">`CreateDefaultBuilder` adds an <xref:Microsoft.AspNetCore.Hosting.Server.IServer> instance by calling the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS*> method to boot the [CoreCLR](/dotnet/standard/glossary#coreclr) and host the app inside of the IIS worker process (*w3wp.exe* or *iisexpress.exe*).</span></span> <span data-ttu-id="c4614-145">Testy výkonu ukazují, že hostování aplikace .NET Core v procesu přináší výrazně vyšší propustnost požadavků ve srovnání s hostováním aplikací mimo proces a proxy požadavků na server [Kestrel.](xref:fundamentals/servers/kestrel)</span><span class="sxs-lookup"><span data-stu-id="c4614-145">Performance tests indicate that hosting a .NET Core app in-process delivers significantly higher request throughput compared to hosting the app out-of-process and proxying requests to [Kestrel](xref:fundamentals/servers/kestrel) server.</span></span>

> [!NOTE]
> <span data-ttu-id="c4614-146">Aplikace publikované jako jeden soubor spustitelný soubor nelze načíst v procesu hostování modelu.</span><span class="sxs-lookup"><span data-stu-id="c4614-146">Apps published as a single file executable can't be loaded by the in-process hosting model.</span></span>

### <a name="out-of-process-hosting-model"></a><span data-ttu-id="c4614-147">Model hostování mimo proces</span><span class="sxs-lookup"><span data-stu-id="c4614-147">Out-of-process hosting model</span></span>

<span data-ttu-id="c4614-148">Vzhledem k tomu, že aplikace ASP.NET Core běží v procesu odděleném od pracovního procesu služby IIS, zpracovává ASP.NET core module správu procesů.</span><span class="sxs-lookup"><span data-stu-id="c4614-148">Because ASP.NET Core apps run in a process separate from the IIS worker process, the ASP.NET Core Module handles process management.</span></span> <span data-ttu-id="c4614-149">Modul spustí proces pro aplikaci ASP.NET Core při příchodu prvního požadavku a restartuje aplikaci, pokud se vypne nebo dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="c4614-149">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="c4614-150">Toto je v podstatě stejné chování jako u aplikací, které běží v procesu, které jsou spravovány [službou aktivace procesu systému Windows (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="c4614-150">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="c4614-151">Následující diagram znázorňuje vztah mezi iis, ASP.NET základní modul a aplikace hostované mimo proces:</span><span class="sxs-lookup"><span data-stu-id="c4614-151">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![ASP.NET základní modul ve scénáři mimoproceshostingového hostingu](index/_static/ancm-outofprocess.png)

<span data-ttu-id="c4614-153">Požadavky dorazí z webu do ovladače HTTP.sys v režimu jádra.</span><span class="sxs-lookup"><span data-stu-id="c4614-153">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="c4614-154">Řidič směruje požadavky do služby IIS na nakonfigurovaném portu webu, obvykle 80 (HTTP) nebo 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="c4614-154">The driver routes the requests to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="c4614-155">Modul předá požadavky Kestrel na náhodný port pro aplikaci, která není port 80 nebo 443.</span><span class="sxs-lookup"><span data-stu-id="c4614-155">The module forwards the requests to Kestrel on a random port for the app, which isn't port 80 or 443.</span></span>

<span data-ttu-id="c4614-156">Modul určuje port prostřednictvím proměnné prostředí při <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> spuštění a rozšíření konfiguruje server pro naslouchání . `http://localhost:{PORT}`</span><span class="sxs-lookup"><span data-stu-id="c4614-156">The module specifies the port via an environment variable at startup, and the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> extension configures the server to listen on `http://localhost:{PORT}`.</span></span> <span data-ttu-id="c4614-157">Jsou prováděny další kontroly a požadavky, které nepocházejí z modulu, jsou odmítnuty.</span><span class="sxs-lookup"><span data-stu-id="c4614-157">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="c4614-158">Modul nepodporuje předávání https, takže požadavky jsou předávány přes HTTP i v případě, že přijaté službou IIS přes protokol HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c4614-158">The module doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="c4614-159">Poté, co Kestrel vyzvedne požadavek z modulu, je požadavek posunut do kanálu ASP.NET middleware.</span><span class="sxs-lookup"><span data-stu-id="c4614-159">After Kestrel picks up the request from the module, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="c4614-160">Middleware kanálu zpracovává požadavek a předá `HttpContext` jej jako instanci logiky aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-160">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="c4614-161">Middleware přidané integrací služby IIS aktualizuje schéma, vzdálenou IP adresu a pathbase tak, aby odpovídaly předání požadavku ke společnosti Kestrel.</span><span class="sxs-lookup"><span data-stu-id="c4614-161">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="c4614-162">Odpověď aplikace je předána zpět do služby IIS, která ji odešle zpět do klienta HTTP, který inicioval požadavek.</span><span class="sxs-lookup"><span data-stu-id="c4614-162">The app's response is passed back to IIS, which pushes it back out to the HTTP client that initiated the request.</span></span>

<span data-ttu-id="c4614-163">Pokyny ke konfiguraci ASP.NET <xref:host-and-deploy/aspnet-core-module>core modulem naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-163">For ASP.NET Core Module configuration guidance, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="c4614-164">Další informace o hostování najdete [v tématu Host in ASP.NET Core](xref:fundamentals/index#host).</span><span class="sxs-lookup"><span data-stu-id="c4614-164">For more information on hosting, see [Host in ASP.NET Core](xref:fundamentals/index#host).</span></span>

## <a name="application-configuration"></a><span data-ttu-id="c4614-165">Konfigurace aplikací</span><span class="sxs-lookup"><span data-stu-id="c4614-165">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="c4614-166">Povolení součástí Integrace iIS</span><span class="sxs-lookup"><span data-stu-id="c4614-166">Enable the IISIntegration components</span></span>

<span data-ttu-id="c4614-167">Při vytváření hostitele `CreateHostBuilder` v *(Program.cs*) volání <xref:Microsoft.Extensions.Hosting.Host.CreateDefaultBuilder*> umožňující integraci iis:</span><span class="sxs-lookup"><span data-stu-id="c4614-167">When building a host in `CreateHostBuilder` (*Program.cs*), call <xref:Microsoft.Extensions.Hosting.Host.CreateDefaultBuilder*> to enable IIS integration:</span></span>

```csharp
public static IHostBuilder CreateHostBuilder(string[] args) =>
    Host.CreateDefaultBuilder(args)
        ...
```

<span data-ttu-id="c4614-168">Další informace `CreateDefaultBuilder`naleznete <xref:fundamentals/host/generic-host#default-builder-settings>v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-168">For more information on `CreateDefaultBuilder`, see <xref:fundamentals/host/generic-host#default-builder-settings>.</span></span>

### <a name="iis-options"></a><span data-ttu-id="c4614-169">Možnosti iis</span><span class="sxs-lookup"><span data-stu-id="c4614-169">IIS options</span></span>

<span data-ttu-id="c4614-170">**Model hostování v procesu**</span><span class="sxs-lookup"><span data-stu-id="c4614-170">**In-process hosting model**</span></span>

<span data-ttu-id="c4614-171">Chcete-li konfigurovat možnosti serveru IIS, zahrňte konfiguraci služby v <xref:Microsoft.AspNetCore.Builder.IISServerOptions> aplikaci <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span><span class="sxs-lookup"><span data-stu-id="c4614-171">To configure IIS Server options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISServerOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="c4614-172">Následující příklad zakáže automatické ověřování:</span><span class="sxs-lookup"><span data-stu-id="c4614-172">The following example disables AutomaticAuthentication:</span></span>

```csharp
services.Configure<IISServerOptions>(options => 
{
    options.AutomaticAuthentication = false;
});
```

| <span data-ttu-id="c4614-173">Možnost</span><span class="sxs-lookup"><span data-stu-id="c4614-173">Option</span></span>                         | <span data-ttu-id="c4614-174">Výchozí</span><span class="sxs-lookup"><span data-stu-id="c4614-174">Default</span></span> | <span data-ttu-id="c4614-175">Nastavení</span><span class="sxs-lookup"><span data-stu-id="c4614-175">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="c4614-176">Pokud `true`server IIS `HttpContext.User` nastaví ověřené ověřování [systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-176">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="c4614-177">Pokud `false`server poskytuje identitu pouze `HttpContext.User` pro výzvy a reaguje na `AuthenticationScheme`ně, pokud o to výslovně požádá .</span><span class="sxs-lookup"><span data-stu-id="c4614-177">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="c4614-178">Aby bylo možné službu `AutomaticAuthentication` IIS fungovat, musí být ve službě IIS povoleno ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-178">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="c4614-179">Další informace naleznete v tématu [Ověřování systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-179">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="c4614-180">Nastaví zobrazované jméno zobrazené uživatelům na přihlašovacích stránkách.</span><span class="sxs-lookup"><span data-stu-id="c4614-180">Sets the display name shown to users on login pages.</span></span> |
| `AllowSynchronousIO`           | `false` | <span data-ttu-id="c4614-181">Zda synchronní V/O je `HttpContext.Request` povoleno `HttpContext.Response`pro a .</span><span class="sxs-lookup"><span data-stu-id="c4614-181">Whether synchronous I/O is allowed for the `HttpContext.Request` and the `HttpContext.Response`.</span></span> |
| `MaxRequestBodySize`           | `30000000`  | <span data-ttu-id="c4614-182">Získá nebo nastaví maximální velikost `HttpRequest`těla požadavku pro .</span><span class="sxs-lookup"><span data-stu-id="c4614-182">Gets or sets the max request body size for the `HttpRequest`.</span></span> <span data-ttu-id="c4614-183">Všimněte si, že `maxAllowedContentLength` iis sám má `MaxRequestBodySize` limit, `IISServerOptions`který bude zpracován před soubor v .</span><span class="sxs-lookup"><span data-stu-id="c4614-183">Note that IIS itself has the limit `maxAllowedContentLength` which will be processed before the `MaxRequestBodySize` set in the `IISServerOptions`.</span></span> <span data-ttu-id="c4614-184">Změna `MaxRequestBodySize` nebude mít vliv `maxAllowedContentLength`na .</span><span class="sxs-lookup"><span data-stu-id="c4614-184">Changing the `MaxRequestBodySize` won't affect the `maxAllowedContentLength`.</span></span> <span data-ttu-id="c4614-185">Chcete-li zvýšit `maxAllowedContentLength`, přidejte položku `maxAllowedContentLength` do *web.config* nastavit na vyšší hodnotu.</span><span class="sxs-lookup"><span data-stu-id="c4614-185">To increase `maxAllowedContentLength`, add an entry in the *web.config* to set `maxAllowedContentLength` to a higher value.</span></span> <span data-ttu-id="c4614-186">Další podrobnosti naleznete v [tématu Konfigurace](/iis/configuration/system.webServer/security/requestFiltering/requestLimits/#configuration).</span><span class="sxs-lookup"><span data-stu-id="c4614-186">For more details, see [Configuration](/iis/configuration/system.webServer/security/requestFiltering/requestLimits/#configuration).</span></span> |

<span data-ttu-id="c4614-187">**Model hostování mimo proces**</span><span class="sxs-lookup"><span data-stu-id="c4614-187">**Out-of-process hosting model**</span></span>

<span data-ttu-id="c4614-188">Chcete-li konfigurovat možnosti služby <xref:Microsoft.AspNetCore.Builder.IISOptions> <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>IIS, zahrňte konfiguraci služby v aplikaci .</span><span class="sxs-lookup"><span data-stu-id="c4614-188">To configure IIS options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="c4614-189">Následující příklad zabrání aplikaci v naplnění `HttpContext.Connection.ClientCertificate`:</span><span class="sxs-lookup"><span data-stu-id="c4614-189">The following example prevents the app from populating `HttpContext.Connection.ClientCertificate`:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="c4614-190">Možnost</span><span class="sxs-lookup"><span data-stu-id="c4614-190">Option</span></span>                         | <span data-ttu-id="c4614-191">Výchozí</span><span class="sxs-lookup"><span data-stu-id="c4614-191">Default</span></span> | <span data-ttu-id="c4614-192">Nastavení</span><span class="sxs-lookup"><span data-stu-id="c4614-192">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="c4614-193">Pokud `true` [middleware integrace služby IIS](#enable-the-iisintegration-components) nastaví ověřené ověřování systému `HttpContext.User` [Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-193">If `true`, [IIS Integration Middleware](#enable-the-iisintegration-components) sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="c4614-194">Pokud `false`middleware poskytuje identitu `HttpContext.User` a reaguje na problémy pouze na `AuthenticationScheme`žádost .</span><span class="sxs-lookup"><span data-stu-id="c4614-194">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="c4614-195">Aby bylo možné službu `AutomaticAuthentication` IIS fungovat, musí být ve službě IIS povoleno ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-195">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="c4614-196">Další informace naleznete v tématu [Ověřování systému Windows.](xref:security/authentication/windowsauth)</span><span class="sxs-lookup"><span data-stu-id="c4614-196">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="c4614-197">Nastaví zobrazované jméno zobrazené uživatelům na přihlašovacích stránkách.</span><span class="sxs-lookup"><span data-stu-id="c4614-197">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="c4614-198">Pokud `true` a `MS-ASPNETCORE-CLIENTCERT` hlavička požadavku `HttpContext.Connection.ClientCertificate` je k dispozici, je naplněn.</span><span class="sxs-lookup"><span data-stu-id="c4614-198">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="c4614-199">Scénáře proxy serveru a vyrovnávání zatížení</span><span class="sxs-lookup"><span data-stu-id="c4614-199">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="c4614-200">[Middleware integrace služby IIS](#enable-the-iisintegration-components), který konfiguruje middleware předávaných záhlaví a ASP.NET základní modul, jsou nakonfigurovány tak, aby předávaly schéma (HTTP/HTTPS) a vzdálenou adresu IP, ze které požadavek pochází.</span><span class="sxs-lookup"><span data-stu-id="c4614-200">The [IIS Integration Middleware](#enable-the-iisintegration-components), which configures Forwarded Headers Middleware, and the ASP.NET Core Module are configured to forward the scheme (HTTP/HTTPS) and the remote IP address where the request originated.</span></span> <span data-ttu-id="c4614-201">Další konfigurace může být vyžadována pro aplikace hostované za dalšími proxy servery a nástroji pro vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="c4614-201">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="c4614-202">Další informace naleznete v [tématu Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="c4614-202">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="c4614-203">soubor web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-203">web.config file</span></span>

<span data-ttu-id="c4614-204">Soubor *web.config* konfiguruje [základní modul ASP.NET](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="c4614-204">The *web.config* file configures the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="c4614-205">Při publikování projektu je vytváření, transformace a publikování souboru *web.config* zpracováno cílem MSBuild (`_TransformWebConfig`).</span><span class="sxs-lookup"><span data-stu-id="c4614-205">Creating, transforming, and publishing the *web.config* file is handled by an MSBuild target (`_TransformWebConfig`) when the project is published.</span></span> <span data-ttu-id="c4614-206">Tento cíl je k dispozici v`Microsoft.NET.Sdk.Web`cílech sady Web SDK ( ).</span><span class="sxs-lookup"><span data-stu-id="c4614-206">This target is present in the Web SDK targets (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="c4614-207">Sada SDK je nastavena v horní části souboru projektu:</span><span class="sxs-lookup"><span data-stu-id="c4614-207">The SDK is set at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="c4614-208">Pokud soubor *web.config* není v projektu přítomen, je soubor vytvořen se správnou *processPath* a *argumenty* pro konfiguraci ASP.NET základnímodul a přesunutna do [publikovaného výstupu](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="c4614-208">If a *web.config* file isn't present in the project, the file is created with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="c4614-209">Pokud *web.config* soubor je přítomen v projektu, soubor je transformován se správným *processPath* a *argumenty* pro konfiguraci ASP.NET core modul a přesunuta do publikovaného výstupu.</span><span class="sxs-lookup"><span data-stu-id="c4614-209">If a *web.config* file is present in the project, the file is transformed with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="c4614-210">Transformace nezmění nastavení konfigurace služby IIS v souboru.</span><span class="sxs-lookup"><span data-stu-id="c4614-210">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="c4614-211">Soubor *web.config* může poskytovat další nastavení konfigurace služby IIS, která řídí aktivní moduly služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-211">The *web.config* file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="c4614-212">Informace o modulech služby IIS, které jsou schopné zpracovávat požadavky pomocí aplikací ASP.NET Core, naleznete v tématu [modulů služby IIS.](xref:host-and-deploy/iis/modules)</span><span class="sxs-lookup"><span data-stu-id="c4614-212">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="c4614-213">Chcete-li zabránit webové sady SDK v transformaci souboru *web.config,* použijte vlastnost \*\* \<IsTransformWebConfigDisabled>\*\* v souboru projektu:</span><span class="sxs-lookup"><span data-stu-id="c4614-213">To prevent the Web SDK from transforming the *web.config* file, use the **\<IsTransformWebConfigDisabled>** property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="c4614-214">Při zakázání webové sady SDK z transformace souboru *processPath* a argumenty by měly být ručně *nastaveny* vývojářem.</span><span class="sxs-lookup"><span data-stu-id="c4614-214">When disabling the Web SDK from transforming the file, the *processPath* and *arguments* should be manually set by the developer.</span></span> <span data-ttu-id="c4614-215">Další informace naleznete v tématu <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="c4614-215">For more information, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="c4614-216">umístění souboru web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-216">web.config file location</span></span>

<span data-ttu-id="c4614-217">Aby bylo možné správně nastavit [ASP.NET core modul,](xref:host-and-deploy/aspnet-core-module) musí být soubor *web.config* přítomen na [cestě kořenového obsahu](xref:fundamentals/index#content-root) (obvykle základní cesta aplikace) nasazené aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-217">In order to set up the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) correctly, the *web.config* file must be present at the [content root](xref:fundamentals/index#content-root) path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="c4614-218">Jedná se o stejné umístění jako fyzická cesta k webu poskytnutá službu IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-218">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="c4614-219">Soubor *web.config* je vyžadován v kořenovém adresáři aplikace, aby bylo možné publikovat více aplikací pomocí nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-219">The *web.config* file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="c4614-220">Na fyzické cestě aplikace existují citlivé soubory, například \* \<assembly>.runtimeconfig.json*, \* \<assembly>.xml* (komentáře xml documentation) a \* \<assembly>.deps.json\*.</span><span class="sxs-lookup"><span data-stu-id="c4614-220">Sensitive files exist on the app's physical path, such as *\<assembly>.runtimeconfig.json*, *\<assembly>.xml* (XML Documentation comments), and *\<assembly>.deps.json*.</span></span> <span data-ttu-id="c4614-221">Pokud je soubor *web.config* přítomen a web se spustí normálně, služby IIS tyto citlivé soubory neobsluhuje, pokud jsou požadovány.</span><span class="sxs-lookup"><span data-stu-id="c4614-221">When the *web.config* file is present and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="c4614-222">Pokud soubor *web.config* chybí, je nesprávně pojmenován nebo jej nelze nakonfigurovat pro normální spuštění, může služba IIS veřejně sloužit citlivým souborům.</span><span class="sxs-lookup"><span data-stu-id="c4614-222">If the *web.config* file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="c4614-223">**Soubor *web.config* musí být v nasazení vždy přítomen, správně pojmenovaný a musí být schopen nakonfigurovat web pro normální spuštění. Nikdy neodstraňujte soubor *web.config* z produkčního nasazení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-223">**The *web.config* file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the *web.config* file from a production deployment.**</span></span>

### <a name="transform-webconfig"></a><span data-ttu-id="c4614-224">Transformace souboru web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-224">Transform web.config</span></span>

<span data-ttu-id="c4614-225">Pokud potřebujete transformovat *web.config* při publikování (například nastavit proměnné prostředí na základě konfigurace, profilu nebo prostředí), přečtěte si viz <xref:host-and-deploy/iis/transform-webconfig>.</span><span class="sxs-lookup"><span data-stu-id="c4614-225">If you need to transform *web.config* on publish (for example, set environment variables based on the configuration, profile, or environment), see <xref:host-and-deploy/iis/transform-webconfig>.</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="c4614-226">Konfigurace služby IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-226">IIS configuration</span></span>

<span data-ttu-id="c4614-227">**Operační systémy Windows Server**</span><span class="sxs-lookup"><span data-stu-id="c4614-227">**Windows Server operating systems**</span></span>

<span data-ttu-id="c4614-228">Povolte roli serveru **webového serveru (IIS)** a vytvořte služby rolí.</span><span class="sxs-lookup"><span data-stu-id="c4614-228">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="c4614-229">Použijte Průvodce **přidáním rolí a funkcí** z nabídky **Spravovat** nebo odkaz ve **Správci serveru**.</span><span class="sxs-lookup"><span data-stu-id="c4614-229">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager**.</span></span> <span data-ttu-id="c4614-230">V kroku **Role serveru** zaškrtněte políčko **U webového serveru (IIS).**</span><span class="sxs-lookup"><span data-stu-id="c4614-230">On the **Server Roles** step, check the box for **Web Server (IIS)**.</span></span>

   ![Role služby IIS webového serveru je vybrána v kroku Vybrat role serveru.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="c4614-232">Po kroku **Funkce** se krok **služby role** načte pro webový server (IIS).</span><span class="sxs-lookup"><span data-stu-id="c4614-232">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="c4614-233">Vyberte požadované služby rolí služby IIS nebo přijměte výchozí služby rolí, které jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="c4614-233">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![Výchozí služby rolí jsou vybrány v kroku Vybrat služby rolí.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="c4614-235">**Ověřování systému Windows (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-235">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="c4614-236">Chcete-li povolit ověřování systému Windows, rozbalte následující uzly:**Zabezpečení** **webového serveru** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-236">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security**.</span></span> <span data-ttu-id="c4614-237">Vyberte funkci **Ověřování systému Windows.**</span><span class="sxs-lookup"><span data-stu-id="c4614-237">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="c4614-238">Další informace naleznete v [tématech Ověřování \<systému Windows windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) a Konfigurace ověřování [systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-238">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="c4614-239">**WebSockets (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-239">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="c4614-240">WebSockets je podporován ASP.NET jádrem 1.1 nebo novějším.</span><span class="sxs-lookup"><span data-stu-id="c4614-240">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="c4614-241">Chcete-li povolit rozhraní WebSockets, rozbalte následující uzly:**Vývoj aplikací webového** **serveru** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-241">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development**.</span></span> <span data-ttu-id="c4614-242">Vyberte funkci **WebSocket Protocol.**</span><span class="sxs-lookup"><span data-stu-id="c4614-242">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="c4614-243">Další informace naleznete v tématu [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="c4614-243">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="c4614-244">Pokračujte v **potvrzovacím** kroku a nainstalujte roli a služby webového serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-244">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="c4614-245">Po instalaci role **webového serveru (IIS)** není restartování serveru nebo služby IIS vyžadováno.</span><span class="sxs-lookup"><span data-stu-id="c4614-245">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="c4614-246">**Desktopové operační systémy Windows**</span><span class="sxs-lookup"><span data-stu-id="c4614-246">**Windows desktop operating systems**</span></span>

<span data-ttu-id="c4614-247">Povolte **konzolu pro správu služby IIS** a **služby World Wide Web Services**.</span><span class="sxs-lookup"><span data-stu-id="c4614-247">Enable the **IIS Management Console** and **World Wide Web Services**.</span></span>

1. <span data-ttu-id="c4614-248">Přejděte na **Ovládací panely** > **Programy** > **a funkce** > **Zapněte nebo vypněte funkce systému Windows** (levá strana obrazovky).</span><span class="sxs-lookup"><span data-stu-id="c4614-248">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="c4614-249">Otevřete uzel **Internetové informační služby.**</span><span class="sxs-lookup"><span data-stu-id="c4614-249">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="c4614-250">Otevřete uzel **Nástroje pro správu webu.**</span><span class="sxs-lookup"><span data-stu-id="c4614-250">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="c4614-251">Zaškrtněte políčko **U konzole pro správu služby IIS**.</span><span class="sxs-lookup"><span data-stu-id="c4614-251">Check the box for **IIS Management Console**.</span></span>

1. <span data-ttu-id="c4614-252">Zaškrtněte políčko **U služeb World Wide Web Services**.</span><span class="sxs-lookup"><span data-stu-id="c4614-252">Check the box for **World Wide Web Services**.</span></span>

1. <span data-ttu-id="c4614-253">Přijměte výchozí funkce **pro služby World Wide Web Services** nebo upravte funkce služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-253">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="c4614-254">**Ověřování systému Windows (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-254">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="c4614-255">Chcete-li povolit ověřování systému Windows, rozbalte následující uzly: **World Wide Web Services** > **Security**.</span><span class="sxs-lookup"><span data-stu-id="c4614-255">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security**.</span></span> <span data-ttu-id="c4614-256">Vyberte funkci **Ověřování systému Windows.**</span><span class="sxs-lookup"><span data-stu-id="c4614-256">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="c4614-257">Další informace naleznete v [tématech Ověřování \<systému Windows windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) a Konfigurace ověřování [systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-257">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="c4614-258">**WebSockets (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-258">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="c4614-259">WebSockets je podporován ASP.NET jádrem 1.1 nebo novějším.</span><span class="sxs-lookup"><span data-stu-id="c4614-259">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="c4614-260">Chcete-li povolit rozhraní WebSockets, rozbalte následující uzly: Funkce**vývoje aplikací**pro **webové služby** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-260">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features**.</span></span> <span data-ttu-id="c4614-261">Vyberte funkci **WebSocket Protocol.**</span><span class="sxs-lookup"><span data-stu-id="c4614-261">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="c4614-262">Další informace naleznete v tématu [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="c4614-262">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="c4614-263">Pokud instalace služby IIS vyžaduje restartování, restartujte systém.</span><span class="sxs-lookup"><span data-stu-id="c4614-263">If the IIS installation requires a restart, restart the system.</span></span>

![V funkcích systému Windows jsou vybrány konzoly IIS Management Console a služby World Wide Web Services.](index/_static/windows-features-win10.png)

## <a name="install-the-net-core-hosting-bundle"></a><span data-ttu-id="c4614-265">Instalace balíčku hostingu jádra .NET</span><span class="sxs-lookup"><span data-stu-id="c4614-265">Install the .NET Core Hosting Bundle</span></span>

<span data-ttu-id="c4614-266">Nainstalujte *balíček .NET Core Hosting do* hostitelského systému.</span><span class="sxs-lookup"><span data-stu-id="c4614-266">Install the *.NET Core Hosting Bundle* on the hosting system.</span></span> <span data-ttu-id="c4614-267">Balíček nainstaluje modul .NET Core Runtime, knihovnu .NET Core Library a [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="c4614-267">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="c4614-268">Modul umožňuje ASP.NET aplikace Core běžet za službou IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-268">The module allows ASP.NET Core apps to run behind IIS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c4614-269">Pokud je sada Hosting Bundle nainstalována před službou IIS, musí být instalace balíčku opravena.</span><span class="sxs-lookup"><span data-stu-id="c4614-269">If the Hosting Bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="c4614-270">Po instalaci služby IIS znovu spusťte instalační program sady Hosting Bundle.</span><span class="sxs-lookup"><span data-stu-id="c4614-270">Run the Hosting Bundle installer again after installing IIS.</span></span>
>
> <span data-ttu-id="c4614-271">Pokud je sada Hosting Bundle nainstalována po instalaci 64bitové (x64) verze rozhraní .NET Core, mohou se zdát, že sady SDK chybí ([byly zjištěny sady SDK .Net Core .](xref:test/troubleshoot#no-net-core-sdks-were-detected)</span><span class="sxs-lookup"><span data-stu-id="c4614-271">If the Hosting Bundle is installed after installing the 64-bit (x64) version of .NET Core, SDKs might appear to be missing ([No .NET Core SDKs were detected](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span></span> <span data-ttu-id="c4614-272">Chcete-li problém <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>vyřešit, naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-272">To resolve the problem, see <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span></span>

### <a name="direct-download-current-version"></a><span data-ttu-id="c4614-273">Přímé stahování (aktuální verze)</span><span class="sxs-lookup"><span data-stu-id="c4614-273">Direct download (current version)</span></span>

<span data-ttu-id="c4614-274">Stáhněte si instalační program pomocí následujícího odkazu:</span><span class="sxs-lookup"><span data-stu-id="c4614-274">Download the installer using the following link:</span></span>

[<span data-ttu-id="c4614-275">Aktuální instalační program .NET Core Hosting Bundle (přímé stahování)</span><span class="sxs-lookup"><span data-stu-id="c4614-275">Current .NET Core Hosting Bundle installer (direct download)</span></span>](https://dotnet.microsoft.com/permalink/dotnetcore-current-windows-runtime-bundle-installer)

### <a name="earlier-versions-of-the-installer"></a><span data-ttu-id="c4614-276">Dřívější verze instalačního programu</span><span class="sxs-lookup"><span data-stu-id="c4614-276">Earlier versions of the installer</span></span>

<span data-ttu-id="c4614-277">Chcete-li získat starší verzi instalačního programu:</span><span class="sxs-lookup"><span data-stu-id="c4614-277">To obtain an earlier version of the installer:</span></span>

1. <span data-ttu-id="c4614-278">Přejděte na stránku [Stáhnout jádro rozhraní .NET.](https://dotnet.microsoft.com/download/dotnet-core)</span><span class="sxs-lookup"><span data-stu-id="c4614-278">Navigate to the [Download .NET Core](https://dotnet.microsoft.com/download/dotnet-core) page.</span></span>
1. <span data-ttu-id="c4614-279">Vyberte požadovanou verzi .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-279">Select the desired .NET Core version.</span></span>
1. <span data-ttu-id="c4614-280">Ve sloupci **Spustit aplikace – runtime** najděte požadovaný řádek požadované verze runtime .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-280">In the **Run apps - Runtime** column, find the row of the .NET Core runtime version desired.</span></span>
1. <span data-ttu-id="c4614-281">Stáhněte si instalační program pomocí odkazu **Hosting Bundle.**</span><span class="sxs-lookup"><span data-stu-id="c4614-281">Download the installer using the **Hosting Bundle** link.</span></span>

> [!WARNING]
> <span data-ttu-id="c4614-282">Některé instalační programy obsahují verze, které dosáhly konce životnosti (EOL) a které již nejsou podporovány společností Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c4614-282">Some installers contain release versions that have reached their end of life (EOL) and are no longer supported by Microsoft.</span></span> <span data-ttu-id="c4614-283">Další informace naleznete v [zásadách podpory](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span><span class="sxs-lookup"><span data-stu-id="c4614-283">For more information, see the [support policy](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span></span>

### <a name="install-the-hosting-bundle"></a><span data-ttu-id="c4614-284">Nainstalujte balíček hostingu</span><span class="sxs-lookup"><span data-stu-id="c4614-284">Install the Hosting Bundle</span></span>

1. <span data-ttu-id="c4614-285">Spusťte instalační program na serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-285">Run the installer on the server.</span></span> <span data-ttu-id="c4614-286">Při spuštění instalačního programu z příkazového prostředí správce jsou k dispozici následující parametry:</span><span class="sxs-lookup"><span data-stu-id="c4614-286">The following parameters are available when running the installer from an administrator command shell:</span></span>

   * <span data-ttu-id="c4614-287">`OPT_NO_ANCM=1`&ndash; Přeskočte instalaci ASP.NET základního modulu.</span><span class="sxs-lookup"><span data-stu-id="c4614-287">`OPT_NO_ANCM=1` &ndash; Skip installing the ASP.NET Core Module.</span></span>
   * <span data-ttu-id="c4614-288">`OPT_NO_RUNTIME=1`&ndash; Přeskočte instalaci runtime jádra .NET.</span><span class="sxs-lookup"><span data-stu-id="c4614-288">`OPT_NO_RUNTIME=1` &ndash; Skip installing the .NET Core runtime.</span></span> <span data-ttu-id="c4614-289">Používá se v případě, že server hostuje pouze [samostatná nasazení (SCD).](/dotnet/core/deploying/#self-contained-deployments-scd)</span><span class="sxs-lookup"><span data-stu-id="c4614-289">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="c4614-290">`OPT_NO_SHAREDFX=1`&ndash; Přeskočit instalaci ASP.NET sdíleného rozhraní (ASP.NET runtime).</span><span class="sxs-lookup"><span data-stu-id="c4614-290">`OPT_NO_SHAREDFX=1` &ndash; Skip installing the ASP.NET Shared Framework (ASP.NET runtime).</span></span> <span data-ttu-id="c4614-291">Používá se v případě, že server hostuje pouze [samostatná nasazení (SCD).](/dotnet/core/deploying/#self-contained-deployments-scd)</span><span class="sxs-lookup"><span data-stu-id="c4614-291">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="c4614-292">`OPT_NO_X86=1`&ndash; Přeskočit instalaci za běhu x86.</span><span class="sxs-lookup"><span data-stu-id="c4614-292">`OPT_NO_X86=1` &ndash; Skip installing x86 runtimes.</span></span> <span data-ttu-id="c4614-293">Tento parametr použijte, pokud víte, že nebudete hostovat 32bitové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-293">Use this parameter when you know that you won't be hosting 32-bit apps.</span></span> <span data-ttu-id="c4614-294">Pokud existuje nějaká šance, že budete v budoucnu hostovat 32bitové i 64bitové aplikace, nepoužívejte tento parametr a nainstalujte oba runtimes.</span><span class="sxs-lookup"><span data-stu-id="c4614-294">If there's any chance that you will host both 32-bit and 64-bit apps in the future, don't use this parameter and install both runtimes.</span></span>
   * <span data-ttu-id="c4614-295">`OPT_NO_SHARED_CONFIG_CHECK=1`&ndash; Zakažte kontrolu použití sdílené konfigurace služby IIS, pokud je sdílená konfigurace *(applicationHost.config)* ve stejném počítači jako instalace služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-295">`OPT_NO_SHARED_CONFIG_CHECK=1` &ndash; Disable the check for using an IIS Shared Configuration when the shared configuration (*applicationHost.config*) is on the same machine as the IIS installation.</span></span> <span data-ttu-id="c4614-296">*K dispozici pouze pro ASP.NET instalačních programů hostingu Bundler nebo novějším.*</span><span class="sxs-lookup"><span data-stu-id="c4614-296">*Only available for ASP.NET Core 2.2 or later Hosting Bundler installers.*</span></span> <span data-ttu-id="c4614-297">Další informace naleznete v tématu <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span><span class="sxs-lookup"><span data-stu-id="c4614-297">For more information, see <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span></span>
1. <span data-ttu-id="c4614-298">Restartujte systém nebo proveďte následující příkazy v příkazovém prostředí:</span><span class="sxs-lookup"><span data-stu-id="c4614-298">Restart the system or execute the following commands in a command shell:</span></span>

   ```console
   net stop was /y
   net start w3svc
   ```
   <span data-ttu-id="c4614-299">Restartování služby IIS vyvolá změnu systémové cesty, což je proměnná prostředí provedená instalačním programem.</span><span class="sxs-lookup"><span data-stu-id="c4614-299">Restarting IIS picks up a change to the system PATH, which is an environment variable, made by the installer.</span></span>

<span data-ttu-id="c4614-300">ASP.NET Core nepřijímá chování pro převrácení pro verze oprav sdílených rámců.</span><span class="sxs-lookup"><span data-stu-id="c4614-300">ASP.NET Core doesn't adopt roll-forward behavior for patch releases of shared framework packages.</span></span> <span data-ttu-id="c4614-301">Po upgradu sdíleného frameworku instalací nového hostingového balíčku restartujte systém nebo spusťte následující příkazy v příkazovém prostředí:</span><span class="sxs-lookup"><span data-stu-id="c4614-301">After upgrading the shared framework by installing a new hosting bundle, restart the system or execute the following commands in a command shell:</span></span>

```console
net stop was /y
net start w3svc
```

> [!NOTE]
> <span data-ttu-id="c4614-302">Informace o sdílené konfiguraci služby IIS naleznete [v tématu ASP.NET Core Module se sdílenou konfigurací služby IIS](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span><span class="sxs-lookup"><span data-stu-id="c4614-302">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="c4614-303">Instalace nasazení webu při publikování pomocí sady Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c4614-303">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="c4614-304">Při nasazování aplikací na servery s [nasazením webu](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later)nainstalujte na server nejnovější verzi nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-304">When deploying apps to servers with [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="c4614-305">Chcete-li nainstalovat nasazení webu, použijte [Instalační službu webové platformy (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) nebo získejte instalační program přímo ze [služby Stažení softwaru](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="c4614-305">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="c4614-306">Upřednostňovanou metodou je použití webpi.</span><span class="sxs-lookup"><span data-stu-id="c4614-306">The preferred method is to use WebPI.</span></span> <span data-ttu-id="c4614-307">WebPI nabízí samostatné nastavení a konfiguraci pro poskytovatele hostingu.</span><span class="sxs-lookup"><span data-stu-id="c4614-307">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="c4614-308">Vytvoření webu iis</span><span class="sxs-lookup"><span data-stu-id="c4614-308">Create the IIS site</span></span>

1. <span data-ttu-id="c4614-309">V hostitelském systému vytvořte složku, která bude obsahovat publikované složky a soubory aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-309">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="c4614-310">V následujícím kroku je cesta ke složce k dispozici službu IIS jako fyzická cesta k aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-310">In a following step, the folder's path is provided to IIS as the physical path to the app.</span></span> <span data-ttu-id="c4614-311">Další informace o složce nasazení aplikace a <xref:host-and-deploy/directory-structure>rozložení souborů naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-311">For more information on an app's deployment folder and file layout, see <xref:host-and-deploy/directory-structure>.</span></span>

1. <span data-ttu-id="c4614-312">Ve Správci služby IIS otevřete uzel serveru v panelu **Připojení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-312">In IIS Manager, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="c4614-313">Klikněte pravým tlačítkem myši na složku **Weby.**</span><span class="sxs-lookup"><span data-stu-id="c4614-313">Right-click the **Sites** folder.</span></span> <span data-ttu-id="c4614-314">V kontextové nabídce vyberte **Přidat web.**</span><span class="sxs-lookup"><span data-stu-id="c4614-314">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="c4614-315">Zadejte **název webu** a nastavte **fyzickou cestu** ke složce nasazení aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-315">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="c4614-316">Zadejte konfiguraci **vazby** a vytvořte web výběrem **možnosti OK**:</span><span class="sxs-lookup"><span data-stu-id="c4614-316">Provide the **Binding** configuration and create the website by selecting **OK**:</span></span>

   ![V kroku Přidat web zadejte název webu, fyzickou cestu a název hostitele.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="c4614-318">Vazby se zástupnými`http://*:80/` symboly nejvyšší úrovně ( a `http://+:80`) by **neměly** být používány.</span><span class="sxs-lookup"><span data-stu-id="c4614-318">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="c4614-319">Vazby se zástupnými symboly nejvyšší úrovně mohou otevřít vaši aplikaci slabá místa zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="c4614-319">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="c4614-320">To platí pro silné i slabé zástupné znaky.</span><span class="sxs-lookup"><span data-stu-id="c4614-320">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="c4614-321">Používejte explicitní názvy hostitelů místo zástupných znaků.</span><span class="sxs-lookup"><span data-stu-id="c4614-321">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="c4614-322">Vazba se zástupnými znaky subdomény (například) nemá toto bezpečnostní riziko, `*.mysub.com` `*.com`pokud řídíte celou nadřazenou doménu (na rozdíl od , která je zranitelná).</span><span class="sxs-lookup"><span data-stu-id="c4614-322">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="c4614-323">Viz [rfc7230 sekce-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) pro více informací.</span><span class="sxs-lookup"><span data-stu-id="c4614-323">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="c4614-324">Pod uzlovým serverem vyberte **fondy aplikací**.</span><span class="sxs-lookup"><span data-stu-id="c4614-324">Under the server's node, select **Application Pools**.</span></span>

1. <span data-ttu-id="c4614-325">Klikněte pravým tlačítkem myši na fond aplikací webu a v kontextové nabídce vyberte **Základní nastavení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-325">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="c4614-326">V okně **Upravit fond aplikací** nastavte verzi **.NET CLR** na **Žádný spravovaný kód**:</span><span class="sxs-lookup"><span data-stu-id="c4614-326">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code**:</span></span>

   ![Pro verzi CLR rozhraní .NET nenastavte žádný spravovaný kód.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="c4614-328">ASP.NET Core běží v samostatném procesu a spravuje runtime.</span><span class="sxs-lookup"><span data-stu-id="c4614-328">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="c4614-329">ASP.NET Core nespoléhá na načtení plochy CLR (.NET CLR)&mdash;Core Common Language Runtime (CoreCLR) pro .NET Core je spuštěn pro hostování aplikace v pracovním procesu.</span><span class="sxs-lookup"><span data-stu-id="c4614-329">ASP.NET Core doesn't rely on loading the desktop CLR (.NET CLR)&mdash;the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process.</span></span> <span data-ttu-id="c4614-330">Nastavení **verze .NET CLR** na **žádný spravovaný kód** je volitelné, ale doporučeno.</span><span class="sxs-lookup"><span data-stu-id="c4614-330">Setting the **.NET CLR version** to **No Managed Code** is optional but recommended.</span></span>

1. <span data-ttu-id="c4614-331">*ASP.NET jádra 2.2 nebo novějšího:* Pro 64bitové (x64) [samostatné nasazení,](/dotnet/core/deploying/#self-contained-deployments-scd) které používá [model hostování v procesu](#in-process-hosting-model), zakažte fond aplikací pro 32bitové (x86) procesy.</span><span class="sxs-lookup"><span data-stu-id="c4614-331">*ASP.NET Core 2.2 or later*: For a 64-bit (x64) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) that uses the [in-process hosting model](#in-process-hosting-model), disable the app pool for 32-bit (x86) processes.</span></span>

   <span data-ttu-id="c4614-332">V postranním panelu **Akce** správce služby IIS > **fondy aplikací**vyberte **možnost Nastavit výchozí nastavení fondu aplikací** nebo **Upřesnit nastavení**.</span><span class="sxs-lookup"><span data-stu-id="c4614-332">In the **Actions** sidebar of IIS Manager > **Application Pools**, select **Set Application Pool Defaults** or **Advanced Settings**.</span></span> <span data-ttu-id="c4614-333">Vyhledejte **funkci Povolit 32bitové aplikace** a nastavte hodnotu na . `False`</span><span class="sxs-lookup"><span data-stu-id="c4614-333">Locate **Enable 32-Bit Applications** and set the value to `False`.</span></span> <span data-ttu-id="c4614-334">Toto nastavení nemá vliv na aplikace nasazené pro [mimoprocesový hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span><span class="sxs-lookup"><span data-stu-id="c4614-334">This setting doesn't affect apps deployed for [out-of-process hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span></span>

1. <span data-ttu-id="c4614-335">Potvrďte, že identita modelu procesu má správná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="c4614-335">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="c4614-336">Pokud se výchozí identita fondu aplikací **(identita\*\*\*\*procesního modelu** > ) změní z **ApplicationPoolIdentity** na jinou identitu, ověřte, zda nová identita má požadovaná oprávnění pro přístup ke složce, databázi a dalším požadovaným prostředkům aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-336">If the default identity of the app pool (**Process Model** > **Identity**) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="c4614-337">Fond aplikací například vyžaduje přístup pro čtení a zápis do složek, kde aplikace čte a zapisuje soubory.</span><span class="sxs-lookup"><span data-stu-id="c4614-337">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="c4614-338">**Konfigurace ověřování systému Windows (volitelná)**</span><span class="sxs-lookup"><span data-stu-id="c4614-338">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="c4614-339">Další informace naleznete v [tématu Configure Windows authentication](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-339">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="c4614-340">Nasazení aplikace</span><span class="sxs-lookup"><span data-stu-id="c4614-340">Deploy the app</span></span>

<span data-ttu-id="c4614-341">Nasaďte aplikaci do složky **Fyzické cesty** služby IIS, která byla vytvořena v části Vytvořit [web služby IIS.](#create-the-iis-site)</span><span class="sxs-lookup"><span data-stu-id="c4614-341">Deploy the app to the IIS **Physical path** folder that was established in the [Create the IIS site](#create-the-iis-site) section.</span></span> <span data-ttu-id="c4614-342">[Nasazení webu](/iis/publish/using-web-deploy/introduction-to-web-deploy) je doporučený mechanismus pro nasazení, ale existuje několik možností pro přesunutí aplikace ze složky *publikování* projektu do složky nasazení hostitelského systému.</span><span class="sxs-lookup"><span data-stu-id="c4614-342">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment, but several options exist for moving the app from the project's *publish* folder to the hosting system's deployment folder.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="c4614-343">Nasazení webu pomocí sady Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c4614-343">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="c4614-344">Podívejte se na [profily publikování aplikace Visual Studio pro téma nasazení aplikace ASP.NET Core,](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) kde se dozvíte, jak vytvořit profil publikování pro použití s nasazením webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-344">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="c4614-345">Pokud poskytovatel hostingu poskytuje profil publikování nebo podporu pro jeho vytvoření, stáhněte si jeho profil a importujte jej pomocí dialogového okna **Publikovat** sady Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="c4614-345">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog:</span></span>

![Stránka dialogového okna Publikovat](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="c4614-347">Nasazení webu mimo Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c4614-347">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="c4614-348">[Nasazení webu](/iis/publish/using-web-deploy/introduction-to-web-deploy) lze také použít mimo Visual Studio z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="c4614-348">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="c4614-349">Další informace naleznete v [tématu Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="c4614-349">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="c4614-350">Alternativy k nasazení webu</span><span class="sxs-lookup"><span data-stu-id="c4614-350">Alternatives to Web Deploy</span></span>

<span data-ttu-id="c4614-351">Pomocí některé z několika metod přesuňte aplikaci do hostitelského systému, jako je ruční kopírování, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy)nebo [PowerShell](/powershell/).</span><span class="sxs-lookup"><span data-stu-id="c4614-351">Use any of several methods to move the app to the hosting system, such as manual copy, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy), or [PowerShell](/powershell/).</span></span>

<span data-ttu-id="c4614-352">Další informace o ASP.NET nasazení jádra do služby IIS naleznete v části [Prostředky nasazení pro správce služby IIS.](#deployment-resources-for-iis-administrators)</span><span class="sxs-lookup"><span data-stu-id="c4614-352">For more information on ASP.NET Core deployment to IIS, see the [Deployment resources for IIS administrators](#deployment-resources-for-iis-administrators) section.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="c4614-353">Procházení webu</span><span class="sxs-lookup"><span data-stu-id="c4614-353">Browse the website</span></span>

<span data-ttu-id="c4614-354">Po nasazení aplikace do hostitelského systému požádejte o jeden z veřejných koncových bodů aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-354">After the app is deployed to the hosting system, make a request to one of the app's public endpoints.</span></span>

<span data-ttu-id="c4614-355">V následujícím příkladu je web vázán na název `www.mysite.com` **hostitele** iis na **portu** `80`.</span><span class="sxs-lookup"><span data-stu-id="c4614-355">In the following example, the site is bound to an IIS **Host name** of `www.mysite.com` on **Port** `80`.</span></span> <span data-ttu-id="c4614-356">Žádost se podává `http://www.mysite.com`na :</span><span class="sxs-lookup"><span data-stu-id="c4614-356">A request is made to `http://www.mysite.com`:</span></span>

![Prohlížeč Microsoft Edge načetl úvodní stránku služby IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="c4614-358">Uzamčené soubory nasazení</span><span class="sxs-lookup"><span data-stu-id="c4614-358">Locked deployment files</span></span>

<span data-ttu-id="c4614-359">Soubory ve složce nasazení jsou uzamčeny, když je aplikace spuštěná.</span><span class="sxs-lookup"><span data-stu-id="c4614-359">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="c4614-360">Uzamčené soubory nelze během nasazení přepsat.</span><span class="sxs-lookup"><span data-stu-id="c4614-360">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="c4614-361">Chcete-li uvolnit uzamčené soubory v nasazení, zastavte fond aplikací pomocí **jednoho z** následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-361">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="c4614-362">Použijte nasazení webu `Microsoft.NET.Sdk.Web` a odkaz v souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="c4614-362">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="c4614-363">Soubor *app_offline.htm* je umístěn v kořenovém adresáři webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-363">An *app_offline.htm* file is placed at the root of the web app directory.</span></span> <span data-ttu-id="c4614-364">Když je soubor k dispozici, ASP.NET základní modul řádně vypne aplikaci a slouží *souboru app_offline.htm* během nasazení.</span><span class="sxs-lookup"><span data-stu-id="c4614-364">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the *app_offline.htm* file during the deployment.</span></span> <span data-ttu-id="c4614-365">Další informace naleznete v [odkazu na konfiguraci ASP.NET core modulem](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span><span class="sxs-lookup"><span data-stu-id="c4614-365">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span></span>
* <span data-ttu-id="c4614-366">Ručně zastavit fond aplikací ve Správci služby IIS na serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-366">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="c4614-367">Použití Prostředí PowerShell k přetažení *app_offline.htm* (vyžaduje PowerShell 5 nebo novější):</span><span class="sxs-lookup"><span data-stu-id="c4614-367">Use PowerShell to drop *app_offline.htm* (requires PowerShell 5 or later):</span></span>

  ```powershell
  $pathToApp = 'PATH_TO_APP'

  # Stop the AppPool
  New-Item -Path $pathToApp app_offline.htm

  # Provide script commands here to deploy the app

  # Restart the AppPool
  Remove-Item -Path $pathToApp app_offline.htm

  ```

## <a name="data-protection"></a><span data-ttu-id="c4614-368">Ochrana dat</span><span class="sxs-lookup"><span data-stu-id="c4614-368">Data protection</span></span>

<span data-ttu-id="c4614-369">Zásobník [ASP.NET Core Data Protection](xref:security/data-protection/introduction) používá několik [middlewares](xref:fundamentals/middleware/index)ASP.NET Core , včetně middlewaru používaného při ověřování.</span><span class="sxs-lookup"><span data-stu-id="c4614-369">The [ASP.NET Core Data Protection stack](xref:security/data-protection/introduction) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="c4614-370">I v případě, že rozhraní API ochrany dat nejsou volána uživatelským kódem, ochrana dat by měla být nakonfigurována pomocí skriptu nasazení nebo v uživatelském kódu, aby se vytvořilo trvalé úložiště kryptografických [klíčů](xref:security/data-protection/implementation/key-management).</span><span class="sxs-lookup"><span data-stu-id="c4614-370">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="c4614-371">Pokud ochrana dat není nakonfigurována, klíče jsou uloženy v paměti a po restartování aplikace zahozeny.</span><span class="sxs-lookup"><span data-stu-id="c4614-371">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="c4614-372">Pokud je kroužek klíče uložen v paměti při restartování aplikace:</span><span class="sxs-lookup"><span data-stu-id="c4614-372">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="c4614-373">Všechny ověřovací tokeny založené na souborech cookie jsou zrušeny.</span><span class="sxs-lookup"><span data-stu-id="c4614-373">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="c4614-374">Uživatelé se musí znovu přihlásit při dalším požadavku.</span><span class="sxs-lookup"><span data-stu-id="c4614-374">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="c4614-375">Všechna data chráněná kroužkem klíče již nelze dešifrovat.</span><span class="sxs-lookup"><span data-stu-id="c4614-375">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="c4614-376">To může zahrnovat [tokeny CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) a [ASP.NET základní soubory cookie MVC TempData](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="c4614-376">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="c4614-377">Chcete-li nakonfigurovat ochranu dat ve službě IIS tak, aby zachycovací byl kroužek klíče, použijte **jeden** z následujících postupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-377">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="c4614-378">**Vytvoření klíčů registru ochrany dat**</span><span class="sxs-lookup"><span data-stu-id="c4614-378">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="c4614-379">Klíče ochrany dat používané ASP.NET aplikace Core jsou uloženy v registru mimo aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-379">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="c4614-380">Chcete-li zachovat klíče pro danou aplikaci, vytvořte klíče registru pro fond aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-380">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="c4614-381">Pro samostatné instalace služby IIS mimo webfarmu lze [skript prostředí PowerShell Pro poskytování ochrany dat-AutoGenKeys.ps1](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) použít pro každý fond aplikací používaný s aplikací ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-381">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="c4614-382">Tento skript vytvoří klíč registru v registru HKLM, který je přístupný pouze pro účet pracovního procesu fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-382">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="c4614-383">Klíče jsou šifrovány v klidovém stavu pomocí dpapi s klíčem pro celý počítač.</span><span class="sxs-lookup"><span data-stu-id="c4614-383">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="c4614-384">Ve scénářích webové farmy lze aplikaci nakonfigurovat tak, aby k ukládání kroužku klíčů pro ochranu dat používala cestu UNC.</span><span class="sxs-lookup"><span data-stu-id="c4614-384">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="c4614-385">Ve výchozím nastavení nejsou klíče ochrany dat šifrovány.</span><span class="sxs-lookup"><span data-stu-id="c4614-385">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="c4614-386">Ujistěte se, že oprávnění k souborům pro sdílenou síť ovou složku jsou omezena na účet Windows, pod kterým aplikace běží.</span><span class="sxs-lookup"><span data-stu-id="c4614-386">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="c4614-387">Certifikát X509 lze použít k ochraně klíčů v klidovém stavu.</span><span class="sxs-lookup"><span data-stu-id="c4614-387">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="c4614-388">Zvažte mechanismus, který uživatelům umožní nahrávat certifikáty: Umístěte certifikáty do úložiště důvěryhodných certifikátů uživatele a ujistěte se, že jsou k dispozici na všech počítačích, kde je spuštěna aplikace uživatele.</span><span class="sxs-lookup"><span data-stu-id="c4614-388">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="c4614-389">Podrobnosti [najdete v tématu Konfigurace ochrany základních dat ASP.NET.](xref:security/data-protection/configuration/overview)</span><span class="sxs-lookup"><span data-stu-id="c4614-389">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="c4614-390">**Konfigurace fondu aplikací služby IIS pro načtení profilu uživatele**</span><span class="sxs-lookup"><span data-stu-id="c4614-390">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="c4614-391">Toto nastavení je v části **Model procesu** v části **Upřesnit nastavení** pro fond aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-391">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="c4614-392">Nastavte **profil načtení uživatele** na `True`.</span><span class="sxs-lookup"><span data-stu-id="c4614-392">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="c4614-393">Pokud je `True`nastavena možnost , jsou klíče uloženy v adresáři profilu uživatele a chráněny pomocí rozhraní DPAPI klíčem specifickým pro uživatelský účet.</span><span class="sxs-lookup"><span data-stu-id="c4614-393">When set to `True`, keys are stored in the user profile directory and protected using DPAPI with a key specific to the user account.</span></span> <span data-ttu-id="c4614-394">Klíče jsou uloženy ve složce *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys.*</span><span class="sxs-lookup"><span data-stu-id="c4614-394">Keys are persisted to the *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys* folder.</span></span>

  <span data-ttu-id="c4614-395">[Atribut setProfileEnvironment](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) fondu aplikací musí být také povolen.</span><span class="sxs-lookup"><span data-stu-id="c4614-395">The app pool's [setProfileEnvironment attribute](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) must also be enabled.</span></span> <span data-ttu-id="c4614-396">Výchozí hodnota `setProfileEnvironment` je `true`.</span><span class="sxs-lookup"><span data-stu-id="c4614-396">The default value of `setProfileEnvironment` is `true`.</span></span> <span data-ttu-id="c4614-397">V některých scénářích (například `setProfileEnvironment` operační `false`systém Windows) je nastavena na .</span><span class="sxs-lookup"><span data-stu-id="c4614-397">In some scenarios (for example, Windows OS), `setProfileEnvironment` is set to `false`.</span></span> <span data-ttu-id="c4614-398">Pokud klíče nejsou uloženy v adresáři profilu uživatele podle očekávání:</span><span class="sxs-lookup"><span data-stu-id="c4614-398">If keys aren't stored in the user profile directory as expected:</span></span>

  1. <span data-ttu-id="c4614-399">Přejděte do složky *%windir%/system32/inetsrv/config.*</span><span class="sxs-lookup"><span data-stu-id="c4614-399">Navigate to the *%windir%/system32/inetsrv/config* folder.</span></span>
  1. <span data-ttu-id="c4614-400">Otevřete soubor *applicationHost.config.*</span><span class="sxs-lookup"><span data-stu-id="c4614-400">Open the *applicationHost.config* file.</span></span>
  1. <span data-ttu-id="c4614-401">Vyhledejte element `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>`.</span><span class="sxs-lookup"><span data-stu-id="c4614-401">Locate the `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span></span>
  1. <span data-ttu-id="c4614-402">Zkontrolujte, `setProfileEnvironment` zda atribut není k dispozici, `true`což je výchozí hodnota na `true`, nebo explicitně nastavte hodnotu atributu na .</span><span class="sxs-lookup"><span data-stu-id="c4614-402">Confirm that the `setProfileEnvironment` attribute isn't present, which defaults the value to `true`, or explicitly set the attribute's value to `true`.</span></span>

* <span data-ttu-id="c4614-403">**Použití systému souborů jako úložiště kroužků na klíče**</span><span class="sxs-lookup"><span data-stu-id="c4614-403">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="c4614-404">Upravte kód aplikace tak, aby [používal systém souborů jako úložiště kroužků klíčů](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="c4614-404">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="c4614-405">K ochraně kroužku na klíče a zajištění, že certifikát je důvěryhodný, použijte certifikát X509.</span><span class="sxs-lookup"><span data-stu-id="c4614-405">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="c4614-406">Pokud je certifikát podepsaný svým držitelem, umístěte jej do úložiště Důvěryhodného kořenového adresáře.</span><span class="sxs-lookup"><span data-stu-id="c4614-406">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="c4614-407">Při použití služby IIS ve webové farmě:</span><span class="sxs-lookup"><span data-stu-id="c4614-407">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="c4614-408">Použijte sdílenou složku, ke které mají přístup všechny počítače.</span><span class="sxs-lookup"><span data-stu-id="c4614-408">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="c4614-409">Nasazení certifikátu X509 do každého počítače.</span><span class="sxs-lookup"><span data-stu-id="c4614-409">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="c4614-410">Konfigurace [ochrany dat v kódu](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="c4614-410">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="c4614-411">**Nastavení celopočítačových zásad pro ochranu dat**</span><span class="sxs-lookup"><span data-stu-id="c4614-411">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="c4614-412">Systém ochrany dat má omezenou podporu pro nastavení výchozí [zásady celého počítače](xref:security/data-protection/configuration/machine-wide-policy) pro všechny aplikace, které spotřebovávají data protection API.</span><span class="sxs-lookup"><span data-stu-id="c4614-412">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="c4614-413">Další informace naleznete v tématu <xref:security/data-protection/introduction>.</span><span class="sxs-lookup"><span data-stu-id="c4614-413">For more information, see <xref:security/data-protection/introduction>.</span></span>

## <a name="virtual-directories"></a><span data-ttu-id="c4614-414">Virtuální adresáře</span><span class="sxs-lookup"><span data-stu-id="c4614-414">Virtual Directories</span></span>

<span data-ttu-id="c4614-415">[Virtuální adresáře služby IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) nejsou podporovány aplikacemi ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-415">[IIS Virtual Directories](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) aren't supported with ASP.NET Core apps.</span></span> <span data-ttu-id="c4614-416">Aplikace může být hostována jako [podaplikace](#sub-applications).</span><span class="sxs-lookup"><span data-stu-id="c4614-416">An app can be hosted as a [sub-application](#sub-applications).</span></span>

## <a name="sub-applications"></a><span data-ttu-id="c4614-417">Dílčí aplikace</span><span class="sxs-lookup"><span data-stu-id="c4614-417">Sub-applications</span></span>

<span data-ttu-id="c4614-418">Aplikaci ASP.NET Core lze hostovat jako [podaplikaci služby IIS (podaplikaci).](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications)</span><span class="sxs-lookup"><span data-stu-id="c4614-418">An ASP.NET Core app can be hosted as an [IIS sub-application (sub-app)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span></span> <span data-ttu-id="c4614-419">Cesta podaplikace se stane součástí adresy URL kořenové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-419">The sub-app's path becomes part of the root app's URL.</span></span>

<span data-ttu-id="c4614-420">Statické odkazy datových zdrojů v rámci podaplikace`~/`by měly používat zápis tildového lomítka ( ).</span><span class="sxs-lookup"><span data-stu-id="c4614-420">Static asset links within the sub-app should use tilde-slash (`~/`) notation.</span></span> <span data-ttu-id="c4614-421">Zápis tildového lomítka aktivuje [pomocníka tagu,](xref:mvc/views/tag-helpers/intro) který předřává základnu cesty podaplikace k vykreslenérelativní vazbě.</span><span class="sxs-lookup"><span data-stu-id="c4614-421">Tilde-slash notation triggers a [Tag Helper](xref:mvc/views/tag-helpers/intro) to prepend the sub-app's pathbase to the rendered relative link.</span></span> <span data-ttu-id="c4614-422">Pro podaplikaci `/subapp_path`na adrese , `src="~/image.png"` obrázek `src="/subapp_path/image.png"`spojený s je vykreslen jako .</span><span class="sxs-lookup"><span data-stu-id="c4614-422">For a sub-app at `/subapp_path`, an image linked with `src="~/image.png"` is rendered as `src="/subapp_path/image.png"`.</span></span> <span data-ttu-id="c4614-423">Middleware statického souboru kořenové aplikace nezpracovává požadavek na statický soubor.</span><span class="sxs-lookup"><span data-stu-id="c4614-423">The root app's Static File Middleware doesn't process the static file request.</span></span> <span data-ttu-id="c4614-424">Požadavek je zpracován middlewarem statického souboru podaplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-424">The request is processed by the sub-app's Static File Middleware.</span></span>

<span data-ttu-id="c4614-425">Pokud je atribut `src` statického datového zdroje nastaven na `src="/image.png"`absolutní cestu (například), odkaz se vykreslí bez vytvoření cesty podaplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-425">If a static asset's `src` attribute is set to an absolute path (for example, `src="/image.png"`), the link is rendered without the sub-app's pathbase.</span></span> <span data-ttu-id="c4614-426">Middleware statického souboru kořenové aplikace se pokouší obsluhovat datový zdroj z [kořenového kořenového kořenového adresáře](xref:fundamentals/index#web-root)aplikace , což má za následek odpověď *404 - Not Found,* pokud není statický datový zdroj k dispozici z kořenové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-426">The root app's Static File Middleware attempts to serve the asset from the root app's [web root](xref:fundamentals/index#web-root), which results in a *404 - Not Found* response unless the static asset is available from the root app.</span></span>

<span data-ttu-id="c4614-427">Hostování aplikace ASP.NET Core jako podaplikace pod jinou aplikací ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="c4614-427">To host an ASP.NET Core app as a sub-app under another ASP.NET Core app:</span></span>

1. <span data-ttu-id="c4614-428">Vytvořte fond aplikací pro podaplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-428">Establish an app pool for the sub-app.</span></span> <span data-ttu-id="c4614-429">Nastavte **verzi .NET CLR** na **žádný spravovaný kód,** protože prostředí Core Common Language Runtime (CoreCLR) pro .NET Core je spuštěno pro hostování aplikace v pracovním procesu, nikoli na ploše CLR (.NET CLR).</span><span class="sxs-lookup"><span data-stu-id="c4614-429">Set the **.NET CLR Version** to **No Managed Code** because the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process, not the desktop CLR (.NET CLR).</span></span>

1. <span data-ttu-id="c4614-430">Přidejte kořenový web ve Správci služby IIS s podaplikací ve složce pod kořenovým webem.</span><span class="sxs-lookup"><span data-stu-id="c4614-430">Add the root site in IIS Manager with the sub-app in a folder under the root site.</span></span>

1. <span data-ttu-id="c4614-431">Klikněte pravým tlačítkem myši na složku podaplikace ve Správci služby IIS a vyberte **příkaz Převést na aplikaci**.</span><span class="sxs-lookup"><span data-stu-id="c4614-431">Right-click the sub-app folder in IIS Manager and select **Convert to Application**.</span></span>

1. <span data-ttu-id="c4614-432">V dialogovém okně **Přidat aplikaci** přiřaďte pomocí tlačítka **Vybrat** pro **fond aplikací** fond aplikací, který jste vytvořili pro podaplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-432">In the **Add Application** dialog, use the **Select** button for the **Application Pool** to assign the app pool that you created for the sub-app.</span></span> <span data-ttu-id="c4614-433">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-433">Select **OK**.</span></span>

<span data-ttu-id="c4614-434">Přiřazení samostatného fondu aplikací do podaplikace je požadavek při použití modelu hostování v procesu.</span><span class="sxs-lookup"><span data-stu-id="c4614-434">The assignment of a separate app pool to the sub-app is a requirement when using the in-process hosting model.</span></span>

<span data-ttu-id="c4614-435">Další informace o modelu hostování v procesu a konfiguraci <xref:host-and-deploy/aspnet-core-module>ASP.NET core modulu naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-435">For more information on the in-process hosting model and configuring the ASP.NET Core Module, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="c4614-436">Konfigurace služby IIS pomocí souboru web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-436">Configuration of IIS with web.config</span></span>

<span data-ttu-id="c4614-437">Konfigurace služby IIS `<system.webServer>` je ovlivněna částí *web.config* pro scénáře služby IIS, které jsou funkční pro ASP.NET aplikace Core pomocí ASP.NET core modulem.</span><span class="sxs-lookup"><span data-stu-id="c4614-437">IIS configuration is influenced by the `<system.webServer>` section of *web.config* for IIS scenarios that are functional for ASP.NET Core apps with the ASP.NET Core Module.</span></span> <span data-ttu-id="c4614-438">Například konfigurace služby IIS je funkční pro dynamickou kompresi.</span><span class="sxs-lookup"><span data-stu-id="c4614-438">For example, IIS configuration is functional for dynamic compression.</span></span> <span data-ttu-id="c4614-439">Pokud je služba IIS nakonfigurována na `<urlCompression>` úrovni serveru pro použití dynamické komprese, prvek v souboru *web.config* aplikace jej může zakázat pro aplikaci ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-439">If IIS is configured at the server level to use dynamic compression, the `<urlCompression>` element in the app's *web.config* file can disable it for an ASP.NET Core app.</span></span>

<span data-ttu-id="c4614-440">Další informace najdete v následujících tématech:</span><span class="sxs-lookup"><span data-stu-id="c4614-440">For more information, see the following topics:</span></span>

* [<span data-ttu-id="c4614-441">Odkaz na \<konfiguraci pro>system.webServer</span><span class="sxs-lookup"><span data-stu-id="c4614-441">Configuration reference for \<system.webServer></span></span>](/iis/configuration/system.webServer/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/iis/modules>

<span data-ttu-id="c4614-442">Chcete-li nastavit proměnné prostředí pro jednotlivé aplikace spuštěné v izolovaných fondech aplikací (podporované pro službu IIS 10.0 nebo novější), přečtěte si část *příkazu AppCmd.exe* v tématu [Environment Variables environmentvariables>\<](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) tématu v referenční dokumentaci služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-442">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="c4614-443">Konfigurační části web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-443">Configuration sections of web.config</span></span>

<span data-ttu-id="c4614-444">Části konfigurace aplikací ASP.NET 4.x v *souboru web.config* nepoužívají aplikace ASP.NET Core pro konfiguraci:</span><span class="sxs-lookup"><span data-stu-id="c4614-444">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* `<system.web>`
* `<appSettings>`
* `<connectionStrings>`
* `<location>`

<span data-ttu-id="c4614-445">ASP.NET aplikace Core jsou konfigurovány pomocí jiných poskytovatelů konfigurace.</span><span class="sxs-lookup"><span data-stu-id="c4614-445">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="c4614-446">Další informace naleznete v [tématu Konfigurace](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="c4614-446">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="c4614-447">Fondy aplikací</span><span class="sxs-lookup"><span data-stu-id="c4614-447">Application Pools</span></span>

<span data-ttu-id="c4614-448">Izolace fondu aplikací je určena modelem hostování:</span><span class="sxs-lookup"><span data-stu-id="c4614-448">App pool isolation is determined by the hosting model:</span></span>

* <span data-ttu-id="c4614-449">V průběhu &ndash; procesu hosting ové aplikace jsou nutné ke spuštění v samostatných fondech aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-449">In-process hosting &ndash; Apps are required to run in separate app pools.</span></span>
* <span data-ttu-id="c4614-450">Mimoprocesový hosting &ndash; Doporučujeme izolovat aplikace od sebe navzájem spuštěním každé aplikace ve vlastním fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-450">Out-of-process hosting &ndash; We recommend isolating the apps from each other by running each app in its own app pool.</span></span>

<span data-ttu-id="c4614-451">Dialogové okno **IIS Přidat web** se ve výchozím nastavení používá do jednoho fondu aplikací na aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-451">The IIS **Add Website** dialog defaults to a single app pool per app.</span></span> <span data-ttu-id="c4614-452">Když je k dispozici **název webu,** text se automaticky přenese do textového pole **Fondu aplikací.**</span><span class="sxs-lookup"><span data-stu-id="c4614-452">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="c4614-453">Při přidání webu se vytvoří nový fond aplikací s názvem webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-453">A new app pool is created using the site name when the site is added.</span></span>

## <a name="application-pool-identity"></a><span data-ttu-id="c4614-454">Identita fondu aplikací</span><span class="sxs-lookup"><span data-stu-id="c4614-454">Application Pool Identity</span></span>

<span data-ttu-id="c4614-455">Účet identity fondu aplikací umožňuje aplikaci spouštět pod jedinečným účtem, aniž by bylo třeba vytvářet a spravovat domény nebo místní účty.</span><span class="sxs-lookup"><span data-stu-id="c4614-455">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="c4614-456">Ve službě IIS 8.0 nebo novější vytvoří pracovní proces správce služby IIS (WAS) virtuální účet s názvem nového fondu aplikací a ve výchozím nastavení spustí pracovní procesy fondu aplikací v rámci tohoto účtu.</span><span class="sxs-lookup"><span data-stu-id="c4614-456">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="c4614-457">V konzole pro správu služby IIS v části **Upřesnit nastavení** fondu aplikací zkontrolujte, zda je **identita** nastavená na použití **applicationpoolidentity**:</span><span class="sxs-lookup"><span data-stu-id="c4614-457">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity**:</span></span>

![Dialogové okno Upřesnit nastavení fondu aplikací](index/_static/apppool-identity.png)

<span data-ttu-id="c4614-459">Proces správy služby IIS vytvoří zabezpečený identifikátor s názvem fondu aplikací v systému zabezpečení systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-459">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="c4614-460">Prostředky lze zabezpečit pomocí této identity.</span><span class="sxs-lookup"><span data-stu-id="c4614-460">Resources can be secured using this identity.</span></span> <span data-ttu-id="c4614-461">Tato identita však není reálný uživatelský účet a nezobrazuje se v konzole pro správu uživatelů systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-461">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="c4614-462">Pokud pracovní proces služby IIS vyžaduje zvýšený přístup k aplikaci, upravte seznam řízení přístupu (ACL) pro adresář obsahující aplikaci:</span><span class="sxs-lookup"><span data-stu-id="c4614-462">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="c4614-463">Sem otevřete Průzkumníka Windows a přejděte do adresáře.</span><span class="sxs-lookup"><span data-stu-id="c4614-463">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="c4614-464">Klepněte pravým tlačítkem myši na adresář a vyberte příkaz **Vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="c4614-464">Right-click on the directory and select **Properties**.</span></span>

1. <span data-ttu-id="c4614-465">Na kartě **Zabezpečení** vyberte tlačítko **Upravit** a pak **tlačítko Přidat.**</span><span class="sxs-lookup"><span data-stu-id="c4614-465">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="c4614-466">Vyberte tlačítko **Umístění** a ujistěte se, že je vybrán systém.</span><span class="sxs-lookup"><span data-stu-id="c4614-466">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="c4614-467">Zadejte **\\<<iIS app_pool_name>** **zadejte názvy objektů, které chcete vybrat.**</span><span class="sxs-lookup"><span data-stu-id="c4614-467">Enter **IIS AppPool\\<app_pool_name>** in **Enter the object names to select** area.</span></span> <span data-ttu-id="c4614-468">Vyberte tlačítko **Zkontrolovat jména.**</span><span class="sxs-lookup"><span data-stu-id="c4614-468">Select the **Check Names** button.</span></span> <span data-ttu-id="c4614-469">Pro *DefaultAppPool* zkontrolujte názvy pomocí **IIS AppPool\DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="c4614-469">For the *DefaultAppPool* check the names using **IIS AppPool\DefaultAppPool**.</span></span> <span data-ttu-id="c4614-470">Když je vybráno tlačítko **Zkontrolovat názvy,** je v oblasti názvů objektů uvedena hodnota **DefaultAppPool.**</span><span class="sxs-lookup"><span data-stu-id="c4614-470">When the **Check Names** button is selected, a value of **DefaultAppPool** is indicated in the object names area.</span></span> <span data-ttu-id="c4614-471">Název fondu aplikací není možné zadat přímo do oblasti názvů objektů.</span><span class="sxs-lookup"><span data-stu-id="c4614-471">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="c4614-472">Při kontrole názvu objektu použijte<<app_pool_name>formátu \*\*IIS AppPool.\\ \*\*</span><span class="sxs-lookup"><span data-stu-id="c4614-472">Use the **IIS AppPool\\<app_pool_name>** format when checking for the object name.</span></span>

   ![Dialogové okno Vybrat uživatele nebo skupiny pro složku aplikace: Název fondu aplikací "DefaultAppPool" se připojí k "IIS AppPool\" v oblasti názvů objektů před výběrem možnosti Zkontrolovat názvy".](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="c4614-474">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-474">Select **OK**.</span></span>

   ![Dialogové okno Vybrat uživatele nebo skupiny pro složku aplikace: Po výběru možnosti Zkontrolovat názvy se v oblasti názvů objektů zobrazí název objektu DefaultAppPool.](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="c4614-476">Oprávnění &amp; ke spuštění čtení by měla být udělena ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="c4614-476">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="c4614-477">Podle potřeby zadejte další oprávnění.</span><span class="sxs-lookup"><span data-stu-id="c4614-477">Provide additional permissions as needed.</span></span>

<span data-ttu-id="c4614-478">Přístup lze také udělit na příkazovém řádku pomocí nástroje **ICACLS.**</span><span class="sxs-lookup"><span data-stu-id="c4614-478">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="c4614-479">Jako příklad použijete *defaultapppool,* který používá následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="c4614-479">Using the *DefaultAppPool* as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="c4614-480">Další informace naleznete v tématu [icacls.](/windows-server/administration/windows-commands/icacls)</span><span class="sxs-lookup"><span data-stu-id="c4614-480">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="http2-support"></a><span data-ttu-id="c4614-481">Podpora HTTP/2</span><span class="sxs-lookup"><span data-stu-id="c4614-481">HTTP/2 support</span></span>

<span data-ttu-id="c4614-482">[Protokol HTTP/2](https://httpwg.org/specs/rfc7540.html) je podporován ASP.NET jádrem v následujících scénářích nasazení služby IIS:</span><span class="sxs-lookup"><span data-stu-id="c4614-482">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported with ASP.NET Core in the following IIS deployment scenarios:</span></span>

* <span data-ttu-id="c4614-483">Neprocesové</span><span class="sxs-lookup"><span data-stu-id="c4614-483">In-process</span></span>
  * <span data-ttu-id="c4614-484">Windows Server 2016/Windows 10 nebo novější; IIS 10 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-484">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="c4614-485">Připojení TLS 1.2 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-485">TLS 1.2 or later connection</span></span>
* <span data-ttu-id="c4614-486">Mimo proces</span><span class="sxs-lookup"><span data-stu-id="c4614-486">Out-of-process</span></span>
  * <span data-ttu-id="c4614-487">Windows Server 2016/Windows 10 nebo novější; IIS 10 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-487">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="c4614-488">Připojení serveru edge směřující mj. [Kestrel server](xref:fundamentals/servers/kestrel)</span><span class="sxs-lookup"><span data-stu-id="c4614-488">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
  * <span data-ttu-id="c4614-489">Připojení TLS 1.2 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-489">TLS 1.2 or later connection</span></span>

<span data-ttu-id="c4614-490">Pro nasazení v procesu při navázání připojení HTTP/2 `HTTP/2`protokol [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) hlásí .</span><span class="sxs-lookup"><span data-stu-id="c4614-490">For an in-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span> <span data-ttu-id="c4614-491">Pro mimoprocesové nasazení při navázání připojení HTTP/2 hlásí protokol `HTTP/1.1` [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) .</span><span class="sxs-lookup"><span data-stu-id="c4614-491">For an out-of-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="c4614-492">Další informace o modelech hostování v procesu a <xref:host-and-deploy/aspnet-core-module>mimo proces naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-492">For more information on the in-process and out-of-process hosting models, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="c4614-493">Protokol HTTP/2 je ve výchozím nastavení povolen.</span><span class="sxs-lookup"><span data-stu-id="c4614-493">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="c4614-494">Připojení se vrátí na HTTP/1.1, pokud není navázáno připojení HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="c4614-494">Connections fall back to HTTP/1.1 if an HTTP/2 connection isn't established.</span></span> <span data-ttu-id="c4614-495">Další informace o konfiguraci protokolu HTTP/2 s nasazením služby IIS naleznete [v tématu HTTP/2 ve službě IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span><span class="sxs-lookup"><span data-stu-id="c4614-495">For more information on HTTP/2 configuration with IIS deployments, see [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span></span>

## <a name="cors-preflight-requests"></a><span data-ttu-id="c4614-496">Požadavky cors kontroly před výstupem</span><span class="sxs-lookup"><span data-stu-id="c4614-496">CORS preflight requests</span></span>

<span data-ttu-id="c4614-497">*Tato část se vztahuje pouze na ASP.NET základní aplikace, které se zaměřují na rozhraní .NET Framework.*</span><span class="sxs-lookup"><span data-stu-id="c4614-497">*This section only applies to ASP.NET Core apps that target the .NET Framework.*</span></span>

<span data-ttu-id="c4614-498">Pro aplikaci ASP.NET Core, která cílí na rozhraní .NET Framework, nejsou požadavky OPTIONS ve výchozím nastavení ve službách IIS předány do aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-498">For an ASP.NET Core app that targets the .NET Framework, OPTIONS requests aren't passed to the app by default in IIS.</span></span> <span data-ttu-id="c4614-499">Informace o konfiguraci obslužných rutin služby IIS aplikace v *souboru web.config* tak, aby předávály požadavky OPTIONS, naleznete v tématu [Povolení požadavků napříč původy v ASP.NET webovém rozhraní API 2: Jak funguje cors](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span><span class="sxs-lookup"><span data-stu-id="c4614-499">To learn how to configure the app's IIS handlers in *web.config* to pass OPTIONS requests, see [Enable cross-origin requests in ASP.NET Web API 2: How CORS Works](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span></span>

## <a name="application-initialization-module-and-idle-timeout"></a><span data-ttu-id="c4614-500">Modul inicializace aplikace a časový limit nečinnosti</span><span class="sxs-lookup"><span data-stu-id="c4614-500">Application Initialization Module and Idle Timeout</span></span>

<span data-ttu-id="c4614-501">Pokud je ve správě ve správě iis hostován ASP.NET základnímodul verze 2:</span><span class="sxs-lookup"><span data-stu-id="c4614-501">When hosted in IIS by the ASP.NET Core Module version 2:</span></span>

* <span data-ttu-id="c4614-502">[Aplikace Inicializační modul](#application-initialization-module) &ndash; aplikace hostované [v procesu](#in-process-hosting-model) nebo [mimo proces](#out-of-process-hosting-model) lze nakonfigurovat tak, aby se automaticky spouštěla při restartování pracovního procesu nebo restartování serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-502">[Application Initialization Module](#application-initialization-module) &ndash; App's hosted [in-process](#in-process-hosting-model) or [out-of-process](#out-of-process-hosting-model) can be configured to start automatically on a worker process restart or server restart.</span></span>
* <span data-ttu-id="c4614-503">[Nevyužitý časový limit](#idle-timeout) &ndash; aplikace hostované [v procesu](#in-process-hosting-model) lze nakonfigurovat tak, aby časový limit během období nečinnosti.</span><span class="sxs-lookup"><span data-stu-id="c4614-503">[Idle Timeout](#idle-timeout) &ndash; App's hosted [in-process](#in-process-hosting-model) can be configured not to timeout during periods of inactivity.</span></span>

### <a name="application-initialization-module"></a><span data-ttu-id="c4614-504">Inicializační modul aplikace</span><span class="sxs-lookup"><span data-stu-id="c4614-504">Application Initialization Module</span></span>

<span data-ttu-id="c4614-505">*Platí pro aplikace hostované v průběhu procesu a mimo proces.*</span><span class="sxs-lookup"><span data-stu-id="c4614-505">*Applies to apps hosted in-process and out-of-process.*</span></span>

<span data-ttu-id="c4614-506">[Inicializace aplikace služby IIS](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) je funkce služby IIS, která odesílá požadavek HTTP do aplikace při spuštění nebo recyklaci fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-506">[IIS Application Initialization](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) is an IIS feature that sends an HTTP request to the app when the app pool starts or is recycled.</span></span> <span data-ttu-id="c4614-507">Požadavek spustí spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-507">The request triggers the app to start.</span></span> <span data-ttu-id="c4614-508">Ve výchozím nastavení služba IIS vydá požadavek`/`na kořenovou adresu URL aplikace ( ) o inicializaci aplikace (další podrobnosti o konfiguraci najdete v [dalších zdrojích](#application-initialization-module-and-idle-timeout-additional-resources) informací).</span><span class="sxs-lookup"><span data-stu-id="c4614-508">By default, IIS issues a request to the app's root URL (`/`) to initialize the app (see the [additional resources](#application-initialization-module-and-idle-timeout-additional-resources) for more details on configuration).</span></span>

<span data-ttu-id="c4614-509">Zkontrolujte, zda je funkce role Inicializace aplikace služby IIS povolena:</span><span class="sxs-lookup"><span data-stu-id="c4614-509">Confirm that the IIS Application Initialization role feature in enabled:</span></span>

<span data-ttu-id="c4614-510">V desktopových systémech se systémem Windows 7 nebo novějších při místním používání služby IIS:</span><span class="sxs-lookup"><span data-stu-id="c4614-510">On Windows 7 or later desktop systems when using IIS locally:</span></span>

1. <span data-ttu-id="c4614-511">Přejděte na **Ovládací panely** > **Programy** > **a funkce** > **Zapněte nebo vypněte funkce systému Windows** (levá strana obrazovky).</span><span class="sxs-lookup"><span data-stu-id="c4614-511">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>
1. <span data-ttu-id="c4614-512">Otevřete funkce **vývoje aplikací** **internetových informačních služeb** > **World Wide Web Services** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-512">Open **Internet Information Services** > **World Wide Web Services** > **Application Development Features**.</span></span>
1. <span data-ttu-id="c4614-513">Zaškrtněte políčko pro **inicializaci aplikace**.</span><span class="sxs-lookup"><span data-stu-id="c4614-513">Select the check box for **Application Initialization**.</span></span>

<span data-ttu-id="c4614-514">V systému Windows Server 2008 R2 nebo novějším:</span><span class="sxs-lookup"><span data-stu-id="c4614-514">On Windows Server 2008 R2 or later:</span></span>

1. <span data-ttu-id="c4614-515">Otevřete **Průvodce přidáním rolí a funkcí**.</span><span class="sxs-lookup"><span data-stu-id="c4614-515">Open the **Add Roles and Features Wizard**.</span></span>
1. <span data-ttu-id="c4614-516">V panelu **Vybrat služby rolí** otevřete uzel **Vývoj aplikací.**</span><span class="sxs-lookup"><span data-stu-id="c4614-516">In the **Select role services** panel, open the **Application Development** node.</span></span>
1. <span data-ttu-id="c4614-517">Zaškrtněte políčko pro **inicializaci aplikace**.</span><span class="sxs-lookup"><span data-stu-id="c4614-517">Select the check box for **Application Initialization**.</span></span>

<span data-ttu-id="c4614-518">K povolení modulu inicializace aplikace pro lokalitu použijte některý z následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-518">Use either of the following approaches to enable the Application Initialization Module for the site:</span></span>

* <span data-ttu-id="c4614-519">Pomocí Správce služby IIS:</span><span class="sxs-lookup"><span data-stu-id="c4614-519">Using IIS Manager:</span></span>

  1. <span data-ttu-id="c4614-520">V panelu **Připojení** vyberte **fondy aplikací.**</span><span class="sxs-lookup"><span data-stu-id="c4614-520">Select **Application Pools** in the **Connections** panel.</span></span>
  1. <span data-ttu-id="c4614-521">Klikněte pravým tlačítkem myši na fond aplikací v seznamu a vyberte **Upřesnit nastavení**.</span><span class="sxs-lookup"><span data-stu-id="c4614-521">Right-click the app's app pool in the list and select **Advanced Settings**.</span></span>
  1. <span data-ttu-id="c4614-522">Výchozí **režim spuštění** je **OnDemand**.</span><span class="sxs-lookup"><span data-stu-id="c4614-522">The default **Start Mode** is **OnDemand**.</span></span> <span data-ttu-id="c4614-523">Nastavte **režim spuštění** na **vždy spuštěný**.</span><span class="sxs-lookup"><span data-stu-id="c4614-523">Set the **Start Mode** to **AlwaysRunning**.</span></span> <span data-ttu-id="c4614-524">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-524">Select **OK**.</span></span>
  1. <span data-ttu-id="c4614-525">Otevřete uzel **Weby** v panelu **Připojení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-525">Open the **Sites** node in the **Connections** panel.</span></span>
  1. <span data-ttu-id="c4614-526">Klikněte pravým tlačítkem myši na aplikaci a vyberte Spravovat **upřesnit nastavení** **webu** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-526">Right-click the app and select **Manage Website** > **Advanced Settings**.</span></span>
  1. <span data-ttu-id="c4614-527">Výchozí nastavení **Preload Enabled** je **False**.</span><span class="sxs-lookup"><span data-stu-id="c4614-527">The default **Preload Enabled** setting is **False**.</span></span> <span data-ttu-id="c4614-528">Nastavte **předběžné načtení povoleno** na **hodnotu True**.</span><span class="sxs-lookup"><span data-stu-id="c4614-528">Set **Preload Enabled** to **True**.</span></span> <span data-ttu-id="c4614-529">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-529">Select **OK**.</span></span>

* <span data-ttu-id="c4614-530">Pomocí `<applicationInitialization>` `doAppInitAfterRestart` *souboru web.config*přidejte `true` prvek `<system.webServer>` s nastavenou na do prvků v souboru *web.config* aplikace:</span><span class="sxs-lookup"><span data-stu-id="c4614-530">Using *web.config*, add the `<applicationInitialization>` element with `doAppInitAfterRestart` set to `true` to the `<system.webServer>` elements in the app's *web.config* file:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <location path="." inheritInChildApplications="false">
      <system.webServer>
        <applicationInitialization doAppInitAfterRestart="true" />
      </system.webServer>
    </location>
  </configuration>
  ```

### <a name="idle-timeout"></a><span data-ttu-id="c4614-531">Časový limit nečinnosti</span><span class="sxs-lookup"><span data-stu-id="c4614-531">Idle Timeout</span></span>

<span data-ttu-id="c4614-532">*Platí pouze pro aplikace hostované v procesu.*</span><span class="sxs-lookup"><span data-stu-id="c4614-532">*Only applies to apps hosted in-process.*</span></span>

<span data-ttu-id="c4614-533">Chcete-li aplikaci zabránit v volnoběhu, nastavte časový limit nečinnosti fondu aplikací pomocí Správce služby IIS:</span><span class="sxs-lookup"><span data-stu-id="c4614-533">To prevent the app from idling, set the app pool's idle timeout using IIS Manager:</span></span>

1. <span data-ttu-id="c4614-534">V panelu **Připojení** vyberte **fondy aplikací.**</span><span class="sxs-lookup"><span data-stu-id="c4614-534">Select **Application Pools** in the **Connections** panel.</span></span>
1. <span data-ttu-id="c4614-535">Klikněte pravým tlačítkem myši na fond aplikací v seznamu a vyberte **Upřesnit nastavení**.</span><span class="sxs-lookup"><span data-stu-id="c4614-535">Right-click the app's app pool in the list and select **Advanced Settings**.</span></span>
1. <span data-ttu-id="c4614-536">Výchozí **časový limit nečinnosti (minuty)** je **20** minut.</span><span class="sxs-lookup"><span data-stu-id="c4614-536">The default **Idle Time-out (minutes)** is **20** minutes.</span></span> <span data-ttu-id="c4614-537">Nastavte **časový limit nečinnosti (minuty)** na **0** (nula).</span><span class="sxs-lookup"><span data-stu-id="c4614-537">Set the **Idle Time-out (minutes)** to **0** (zero).</span></span> <span data-ttu-id="c4614-538">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-538">Select **OK**.</span></span>
1. <span data-ttu-id="c4614-539">Recyklujte pracovní proces.</span><span class="sxs-lookup"><span data-stu-id="c4614-539">Recycle the worker process.</span></span>

<span data-ttu-id="c4614-540">Chcete-li zabránit vypršení časového limitu aplikací hostovaných [mimo proces,](#out-of-process-hosting-model) použijte některý z následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-540">To prevent apps hosted [out-of-process](#out-of-process-hosting-model) from timing out, use either of the following approaches:</span></span>

* <span data-ttu-id="c4614-541">Příkazping aplikace z externí služby, aby byla spuštěna.</span><span class="sxs-lookup"><span data-stu-id="c4614-541">Ping the app from an external service in order to keep it running.</span></span>
* <span data-ttu-id="c4614-542">Pokud aplikace hostuje pouze služby na pozadí, vyhněte se hostování služby IIS a pomocí [služby Windows service hostujte aplikaci ASP.NET Core](xref:host-and-deploy/windows-service).</span><span class="sxs-lookup"><span data-stu-id="c4614-542">If the app only hosts background services, avoid IIS hosting and use a [Windows Service to host the ASP.NET Core app](xref:host-and-deploy/windows-service).</span></span>

### <a name="application-initialization-module-and-idle-timeout-additional-resources"></a><span data-ttu-id="c4614-543">Modul inicializace aplikace a časový limit nečinnosti další prostředky</span><span class="sxs-lookup"><span data-stu-id="c4614-543">Application Initialization Module and Idle Timeout additional resources</span></span>

* [<span data-ttu-id="c4614-544">Inicializace aplikace služby IIS 8.0</span><span class="sxs-lookup"><span data-stu-id="c4614-544">IIS 8.0 Application Initialization</span></span>](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization)
* <span data-ttu-id="c4614-545">[Aplikace Inicializace \<aplikaceInicializační>](/iis/configuration/system.webserver/applicationinitialization/).</span><span class="sxs-lookup"><span data-stu-id="c4614-545">[Application Initialization \<applicationInitialization>](/iis/configuration/system.webserver/applicationinitialization/).</span></span>
* <span data-ttu-id="c4614-546">[Zpracovat nastavení modelu \<pro proces fondu aplikacíModel>](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span><span class="sxs-lookup"><span data-stu-id="c4614-546">[Process Model Settings for an Application Pool \<processModel>](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span></span>

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="c4614-547">Prostředky nasazení pro správce služby IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-547">Deployment resources for IIS administrators</span></span>

* [<span data-ttu-id="c4614-548">Dokumentace iis</span><span class="sxs-lookup"><span data-stu-id="c4614-548">IIS documentation</span></span>](/iis)
* [<span data-ttu-id="c4614-549">Začínáme se Správcem služby IIS ve službách IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-549">Getting Started with the IIS Manager in IIS</span></span>](/iis/get-started/getting-started-with-iis/getting-started-with-the-iis-manager-in-iis-7-and-iis-8)
* [<span data-ttu-id="c4614-550">Nasazení aplikace .NET Core</span><span class="sxs-lookup"><span data-stu-id="c4614-550">.NET Core application deployment</span></span>](/dotnet/core/deploying/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/directory-structure>
* <xref:host-and-deploy/iis/modules>
* <xref:test/troubleshoot-azure-iis>
* <xref:host-and-deploy/azure-iis-errors-reference>

## <a name="additional-resources"></a><span data-ttu-id="c4614-551">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="c4614-551">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:index>
* [<span data-ttu-id="c4614-552">Oficiální web služby Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-552">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="c4614-553">Knihovna technického obsahu systému Windows Server</span><span class="sxs-lookup"><span data-stu-id="c4614-553">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="c4614-554">HTTP/2 ve službě IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-554">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="c4614-555">Výukové prostředí o publikování aplikace ASP.NET Core na server <xref:tutorials/publish-to-iis>služby IIS naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-555">For a tutorial experience on publishing an ASP.NET Core app to an IIS server, see <xref:tutorials/publish-to-iis>.</span></span>

[<span data-ttu-id="c4614-556">Instalace balíčku hostingu jádra .NET</span><span class="sxs-lookup"><span data-stu-id="c4614-556">Install the .NET Core Hosting Bundle</span></span>](#install-the-net-core-hosting-bundle)

## <a name="supported-operating-systems"></a><span data-ttu-id="c4614-557">Podporované operační systémy</span><span class="sxs-lookup"><span data-stu-id="c4614-557">Supported operating systems</span></span>

<span data-ttu-id="c4614-558">Podporovány jsou následující operační systémy:</span><span class="sxs-lookup"><span data-stu-id="c4614-558">The following operating systems are supported:</span></span>

* <span data-ttu-id="c4614-559">Windows 7 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-559">Windows 7 or later</span></span>
* <span data-ttu-id="c4614-560">Windows Server 2008 R2 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-560">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="c4614-561">[Server HTTP.sys](xref:fundamentals/servers/httpsys) (dříve nazývaný WebListener) nefunguje v konfiguraci reverzního proxy serveru se službou IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-561">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called WebListener) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="c4614-562">Použijte [server Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="c4614-562">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="c4614-563">Informace o hostování v <xref:host-and-deploy/azure-apps/index>Azure najdete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-563">For information on hosting in Azure, see <xref:host-and-deploy/azure-apps/index>.</span></span>

<span data-ttu-id="c4614-564">Pokyny pro řešení <xref:test/troubleshoot>potíží naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-564">For troubleshooting guidance, see <xref:test/troubleshoot>.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="c4614-565">Podporované platformy</span><span class="sxs-lookup"><span data-stu-id="c4614-565">Supported platforms</span></span>

<span data-ttu-id="c4614-566">Podporovány jsou aplikace publikované pro 32bitové (x86) nebo 64bitové (x64) nasazení.</span><span class="sxs-lookup"><span data-stu-id="c4614-566">Apps published for 32-bit (x86) or 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="c4614-567">Nasazení 32bitové aplikace s 32bitovou sadou .NET Core SDK, pokud ji ne:</span><span class="sxs-lookup"><span data-stu-id="c4614-567">Deploy a 32-bit app with a 32-bit (x86) .NET Core SDK unless the app:</span></span>

* <span data-ttu-id="c4614-568">Vyžaduje větší adresní prostor virtuální paměti, který je k dispozici pro 64bitovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-568">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="c4614-569">Vyžaduje větší velikost zásobníku iis.</span><span class="sxs-lookup"><span data-stu-id="c4614-569">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="c4614-570">Má 64bitové nativní závislosti.</span><span class="sxs-lookup"><span data-stu-id="c4614-570">Has 64-bit native dependencies.</span></span>

<span data-ttu-id="c4614-571">K publikování 64bitové sady SDK jádra (x64) použijte 64bitovou sadu .NET Core SDK.</span><span class="sxs-lookup"><span data-stu-id="c4614-571">Use a 64-bit (x64) .NET Core SDK to publish a 64-bit app.</span></span> <span data-ttu-id="c4614-572">V hostitelském systému musí být k dispozici 64bitový běhový čas.</span><span class="sxs-lookup"><span data-stu-id="c4614-572">A 64-bit runtime must be present on the host system.</span></span>

## <a name="hosting-models"></a><span data-ttu-id="c4614-573">Modely hostingu</span><span class="sxs-lookup"><span data-stu-id="c4614-573">Hosting models</span></span>

### <a name="in-process-hosting-model"></a><span data-ttu-id="c4614-574">Model hostování v procesu</span><span class="sxs-lookup"><span data-stu-id="c4614-574">In-process hosting model</span></span>

<span data-ttu-id="c4614-575">Pomocí hostování v rámci procesu běží aplikace ASP.NET Core ve stejném procesu jako pracovní proces služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-575">Using in-process hosting, an ASP.NET Core app runs in the same process as its IIS worker process.</span></span> <span data-ttu-id="c4614-576">Hostování v procesu poskytuje lepší výkon než mimoproceshosting, protože požadavky nejsou proxied přes adaptér zpětné smyčky, síťové rozhraní, které vrací odchozí síťový provoz zpět do stejného počítače.</span><span class="sxs-lookup"><span data-stu-id="c4614-576">In-process hosting provides improved performance over out-of-process hosting because requests aren't proxied over the loopback adapter, a network interface that returns outgoing network traffic back to the same machine.</span></span> <span data-ttu-id="c4614-577">Služba IIS zpracovává správu procesů pomocí [služby aktivace procesů systému Windows (WAS).](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was)</span><span class="sxs-lookup"><span data-stu-id="c4614-577">IIS handles process management with the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="c4614-578">Základní [modul ASP.NET](xref:host-and-deploy/aspnet-core-module):</span><span class="sxs-lookup"><span data-stu-id="c4614-578">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module):</span></span>

* <span data-ttu-id="c4614-579">Provede inicializaci aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-579">Performs app initialization.</span></span>
  * <span data-ttu-id="c4614-580">Načte [CoreCLR](/dotnet/standard/glossary#coreclr).</span><span class="sxs-lookup"><span data-stu-id="c4614-580">Loads the [CoreCLR](/dotnet/standard/glossary#coreclr).</span></span>
  * <span data-ttu-id="c4614-581">Volání `Program.Main`.</span><span class="sxs-lookup"><span data-stu-id="c4614-581">Calls `Program.Main`.</span></span>
* <span data-ttu-id="c4614-582">Zpracovává životnost nativního požadavku služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-582">Handles the lifetime of the IIS native request.</span></span>

<span data-ttu-id="c4614-583">Model hostování v procesu není podporován pro aplikace ASP.NET Core, které cílí na rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c4614-583">The in-process hosting model isn't supported for ASP.NET Core apps that target the .NET Framework.</span></span>

<span data-ttu-id="c4614-584">Následující diagram znázorňuje vztah mezi iis, ASP.NET základní modul a aplikace hostované v procesu:</span><span class="sxs-lookup"><span data-stu-id="c4614-584">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted in-process:</span></span>

![ASP.NET core modul ve scénáři hostování v procesu](index/_static/ancm-inprocess.png)

<span data-ttu-id="c4614-586">Požadavek přichází z webu na ovladač HTTP.sys v režimu jádra.</span><span class="sxs-lookup"><span data-stu-id="c4614-586">A request arrives from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="c4614-587">Řidič směruje nativní požadavek do služby IIS na nakonfigurovaném portu webu, obvykle 80 (HTTP) nebo 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="c4614-587">The driver routes the native request to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="c4614-588">Základní modul ASP.NET obdrží nativní požadavek a předá`IISHttpServer`jej serveru HTTP služby IIS ( ).</span><span class="sxs-lookup"><span data-stu-id="c4614-588">The ASP.NET Core Module receives the native request and passes it to IIS HTTP Server (`IISHttpServer`).</span></span> <span data-ttu-id="c4614-589">Server HTTP služby IIS je implementace serveru v procesu pro službu IIS, která převádí požadavek z nativního na spravovaný.</span><span class="sxs-lookup"><span data-stu-id="c4614-589">IIS HTTP Server is an in-process server implementation for IIS that converts the request from native to managed.</span></span>

<span data-ttu-id="c4614-590">Po zpracování požadavku serverem HTTP služby IIS je požadavek odeslán do kanálu middlewaru ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-590">After the IIS HTTP Server processes the request, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="c4614-591">Middleware kanálu zpracovává požadavek a předá `HttpContext` jej jako instanci logiky aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-591">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="c4614-592">Odpověď aplikace je předána zpět do služby IIS prostřednictvím serveru HTTP služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-592">The app's response is passed back to IIS through IIS HTTP Server.</span></span> <span data-ttu-id="c4614-593">Služba IIS odešle odpověď klientovi, který požadavek inicioval.</span><span class="sxs-lookup"><span data-stu-id="c4614-593">IIS sends the response to the client that initiated the request.</span></span>

<span data-ttu-id="c4614-594">Hostování v procesu je přihlášení pro stávající aplikace, ale [dotnet nové](/dotnet/core/tools/dotnet-new) šablony výchozí v procesu hostování modelu pro všechny scénáře služby IIS a IIS Express.</span><span class="sxs-lookup"><span data-stu-id="c4614-594">In-process hosting is opt-in for existing apps, but [dotnet new](/dotnet/core/tools/dotnet-new) templates default to the in-process hosting model for all IIS and IIS Express scenarios.</span></span>

<span data-ttu-id="c4614-595">`CreateDefaultBuilder`přidá <xref:Microsoft.AspNetCore.Hosting.Server.IServer> instanci <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS*> voláním metody pro spuštění [coreclru](/dotnet/standard/glossary#coreclr) a hostování aplikace uvnitř pracovního procesu služby IIS (*w3wp.exe* nebo *iisexpress.exe*).</span><span class="sxs-lookup"><span data-stu-id="c4614-595">`CreateDefaultBuilder` adds an <xref:Microsoft.AspNetCore.Hosting.Server.IServer> instance by calling the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIIS*> method to boot the [CoreCLR](/dotnet/standard/glossary#coreclr) and host the app inside of the IIS worker process (*w3wp.exe* or *iisexpress.exe*).</span></span> <span data-ttu-id="c4614-596">Testy výkonu ukazují, že hostování aplikace .NET Core v procesu přináší výrazně vyšší propustnost požadavků ve srovnání s hostováním aplikací mimo proces a proxy požadavků na server [Kestrel.](xref:fundamentals/servers/kestrel)</span><span class="sxs-lookup"><span data-stu-id="c4614-596">Performance tests indicate that hosting a .NET Core app in-process delivers significantly higher request throughput compared to hosting the app out-of-process and proxying requests to [Kestrel](xref:fundamentals/servers/kestrel) server.</span></span>

### <a name="out-of-process-hosting-model"></a><span data-ttu-id="c4614-597">Model hostování mimo proces</span><span class="sxs-lookup"><span data-stu-id="c4614-597">Out-of-process hosting model</span></span>

<span data-ttu-id="c4614-598">Vzhledem k tomu, že aplikace ASP.NET Core běží v procesu odděleném od pracovního procesu služby IIS, zpracovává ASP.NET core module správu procesů.</span><span class="sxs-lookup"><span data-stu-id="c4614-598">Because ASP.NET Core apps run in a process separate from the IIS worker process, the ASP.NET Core Module handles process management.</span></span> <span data-ttu-id="c4614-599">Modul spustí proces pro aplikaci ASP.NET Core při příchodu prvního požadavku a restartuje aplikaci, pokud se vypne nebo dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="c4614-599">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="c4614-600">Toto je v podstatě stejné chování jako u aplikací, které běží v procesu, které jsou spravovány [službou aktivace procesu systému Windows (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="c4614-600">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="c4614-601">Následující diagram znázorňuje vztah mezi iis, ASP.NET základní modul a aplikace hostované mimo proces:</span><span class="sxs-lookup"><span data-stu-id="c4614-601">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![ASP.NET základní modul ve scénáři mimoproceshostingového hostingu](index/_static/ancm-outofprocess.png)

<span data-ttu-id="c4614-603">Požadavky dorazí z webu do ovladače HTTP.sys v režimu jádra.</span><span class="sxs-lookup"><span data-stu-id="c4614-603">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="c4614-604">Řidič směruje požadavky do služby IIS na nakonfigurovaném portu webu, obvykle 80 (HTTP) nebo 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="c4614-604">The driver routes the requests to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="c4614-605">Modul předá požadavky Kestrel na náhodný port pro aplikaci, která není port 80 nebo 443.</span><span class="sxs-lookup"><span data-stu-id="c4614-605">The module forwards the requests to Kestrel on a random port for the app, which isn't port 80 or 443.</span></span>

<span data-ttu-id="c4614-606">Modul určuje port prostřednictvím proměnné prostředí při <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> spuštění a rozšíření konfiguruje server pro naslouchání . `http://localhost:{PORT}`</span><span class="sxs-lookup"><span data-stu-id="c4614-606">The module specifies the port via an environment variable at startup, and the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> extension configures the server to listen on `http://localhost:{PORT}`.</span></span> <span data-ttu-id="c4614-607">Jsou prováděny další kontroly a požadavky, které nepocházejí z modulu, jsou odmítnuty.</span><span class="sxs-lookup"><span data-stu-id="c4614-607">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="c4614-608">Modul nepodporuje předávání https, takže požadavky jsou předávány přes HTTP i v případě, že přijaté službou IIS přes protokol HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c4614-608">The module doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="c4614-609">Poté, co Kestrel vyzvedne požadavek z modulu, je požadavek posunut do kanálu ASP.NET middleware.</span><span class="sxs-lookup"><span data-stu-id="c4614-609">After Kestrel picks up the request from the module, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="c4614-610">Middleware kanálu zpracovává požadavek a předá `HttpContext` jej jako instanci logiky aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-610">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="c4614-611">Middleware přidané integrací služby IIS aktualizuje schéma, vzdálenou IP adresu a pathbase tak, aby odpovídaly předání požadavku ke společnosti Kestrel.</span><span class="sxs-lookup"><span data-stu-id="c4614-611">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="c4614-612">Odpověď aplikace je předána zpět do služby IIS, která ji odešle zpět do klienta HTTP, který inicioval požadavek.</span><span class="sxs-lookup"><span data-stu-id="c4614-612">The app's response is passed back to IIS, which pushes it back out to the HTTP client that initiated the request.</span></span>

<span data-ttu-id="c4614-613">Pokyny ke konfiguraci ASP.NET <xref:host-and-deploy/aspnet-core-module>core modulem naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-613">For ASP.NET Core Module configuration guidance, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="c4614-614">Další informace o hostování najdete [v tématu Host in ASP.NET Core](xref:fundamentals/index#host).</span><span class="sxs-lookup"><span data-stu-id="c4614-614">For more information on hosting, see [Host in ASP.NET Core](xref:fundamentals/index#host).</span></span>

## <a name="application-configuration"></a><span data-ttu-id="c4614-615">Konfigurace aplikací</span><span class="sxs-lookup"><span data-stu-id="c4614-615">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="c4614-616">Povolení součástí Integrace iIS</span><span class="sxs-lookup"><span data-stu-id="c4614-616">Enable the IISIntegration components</span></span>

<span data-ttu-id="c4614-617">Při vytváření hostitele `CreateWebHostBuilder` v *(Program.cs*) volání <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> umožňující integraci iis:</span><span class="sxs-lookup"><span data-stu-id="c4614-617">When building a host in `CreateWebHostBuilder` (*Program.cs*), call <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> to enable IIS integration:</span></span>

```csharp
public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

<span data-ttu-id="c4614-618">Další informace `CreateDefaultBuilder`naleznete <xref:fundamentals/host/web-host#set-up-a-host>v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-618">For more information on `CreateDefaultBuilder`, see <xref:fundamentals/host/web-host#set-up-a-host>.</span></span>

### <a name="iis-options"></a><span data-ttu-id="c4614-619">Možnosti iis</span><span class="sxs-lookup"><span data-stu-id="c4614-619">IIS options</span></span>

<span data-ttu-id="c4614-620">**Model hostování v procesu**</span><span class="sxs-lookup"><span data-stu-id="c4614-620">**In-process hosting model**</span></span>

<span data-ttu-id="c4614-621">Chcete-li konfigurovat možnosti serveru IIS, zahrňte konfiguraci služby v <xref:Microsoft.AspNetCore.Builder.IISServerOptions> aplikaci <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span><span class="sxs-lookup"><span data-stu-id="c4614-621">To configure IIS Server options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISServerOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="c4614-622">Následující příklad zakáže automatické ověřování:</span><span class="sxs-lookup"><span data-stu-id="c4614-622">The following example disables AutomaticAuthentication:</span></span>

```csharp
services.Configure<IISServerOptions>(options => 
{
    options.AutomaticAuthentication = false;
});
```

| <span data-ttu-id="c4614-623">Možnost</span><span class="sxs-lookup"><span data-stu-id="c4614-623">Option</span></span>                         | <span data-ttu-id="c4614-624">Výchozí</span><span class="sxs-lookup"><span data-stu-id="c4614-624">Default</span></span> | <span data-ttu-id="c4614-625">Nastavení</span><span class="sxs-lookup"><span data-stu-id="c4614-625">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="c4614-626">Pokud `true`server IIS `HttpContext.User` nastaví ověřené ověřování [systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-626">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="c4614-627">Pokud `false`server poskytuje identitu pouze `HttpContext.User` pro výzvy a reaguje na `AuthenticationScheme`ně, pokud o to výslovně požádá .</span><span class="sxs-lookup"><span data-stu-id="c4614-627">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="c4614-628">Aby bylo možné službu `AutomaticAuthentication` IIS fungovat, musí být ve službě IIS povoleno ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-628">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="c4614-629">Další informace naleznete v tématu [Ověřování systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-629">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="c4614-630">Nastaví zobrazované jméno zobrazené uživatelům na přihlašovacích stránkách.</span><span class="sxs-lookup"><span data-stu-id="c4614-630">Sets the display name shown to users on login pages.</span></span> |

<span data-ttu-id="c4614-631">**Model hostování mimo proces**</span><span class="sxs-lookup"><span data-stu-id="c4614-631">**Out-of-process hosting model**</span></span>

<span data-ttu-id="c4614-632">Chcete-li konfigurovat možnosti služby <xref:Microsoft.AspNetCore.Builder.IISOptions> <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>IIS, zahrňte konfiguraci služby v aplikaci .</span><span class="sxs-lookup"><span data-stu-id="c4614-632">To configure IIS options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="c4614-633">Následující příklad zabrání aplikaci v naplnění `HttpContext.Connection.ClientCertificate`:</span><span class="sxs-lookup"><span data-stu-id="c4614-633">The following example prevents the app from populating `HttpContext.Connection.ClientCertificate`:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="c4614-634">Možnost</span><span class="sxs-lookup"><span data-stu-id="c4614-634">Option</span></span>                         | <span data-ttu-id="c4614-635">Výchozí</span><span class="sxs-lookup"><span data-stu-id="c4614-635">Default</span></span> | <span data-ttu-id="c4614-636">Nastavení</span><span class="sxs-lookup"><span data-stu-id="c4614-636">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="c4614-637">Pokud `true` [middleware integrace služby IIS](#enable-the-iisintegration-components) nastaví ověřené ověřování systému `HttpContext.User` [Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-637">If `true`, [IIS Integration Middleware](#enable-the-iisintegration-components) sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="c4614-638">Pokud `false`middleware poskytuje identitu `HttpContext.User` a reaguje na problémy pouze na `AuthenticationScheme`žádost .</span><span class="sxs-lookup"><span data-stu-id="c4614-638">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="c4614-639">Aby bylo možné službu `AutomaticAuthentication` IIS fungovat, musí být ve službě IIS povoleno ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-639">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="c4614-640">Další informace naleznete v tématu [Ověřování systému Windows.](xref:security/authentication/windowsauth)</span><span class="sxs-lookup"><span data-stu-id="c4614-640">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="c4614-641">Nastaví zobrazované jméno zobrazené uživatelům na přihlašovacích stránkách.</span><span class="sxs-lookup"><span data-stu-id="c4614-641">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="c4614-642">Pokud `true` a `MS-ASPNETCORE-CLIENTCERT` hlavička požadavku `HttpContext.Connection.ClientCertificate` je k dispozici, je naplněn.</span><span class="sxs-lookup"><span data-stu-id="c4614-642">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="c4614-643">Scénáře proxy serveru a vyrovnávání zatížení</span><span class="sxs-lookup"><span data-stu-id="c4614-643">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="c4614-644">[Middleware integrace služby IIS](#enable-the-iisintegration-components), který konfiguruje middleware předávaných záhlaví a ASP.NET základní modul, jsou nakonfigurovány tak, aby předávaly schéma (HTTP/HTTPS) a vzdálenou adresu IP, ze které požadavek pochází.</span><span class="sxs-lookup"><span data-stu-id="c4614-644">The [IIS Integration Middleware](#enable-the-iisintegration-components), which configures Forwarded Headers Middleware, and the ASP.NET Core Module are configured to forward the scheme (HTTP/HTTPS) and the remote IP address where the request originated.</span></span> <span data-ttu-id="c4614-645">Další konfigurace může být vyžadována pro aplikace hostované za dalšími proxy servery a nástroji pro vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="c4614-645">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="c4614-646">Další informace naleznete v [tématu Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="c4614-646">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="c4614-647">soubor web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-647">web.config file</span></span>

<span data-ttu-id="c4614-648">Soubor *web.config* konfiguruje [základní modul ASP.NET](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="c4614-648">The *web.config* file configures the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="c4614-649">Při publikování projektu je vytváření, transformace a publikování souboru *web.config* zpracováno cílem MSBuild (`_TransformWebConfig`).</span><span class="sxs-lookup"><span data-stu-id="c4614-649">Creating, transforming, and publishing the *web.config* file is handled by an MSBuild target (`_TransformWebConfig`) when the project is published.</span></span> <span data-ttu-id="c4614-650">Tento cíl je k dispozici v`Microsoft.NET.Sdk.Web`cílech sady Web SDK ( ).</span><span class="sxs-lookup"><span data-stu-id="c4614-650">This target is present in the Web SDK targets (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="c4614-651">Sada SDK je nastavena v horní části souboru projektu:</span><span class="sxs-lookup"><span data-stu-id="c4614-651">The SDK is set at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="c4614-652">Pokud soubor *web.config* není v projektu přítomen, je soubor vytvořen se správnou *processPath* a *argumenty* pro konfiguraci ASP.NET základnímodul a přesunutna do [publikovaného výstupu](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="c4614-652">If a *web.config* file isn't present in the project, the file is created with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="c4614-653">Pokud *web.config* soubor je přítomen v projektu, soubor je transformován se správným *processPath* a *argumenty* pro konfiguraci ASP.NET core modul a přesunuta do publikovaného výstupu.</span><span class="sxs-lookup"><span data-stu-id="c4614-653">If a *web.config* file is present in the project, the file is transformed with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="c4614-654">Transformace nezmění nastavení konfigurace služby IIS v souboru.</span><span class="sxs-lookup"><span data-stu-id="c4614-654">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="c4614-655">Soubor *web.config* může poskytovat další nastavení konfigurace služby IIS, která řídí aktivní moduly služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-655">The *web.config* file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="c4614-656">Informace o modulech služby IIS, které jsou schopné zpracovávat požadavky pomocí aplikací ASP.NET Core, naleznete v tématu [modulů služby IIS.](xref:host-and-deploy/iis/modules)</span><span class="sxs-lookup"><span data-stu-id="c4614-656">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="c4614-657">Chcete-li zabránit webové sady SDK v transformaci souboru *web.config,* použijte vlastnost \*\* \<IsTransformWebConfigDisabled>\*\* v souboru projektu:</span><span class="sxs-lookup"><span data-stu-id="c4614-657">To prevent the Web SDK from transforming the *web.config* file, use the **\<IsTransformWebConfigDisabled>** property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="c4614-658">Při zakázání webové sady SDK z transformace souboru *processPath* a argumenty by měly být ručně *nastaveny* vývojářem.</span><span class="sxs-lookup"><span data-stu-id="c4614-658">When disabling the Web SDK from transforming the file, the *processPath* and *arguments* should be manually set by the developer.</span></span> <span data-ttu-id="c4614-659">Další informace naleznete v tématu <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="c4614-659">For more information, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="c4614-660">umístění souboru web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-660">web.config file location</span></span>

<span data-ttu-id="c4614-661">Aby bylo možné správně nastavit [ASP.NET core modul,](xref:host-and-deploy/aspnet-core-module) musí být soubor *web.config* přítomen na [cestě kořenového obsahu](xref:fundamentals/index#content-root) (obvykle základní cesta aplikace) nasazené aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-661">In order to set up the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) correctly, the *web.config* file must be present at the [content root](xref:fundamentals/index#content-root) path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="c4614-662">Jedná se o stejné umístění jako fyzická cesta k webu poskytnutá službu IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-662">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="c4614-663">Soubor *web.config* je vyžadován v kořenovém adresáři aplikace, aby bylo možné publikovat více aplikací pomocí nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-663">The *web.config* file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="c4614-664">Na fyzické cestě aplikace existují citlivé soubory, například \* \<assembly>.runtimeconfig.json*, \* \<assembly>.xml* (komentáře xml documentation) a \* \<assembly>.deps.json\*.</span><span class="sxs-lookup"><span data-stu-id="c4614-664">Sensitive files exist on the app's physical path, such as *\<assembly>.runtimeconfig.json*, *\<assembly>.xml* (XML Documentation comments), and *\<assembly>.deps.json*.</span></span> <span data-ttu-id="c4614-665">Pokud je soubor *web.config* přítomen a web se spustí normálně, služby IIS tyto citlivé soubory neobsluhuje, pokud jsou požadovány.</span><span class="sxs-lookup"><span data-stu-id="c4614-665">When the *web.config* file is present and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="c4614-666">Pokud soubor *web.config* chybí, je nesprávně pojmenován nebo jej nelze nakonfigurovat pro normální spuštění, může služba IIS veřejně sloužit citlivým souborům.</span><span class="sxs-lookup"><span data-stu-id="c4614-666">If the *web.config* file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="c4614-667">**Soubor *web.config* musí být v nasazení vždy přítomen, správně pojmenovaný a musí být schopen nakonfigurovat web pro normální spuštění. Nikdy neodstraňujte soubor *web.config* z produkčního nasazení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-667">**The *web.config* file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the *web.config* file from a production deployment.**</span></span>

### <a name="transform-webconfig"></a><span data-ttu-id="c4614-668">Transformace souboru web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-668">Transform web.config</span></span>

<span data-ttu-id="c4614-669">Pokud potřebujete transformovat *web.config* při publikování (například nastavit proměnné prostředí na základě konfigurace, profilu nebo prostředí), přečtěte si viz <xref:host-and-deploy/iis/transform-webconfig>.</span><span class="sxs-lookup"><span data-stu-id="c4614-669">If you need to transform *web.config* on publish (for example, set environment variables based on the configuration, profile, or environment), see <xref:host-and-deploy/iis/transform-webconfig>.</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="c4614-670">Konfigurace služby IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-670">IIS configuration</span></span>

<span data-ttu-id="c4614-671">**Operační systémy Windows Server**</span><span class="sxs-lookup"><span data-stu-id="c4614-671">**Windows Server operating systems**</span></span>

<span data-ttu-id="c4614-672">Povolte roli serveru **webového serveru (IIS)** a vytvořte služby rolí.</span><span class="sxs-lookup"><span data-stu-id="c4614-672">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="c4614-673">Použijte Průvodce **přidáním rolí a funkcí** z nabídky **Spravovat** nebo odkaz ve **Správci serveru**.</span><span class="sxs-lookup"><span data-stu-id="c4614-673">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager**.</span></span> <span data-ttu-id="c4614-674">V kroku **Role serveru** zaškrtněte políčko **U webového serveru (IIS).**</span><span class="sxs-lookup"><span data-stu-id="c4614-674">On the **Server Roles** step, check the box for **Web Server (IIS)**.</span></span>

   ![Role služby IIS webového serveru je vybrána v kroku Vybrat role serveru.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="c4614-676">Po kroku **Funkce** se krok **služby role** načte pro webový server (IIS).</span><span class="sxs-lookup"><span data-stu-id="c4614-676">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="c4614-677">Vyberte požadované služby rolí služby IIS nebo přijměte výchozí služby rolí, které jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="c4614-677">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![Výchozí služby rolí jsou vybrány v kroku Vybrat služby rolí.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="c4614-679">**Ověřování systému Windows (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-679">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="c4614-680">Chcete-li povolit ověřování systému Windows, rozbalte následující uzly:**Zabezpečení** **webového serveru** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-680">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security**.</span></span> <span data-ttu-id="c4614-681">Vyberte funkci **Ověřování systému Windows.**</span><span class="sxs-lookup"><span data-stu-id="c4614-681">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="c4614-682">Další informace naleznete v [tématech Ověřování \<systému Windows windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) a Konfigurace ověřování [systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-682">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="c4614-683">**WebSockets (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-683">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="c4614-684">WebSockets je podporován ASP.NET jádrem 1.1 nebo novějším.</span><span class="sxs-lookup"><span data-stu-id="c4614-684">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="c4614-685">Chcete-li povolit rozhraní WebSockets, rozbalte následující uzly:**Vývoj aplikací webového** **serveru** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-685">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development**.</span></span> <span data-ttu-id="c4614-686">Vyberte funkci **WebSocket Protocol.**</span><span class="sxs-lookup"><span data-stu-id="c4614-686">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="c4614-687">Další informace naleznete v tématu [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="c4614-687">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="c4614-688">Pokračujte v **potvrzovacím** kroku a nainstalujte roli a služby webového serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-688">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="c4614-689">Po instalaci role **webového serveru (IIS)** není restartování serveru nebo služby IIS vyžadováno.</span><span class="sxs-lookup"><span data-stu-id="c4614-689">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="c4614-690">**Desktopové operační systémy Windows**</span><span class="sxs-lookup"><span data-stu-id="c4614-690">**Windows desktop operating systems**</span></span>

<span data-ttu-id="c4614-691">Povolte **konzolu pro správu služby IIS** a **služby World Wide Web Services**.</span><span class="sxs-lookup"><span data-stu-id="c4614-691">Enable the **IIS Management Console** and **World Wide Web Services**.</span></span>

1. <span data-ttu-id="c4614-692">Přejděte na **Ovládací panely** > **Programy** > **a funkce** > **Zapněte nebo vypněte funkce systému Windows** (levá strana obrazovky).</span><span class="sxs-lookup"><span data-stu-id="c4614-692">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="c4614-693">Otevřete uzel **Internetové informační služby.**</span><span class="sxs-lookup"><span data-stu-id="c4614-693">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="c4614-694">Otevřete uzel **Nástroje pro správu webu.**</span><span class="sxs-lookup"><span data-stu-id="c4614-694">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="c4614-695">Zaškrtněte políčko **U konzole pro správu služby IIS**.</span><span class="sxs-lookup"><span data-stu-id="c4614-695">Check the box for **IIS Management Console**.</span></span>

1. <span data-ttu-id="c4614-696">Zaškrtněte políčko **U služeb World Wide Web Services**.</span><span class="sxs-lookup"><span data-stu-id="c4614-696">Check the box for **World Wide Web Services**.</span></span>

1. <span data-ttu-id="c4614-697">Přijměte výchozí funkce **pro služby World Wide Web Services** nebo upravte funkce služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-697">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="c4614-698">**Ověřování systému Windows (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-698">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="c4614-699">Chcete-li povolit ověřování systému Windows, rozbalte následující uzly: **World Wide Web Services** > **Security**.</span><span class="sxs-lookup"><span data-stu-id="c4614-699">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security**.</span></span> <span data-ttu-id="c4614-700">Vyberte funkci **Ověřování systému Windows.**</span><span class="sxs-lookup"><span data-stu-id="c4614-700">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="c4614-701">Další informace naleznete v [tématech Ověřování \<systému Windows windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) a Konfigurace ověřování [systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-701">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="c4614-702">**WebSockets (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-702">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="c4614-703">WebSockets je podporován ASP.NET jádrem 1.1 nebo novějším.</span><span class="sxs-lookup"><span data-stu-id="c4614-703">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="c4614-704">Chcete-li povolit rozhraní WebSockets, rozbalte následující uzly: Funkce**vývoje aplikací**pro **webové služby** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-704">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features**.</span></span> <span data-ttu-id="c4614-705">Vyberte funkci **WebSocket Protocol.**</span><span class="sxs-lookup"><span data-stu-id="c4614-705">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="c4614-706">Další informace naleznete v tématu [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="c4614-706">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="c4614-707">Pokud instalace služby IIS vyžaduje restartování, restartujte systém.</span><span class="sxs-lookup"><span data-stu-id="c4614-707">If the IIS installation requires a restart, restart the system.</span></span>

![V funkcích systému Windows jsou vybrány konzoly IIS Management Console a služby World Wide Web Services.](index/_static/windows-features-win10.png)

## <a name="install-the-net-core-hosting-bundle"></a><span data-ttu-id="c4614-709">Instalace balíčku hostingu jádra .NET</span><span class="sxs-lookup"><span data-stu-id="c4614-709">Install the .NET Core Hosting Bundle</span></span>

<span data-ttu-id="c4614-710">Nainstalujte *balíček .NET Core Hosting do* hostitelského systému.</span><span class="sxs-lookup"><span data-stu-id="c4614-710">Install the *.NET Core Hosting Bundle* on the hosting system.</span></span> <span data-ttu-id="c4614-711">Balíček nainstaluje modul .NET Core Runtime, knihovnu .NET Core Library a [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="c4614-711">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="c4614-712">Modul umožňuje ASP.NET aplikace Core běžet za službou IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-712">The module allows ASP.NET Core apps to run behind IIS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c4614-713">Pokud je sada Hosting Bundle nainstalována před službou IIS, musí být instalace balíčku opravena.</span><span class="sxs-lookup"><span data-stu-id="c4614-713">If the Hosting Bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="c4614-714">Po instalaci služby IIS znovu spusťte instalační program sady Hosting Bundle.</span><span class="sxs-lookup"><span data-stu-id="c4614-714">Run the Hosting Bundle installer again after installing IIS.</span></span>
>
> <span data-ttu-id="c4614-715">Pokud je sada Hosting Bundle nainstalována po instalaci 64bitové (x64) verze rozhraní .NET Core, mohou se zdát, že sady SDK chybí ([byly zjištěny sady SDK .Net Core .](xref:test/troubleshoot#no-net-core-sdks-were-detected)</span><span class="sxs-lookup"><span data-stu-id="c4614-715">If the Hosting Bundle is installed after installing the 64-bit (x64) version of .NET Core, SDKs might appear to be missing ([No .NET Core SDKs were detected](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span></span> <span data-ttu-id="c4614-716">Chcete-li problém <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>vyřešit, naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-716">To resolve the problem, see <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span></span>

### <a name="download"></a><span data-ttu-id="c4614-717">Stáhnout</span><span class="sxs-lookup"><span data-stu-id="c4614-717">Download</span></span>

1. <span data-ttu-id="c4614-718">Přejděte na stránku [Stáhnout jádro rozhraní .NET.](https://dotnet.microsoft.com/download/dotnet-core)</span><span class="sxs-lookup"><span data-stu-id="c4614-718">Navigate to the [Download .NET Core](https://dotnet.microsoft.com/download/dotnet-core) page.</span></span>
1. <span data-ttu-id="c4614-719">Vyberte požadovanou verzi .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-719">Select the desired .NET Core version.</span></span>
1. <span data-ttu-id="c4614-720">Ve sloupci **Spustit aplikace – runtime** najděte požadovaný řádek požadované verze runtime .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-720">In the **Run apps - Runtime** column, find the row of the .NET Core runtime version desired.</span></span>
1. <span data-ttu-id="c4614-721">Stáhněte si instalační program pomocí odkazu **Hosting Bundle.**</span><span class="sxs-lookup"><span data-stu-id="c4614-721">Download the installer using the **Hosting Bundle** link.</span></span>

> [!WARNING]
> <span data-ttu-id="c4614-722">Některé instalační programy obsahují verze, které dosáhly konce životnosti (EOL) a které již nejsou podporovány společností Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c4614-722">Some installers contain release versions that have reached their end of life (EOL) and are no longer supported by Microsoft.</span></span> <span data-ttu-id="c4614-723">Další informace naleznete v [zásadách podpory](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span><span class="sxs-lookup"><span data-stu-id="c4614-723">For more information, see the [support policy](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span></span>

### <a name="install-the-hosting-bundle"></a><span data-ttu-id="c4614-724">Nainstalujte balíček hostingu</span><span class="sxs-lookup"><span data-stu-id="c4614-724">Install the Hosting Bundle</span></span>

1. <span data-ttu-id="c4614-725">Spusťte instalační program na serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-725">Run the installer on the server.</span></span> <span data-ttu-id="c4614-726">Při spuštění instalačního programu z příkazového prostředí správce jsou k dispozici následující parametry:</span><span class="sxs-lookup"><span data-stu-id="c4614-726">The following parameters are available when running the installer from an administrator command shell:</span></span>

   * <span data-ttu-id="c4614-727">`OPT_NO_ANCM=1`&ndash; Přeskočte instalaci ASP.NET základního modulu.</span><span class="sxs-lookup"><span data-stu-id="c4614-727">`OPT_NO_ANCM=1` &ndash; Skip installing the ASP.NET Core Module.</span></span>
   * <span data-ttu-id="c4614-728">`OPT_NO_RUNTIME=1`&ndash; Přeskočte instalaci runtime jádra .NET.</span><span class="sxs-lookup"><span data-stu-id="c4614-728">`OPT_NO_RUNTIME=1` &ndash; Skip installing the .NET Core runtime.</span></span> <span data-ttu-id="c4614-729">Používá se v případě, že server hostuje pouze [samostatná nasazení (SCD).](/dotnet/core/deploying/#self-contained-deployments-scd)</span><span class="sxs-lookup"><span data-stu-id="c4614-729">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="c4614-730">`OPT_NO_SHAREDFX=1`&ndash; Přeskočit instalaci ASP.NET sdíleného rozhraní (ASP.NET runtime).</span><span class="sxs-lookup"><span data-stu-id="c4614-730">`OPT_NO_SHAREDFX=1` &ndash; Skip installing the ASP.NET Shared Framework (ASP.NET runtime).</span></span> <span data-ttu-id="c4614-731">Používá se v případě, že server hostuje pouze [samostatná nasazení (SCD).](/dotnet/core/deploying/#self-contained-deployments-scd)</span><span class="sxs-lookup"><span data-stu-id="c4614-731">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="c4614-732">`OPT_NO_X86=1`&ndash; Přeskočit instalaci za běhu x86.</span><span class="sxs-lookup"><span data-stu-id="c4614-732">`OPT_NO_X86=1` &ndash; Skip installing x86 runtimes.</span></span> <span data-ttu-id="c4614-733">Tento parametr použijte, pokud víte, že nebudete hostovat 32bitové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-733">Use this parameter when you know that you won't be hosting 32-bit apps.</span></span> <span data-ttu-id="c4614-734">Pokud existuje nějaká šance, že budete v budoucnu hostovat 32bitové i 64bitové aplikace, nepoužívejte tento parametr a nainstalujte oba runtimes.</span><span class="sxs-lookup"><span data-stu-id="c4614-734">If there's any chance that you will host both 32-bit and 64-bit apps in the future, don't use this parameter and install both runtimes.</span></span>
   * <span data-ttu-id="c4614-735">`OPT_NO_SHARED_CONFIG_CHECK=1`&ndash; Zakažte kontrolu použití sdílené konfigurace služby IIS, pokud je sdílená konfigurace *(applicationHost.config)* ve stejném počítači jako instalace služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-735">`OPT_NO_SHARED_CONFIG_CHECK=1` &ndash; Disable the check for using an IIS Shared Configuration when the shared configuration (*applicationHost.config*) is on the same machine as the IIS installation.</span></span> <span data-ttu-id="c4614-736">*K dispozici pouze pro ASP.NET instalačních programů hostingu Bundler nebo novějším.*</span><span class="sxs-lookup"><span data-stu-id="c4614-736">*Only available for ASP.NET Core 2.2 or later Hosting Bundler installers.*</span></span> <span data-ttu-id="c4614-737">Další informace naleznete v tématu <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span><span class="sxs-lookup"><span data-stu-id="c4614-737">For more information, see <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span></span>
1. <span data-ttu-id="c4614-738">Restartujte systém nebo proveďte následující příkazy v příkazovém prostředí:</span><span class="sxs-lookup"><span data-stu-id="c4614-738">Restart the system or execute the following commands in a command shell:</span></span>

   ```console
   net stop was /y
   net start w3svc
   ```
   <span data-ttu-id="c4614-739">Restartování služby IIS vyvolá změnu systémové cesty, což je proměnná prostředí provedená instalačním programem.</span><span class="sxs-lookup"><span data-stu-id="c4614-739">Restarting IIS picks up a change to the system PATH, which is an environment variable, made by the installer.</span></span>

<span data-ttu-id="c4614-740">Při instalaci balíčku Hosting Bundle není nutné ručně zastavovat jednotlivé weby ve službách IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-740">It isn't necessary to manually stop individual sites in IIS when installing the Hosting Bundle.</span></span> <span data-ttu-id="c4614-741">Hostované aplikace (weby služby IIS) se restartují při restartování služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-741">Hosted apps (IIS sites) restart when IIS restarts.</span></span> <span data-ttu-id="c4614-742">Aplikace se znovu spustí, když obdrží svůj první požadavek, včetně z [modulu inicializace aplikace](#application-initialization-module-and-idle-timeout).</span><span class="sxs-lookup"><span data-stu-id="c4614-742">Apps start up again when they receive their first request, including from the [Application Initialization Module](#application-initialization-module-and-idle-timeout).</span></span>

<span data-ttu-id="c4614-743">ASP.NET Core přijímá roll-forward chování pro opravy vydání sdílených rámců.</span><span class="sxs-lookup"><span data-stu-id="c4614-743">ASP.NET Core adopts roll-forward behavior for patch releases of shared framework packages.</span></span> <span data-ttu-id="c4614-744">Když se aplikace hostované službou IIS restartují se službou IIS, aplikace se načítají nejnovějšími verzemi oprav svých odkazovaných balíčků, když obdrží svůj první požadavek.</span><span class="sxs-lookup"><span data-stu-id="c4614-744">When apps hosted by IIS restart with IIS, the apps load with the latest patch releases of their referenced packages when they receive their first request.</span></span> <span data-ttu-id="c4614-745">Pokud služba IIS není restartována, aplikace se restartují a vykazují chování pro předávání vpřed, když jsou jejich pracovní procesy recyklovány a obdrží první požadavek.</span><span class="sxs-lookup"><span data-stu-id="c4614-745">If IIS isn't restarted, apps restart and exhibit roll-forward behavior when their worker processes are recycled and they receive their first request.</span></span>

> [!NOTE]
> <span data-ttu-id="c4614-746">Informace o sdílené konfiguraci služby IIS naleznete [v tématu ASP.NET Core Module se sdílenou konfigurací služby IIS](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span><span class="sxs-lookup"><span data-stu-id="c4614-746">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="c4614-747">Instalace nasazení webu při publikování pomocí sady Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c4614-747">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="c4614-748">Při nasazování aplikací na servery s [nasazením webu](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later)nainstalujte na server nejnovější verzi nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-748">When deploying apps to servers with [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="c4614-749">Chcete-li nainstalovat nasazení webu, použijte [Instalační službu webové platformy (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) nebo získejte instalační program přímo ze [služby Stažení softwaru](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="c4614-749">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="c4614-750">Upřednostňovanou metodou je použití webpi.</span><span class="sxs-lookup"><span data-stu-id="c4614-750">The preferred method is to use WebPI.</span></span> <span data-ttu-id="c4614-751">WebPI nabízí samostatné nastavení a konfiguraci pro poskytovatele hostingu.</span><span class="sxs-lookup"><span data-stu-id="c4614-751">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="c4614-752">Vytvoření webu iis</span><span class="sxs-lookup"><span data-stu-id="c4614-752">Create the IIS site</span></span>

1. <span data-ttu-id="c4614-753">V hostitelském systému vytvořte složku, která bude obsahovat publikované složky a soubory aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-753">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="c4614-754">V následujícím kroku je cesta ke složce k dispozici službu IIS jako fyzická cesta k aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-754">In a following step, the folder's path is provided to IIS as the physical path to the app.</span></span> <span data-ttu-id="c4614-755">Další informace o složce nasazení aplikace a <xref:host-and-deploy/directory-structure>rozložení souborů naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-755">For more information on an app's deployment folder and file layout, see <xref:host-and-deploy/directory-structure>.</span></span>

1. <span data-ttu-id="c4614-756">Ve Správci služby IIS otevřete uzel serveru v panelu **Připojení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-756">In IIS Manager, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="c4614-757">Klikněte pravým tlačítkem myši na složku **Weby.**</span><span class="sxs-lookup"><span data-stu-id="c4614-757">Right-click the **Sites** folder.</span></span> <span data-ttu-id="c4614-758">V kontextové nabídce vyberte **Přidat web.**</span><span class="sxs-lookup"><span data-stu-id="c4614-758">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="c4614-759">Zadejte **název webu** a nastavte **fyzickou cestu** ke složce nasazení aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-759">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="c4614-760">Zadejte konfiguraci **vazby** a vytvořte web výběrem **možnosti OK**:</span><span class="sxs-lookup"><span data-stu-id="c4614-760">Provide the **Binding** configuration and create the website by selecting **OK**:</span></span>

   ![V kroku Přidat web zadejte název webu, fyzickou cestu a název hostitele.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="c4614-762">Vazby se zástupnými`http://*:80/` symboly nejvyšší úrovně ( a `http://+:80`) by **neměly** být používány.</span><span class="sxs-lookup"><span data-stu-id="c4614-762">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="c4614-763">Vazby se zástupnými symboly nejvyšší úrovně mohou otevřít vaši aplikaci slabá místa zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="c4614-763">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="c4614-764">To platí pro silné i slabé zástupné znaky.</span><span class="sxs-lookup"><span data-stu-id="c4614-764">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="c4614-765">Používejte explicitní názvy hostitelů místo zástupných znaků.</span><span class="sxs-lookup"><span data-stu-id="c4614-765">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="c4614-766">Vazba se zástupnými znaky subdomény (například) nemá toto bezpečnostní riziko, `*.mysub.com` `*.com`pokud řídíte celou nadřazenou doménu (na rozdíl od , která je zranitelná).</span><span class="sxs-lookup"><span data-stu-id="c4614-766">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="c4614-767">Viz [rfc7230 sekce-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) pro více informací.</span><span class="sxs-lookup"><span data-stu-id="c4614-767">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="c4614-768">Pod uzlovým serverem vyberte **fondy aplikací**.</span><span class="sxs-lookup"><span data-stu-id="c4614-768">Under the server's node, select **Application Pools**.</span></span>

1. <span data-ttu-id="c4614-769">Klikněte pravým tlačítkem myši na fond aplikací webu a v kontextové nabídce vyberte **Základní nastavení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-769">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="c4614-770">V okně **Upravit fond aplikací** nastavte verzi **.NET CLR** na **Žádný spravovaný kód**:</span><span class="sxs-lookup"><span data-stu-id="c4614-770">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code**:</span></span>

   ![Pro verzi CLR rozhraní .NET nenastavte žádný spravovaný kód.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="c4614-772">ASP.NET Core běží v samostatném procesu a spravuje runtime.</span><span class="sxs-lookup"><span data-stu-id="c4614-772">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="c4614-773">ASP.NET Core nespoléhá na načtení plochy CLR (.NET CLR)&mdash;Core Common Language Runtime (CoreCLR) pro .NET Core je spuštěn pro hostování aplikace v pracovním procesu.</span><span class="sxs-lookup"><span data-stu-id="c4614-773">ASP.NET Core doesn't rely on loading the desktop CLR (.NET CLR)&mdash;the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process.</span></span> <span data-ttu-id="c4614-774">Nastavení **verze .NET CLR** na **žádný spravovaný kód** je volitelné, ale doporučeno.</span><span class="sxs-lookup"><span data-stu-id="c4614-774">Setting the **.NET CLR version** to **No Managed Code** is optional but recommended.</span></span>

1. <span data-ttu-id="c4614-775">*ASP.NET jádra 2.2 nebo novějšího:* Pro 64bitové (x64) [samostatné nasazení,](/dotnet/core/deploying/#self-contained-deployments-scd) které používá [model hostování v procesu](#in-process-hosting-model), zakažte fond aplikací pro 32bitové (x86) procesy.</span><span class="sxs-lookup"><span data-stu-id="c4614-775">*ASP.NET Core 2.2 or later*: For a 64-bit (x64) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) that uses the [in-process hosting model](#in-process-hosting-model), disable the app pool for 32-bit (x86) processes.</span></span>

   <span data-ttu-id="c4614-776">V postranním panelu **Akce** správce služby IIS > **fondy aplikací**vyberte **možnost Nastavit výchozí nastavení fondu aplikací** nebo **Upřesnit nastavení**.</span><span class="sxs-lookup"><span data-stu-id="c4614-776">In the **Actions** sidebar of IIS Manager > **Application Pools**, select **Set Application Pool Defaults** or **Advanced Settings**.</span></span> <span data-ttu-id="c4614-777">Vyhledejte **funkci Povolit 32bitové aplikace** a nastavte hodnotu na . `False`</span><span class="sxs-lookup"><span data-stu-id="c4614-777">Locate **Enable 32-Bit Applications** and set the value to `False`.</span></span> <span data-ttu-id="c4614-778">Toto nastavení nemá vliv na aplikace nasazené pro [mimoprocesový hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span><span class="sxs-lookup"><span data-stu-id="c4614-778">This setting doesn't affect apps deployed for [out-of-process hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span></span>

1. <span data-ttu-id="c4614-779">Potvrďte, že identita modelu procesu má správná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="c4614-779">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="c4614-780">Pokud se výchozí identita fondu aplikací **(identita\*\*\*\*procesního modelu** > ) změní z **ApplicationPoolIdentity** na jinou identitu, ověřte, zda nová identita má požadovaná oprávnění pro přístup ke složce, databázi a dalším požadovaným prostředkům aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-780">If the default identity of the app pool (**Process Model** > **Identity**) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="c4614-781">Fond aplikací například vyžaduje přístup pro čtení a zápis do složek, kde aplikace čte a zapisuje soubory.</span><span class="sxs-lookup"><span data-stu-id="c4614-781">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="c4614-782">**Konfigurace ověřování systému Windows (volitelná)**</span><span class="sxs-lookup"><span data-stu-id="c4614-782">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="c4614-783">Další informace naleznete v [tématu Configure Windows authentication](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-783">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="c4614-784">Nasazení aplikace</span><span class="sxs-lookup"><span data-stu-id="c4614-784">Deploy the app</span></span>

<span data-ttu-id="c4614-785">Nasaďte aplikaci do složky **Fyzické cesty** služby IIS, která byla vytvořena v části Vytvořit [web služby IIS.](#create-the-iis-site)</span><span class="sxs-lookup"><span data-stu-id="c4614-785">Deploy the app to the IIS **Physical path** folder that was established in the [Create the IIS site](#create-the-iis-site) section.</span></span> <span data-ttu-id="c4614-786">[Nasazení webu](/iis/publish/using-web-deploy/introduction-to-web-deploy) je doporučený mechanismus pro nasazení, ale existuje několik možností pro přesunutí aplikace ze složky *publikování* projektu do složky nasazení hostitelského systému.</span><span class="sxs-lookup"><span data-stu-id="c4614-786">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment, but several options exist for moving the app from the project's *publish* folder to the hosting system's deployment folder.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="c4614-787">Nasazení webu pomocí sady Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c4614-787">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="c4614-788">Podívejte se na [profily publikování aplikace Visual Studio pro téma nasazení aplikace ASP.NET Core,](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) kde se dozvíte, jak vytvořit profil publikování pro použití s nasazením webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-788">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="c4614-789">Pokud poskytovatel hostingu poskytuje profil publikování nebo podporu pro jeho vytvoření, stáhněte si jeho profil a importujte jej pomocí dialogového okna **Publikovat** sady Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="c4614-789">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog:</span></span>

![Stránka dialogového okna Publikovat](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="c4614-791">Nasazení webu mimo Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c4614-791">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="c4614-792">[Nasazení webu](/iis/publish/using-web-deploy/introduction-to-web-deploy) lze také použít mimo Visual Studio z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="c4614-792">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="c4614-793">Další informace naleznete v [tématu Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="c4614-793">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="c4614-794">Alternativy k nasazení webu</span><span class="sxs-lookup"><span data-stu-id="c4614-794">Alternatives to Web Deploy</span></span>

<span data-ttu-id="c4614-795">Pomocí některé z několika metod přesuňte aplikaci do hostitelského systému, jako je ruční kopírování, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy)nebo [PowerShell](/powershell/).</span><span class="sxs-lookup"><span data-stu-id="c4614-795">Use any of several methods to move the app to the hosting system, such as manual copy, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy), or [PowerShell](/powershell/).</span></span>

<span data-ttu-id="c4614-796">Další informace o ASP.NET nasazení jádra do služby IIS naleznete v části [Prostředky nasazení pro správce služby IIS.](#deployment-resources-for-iis-administrators)</span><span class="sxs-lookup"><span data-stu-id="c4614-796">For more information on ASP.NET Core deployment to IIS, see the [Deployment resources for IIS administrators](#deployment-resources-for-iis-administrators) section.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="c4614-797">Procházení webu</span><span class="sxs-lookup"><span data-stu-id="c4614-797">Browse the website</span></span>

<span data-ttu-id="c4614-798">Po nasazení aplikace do hostitelského systému požádejte o jeden z veřejných koncových bodů aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-798">After the app is deployed to the hosting system, make a request to one of the app's public endpoints.</span></span>

<span data-ttu-id="c4614-799">V následujícím příkladu je web vázán na název `www.mysite.com` **hostitele** iis na **portu** `80`.</span><span class="sxs-lookup"><span data-stu-id="c4614-799">In the following example, the site is bound to an IIS **Host name** of `www.mysite.com` on **Port** `80`.</span></span> <span data-ttu-id="c4614-800">Žádost se podává `http://www.mysite.com`na :</span><span class="sxs-lookup"><span data-stu-id="c4614-800">A request is made to `http://www.mysite.com`:</span></span>

![Prohlížeč Microsoft Edge načetl úvodní stránku služby IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="c4614-802">Uzamčené soubory nasazení</span><span class="sxs-lookup"><span data-stu-id="c4614-802">Locked deployment files</span></span>

<span data-ttu-id="c4614-803">Soubory ve složce nasazení jsou uzamčeny, když je aplikace spuštěná.</span><span class="sxs-lookup"><span data-stu-id="c4614-803">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="c4614-804">Uzamčené soubory nelze během nasazení přepsat.</span><span class="sxs-lookup"><span data-stu-id="c4614-804">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="c4614-805">Chcete-li uvolnit uzamčené soubory v nasazení, zastavte fond aplikací pomocí **jednoho z** následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-805">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="c4614-806">Použijte nasazení webu `Microsoft.NET.Sdk.Web` a odkaz v souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="c4614-806">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="c4614-807">Soubor *app_offline.htm* je umístěn v kořenovém adresáři webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-807">An *app_offline.htm* file is placed at the root of the web app directory.</span></span> <span data-ttu-id="c4614-808">Když je soubor k dispozici, ASP.NET základní modul řádně vypne aplikaci a slouží *souboru app_offline.htm* během nasazení.</span><span class="sxs-lookup"><span data-stu-id="c4614-808">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the *app_offline.htm* file during the deployment.</span></span> <span data-ttu-id="c4614-809">Další informace naleznete v [odkazu na konfiguraci ASP.NET core modulem](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span><span class="sxs-lookup"><span data-stu-id="c4614-809">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span></span>
* <span data-ttu-id="c4614-810">Ručně zastavit fond aplikací ve Správci služby IIS na serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-810">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="c4614-811">Použití Prostředí PowerShell k přetažení *app_offline.htm* (vyžaduje PowerShell 5 nebo novější):</span><span class="sxs-lookup"><span data-stu-id="c4614-811">Use PowerShell to drop *app_offline.htm* (requires PowerShell 5 or later):</span></span>

  ```powershell
  $pathToApp = 'PATH_TO_APP'

  # Stop the AppPool
  New-Item -Path $pathToApp app_offline.htm

  # Provide script commands here to deploy the app

  # Restart the AppPool
  Remove-Item -Path $pathToApp app_offline.htm

  ```

## <a name="data-protection"></a><span data-ttu-id="c4614-812">Ochrana dat</span><span class="sxs-lookup"><span data-stu-id="c4614-812">Data protection</span></span>

<span data-ttu-id="c4614-813">Zásobník [ASP.NET Core Data Protection](xref:security/data-protection/introduction) používá několik [middlewares](xref:fundamentals/middleware/index)ASP.NET Core , včetně middlewaru používaného při ověřování.</span><span class="sxs-lookup"><span data-stu-id="c4614-813">The [ASP.NET Core Data Protection stack](xref:security/data-protection/introduction) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="c4614-814">I v případě, že rozhraní API ochrany dat nejsou volána uživatelským kódem, ochrana dat by měla být nakonfigurována pomocí skriptu nasazení nebo v uživatelském kódu, aby se vytvořilo trvalé úložiště kryptografických [klíčů](xref:security/data-protection/implementation/key-management).</span><span class="sxs-lookup"><span data-stu-id="c4614-814">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="c4614-815">Pokud ochrana dat není nakonfigurována, klíče jsou uloženy v paměti a po restartování aplikace zahozeny.</span><span class="sxs-lookup"><span data-stu-id="c4614-815">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="c4614-816">Pokud je kroužek klíče uložen v paměti při restartování aplikace:</span><span class="sxs-lookup"><span data-stu-id="c4614-816">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="c4614-817">Všechny ověřovací tokeny založené na souborech cookie jsou zrušeny.</span><span class="sxs-lookup"><span data-stu-id="c4614-817">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="c4614-818">Uživatelé se musí znovu přihlásit při dalším požadavku.</span><span class="sxs-lookup"><span data-stu-id="c4614-818">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="c4614-819">Všechna data chráněná kroužkem klíče již nelze dešifrovat.</span><span class="sxs-lookup"><span data-stu-id="c4614-819">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="c4614-820">To může zahrnovat [tokeny CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) a [ASP.NET základní soubory cookie MVC TempData](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="c4614-820">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="c4614-821">Chcete-li nakonfigurovat ochranu dat ve službě IIS tak, aby zachycovací byl kroužek klíče, použijte **jeden** z následujících postupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-821">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="c4614-822">**Vytvoření klíčů registru ochrany dat**</span><span class="sxs-lookup"><span data-stu-id="c4614-822">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="c4614-823">Klíče ochrany dat používané ASP.NET aplikace Core jsou uloženy v registru mimo aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-823">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="c4614-824">Chcete-li zachovat klíče pro danou aplikaci, vytvořte klíče registru pro fond aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-824">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="c4614-825">Pro samostatné instalace služby IIS mimo webfarmu lze [skript prostředí PowerShell Pro poskytování ochrany dat-AutoGenKeys.ps1](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) použít pro každý fond aplikací používaný s aplikací ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-825">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="c4614-826">Tento skript vytvoří klíč registru v registru HKLM, který je přístupný pouze pro účet pracovního procesu fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-826">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="c4614-827">Klíče jsou šifrovány v klidovém stavu pomocí dpapi s klíčem pro celý počítač.</span><span class="sxs-lookup"><span data-stu-id="c4614-827">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="c4614-828">Ve scénářích webové farmy lze aplikaci nakonfigurovat tak, aby k ukládání kroužku klíčů pro ochranu dat používala cestu UNC.</span><span class="sxs-lookup"><span data-stu-id="c4614-828">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="c4614-829">Ve výchozím nastavení nejsou klíče ochrany dat šifrovány.</span><span class="sxs-lookup"><span data-stu-id="c4614-829">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="c4614-830">Ujistěte se, že oprávnění k souborům pro sdílenou síť ovou složku jsou omezena na účet Windows, pod kterým aplikace běží.</span><span class="sxs-lookup"><span data-stu-id="c4614-830">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="c4614-831">Certifikát X509 lze použít k ochraně klíčů v klidovém stavu.</span><span class="sxs-lookup"><span data-stu-id="c4614-831">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="c4614-832">Zvažte mechanismus, který uživatelům umožní nahrávat certifikáty: Umístěte certifikáty do úložiště důvěryhodných certifikátů uživatele a ujistěte se, že jsou k dispozici na všech počítačích, kde je spuštěna aplikace uživatele.</span><span class="sxs-lookup"><span data-stu-id="c4614-832">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="c4614-833">Podrobnosti [najdete v tématu Konfigurace ochrany základních dat ASP.NET.](xref:security/data-protection/configuration/overview)</span><span class="sxs-lookup"><span data-stu-id="c4614-833">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="c4614-834">**Konfigurace fondu aplikací služby IIS pro načtení profilu uživatele**</span><span class="sxs-lookup"><span data-stu-id="c4614-834">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="c4614-835">Toto nastavení je v části **Model procesu** v části **Upřesnit nastavení** pro fond aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-835">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="c4614-836">Nastavte **profil načtení uživatele** na `True`.</span><span class="sxs-lookup"><span data-stu-id="c4614-836">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="c4614-837">Pokud je `True`nastavena možnost , jsou klíče uloženy v adresáři profilu uživatele a chráněny pomocí rozhraní DPAPI klíčem specifickým pro uživatelský účet.</span><span class="sxs-lookup"><span data-stu-id="c4614-837">When set to `True`, keys are stored in the user profile directory and protected using DPAPI with a key specific to the user account.</span></span> <span data-ttu-id="c4614-838">Klíče jsou uloženy ve složce *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys.*</span><span class="sxs-lookup"><span data-stu-id="c4614-838">Keys are persisted to the *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys* folder.</span></span>

  <span data-ttu-id="c4614-839">[Atribut setProfileEnvironment](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) fondu aplikací musí být také povolen.</span><span class="sxs-lookup"><span data-stu-id="c4614-839">The app pool's [setProfileEnvironment attribute](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) must also be enabled.</span></span> <span data-ttu-id="c4614-840">Výchozí hodnota `setProfileEnvironment` je `true`.</span><span class="sxs-lookup"><span data-stu-id="c4614-840">The default value of `setProfileEnvironment` is `true`.</span></span> <span data-ttu-id="c4614-841">V některých scénářích (například `setProfileEnvironment` operační `false`systém Windows) je nastavena na .</span><span class="sxs-lookup"><span data-stu-id="c4614-841">In some scenarios (for example, Windows OS), `setProfileEnvironment` is set to `false`.</span></span> <span data-ttu-id="c4614-842">Pokud klíče nejsou uloženy v adresáři profilu uživatele podle očekávání:</span><span class="sxs-lookup"><span data-stu-id="c4614-842">If keys aren't stored in the user profile directory as expected:</span></span>

  1. <span data-ttu-id="c4614-843">Přejděte do složky *%windir%/system32/inetsrv/config.*</span><span class="sxs-lookup"><span data-stu-id="c4614-843">Navigate to the *%windir%/system32/inetsrv/config* folder.</span></span>
  1. <span data-ttu-id="c4614-844">Otevřete soubor *applicationHost.config.*</span><span class="sxs-lookup"><span data-stu-id="c4614-844">Open the *applicationHost.config* file.</span></span>
  1. <span data-ttu-id="c4614-845">Vyhledejte element `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>`.</span><span class="sxs-lookup"><span data-stu-id="c4614-845">Locate the `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span></span>
  1. <span data-ttu-id="c4614-846">Zkontrolujte, `setProfileEnvironment` zda atribut není k dispozici, `true`což je výchozí hodnota na `true`, nebo explicitně nastavte hodnotu atributu na .</span><span class="sxs-lookup"><span data-stu-id="c4614-846">Confirm that the `setProfileEnvironment` attribute isn't present, which defaults the value to `true`, or explicitly set the attribute's value to `true`.</span></span>

* <span data-ttu-id="c4614-847">**Použití systému souborů jako úložiště kroužků na klíče**</span><span class="sxs-lookup"><span data-stu-id="c4614-847">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="c4614-848">Upravte kód aplikace tak, aby [používal systém souborů jako úložiště kroužků klíčů](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="c4614-848">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="c4614-849">K ochraně kroužku na klíče a zajištění, že certifikát je důvěryhodný, použijte certifikát X509.</span><span class="sxs-lookup"><span data-stu-id="c4614-849">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="c4614-850">Pokud je certifikát podepsaný svým držitelem, umístěte jej do úložiště Důvěryhodného kořenového adresáře.</span><span class="sxs-lookup"><span data-stu-id="c4614-850">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="c4614-851">Při použití služby IIS ve webové farmě:</span><span class="sxs-lookup"><span data-stu-id="c4614-851">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="c4614-852">Použijte sdílenou složku, ke které mají přístup všechny počítače.</span><span class="sxs-lookup"><span data-stu-id="c4614-852">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="c4614-853">Nasazení certifikátu X509 do každého počítače.</span><span class="sxs-lookup"><span data-stu-id="c4614-853">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="c4614-854">Konfigurace [ochrany dat v kódu](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="c4614-854">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="c4614-855">**Nastavení celopočítačových zásad pro ochranu dat**</span><span class="sxs-lookup"><span data-stu-id="c4614-855">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="c4614-856">Systém ochrany dat má omezenou podporu pro nastavení výchozí [zásady celého počítače](xref:security/data-protection/configuration/machine-wide-policy) pro všechny aplikace, které spotřebovávají data protection API.</span><span class="sxs-lookup"><span data-stu-id="c4614-856">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="c4614-857">Další informace naleznete v tématu <xref:security/data-protection/introduction>.</span><span class="sxs-lookup"><span data-stu-id="c4614-857">For more information, see <xref:security/data-protection/introduction>.</span></span>

## <a name="virtual-directories"></a><span data-ttu-id="c4614-858">Virtuální adresáře</span><span class="sxs-lookup"><span data-stu-id="c4614-858">Virtual Directories</span></span>

<span data-ttu-id="c4614-859">[Virtuální adresáře služby IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) nejsou podporovány aplikacemi ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-859">[IIS Virtual Directories](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) aren't supported with ASP.NET Core apps.</span></span> <span data-ttu-id="c4614-860">Aplikace může být hostována jako [podaplikace](#sub-applications).</span><span class="sxs-lookup"><span data-stu-id="c4614-860">An app can be hosted as a [sub-application](#sub-applications).</span></span>

## <a name="sub-applications"></a><span data-ttu-id="c4614-861">Dílčí aplikace</span><span class="sxs-lookup"><span data-stu-id="c4614-861">Sub-applications</span></span>

<span data-ttu-id="c4614-862">Aplikaci ASP.NET Core lze hostovat jako [podaplikaci služby IIS (podaplikaci).](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications)</span><span class="sxs-lookup"><span data-stu-id="c4614-862">An ASP.NET Core app can be hosted as an [IIS sub-application (sub-app)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span></span> <span data-ttu-id="c4614-863">Cesta podaplikace se stane součástí adresy URL kořenové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-863">The sub-app's path becomes part of the root app's URL.</span></span>

<span data-ttu-id="c4614-864">Statické odkazy datových zdrojů v rámci podaplikace`~/`by měly používat zápis tildového lomítka ( ).</span><span class="sxs-lookup"><span data-stu-id="c4614-864">Static asset links within the sub-app should use tilde-slash (`~/`) notation.</span></span> <span data-ttu-id="c4614-865">Zápis tildového lomítka aktivuje [pomocníka tagu,](xref:mvc/views/tag-helpers/intro) který předřává základnu cesty podaplikace k vykreslenérelativní vazbě.</span><span class="sxs-lookup"><span data-stu-id="c4614-865">Tilde-slash notation triggers a [Tag Helper](xref:mvc/views/tag-helpers/intro) to prepend the sub-app's pathbase to the rendered relative link.</span></span> <span data-ttu-id="c4614-866">Pro podaplikaci `/subapp_path`na adrese , `src="~/image.png"` obrázek `src="/subapp_path/image.png"`spojený s je vykreslen jako .</span><span class="sxs-lookup"><span data-stu-id="c4614-866">For a sub-app at `/subapp_path`, an image linked with `src="~/image.png"` is rendered as `src="/subapp_path/image.png"`.</span></span> <span data-ttu-id="c4614-867">Middleware statického souboru kořenové aplikace nezpracovává požadavek na statický soubor.</span><span class="sxs-lookup"><span data-stu-id="c4614-867">The root app's Static File Middleware doesn't process the static file request.</span></span> <span data-ttu-id="c4614-868">Požadavek je zpracován middlewarem statického souboru podaplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-868">The request is processed by the sub-app's Static File Middleware.</span></span>

<span data-ttu-id="c4614-869">Pokud je atribut `src` statického datového zdroje nastaven na `src="/image.png"`absolutní cestu (například), odkaz se vykreslí bez vytvoření cesty podaplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-869">If a static asset's `src` attribute is set to an absolute path (for example, `src="/image.png"`), the link is rendered without the sub-app's pathbase.</span></span> <span data-ttu-id="c4614-870">Middleware statického souboru kořenové aplikace se pokouší obsluhovat datový zdroj z [kořenového kořenového kořenového adresáře](xref:fundamentals/index#web-root)aplikace , což má za následek odpověď *404 - Not Found,* pokud není statický datový zdroj k dispozici z kořenové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-870">The root app's Static File Middleware attempts to serve the asset from the root app's [web root](xref:fundamentals/index#web-root), which results in a *404 - Not Found* response unless the static asset is available from the root app.</span></span>

<span data-ttu-id="c4614-871">Hostování aplikace ASP.NET Core jako podaplikace pod jinou aplikací ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="c4614-871">To host an ASP.NET Core app as a sub-app under another ASP.NET Core app:</span></span>

1. <span data-ttu-id="c4614-872">Vytvořte fond aplikací pro podaplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-872">Establish an app pool for the sub-app.</span></span> <span data-ttu-id="c4614-873">Nastavte **verzi .NET CLR** na **žádný spravovaný kód,** protože prostředí Core Common Language Runtime (CoreCLR) pro .NET Core je spuštěno pro hostování aplikace v pracovním procesu, nikoli na ploše CLR (.NET CLR).</span><span class="sxs-lookup"><span data-stu-id="c4614-873">Set the **.NET CLR Version** to **No Managed Code** because the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process, not the desktop CLR (.NET CLR).</span></span>

1. <span data-ttu-id="c4614-874">Přidejte kořenový web ve Správci služby IIS s podaplikací ve složce pod kořenovým webem.</span><span class="sxs-lookup"><span data-stu-id="c4614-874">Add the root site in IIS Manager with the sub-app in a folder under the root site.</span></span>

1. <span data-ttu-id="c4614-875">Klikněte pravým tlačítkem myši na složku podaplikace ve Správci služby IIS a vyberte **příkaz Převést na aplikaci**.</span><span class="sxs-lookup"><span data-stu-id="c4614-875">Right-click the sub-app folder in IIS Manager and select **Convert to Application**.</span></span>

1. <span data-ttu-id="c4614-876">V dialogovém okně **Přidat aplikaci** přiřaďte pomocí tlačítka **Vybrat** pro **fond aplikací** fond aplikací, který jste vytvořili pro podaplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-876">In the **Add Application** dialog, use the **Select** button for the **Application Pool** to assign the app pool that you created for the sub-app.</span></span> <span data-ttu-id="c4614-877">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-877">Select **OK**.</span></span>

<span data-ttu-id="c4614-878">Přiřazení samostatného fondu aplikací do podaplikace je požadavek při použití modelu hostování v procesu.</span><span class="sxs-lookup"><span data-stu-id="c4614-878">The assignment of a separate app pool to the sub-app is a requirement when using the in-process hosting model.</span></span>

<span data-ttu-id="c4614-879">Další informace o modelu hostování v procesu a konfiguraci <xref:host-and-deploy/aspnet-core-module>ASP.NET core modulu naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-879">For more information on the in-process hosting model and configuring the ASP.NET Core Module, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="c4614-880">Konfigurace služby IIS pomocí souboru web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-880">Configuration of IIS with web.config</span></span>

<span data-ttu-id="c4614-881">Konfigurace služby IIS `<system.webServer>` je ovlivněna částí *web.config* pro scénáře služby IIS, které jsou funkční pro ASP.NET aplikace Core pomocí ASP.NET core modulem.</span><span class="sxs-lookup"><span data-stu-id="c4614-881">IIS configuration is influenced by the `<system.webServer>` section of *web.config* for IIS scenarios that are functional for ASP.NET Core apps with the ASP.NET Core Module.</span></span> <span data-ttu-id="c4614-882">Například konfigurace služby IIS je funkční pro dynamickou kompresi.</span><span class="sxs-lookup"><span data-stu-id="c4614-882">For example, IIS configuration is functional for dynamic compression.</span></span> <span data-ttu-id="c4614-883">Pokud je služba IIS nakonfigurována na `<urlCompression>` úrovni serveru pro použití dynamické komprese, prvek v souboru *web.config* aplikace jej může zakázat pro aplikaci ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-883">If IIS is configured at the server level to use dynamic compression, the `<urlCompression>` element in the app's *web.config* file can disable it for an ASP.NET Core app.</span></span>

<span data-ttu-id="c4614-884">Další informace najdete v následujících tématech:</span><span class="sxs-lookup"><span data-stu-id="c4614-884">For more information, see the following topics:</span></span>

* [<span data-ttu-id="c4614-885">Odkaz na \<konfiguraci pro>system.webServer</span><span class="sxs-lookup"><span data-stu-id="c4614-885">Configuration reference for \<system.webServer></span></span>](/iis/configuration/system.webServer/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/iis/modules>

<span data-ttu-id="c4614-886">Chcete-li nastavit proměnné prostředí pro jednotlivé aplikace spuštěné v izolovaných fondech aplikací (podporované pro službu IIS 10.0 nebo novější), přečtěte si část *příkazu AppCmd.exe* v tématu [Environment Variables environmentvariables>\<](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) tématu v referenční dokumentaci služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-886">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="c4614-887">Konfigurační části web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-887">Configuration sections of web.config</span></span>

<span data-ttu-id="c4614-888">Části konfigurace aplikací ASP.NET 4.x v *souboru web.config* nepoužívají aplikace ASP.NET Core pro konfiguraci:</span><span class="sxs-lookup"><span data-stu-id="c4614-888">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* `<system.web>`
* `<appSettings>`
* `<connectionStrings>`
* `<location>`

<span data-ttu-id="c4614-889">ASP.NET aplikace Core jsou konfigurovány pomocí jiných poskytovatelů konfigurace.</span><span class="sxs-lookup"><span data-stu-id="c4614-889">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="c4614-890">Další informace naleznete v [tématu Konfigurace](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="c4614-890">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="c4614-891">Fondy aplikací</span><span class="sxs-lookup"><span data-stu-id="c4614-891">Application Pools</span></span>

<span data-ttu-id="c4614-892">Izolace fondu aplikací je určena modelem hostování:</span><span class="sxs-lookup"><span data-stu-id="c4614-892">App pool isolation is determined by the hosting model:</span></span>

* <span data-ttu-id="c4614-893">V průběhu &ndash; procesu hosting ové aplikace jsou nutné ke spuštění v samostatných fondech aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-893">In-process hosting &ndash; Apps are required to run in separate app pools.</span></span>
* <span data-ttu-id="c4614-894">Mimoprocesový hosting &ndash; Doporučujeme izolovat aplikace od sebe navzájem spuštěním každé aplikace ve vlastním fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-894">Out-of-process hosting &ndash; We recommend isolating the apps from each other by running each app in its own app pool.</span></span>

<span data-ttu-id="c4614-895">Dialogové okno **IIS Přidat web** se ve výchozím nastavení používá do jednoho fondu aplikací na aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-895">The IIS **Add Website** dialog defaults to a single app pool per app.</span></span> <span data-ttu-id="c4614-896">Když je k dispozici **název webu,** text se automaticky přenese do textového pole **Fondu aplikací.**</span><span class="sxs-lookup"><span data-stu-id="c4614-896">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="c4614-897">Při přidání webu se vytvoří nový fond aplikací s názvem webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-897">A new app pool is created using the site name when the site is added.</span></span>

## <a name="application-pool-identity"></a><span data-ttu-id="c4614-898">Identita fondu aplikací</span><span class="sxs-lookup"><span data-stu-id="c4614-898">Application Pool Identity</span></span>

<span data-ttu-id="c4614-899">Účet identity fondu aplikací umožňuje aplikaci spouštět pod jedinečným účtem, aniž by bylo třeba vytvářet a spravovat domény nebo místní účty.</span><span class="sxs-lookup"><span data-stu-id="c4614-899">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="c4614-900">Ve službě IIS 8.0 nebo novější vytvoří pracovní proces správce služby IIS (WAS) virtuální účet s názvem nového fondu aplikací a ve výchozím nastavení spustí pracovní procesy fondu aplikací v rámci tohoto účtu.</span><span class="sxs-lookup"><span data-stu-id="c4614-900">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="c4614-901">V konzole pro správu služby IIS v části **Upřesnit nastavení** fondu aplikací zkontrolujte, zda je **identita** nastavená na použití **applicationpoolidentity**:</span><span class="sxs-lookup"><span data-stu-id="c4614-901">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity**:</span></span>

![Dialogové okno Upřesnit nastavení fondu aplikací](index/_static/apppool-identity.png)

<span data-ttu-id="c4614-903">Proces správy služby IIS vytvoří zabezpečený identifikátor s názvem fondu aplikací v systému zabezpečení systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-903">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="c4614-904">Prostředky lze zabezpečit pomocí této identity.</span><span class="sxs-lookup"><span data-stu-id="c4614-904">Resources can be secured using this identity.</span></span> <span data-ttu-id="c4614-905">Tato identita však není reálný uživatelský účet a nezobrazuje se v konzole pro správu uživatelů systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-905">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="c4614-906">Pokud pracovní proces služby IIS vyžaduje zvýšený přístup k aplikaci, upravte seznam řízení přístupu (ACL) pro adresář obsahující aplikaci:</span><span class="sxs-lookup"><span data-stu-id="c4614-906">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="c4614-907">Sem otevřete Průzkumníka Windows a přejděte do adresáře.</span><span class="sxs-lookup"><span data-stu-id="c4614-907">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="c4614-908">Klepněte pravým tlačítkem myši na adresář a vyberte příkaz **Vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="c4614-908">Right-click on the directory and select **Properties**.</span></span>

1. <span data-ttu-id="c4614-909">Na kartě **Zabezpečení** vyberte tlačítko **Upravit** a pak **tlačítko Přidat.**</span><span class="sxs-lookup"><span data-stu-id="c4614-909">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="c4614-910">Vyberte tlačítko **Umístění** a ujistěte se, že je vybrán systém.</span><span class="sxs-lookup"><span data-stu-id="c4614-910">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="c4614-911">Zadejte **\\<<iIS app_pool_name>** **zadejte názvy objektů, které chcete vybrat.**</span><span class="sxs-lookup"><span data-stu-id="c4614-911">Enter **IIS AppPool\\<app_pool_name>** in **Enter the object names to select** area.</span></span> <span data-ttu-id="c4614-912">Vyberte tlačítko **Zkontrolovat jména.**</span><span class="sxs-lookup"><span data-stu-id="c4614-912">Select the **Check Names** button.</span></span> <span data-ttu-id="c4614-913">Pro *DefaultAppPool* zkontrolujte názvy pomocí **IIS AppPool\DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="c4614-913">For the *DefaultAppPool* check the names using **IIS AppPool\DefaultAppPool**.</span></span> <span data-ttu-id="c4614-914">Když je vybráno tlačítko **Zkontrolovat názvy,** je v oblasti názvů objektů uvedena hodnota **DefaultAppPool.**</span><span class="sxs-lookup"><span data-stu-id="c4614-914">When the **Check Names** button is selected, a value of **DefaultAppPool** is indicated in the object names area.</span></span> <span data-ttu-id="c4614-915">Název fondu aplikací není možné zadat přímo do oblasti názvů objektů.</span><span class="sxs-lookup"><span data-stu-id="c4614-915">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="c4614-916">Při kontrole názvu objektu použijte<<app_pool_name>formátu \*\*IIS AppPool.\\ \*\*</span><span class="sxs-lookup"><span data-stu-id="c4614-916">Use the **IIS AppPool\\<app_pool_name>** format when checking for the object name.</span></span>

   ![Dialogové okno Vybrat uživatele nebo skupiny pro složku aplikace: Název fondu aplikací "DefaultAppPool" se připojí k "IIS AppPool\" v oblasti názvů objektů před výběrem možnosti Zkontrolovat názvy".](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="c4614-918">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-918">Select **OK**.</span></span>

   ![Dialogové okno Vybrat uživatele nebo skupiny pro složku aplikace: Po výběru možnosti Zkontrolovat názvy se v oblasti názvů objektů zobrazí název objektu DefaultAppPool.](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="c4614-920">Oprávnění &amp; ke spuštění čtení by měla být udělena ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="c4614-920">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="c4614-921">Podle potřeby zadejte další oprávnění.</span><span class="sxs-lookup"><span data-stu-id="c4614-921">Provide additional permissions as needed.</span></span>

<span data-ttu-id="c4614-922">Přístup lze také udělit na příkazovém řádku pomocí nástroje **ICACLS.**</span><span class="sxs-lookup"><span data-stu-id="c4614-922">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="c4614-923">Jako příklad použijete *defaultapppool,* který používá následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="c4614-923">Using the *DefaultAppPool* as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="c4614-924">Další informace naleznete v tématu [icacls.](/windows-server/administration/windows-commands/icacls)</span><span class="sxs-lookup"><span data-stu-id="c4614-924">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="http2-support"></a><span data-ttu-id="c4614-925">Podpora HTTP/2</span><span class="sxs-lookup"><span data-stu-id="c4614-925">HTTP/2 support</span></span>

<span data-ttu-id="c4614-926">[Protokol HTTP/2](https://httpwg.org/specs/rfc7540.html) je podporován ASP.NET jádrem v následujících scénářích nasazení služby IIS:</span><span class="sxs-lookup"><span data-stu-id="c4614-926">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported with ASP.NET Core in the following IIS deployment scenarios:</span></span>

* <span data-ttu-id="c4614-927">Neprocesové</span><span class="sxs-lookup"><span data-stu-id="c4614-927">In-process</span></span>
  * <span data-ttu-id="c4614-928">Windows Server 2016/Windows 10 nebo novější; IIS 10 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-928">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="c4614-929">Připojení TLS 1.2 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-929">TLS 1.2 or later connection</span></span>
* <span data-ttu-id="c4614-930">Mimo proces</span><span class="sxs-lookup"><span data-stu-id="c4614-930">Out-of-process</span></span>
  * <span data-ttu-id="c4614-931">Windows Server 2016/Windows 10 nebo novější; IIS 10 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-931">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
  * <span data-ttu-id="c4614-932">Připojení serveru edge směřující mj. [Kestrel server](xref:fundamentals/servers/kestrel)</span><span class="sxs-lookup"><span data-stu-id="c4614-932">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
  * <span data-ttu-id="c4614-933">Připojení TLS 1.2 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-933">TLS 1.2 or later connection</span></span>

<span data-ttu-id="c4614-934">Pro nasazení v procesu při navázání připojení HTTP/2 `HTTP/2`protokol [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) hlásí .</span><span class="sxs-lookup"><span data-stu-id="c4614-934">For an in-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/2`.</span></span> <span data-ttu-id="c4614-935">Pro mimoprocesové nasazení při navázání připojení HTTP/2 hlásí protokol `HTTP/1.1` [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) .</span><span class="sxs-lookup"><span data-stu-id="c4614-935">For an out-of-process deployment when an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="c4614-936">Další informace o modelech hostování v procesu a <xref:host-and-deploy/aspnet-core-module>mimo proces naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-936">For more information on the in-process and out-of-process hosting models, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="c4614-937">Protokol HTTP/2 je ve výchozím nastavení povolen.</span><span class="sxs-lookup"><span data-stu-id="c4614-937">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="c4614-938">Připojení se vrátí na HTTP/1.1, pokud není navázáno připojení HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="c4614-938">Connections fall back to HTTP/1.1 if an HTTP/2 connection isn't established.</span></span> <span data-ttu-id="c4614-939">Další informace o konfiguraci protokolu HTTP/2 s nasazením služby IIS naleznete [v tématu HTTP/2 ve službě IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span><span class="sxs-lookup"><span data-stu-id="c4614-939">For more information on HTTP/2 configuration with IIS deployments, see [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span></span>

## <a name="cors-preflight-requests"></a><span data-ttu-id="c4614-940">Požadavky cors kontroly před výstupem</span><span class="sxs-lookup"><span data-stu-id="c4614-940">CORS preflight requests</span></span>

<span data-ttu-id="c4614-941">*Tato část se vztahuje pouze na ASP.NET základní aplikace, které se zaměřují na rozhraní .NET Framework.*</span><span class="sxs-lookup"><span data-stu-id="c4614-941">*This section only applies to ASP.NET Core apps that target the .NET Framework.*</span></span>

<span data-ttu-id="c4614-942">Pro aplikaci ASP.NET Core, která cílí na rozhraní .NET Framework, nejsou požadavky OPTIONS ve výchozím nastavení ve službách IIS předány do aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-942">For an ASP.NET Core app that targets the .NET Framework, OPTIONS requests aren't passed to the app by default in IIS.</span></span> <span data-ttu-id="c4614-943">Informace o konfiguraci obslužných rutin služby IIS aplikace v *souboru web.config* tak, aby předávály požadavky OPTIONS, naleznete v tématu [Povolení požadavků napříč původy v ASP.NET webovém rozhraní API 2: Jak funguje cors](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span><span class="sxs-lookup"><span data-stu-id="c4614-943">To learn how to configure the app's IIS handlers in *web.config* to pass OPTIONS requests, see [Enable cross-origin requests in ASP.NET Web API 2: How CORS Works](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span></span>

## <a name="application-initialization-module-and-idle-timeout"></a><span data-ttu-id="c4614-944">Modul inicializace aplikace a časový limit nečinnosti</span><span class="sxs-lookup"><span data-stu-id="c4614-944">Application Initialization Module and Idle Timeout</span></span>

<span data-ttu-id="c4614-945">Pokud je ve správě ve správě iis hostován ASP.NET základnímodul verze 2:</span><span class="sxs-lookup"><span data-stu-id="c4614-945">When hosted in IIS by the ASP.NET Core Module version 2:</span></span>

* <span data-ttu-id="c4614-946">[Aplikace Inicializační modul](#application-initialization-module) &ndash; aplikace hostované [v procesu](#in-process-hosting-model) nebo [mimo proces](#out-of-process-hosting-model) lze nakonfigurovat tak, aby se automaticky spouštěla při restartování pracovního procesu nebo restartování serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-946">[Application Initialization Module](#application-initialization-module) &ndash; App's hosted [in-process](#in-process-hosting-model) or [out-of-process](#out-of-process-hosting-model) can be configured to start automatically on a worker process restart or server restart.</span></span>
* <span data-ttu-id="c4614-947">[Nevyužitý časový limit](#idle-timeout) &ndash; aplikace hostované [v procesu](#in-process-hosting-model) lze nakonfigurovat tak, aby časový limit během období nečinnosti.</span><span class="sxs-lookup"><span data-stu-id="c4614-947">[Idle Timeout](#idle-timeout) &ndash; App's hosted [in-process](#in-process-hosting-model) can be configured not to timeout during periods of inactivity.</span></span>

### <a name="application-initialization-module"></a><span data-ttu-id="c4614-948">Inicializační modul aplikace</span><span class="sxs-lookup"><span data-stu-id="c4614-948">Application Initialization Module</span></span>

<span data-ttu-id="c4614-949">*Platí pro aplikace hostované v průběhu procesu a mimo proces.*</span><span class="sxs-lookup"><span data-stu-id="c4614-949">*Applies to apps hosted in-process and out-of-process.*</span></span>

<span data-ttu-id="c4614-950">[Inicializace aplikace služby IIS](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) je funkce služby IIS, která odesílá požadavek HTTP do aplikace při spuštění nebo recyklaci fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-950">[IIS Application Initialization](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization) is an IIS feature that sends an HTTP request to the app when the app pool starts or is recycled.</span></span> <span data-ttu-id="c4614-951">Požadavek spustí spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-951">The request triggers the app to start.</span></span> <span data-ttu-id="c4614-952">Ve výchozím nastavení služba IIS vydá požadavek`/`na kořenovou adresu URL aplikace ( ) o inicializaci aplikace (další podrobnosti o konfiguraci najdete v [dalších zdrojích](#application-initialization-module-and-idle-timeout-additional-resources) informací).</span><span class="sxs-lookup"><span data-stu-id="c4614-952">By default, IIS issues a request to the app's root URL (`/`) to initialize the app (see the [additional resources](#application-initialization-module-and-idle-timeout-additional-resources) for more details on configuration).</span></span>

<span data-ttu-id="c4614-953">Zkontrolujte, zda je funkce role Inicializace aplikace služby IIS povolena:</span><span class="sxs-lookup"><span data-stu-id="c4614-953">Confirm that the IIS Application Initialization role feature in enabled:</span></span>

<span data-ttu-id="c4614-954">V desktopových systémech se systémem Windows 7 nebo novějších při místním používání služby IIS:</span><span class="sxs-lookup"><span data-stu-id="c4614-954">On Windows 7 or later desktop systems when using IIS locally:</span></span>

1. <span data-ttu-id="c4614-955">Přejděte na **Ovládací panely** > **Programy** > **a funkce** > **Zapněte nebo vypněte funkce systému Windows** (levá strana obrazovky).</span><span class="sxs-lookup"><span data-stu-id="c4614-955">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>
1. <span data-ttu-id="c4614-956">Otevřete funkce **vývoje aplikací** **internetových informačních služeb** > **World Wide Web Services** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-956">Open **Internet Information Services** > **World Wide Web Services** > **Application Development Features**.</span></span>
1. <span data-ttu-id="c4614-957">Zaškrtněte políčko pro **inicializaci aplikace**.</span><span class="sxs-lookup"><span data-stu-id="c4614-957">Select the check box for **Application Initialization**.</span></span>

<span data-ttu-id="c4614-958">V systému Windows Server 2008 R2 nebo novějším:</span><span class="sxs-lookup"><span data-stu-id="c4614-958">On Windows Server 2008 R2 or later:</span></span>

1. <span data-ttu-id="c4614-959">Otevřete **Průvodce přidáním rolí a funkcí**.</span><span class="sxs-lookup"><span data-stu-id="c4614-959">Open the **Add Roles and Features Wizard**.</span></span>
1. <span data-ttu-id="c4614-960">V panelu **Vybrat služby rolí** otevřete uzel **Vývoj aplikací.**</span><span class="sxs-lookup"><span data-stu-id="c4614-960">In the **Select role services** panel, open the **Application Development** node.</span></span>
1. <span data-ttu-id="c4614-961">Zaškrtněte políčko pro **inicializaci aplikace**.</span><span class="sxs-lookup"><span data-stu-id="c4614-961">Select the check box for **Application Initialization**.</span></span>

<span data-ttu-id="c4614-962">K povolení modulu inicializace aplikace pro lokalitu použijte některý z následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-962">Use either of the following approaches to enable the Application Initialization Module for the site:</span></span>

* <span data-ttu-id="c4614-963">Pomocí Správce služby IIS:</span><span class="sxs-lookup"><span data-stu-id="c4614-963">Using IIS Manager:</span></span>

  1. <span data-ttu-id="c4614-964">V panelu **Připojení** vyberte **fondy aplikací.**</span><span class="sxs-lookup"><span data-stu-id="c4614-964">Select **Application Pools** in the **Connections** panel.</span></span>
  1. <span data-ttu-id="c4614-965">Klikněte pravým tlačítkem myši na fond aplikací v seznamu a vyberte **Upřesnit nastavení**.</span><span class="sxs-lookup"><span data-stu-id="c4614-965">Right-click the app's app pool in the list and select **Advanced Settings**.</span></span>
  1. <span data-ttu-id="c4614-966">Výchozí **režim spuštění** je **OnDemand**.</span><span class="sxs-lookup"><span data-stu-id="c4614-966">The default **Start Mode** is **OnDemand**.</span></span> <span data-ttu-id="c4614-967">Nastavte **režim spuštění** na **vždy spuštěný**.</span><span class="sxs-lookup"><span data-stu-id="c4614-967">Set the **Start Mode** to **AlwaysRunning**.</span></span> <span data-ttu-id="c4614-968">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-968">Select **OK**.</span></span>
  1. <span data-ttu-id="c4614-969">Otevřete uzel **Weby** v panelu **Připojení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-969">Open the **Sites** node in the **Connections** panel.</span></span>
  1. <span data-ttu-id="c4614-970">Klikněte pravým tlačítkem myši na aplikaci a vyberte Spravovat **upřesnit nastavení** **webu** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-970">Right-click the app and select **Manage Website** > **Advanced Settings**.</span></span>
  1. <span data-ttu-id="c4614-971">Výchozí nastavení **Preload Enabled** je **False**.</span><span class="sxs-lookup"><span data-stu-id="c4614-971">The default **Preload Enabled** setting is **False**.</span></span> <span data-ttu-id="c4614-972">Nastavte **předběžné načtení povoleno** na **hodnotu True**.</span><span class="sxs-lookup"><span data-stu-id="c4614-972">Set **Preload Enabled** to **True**.</span></span> <span data-ttu-id="c4614-973">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-973">Select **OK**.</span></span>

* <span data-ttu-id="c4614-974">Pomocí `<applicationInitialization>` `doAppInitAfterRestart` *souboru web.config*přidejte `true` prvek `<system.webServer>` s nastavenou na do prvků v souboru *web.config* aplikace:</span><span class="sxs-lookup"><span data-stu-id="c4614-974">Using *web.config*, add the `<applicationInitialization>` element with `doAppInitAfterRestart` set to `true` to the `<system.webServer>` elements in the app's *web.config* file:</span></span>

  ```xml
  <?xml version="1.0" encoding="utf-8"?>
  <configuration>
    <location path="." inheritInChildApplications="false">
      <system.webServer>
        <applicationInitialization doAppInitAfterRestart="true" />
      </system.webServer>
    </location>
  </configuration>
  ```

### <a name="idle-timeout"></a><span data-ttu-id="c4614-975">Časový limit nečinnosti</span><span class="sxs-lookup"><span data-stu-id="c4614-975">Idle Timeout</span></span>

<span data-ttu-id="c4614-976">*Platí pouze pro aplikace hostované v procesu.*</span><span class="sxs-lookup"><span data-stu-id="c4614-976">*Only applies to apps hosted in-process.*</span></span>

<span data-ttu-id="c4614-977">Chcete-li aplikaci zabránit v volnoběhu, nastavte časový limit nečinnosti fondu aplikací pomocí Správce služby IIS:</span><span class="sxs-lookup"><span data-stu-id="c4614-977">To prevent the app from idling, set the app pool's idle timeout using IIS Manager:</span></span>

1. <span data-ttu-id="c4614-978">V panelu **Připojení** vyberte **fondy aplikací.**</span><span class="sxs-lookup"><span data-stu-id="c4614-978">Select **Application Pools** in the **Connections** panel.</span></span>
1. <span data-ttu-id="c4614-979">Klikněte pravým tlačítkem myši na fond aplikací v seznamu a vyberte **Upřesnit nastavení**.</span><span class="sxs-lookup"><span data-stu-id="c4614-979">Right-click the app's app pool in the list and select **Advanced Settings**.</span></span>
1. <span data-ttu-id="c4614-980">Výchozí **časový limit nečinnosti (minuty)** je **20** minut.</span><span class="sxs-lookup"><span data-stu-id="c4614-980">The default **Idle Time-out (minutes)** is **20** minutes.</span></span> <span data-ttu-id="c4614-981">Nastavte **časový limit nečinnosti (minuty)** na **0** (nula).</span><span class="sxs-lookup"><span data-stu-id="c4614-981">Set the **Idle Time-out (minutes)** to **0** (zero).</span></span> <span data-ttu-id="c4614-982">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-982">Select **OK**.</span></span>
1. <span data-ttu-id="c4614-983">Recyklujte pracovní proces.</span><span class="sxs-lookup"><span data-stu-id="c4614-983">Recycle the worker process.</span></span>

<span data-ttu-id="c4614-984">Chcete-li zabránit vypršení časového limitu aplikací hostovaných [mimo proces,](#out-of-process-hosting-model) použijte některý z následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-984">To prevent apps hosted [out-of-process](#out-of-process-hosting-model) from timing out, use either of the following approaches:</span></span>

* <span data-ttu-id="c4614-985">Příkazping aplikace z externí služby, aby byla spuštěna.</span><span class="sxs-lookup"><span data-stu-id="c4614-985">Ping the app from an external service in order to keep it running.</span></span>
* <span data-ttu-id="c4614-986">Pokud aplikace hostuje pouze služby na pozadí, vyhněte se hostování služby IIS a pomocí [služby Windows service hostujte aplikaci ASP.NET Core](xref:host-and-deploy/windows-service).</span><span class="sxs-lookup"><span data-stu-id="c4614-986">If the app only hosts background services, avoid IIS hosting and use a [Windows Service to host the ASP.NET Core app](xref:host-and-deploy/windows-service).</span></span>

### <a name="application-initialization-module-and-idle-timeout-additional-resources"></a><span data-ttu-id="c4614-987">Modul inicializace aplikace a časový limit nečinnosti další prostředky</span><span class="sxs-lookup"><span data-stu-id="c4614-987">Application Initialization Module and Idle Timeout additional resources</span></span>

* [<span data-ttu-id="c4614-988">Inicializace aplikace služby IIS 8.0</span><span class="sxs-lookup"><span data-stu-id="c4614-988">IIS 8.0 Application Initialization</span></span>](/iis/get-started/whats-new-in-iis-8/iis-80-application-initialization)
* <span data-ttu-id="c4614-989">[Aplikace Inicializace \<aplikaceInicializační>](/iis/configuration/system.webserver/applicationinitialization/).</span><span class="sxs-lookup"><span data-stu-id="c4614-989">[Application Initialization \<applicationInitialization>](/iis/configuration/system.webserver/applicationinitialization/).</span></span>
* <span data-ttu-id="c4614-990">[Zpracovat nastavení modelu \<pro proces fondu aplikacíModel>](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span><span class="sxs-lookup"><span data-stu-id="c4614-990">[Process Model Settings for an Application Pool \<processModel>](/iis/configuration/system.applicationhost/applicationpools/add/processmodel).</span></span>

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="c4614-991">Prostředky nasazení pro správce služby IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-991">Deployment resources for IIS administrators</span></span>

* [<span data-ttu-id="c4614-992">Dokumentace iis</span><span class="sxs-lookup"><span data-stu-id="c4614-992">IIS documentation</span></span>](/iis)
* [<span data-ttu-id="c4614-993">Začínáme se Správcem služby IIS ve službách IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-993">Getting Started with the IIS Manager in IIS</span></span>](/iis/get-started/getting-started-with-iis/getting-started-with-the-iis-manager-in-iis-7-and-iis-8)
* [<span data-ttu-id="c4614-994">Nasazení aplikace .NET Core</span><span class="sxs-lookup"><span data-stu-id="c4614-994">.NET Core application deployment</span></span>](/dotnet/core/deploying/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/directory-structure>
* <xref:host-and-deploy/iis/modules>
* <xref:test/troubleshoot-azure-iis>
* <xref:host-and-deploy/azure-iis-errors-reference>

## <a name="additional-resources"></a><span data-ttu-id="c4614-995">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="c4614-995">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:index>
* [<span data-ttu-id="c4614-996">Oficiální web služby Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-996">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="c4614-997">Knihovna technického obsahu systému Windows Server</span><span class="sxs-lookup"><span data-stu-id="c4614-997">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="c4614-998">HTTP/2 ve službě IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-998">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="c4614-999">Výukové prostředí o publikování aplikace ASP.NET Core na server <xref:tutorials/publish-to-iis>služby IIS naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-999">For a tutorial experience on publishing an ASP.NET Core app to an IIS server, see <xref:tutorials/publish-to-iis>.</span></span>

[<span data-ttu-id="c4614-1000">Instalace balíčku hostingu jádra .NET</span><span class="sxs-lookup"><span data-stu-id="c4614-1000">Install the .NET Core Hosting Bundle</span></span>](#install-the-net-core-hosting-bundle)

## <a name="supported-operating-systems"></a><span data-ttu-id="c4614-1001">Podporované operační systémy</span><span class="sxs-lookup"><span data-stu-id="c4614-1001">Supported operating systems</span></span>

<span data-ttu-id="c4614-1002">Podporovány jsou následující operační systémy:</span><span class="sxs-lookup"><span data-stu-id="c4614-1002">The following operating systems are supported:</span></span>

* <span data-ttu-id="c4614-1003">Windows 7 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-1003">Windows 7 or later</span></span>
* <span data-ttu-id="c4614-1004">Windows Server 2008 R2 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-1004">Windows Server 2008 R2 or later</span></span>

<span data-ttu-id="c4614-1005">[Server HTTP.sys](xref:fundamentals/servers/httpsys) (dříve nazývaný WebListener) nefunguje v konfiguraci reverzního proxy serveru se službou IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1005">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called WebListener) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="c4614-1006">Použijte [server Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="c4614-1006">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

<span data-ttu-id="c4614-1007">Informace o hostování v <xref:host-and-deploy/azure-apps/index>Azure najdete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-1007">For information on hosting in Azure, see <xref:host-and-deploy/azure-apps/index>.</span></span>

<span data-ttu-id="c4614-1008">Pokyny pro řešení <xref:test/troubleshoot>potíží naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-1008">For troubleshooting guidance, see <xref:test/troubleshoot>.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="c4614-1009">Podporované platformy</span><span class="sxs-lookup"><span data-stu-id="c4614-1009">Supported platforms</span></span>

<span data-ttu-id="c4614-1010">Podporovány jsou aplikace publikované pro 32bitové (x86) nebo 64bitové (x64) nasazení.</span><span class="sxs-lookup"><span data-stu-id="c4614-1010">Apps published for 32-bit (x86) or 64-bit (x64) deployment are supported.</span></span> <span data-ttu-id="c4614-1011">Nasazení 32bitové aplikace s 32bitovou sadou .NET Core SDK, pokud ji ne:</span><span class="sxs-lookup"><span data-stu-id="c4614-1011">Deploy a 32-bit app with a 32-bit (x86) .NET Core SDK unless the app:</span></span>

* <span data-ttu-id="c4614-1012">Vyžaduje větší adresní prostor virtuální paměti, který je k dispozici pro 64bitovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-1012">Requires the larger virtual memory address space available to a 64-bit app.</span></span>
* <span data-ttu-id="c4614-1013">Vyžaduje větší velikost zásobníku iis.</span><span class="sxs-lookup"><span data-stu-id="c4614-1013">Requires the larger IIS stack size.</span></span>
* <span data-ttu-id="c4614-1014">Má 64bitové nativní závislosti.</span><span class="sxs-lookup"><span data-stu-id="c4614-1014">Has 64-bit native dependencies.</span></span>

<span data-ttu-id="c4614-1015">K publikování 64bitové sady SDK jádra (x64) použijte 64bitovou sadu .NET Core SDK.</span><span class="sxs-lookup"><span data-stu-id="c4614-1015">Use a 64-bit (x64) .NET Core SDK to publish a 64-bit app.</span></span> <span data-ttu-id="c4614-1016">V hostitelském systému musí být k dispozici 64bitový běhový čas.</span><span class="sxs-lookup"><span data-stu-id="c4614-1016">A 64-bit runtime must be present on the host system.</span></span>

<span data-ttu-id="c4614-1017">ASP.NET Core je dodáván se [serverem Kestrel](xref:fundamentals/servers/kestrel), což je výchozí http server pro více platforem.</span><span class="sxs-lookup"><span data-stu-id="c4614-1017">ASP.NET Core ships with [Kestrel server](xref:fundamentals/servers/kestrel), a default, cross-platform HTTP server.</span></span>

<span data-ttu-id="c4614-1018">Při použití [služby IIS](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture) nebo [služby IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview)je aplikace spuštěna v procesu odděleném od pracovního procesu služby IIS *(mimo proces)* se [serverem Kestrel](xref:fundamentals/servers/index#kestrel).</span><span class="sxs-lookup"><span data-stu-id="c4614-1018">When using [IIS](/iis/get-started/introduction-to-iis/introduction-to-iis-architecture) or [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview), the app runs in a process separate from the IIS worker process (*out-of-process*) with the [Kestrel server](xref:fundamentals/servers/index#kestrel).</span></span>

<span data-ttu-id="c4614-1019">Vzhledem k tomu, ASP.NET základní aplikace spustit v procesu odděleném od pracovního procesu služby IIS, modul zpracovává správu procesů.</span><span class="sxs-lookup"><span data-stu-id="c4614-1019">Because ASP.NET Core apps run in a process separate from the IIS worker process, the module handles process management.</span></span> <span data-ttu-id="c4614-1020">Modul spustí proces pro aplikaci ASP.NET Core při příchodu prvního požadavku a restartuje aplikaci, pokud se vypne nebo dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="c4614-1020">The module starts the process for the ASP.NET Core app when the first request arrives and restarts the app if it shuts down or crashes.</span></span> <span data-ttu-id="c4614-1021">Toto je v podstatě stejné chování jako u aplikací, které běží v procesu, které jsou spravovány [službou aktivace procesu systému Windows (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span><span class="sxs-lookup"><span data-stu-id="c4614-1021">This is essentially the same behavior as seen with apps that run in-process that are managed by the [Windows Process Activation Service (WAS)](/iis/manage/provisioning-and-managing-iis/features-of-the-windows-process-activation-service-was).</span></span>

<span data-ttu-id="c4614-1022">Následující diagram znázorňuje vztah mezi iis, ASP.NET základní modul a aplikace hostované mimo proces:</span><span class="sxs-lookup"><span data-stu-id="c4614-1022">The following diagram illustrates the relationship between IIS, the ASP.NET Core Module, and an app hosted out-of-process:</span></span>

![Modul ASP.NET Core](index/_static/ancm-outofprocess.png)

<span data-ttu-id="c4614-1024">Požadavky dorazí z webu do ovladače HTTP.sys v režimu jádra.</span><span class="sxs-lookup"><span data-stu-id="c4614-1024">Requests arrive from the web to the kernel-mode HTTP.sys driver.</span></span> <span data-ttu-id="c4614-1025">Řidič směruje požadavky do služby IIS na nakonfigurovaném portu webu, obvykle 80 (HTTP) nebo 443 (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="c4614-1025">The driver routes the requests to IIS on the website's configured port, usually 80 (HTTP) or 443 (HTTPS).</span></span> <span data-ttu-id="c4614-1026">Modul předá požadavky Kestrel na náhodný port pro aplikaci, která není port 80 nebo 443.</span><span class="sxs-lookup"><span data-stu-id="c4614-1026">The module forwards the requests to Kestrel on a random port for the app, which isn't port 80 or 443.</span></span>

<span data-ttu-id="c4614-1027">Modul určuje port prostřednictvím proměnné prostředí při spuštění a [middleware integrace služby IIS](xref:host-and-deploy/iis/index#enable-the-iisintegration-components) nakonfiguruje server tak, aby naslouchal . `http://localhost:{port}`</span><span class="sxs-lookup"><span data-stu-id="c4614-1027">The module specifies the port via an environment variable at startup, and the [IIS Integration Middleware](xref:host-and-deploy/iis/index#enable-the-iisintegration-components) configures the server to listen on `http://localhost:{port}`.</span></span> <span data-ttu-id="c4614-1028">Jsou prováděny další kontroly a požadavky, které nepocházejí z modulu, jsou odmítnuty.</span><span class="sxs-lookup"><span data-stu-id="c4614-1028">Additional checks are performed, and requests that don't originate from the module are rejected.</span></span> <span data-ttu-id="c4614-1029">Modul nepodporuje předávání https, takže požadavky jsou předávány přes HTTP i v případě, že přijaté službou IIS přes protokol HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1029">The module doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.</span></span>

<span data-ttu-id="c4614-1030">Poté, co Kestrel vyzvedne požadavek z modulu, je požadavek posunut do kanálu ASP.NET middleware.</span><span class="sxs-lookup"><span data-stu-id="c4614-1030">After Kestrel picks up the request from the module, the request is pushed into the ASP.NET Core middleware pipeline.</span></span> <span data-ttu-id="c4614-1031">Middleware kanálu zpracovává požadavek a předá `HttpContext` jej jako instanci logiky aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1031">The middleware pipeline handles the request and passes it on as an `HttpContext` instance to the app's logic.</span></span> <span data-ttu-id="c4614-1032">Middleware přidané integrací služby IIS aktualizuje schéma, vzdálenou IP adresu a pathbase tak, aby odpovídaly předání požadavku ke společnosti Kestrel.</span><span class="sxs-lookup"><span data-stu-id="c4614-1032">Middleware added by IIS Integration updates the scheme, remote IP, and pathbase to account for forwarding the request to Kestrel.</span></span> <span data-ttu-id="c4614-1033">Odpověď aplikace je předána zpět do služby IIS, která ji odešle zpět do klienta HTTP, který inicioval požadavek.</span><span class="sxs-lookup"><span data-stu-id="c4614-1033">The app's response is passed back to IIS, which pushes it back out to the HTTP client that initiated the request.</span></span>

<span data-ttu-id="c4614-1034">`CreateDefaultBuilder`Konfiguruje server [Kestrel](xref:fundamentals/servers/kestrel) jako webový server a umožňuje integraci služby IIS konfigurací základní cesty a portu pro [základní modul ASP.NET .](xref:host-and-deploy/aspnet-core-module)</span><span class="sxs-lookup"><span data-stu-id="c4614-1034">`CreateDefaultBuilder` configures [Kestrel](xref:fundamentals/servers/kestrel) server as the web server and enables IIS Integration by configuring the base path and port for the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span>

<span data-ttu-id="c4614-1035">Základní modul ASP.NET generuje dynamický port, který má být přiřazen k procesu back-endu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1035">The ASP.NET Core Module generates a dynamic port to assign to the backend process.</span></span> <span data-ttu-id="c4614-1036">`CreateDefaultBuilder`volá <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> metodu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1036">`CreateDefaultBuilder` calls the <xref:Microsoft.AspNetCore.Hosting.WebHostBuilderIISExtensions.UseIISIntegration*> method.</span></span> <span data-ttu-id="c4614-1037">`UseIISIntegration`konfiguruje Kestrel poslouchat na dynamickém portu na localhost IP adresu (`127.0.0.1`).</span><span class="sxs-lookup"><span data-stu-id="c4614-1037">`UseIISIntegration` configures Kestrel to listen on the dynamic port at the localhost IP address (`127.0.0.1`).</span></span> <span data-ttu-id="c4614-1038">Pokud je dynamický port 1234, Kestrel naslouchá na `127.0.0.1:1234`.</span><span class="sxs-lookup"><span data-stu-id="c4614-1038">If the dynamic port is 1234, Kestrel listens at `127.0.0.1:1234`.</span></span> <span data-ttu-id="c4614-1039">Tato konfigurace nahrazuje další konfigurace adres URL poskytované:</span><span class="sxs-lookup"><span data-stu-id="c4614-1039">This configuration replaces other URL configurations provided by:</span></span>

* `UseUrls`
* [<span data-ttu-id="c4614-1040">Kestrel je Poslouchat API</span><span class="sxs-lookup"><span data-stu-id="c4614-1040">Kestrel's Listen API</span></span>](xref:fundamentals/servers/kestrel#endpoint-configuration)
* <span data-ttu-id="c4614-1041">[Konfigurace](xref:fundamentals/configuration/index) (nebo [možnost --urls příkazového řádku)](xref:fundamentals/host/web-host#override-configuration)</span><span class="sxs-lookup"><span data-stu-id="c4614-1041">[Configuration](xref:fundamentals/configuration/index) (or [command-line --urls option](xref:fundamentals/host/web-host#override-configuration))</span></span>

<span data-ttu-id="c4614-1042">Volání `UseUrls` nebo Kestrel `Listen` api nejsou vyžadovány při použití modulu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1042">Calls to `UseUrls` or Kestrel's `Listen` API aren't required when using the module.</span></span> <span data-ttu-id="c4614-1043">Pokud `UseUrls` `Listen` nebo je volána, Kestrel naslouchá na portu určeném pouze při spuštění aplikace bez iis.</span><span class="sxs-lookup"><span data-stu-id="c4614-1043">If `UseUrls` or `Listen` is called, Kestrel listens on the port specified only when running the app without IIS.</span></span>

<span data-ttu-id="c4614-1044">Pokyny ke konfiguraci ASP.NET <xref:host-and-deploy/aspnet-core-module>core modulem naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-1044">For ASP.NET Core Module configuration guidance, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

<span data-ttu-id="c4614-1045">Další informace o hostování najdete [v tématu Host in ASP.NET Core](xref:fundamentals/index#host).</span><span class="sxs-lookup"><span data-stu-id="c4614-1045">For more information on hosting, see [Host in ASP.NET Core](xref:fundamentals/index#host).</span></span>

## <a name="application-configuration"></a><span data-ttu-id="c4614-1046">Konfigurace aplikací</span><span class="sxs-lookup"><span data-stu-id="c4614-1046">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="c4614-1047">Povolení součástí Integrace iIS</span><span class="sxs-lookup"><span data-stu-id="c4614-1047">Enable the IISIntegration components</span></span>

<span data-ttu-id="c4614-1048">Při vytváření hostitele `CreateWebHostBuilder` v *(Program.cs*) volání <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> umožňující integraci iis:</span><span class="sxs-lookup"><span data-stu-id="c4614-1048">When building a host in `CreateWebHostBuilder` (*Program.cs*), call <xref:Microsoft.AspNetCore.WebHost.CreateDefaultBuilder*> to enable IIS integration:</span></span>

```csharp
public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

<span data-ttu-id="c4614-1049">Další informace `CreateDefaultBuilder`naleznete <xref:fundamentals/host/web-host#set-up-a-host>v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-1049">For more information on `CreateDefaultBuilder`, see <xref:fundamentals/host/web-host#set-up-a-host>.</span></span>

### <a name="iis-options"></a><span data-ttu-id="c4614-1050">Možnosti iis</span><span class="sxs-lookup"><span data-stu-id="c4614-1050">IIS options</span></span>

| <span data-ttu-id="c4614-1051">Možnost</span><span class="sxs-lookup"><span data-stu-id="c4614-1051">Option</span></span>                         | <span data-ttu-id="c4614-1052">Výchozí</span><span class="sxs-lookup"><span data-stu-id="c4614-1052">Default</span></span> | <span data-ttu-id="c4614-1053">Nastavení</span><span class="sxs-lookup"><span data-stu-id="c4614-1053">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="c4614-1054">Pokud `true`server IIS `HttpContext.User` nastaví ověřené ověřování [systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-1054">If `true`, IIS Server sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="c4614-1055">Pokud `false`server poskytuje identitu pouze `HttpContext.User` pro výzvy a reaguje na `AuthenticationScheme`ně, pokud o to výslovně požádá .</span><span class="sxs-lookup"><span data-stu-id="c4614-1055">If `false`, the server only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="c4614-1056">Aby bylo možné službu `AutomaticAuthentication` IIS fungovat, musí být ve službě IIS povoleno ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-1056">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="c4614-1057">Další informace naleznete v tématu [Ověřování systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-1057">For more information, see [Windows Authentication](xref:security/authentication/windowsauth).</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="c4614-1058">Nastaví zobrazované jméno zobrazené uživatelům na přihlašovacích stránkách.</span><span class="sxs-lookup"><span data-stu-id="c4614-1058">Sets the display name shown to users on login pages.</span></span> |

<span data-ttu-id="c4614-1059">Chcete-li konfigurovat možnosti služby <xref:Microsoft.AspNetCore.Builder.IISOptions> <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>IIS, zahrňte konfiguraci služby v aplikaci .</span><span class="sxs-lookup"><span data-stu-id="c4614-1059">To configure IIS options, include a service configuration for <xref:Microsoft.AspNetCore.Builder.IISOptions> in <xref:Microsoft.AspNetCore.Hosting.IStartup.ConfigureServices*>.</span></span> <span data-ttu-id="c4614-1060">Následující příklad zabrání aplikaci v naplnění `HttpContext.Connection.ClientCertificate`:</span><span class="sxs-lookup"><span data-stu-id="c4614-1060">The following example prevents the app from populating `HttpContext.Connection.ClientCertificate`:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="c4614-1061">Možnost</span><span class="sxs-lookup"><span data-stu-id="c4614-1061">Option</span></span>                         | <span data-ttu-id="c4614-1062">Výchozí</span><span class="sxs-lookup"><span data-stu-id="c4614-1062">Default</span></span> | <span data-ttu-id="c4614-1063">Nastavení</span><span class="sxs-lookup"><span data-stu-id="c4614-1063">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="c4614-1064">Pokud `true` [middleware integrace služby IIS](#enable-the-iisintegration-components) nastaví ověřené ověřování systému `HttpContext.User` [Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-1064">If `true`, [IIS Integration Middleware](#enable-the-iisintegration-components) sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="c4614-1065">Pokud `false`middleware poskytuje identitu `HttpContext.User` a reaguje na problémy pouze na `AuthenticationScheme`žádost .</span><span class="sxs-lookup"><span data-stu-id="c4614-1065">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="c4614-1066">Aby bylo možné službu `AutomaticAuthentication` IIS fungovat, musí být ve službě IIS povoleno ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-1066">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="c4614-1067">Další informace naleznete v tématu [Ověřování systému Windows.](xref:security/authentication/windowsauth)</span><span class="sxs-lookup"><span data-stu-id="c4614-1067">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="c4614-1068">Nastaví zobrazované jméno zobrazené uživatelům na přihlašovacích stránkách.</span><span class="sxs-lookup"><span data-stu-id="c4614-1068">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="c4614-1069">Pokud `true` a `MS-ASPNETCORE-CLIENTCERT` hlavička požadavku `HttpContext.Connection.ClientCertificate` je k dispozici, je naplněn.</span><span class="sxs-lookup"><span data-stu-id="c4614-1069">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="c4614-1070">Scénáře proxy serveru a vyrovnávání zatížení</span><span class="sxs-lookup"><span data-stu-id="c4614-1070">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="c4614-1071">[Middleware integrace služby IIS](#enable-the-iisintegration-components), který konfiguruje middleware předávaných záhlaví a ASP.NET základní modul, jsou nakonfigurovány tak, aby předávaly schéma (HTTP/HTTPS) a vzdálenou adresu IP, ze které požadavek pochází.</span><span class="sxs-lookup"><span data-stu-id="c4614-1071">The [IIS Integration Middleware](#enable-the-iisintegration-components), which configures Forwarded Headers Middleware, and the ASP.NET Core Module are configured to forward the scheme (HTTP/HTTPS) and the remote IP address where the request originated.</span></span> <span data-ttu-id="c4614-1072">Další konfigurace může být vyžadována pro aplikace hostované za dalšími proxy servery a nástroji pro vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="c4614-1072">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="c4614-1073">Další informace naleznete v [tématu Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="c4614-1073">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="c4614-1074">soubor web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-1074">web.config file</span></span>

<span data-ttu-id="c4614-1075">Soubor *web.config* konfiguruje [základní modul ASP.NET](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="c4614-1075">The *web.config* file configures the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="c4614-1076">Při publikování projektu je vytváření, transformace a publikování souboru *web.config* zpracováno cílem MSBuild (`_TransformWebConfig`).</span><span class="sxs-lookup"><span data-stu-id="c4614-1076">Creating, transforming, and publishing the *web.config* file is handled by an MSBuild target (`_TransformWebConfig`) when the project is published.</span></span> <span data-ttu-id="c4614-1077">Tento cíl je k dispozici v`Microsoft.NET.Sdk.Web`cílech sady Web SDK ( ).</span><span class="sxs-lookup"><span data-stu-id="c4614-1077">This target is present in the Web SDK targets (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="c4614-1078">Sada SDK je nastavena v horní části souboru projektu:</span><span class="sxs-lookup"><span data-stu-id="c4614-1078">The SDK is set at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="c4614-1079">Pokud soubor *web.config* není v projektu přítomen, je soubor vytvořen se správnou *processPath* a *argumenty* pro konfiguraci ASP.NET základnímodul a přesunutna do [publikovaného výstupu](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="c4614-1079">If a *web.config* file isn't present in the project, the file is created with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="c4614-1080">Pokud *web.config* soubor je přítomen v projektu, soubor je transformován se správným *processPath* a *argumenty* pro konfiguraci ASP.NET core modul a přesunuta do publikovaného výstupu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1080">If a *web.config* file is present in the project, the file is transformed with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="c4614-1081">Transformace nezmění nastavení konfigurace služby IIS v souboru.</span><span class="sxs-lookup"><span data-stu-id="c4614-1081">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="c4614-1082">Soubor *web.config* může poskytovat další nastavení konfigurace služby IIS, která řídí aktivní moduly služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1082">The *web.config* file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="c4614-1083">Informace o modulech služby IIS, které jsou schopné zpracovávat požadavky pomocí aplikací ASP.NET Core, naleznete v tématu [modulů služby IIS.](xref:host-and-deploy/iis/modules)</span><span class="sxs-lookup"><span data-stu-id="c4614-1083">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="c4614-1084">Chcete-li zabránit webové sady SDK v transformaci souboru *web.config,* použijte vlastnost \*\* \<IsTransformWebConfigDisabled>\*\* v souboru projektu:</span><span class="sxs-lookup"><span data-stu-id="c4614-1084">To prevent the Web SDK from transforming the *web.config* file, use the **\<IsTransformWebConfigDisabled>** property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="c4614-1085">Při zakázání webové sady SDK z transformace souboru *processPath* a argumenty by měly být ručně *nastaveny* vývojářem.</span><span class="sxs-lookup"><span data-stu-id="c4614-1085">When disabling the Web SDK from transforming the file, the *processPath* and *arguments* should be manually set by the developer.</span></span> <span data-ttu-id="c4614-1086">Další informace naleznete v tématu <xref:host-and-deploy/aspnet-core-module>.</span><span class="sxs-lookup"><span data-stu-id="c4614-1086">For more information, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="c4614-1087">umístění souboru web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-1087">web.config file location</span></span>

<span data-ttu-id="c4614-1088">Aby bylo možné správně nastavit [ASP.NET core modul,](xref:host-and-deploy/aspnet-core-module) musí být soubor *web.config* přítomen na [cestě kořenového obsahu](xref:fundamentals/index#content-root) (obvykle základní cesta aplikace) nasazené aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1088">In order to set up the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) correctly, the *web.config* file must be present at the [content root](xref:fundamentals/index#content-root) path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="c4614-1089">Jedná se o stejné umístění jako fyzická cesta k webu poskytnutá službu IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1089">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="c4614-1090">Soubor *web.config* je vyžadován v kořenovém adresáři aplikace, aby bylo možné publikovat více aplikací pomocí nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1090">The *web.config* file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="c4614-1091">Na fyzické cestě aplikace existují citlivé soubory, například \* \<assembly>.runtimeconfig.json*, \* \<assembly>.xml* (komentáře xml documentation) a \* \<assembly>.deps.json\*.</span><span class="sxs-lookup"><span data-stu-id="c4614-1091">Sensitive files exist on the app's physical path, such as *\<assembly>.runtimeconfig.json*, *\<assembly>.xml* (XML Documentation comments), and *\<assembly>.deps.json*.</span></span> <span data-ttu-id="c4614-1092">Pokud je soubor *web.config* přítomen a web se spustí normálně, služby IIS tyto citlivé soubory neobsluhuje, pokud jsou požadovány.</span><span class="sxs-lookup"><span data-stu-id="c4614-1092">When the *web.config* file is present and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="c4614-1093">Pokud soubor *web.config* chybí, je nesprávně pojmenován nebo jej nelze nakonfigurovat pro normální spuštění, může služba IIS veřejně sloužit citlivým souborům.</span><span class="sxs-lookup"><span data-stu-id="c4614-1093">If the *web.config* file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="c4614-1094">**Soubor *web.config* musí být v nasazení vždy přítomen, správně pojmenovaný a musí být schopen nakonfigurovat web pro normální spuštění. Nikdy neodstraňujte soubor *web.config* z produkčního nasazení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1094">**The *web.config* file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the *web.config* file from a production deployment.**</span></span>

### <a name="transform-webconfig"></a><span data-ttu-id="c4614-1095">Transformace souboru web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-1095">Transform web.config</span></span>

<span data-ttu-id="c4614-1096">Pokud potřebujete transformovat *web.config* při publikování (například nastavit proměnné prostředí na základě konfigurace, profilu nebo prostředí), přečtěte si viz <xref:host-and-deploy/iis/transform-webconfig>.</span><span class="sxs-lookup"><span data-stu-id="c4614-1096">If you need to transform *web.config* on publish (for example, set environment variables based on the configuration, profile, or environment), see <xref:host-and-deploy/iis/transform-webconfig>.</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="c4614-1097">Konfigurace služby IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-1097">IIS configuration</span></span>

<span data-ttu-id="c4614-1098">**Operační systémy Windows Server**</span><span class="sxs-lookup"><span data-stu-id="c4614-1098">**Windows Server operating systems**</span></span>

<span data-ttu-id="c4614-1099">Povolte roli serveru **webového serveru (IIS)** a vytvořte služby rolí.</span><span class="sxs-lookup"><span data-stu-id="c4614-1099">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="c4614-1100">Použijte Průvodce **přidáním rolí a funkcí** z nabídky **Spravovat** nebo odkaz ve **Správci serveru**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1100">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager**.</span></span> <span data-ttu-id="c4614-1101">V kroku **Role serveru** zaškrtněte políčko **U webového serveru (IIS).**</span><span class="sxs-lookup"><span data-stu-id="c4614-1101">On the **Server Roles** step, check the box for **Web Server (IIS)**.</span></span>

   ![Role služby IIS webového serveru je vybrána v kroku Vybrat role serveru.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="c4614-1103">Po kroku **Funkce** se krok **služby role** načte pro webový server (IIS).</span><span class="sxs-lookup"><span data-stu-id="c4614-1103">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="c4614-1104">Vyberte požadované služby rolí služby IIS nebo přijměte výchozí služby rolí, které jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="c4614-1104">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![Výchozí služby rolí jsou vybrány v kroku Vybrat služby rolí.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="c4614-1106">**Ověřování systému Windows (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-1106">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="c4614-1107">Chcete-li povolit ověřování systému Windows, rozbalte následující uzly:**Zabezpečení** **webového serveru** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-1107">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security**.</span></span> <span data-ttu-id="c4614-1108">Vyberte funkci **Ověřování systému Windows.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1108">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="c4614-1109">Další informace naleznete v [tématech Ověřování \<systému Windows windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) a Konfigurace ověřování [systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-1109">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="c4614-1110">**WebSockets (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-1110">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="c4614-1111">WebSockets je podporován ASP.NET jádrem 1.1 nebo novějším.</span><span class="sxs-lookup"><span data-stu-id="c4614-1111">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="c4614-1112">Chcete-li povolit rozhraní WebSockets, rozbalte následující uzly:**Vývoj aplikací webového** **serveru** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-1112">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development**.</span></span> <span data-ttu-id="c4614-1113">Vyberte funkci **WebSocket Protocol.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1113">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="c4614-1114">Další informace naleznete v tématu [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="c4614-1114">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="c4614-1115">Pokračujte v **potvrzovacím** kroku a nainstalujte roli a služby webového serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-1115">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="c4614-1116">Po instalaci role **webového serveru (IIS)** není restartování serveru nebo služby IIS vyžadováno.</span><span class="sxs-lookup"><span data-stu-id="c4614-1116">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="c4614-1117">**Desktopové operační systémy Windows**</span><span class="sxs-lookup"><span data-stu-id="c4614-1117">**Windows desktop operating systems**</span></span>

<span data-ttu-id="c4614-1118">Povolte **konzolu pro správu služby IIS** a **služby World Wide Web Services**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1118">Enable the **IIS Management Console** and **World Wide Web Services**.</span></span>

1. <span data-ttu-id="c4614-1119">Přejděte na **Ovládací panely** > **Programy** > **a funkce** > **Zapněte nebo vypněte funkce systému Windows** (levá strana obrazovky).</span><span class="sxs-lookup"><span data-stu-id="c4614-1119">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="c4614-1120">Otevřete uzel **Internetové informační služby.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1120">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="c4614-1121">Otevřete uzel **Nástroje pro správu webu.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1121">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="c4614-1122">Zaškrtněte políčko **U konzole pro správu služby IIS**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1122">Check the box for **IIS Management Console**.</span></span>

1. <span data-ttu-id="c4614-1123">Zaškrtněte políčko **U služeb World Wide Web Services**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1123">Check the box for **World Wide Web Services**.</span></span>

1. <span data-ttu-id="c4614-1124">Přijměte výchozí funkce **pro služby World Wide Web Services** nebo upravte funkce služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1124">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="c4614-1125">**Ověřování systému Windows (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-1125">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="c4614-1126">Chcete-li povolit ověřování systému Windows, rozbalte následující uzly: **World Wide Web Services** > **Security**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1126">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security**.</span></span> <span data-ttu-id="c4614-1127">Vyberte funkci **Ověřování systému Windows.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1127">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="c4614-1128">Další informace naleznete v [tématech Ověřování \<systému Windows windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) a Konfigurace ověřování [systému Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-1128">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="c4614-1129">**WebSockets (volitelné)**</span><span class="sxs-lookup"><span data-stu-id="c4614-1129">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="c4614-1130">WebSockets je podporován ASP.NET jádrem 1.1 nebo novějším.</span><span class="sxs-lookup"><span data-stu-id="c4614-1130">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="c4614-1131">Chcete-li povolit rozhraní WebSockets, rozbalte následující uzly: Funkce**vývoje aplikací**pro **webové služby** > .</span><span class="sxs-lookup"><span data-stu-id="c4614-1131">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features**.</span></span> <span data-ttu-id="c4614-1132">Vyberte funkci **WebSocket Protocol.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1132">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="c4614-1133">Další informace naleznete v tématu [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="c4614-1133">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="c4614-1134">Pokud instalace služby IIS vyžaduje restartování, restartujte systém.</span><span class="sxs-lookup"><span data-stu-id="c4614-1134">If the IIS installation requires a restart, restart the system.</span></span>

![V funkcích systému Windows jsou vybrány konzoly IIS Management Console a služby World Wide Web Services.](index/_static/windows-features-win10.png)

## <a name="install-the-net-core-hosting-bundle"></a><span data-ttu-id="c4614-1136">Instalace balíčku hostingu jádra .NET</span><span class="sxs-lookup"><span data-stu-id="c4614-1136">Install the .NET Core Hosting Bundle</span></span>

<span data-ttu-id="c4614-1137">Nainstalujte *balíček .NET Core Hosting do* hostitelského systému.</span><span class="sxs-lookup"><span data-stu-id="c4614-1137">Install the *.NET Core Hosting Bundle* on the hosting system.</span></span> <span data-ttu-id="c4614-1138">Balíček nainstaluje modul .NET Core Runtime, knihovnu .NET Core Library a [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="c4614-1138">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span> <span data-ttu-id="c4614-1139">Modul umožňuje ASP.NET aplikace Core běžet za službou IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1139">The module allows ASP.NET Core apps to run behind IIS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c4614-1140">Pokud je sada Hosting Bundle nainstalována před službou IIS, musí být instalace balíčku opravena.</span><span class="sxs-lookup"><span data-stu-id="c4614-1140">If the Hosting Bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="c4614-1141">Po instalaci služby IIS znovu spusťte instalační program sady Hosting Bundle.</span><span class="sxs-lookup"><span data-stu-id="c4614-1141">Run the Hosting Bundle installer again after installing IIS.</span></span>
>
> <span data-ttu-id="c4614-1142">Pokud je sada Hosting Bundle nainstalována po instalaci 64bitové (x64) verze rozhraní .NET Core, mohou se zdát, že sady SDK chybí ([byly zjištěny sady SDK .Net Core .](xref:test/troubleshoot#no-net-core-sdks-were-detected)</span><span class="sxs-lookup"><span data-stu-id="c4614-1142">If the Hosting Bundle is installed after installing the 64-bit (x64) version of .NET Core, SDKs might appear to be missing ([No .NET Core SDKs were detected](xref:test/troubleshoot#no-net-core-sdks-were-detected)).</span></span> <span data-ttu-id="c4614-1143">Chcete-li problém <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>vyřešit, naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-1143">To resolve the problem, see <xref:test/troubleshoot#missing-sdk-after-installing-the-net-core-hosting-bundle>.</span></span>

### <a name="download"></a><span data-ttu-id="c4614-1144">Stáhnout</span><span class="sxs-lookup"><span data-stu-id="c4614-1144">Download</span></span>

1. <span data-ttu-id="c4614-1145">Přejděte na stránku [Stáhnout jádro rozhraní .NET.](https://dotnet.microsoft.com/download/dotnet-core)</span><span class="sxs-lookup"><span data-stu-id="c4614-1145">Navigate to the [Download .NET Core](https://dotnet.microsoft.com/download/dotnet-core) page.</span></span>
1. <span data-ttu-id="c4614-1146">Vyberte požadovanou verzi .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-1146">Select the desired .NET Core version.</span></span>
1. <span data-ttu-id="c4614-1147">Ve sloupci **Spustit aplikace – runtime** najděte požadovaný řádek požadované verze runtime .NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-1147">In the **Run apps - Runtime** column, find the row of the .NET Core runtime version desired.</span></span>
1. <span data-ttu-id="c4614-1148">Stáhněte si instalační program pomocí odkazu **Hosting Bundle.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1148">Download the installer using the **Hosting Bundle** link.</span></span>

> [!WARNING]
> <span data-ttu-id="c4614-1149">Některé instalační programy obsahují verze, které dosáhly konce životnosti (EOL) a které již nejsou podporovány společností Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c4614-1149">Some installers contain release versions that have reached their end of life (EOL) and are no longer supported by Microsoft.</span></span> <span data-ttu-id="c4614-1150">Další informace naleznete v [zásadách podpory](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span><span class="sxs-lookup"><span data-stu-id="c4614-1150">For more information, see the [support policy](https://dotnet.microsoft.com/platform/support/policy/dotnet-core).</span></span>

### <a name="install-the-hosting-bundle"></a><span data-ttu-id="c4614-1151">Nainstalujte balíček hostingu</span><span class="sxs-lookup"><span data-stu-id="c4614-1151">Install the Hosting Bundle</span></span>

1. <span data-ttu-id="c4614-1152">Spusťte instalační program na serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-1152">Run the installer on the server.</span></span> <span data-ttu-id="c4614-1153">Při spuštění instalačního programu z příkazového prostředí správce jsou k dispozici následující parametry:</span><span class="sxs-lookup"><span data-stu-id="c4614-1153">The following parameters are available when running the installer from an administrator command shell:</span></span>

   * <span data-ttu-id="c4614-1154">`OPT_NO_ANCM=1`&ndash; Přeskočte instalaci ASP.NET základního modulu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1154">`OPT_NO_ANCM=1` &ndash; Skip installing the ASP.NET Core Module.</span></span>
   * <span data-ttu-id="c4614-1155">`OPT_NO_RUNTIME=1`&ndash; Přeskočte instalaci runtime jádra .NET.</span><span class="sxs-lookup"><span data-stu-id="c4614-1155">`OPT_NO_RUNTIME=1` &ndash; Skip installing the .NET Core runtime.</span></span> <span data-ttu-id="c4614-1156">Používá se v případě, že server hostuje pouze [samostatná nasazení (SCD).](/dotnet/core/deploying/#self-contained-deployments-scd)</span><span class="sxs-lookup"><span data-stu-id="c4614-1156">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="c4614-1157">`OPT_NO_SHAREDFX=1`&ndash; Přeskočit instalaci ASP.NET sdíleného rozhraní (ASP.NET runtime).</span><span class="sxs-lookup"><span data-stu-id="c4614-1157">`OPT_NO_SHAREDFX=1` &ndash; Skip installing the ASP.NET Shared Framework (ASP.NET runtime).</span></span> <span data-ttu-id="c4614-1158">Používá se v případě, že server hostuje pouze [samostatná nasazení (SCD).](/dotnet/core/deploying/#self-contained-deployments-scd)</span><span class="sxs-lookup"><span data-stu-id="c4614-1158">Used when the server only hosts [self-contained deployments (SCD)](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>
   * <span data-ttu-id="c4614-1159">`OPT_NO_X86=1`&ndash; Přeskočit instalaci za běhu x86.</span><span class="sxs-lookup"><span data-stu-id="c4614-1159">`OPT_NO_X86=1` &ndash; Skip installing x86 runtimes.</span></span> <span data-ttu-id="c4614-1160">Tento parametr použijte, pokud víte, že nebudete hostovat 32bitové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1160">Use this parameter when you know that you won't be hosting 32-bit apps.</span></span> <span data-ttu-id="c4614-1161">Pokud existuje nějaká šance, že budete v budoucnu hostovat 32bitové i 64bitové aplikace, nepoužívejte tento parametr a nainstalujte oba runtimes.</span><span class="sxs-lookup"><span data-stu-id="c4614-1161">If there's any chance that you will host both 32-bit and 64-bit apps in the future, don't use this parameter and install both runtimes.</span></span>
   * <span data-ttu-id="c4614-1162">`OPT_NO_SHARED_CONFIG_CHECK=1`&ndash; Zakažte kontrolu použití sdílené konfigurace služby IIS, pokud je sdílená konfigurace *(applicationHost.config)* ve stejném počítači jako instalace služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1162">`OPT_NO_SHARED_CONFIG_CHECK=1` &ndash; Disable the check for using an IIS Shared Configuration when the shared configuration (*applicationHost.config*) is on the same machine as the IIS installation.</span></span> <span data-ttu-id="c4614-1163">*K dispozici pouze pro ASP.NET instalačních programů hostingu Bundler nebo novějším.*</span><span class="sxs-lookup"><span data-stu-id="c4614-1163">*Only available for ASP.NET Core 2.2 or later Hosting Bundler installers.*</span></span> <span data-ttu-id="c4614-1164">Další informace naleznete v tématu <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span><span class="sxs-lookup"><span data-stu-id="c4614-1164">For more information, see <xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration>.</span></span>
1. <span data-ttu-id="c4614-1165">Restartujte systém nebo proveďte následující příkazy v příkazovém prostředí:</span><span class="sxs-lookup"><span data-stu-id="c4614-1165">Restart the system or execute the following commands in a command shell:</span></span>

   ```console
   net stop was /y
   net start w3svc
   ```
   <span data-ttu-id="c4614-1166">Restartování služby IIS vyvolá změnu systémové cesty, což je proměnná prostředí provedená instalačním programem.</span><span class="sxs-lookup"><span data-stu-id="c4614-1166">Restarting IIS picks up a change to the system PATH, which is an environment variable, made by the installer.</span></span>

<span data-ttu-id="c4614-1167">Při instalaci balíčku Hosting Bundle není nutné ručně zastavovat jednotlivé weby ve službách IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1167">It isn't necessary to manually stop individual sites in IIS when installing the Hosting Bundle.</span></span> <span data-ttu-id="c4614-1168">Hostované aplikace (weby služby IIS) se restartují při restartování služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1168">Hosted apps (IIS sites) restart when IIS restarts.</span></span> <span data-ttu-id="c4614-1169">Aplikace se znovu spustí, když obdrží svůj první požadavek, včetně z [modulu inicializace aplikace](#application-initialization-module-and-idle-timeout).</span><span class="sxs-lookup"><span data-stu-id="c4614-1169">Apps start up again when they receive their first request, including from the [Application Initialization Module](#application-initialization-module-and-idle-timeout).</span></span>

<span data-ttu-id="c4614-1170">ASP.NET Core přijímá roll-forward chování pro opravy vydání sdílených rámců.</span><span class="sxs-lookup"><span data-stu-id="c4614-1170">ASP.NET Core adopts roll-forward behavior for patch releases of shared framework packages.</span></span> <span data-ttu-id="c4614-1171">Když se aplikace hostované službou IIS restartují se službou IIS, aplikace se načítají nejnovějšími verzemi oprav svých odkazovaných balíčků, když obdrží svůj první požadavek.</span><span class="sxs-lookup"><span data-stu-id="c4614-1171">When apps hosted by IIS restart with IIS, the apps load with the latest patch releases of their referenced packages when they receive their first request.</span></span> <span data-ttu-id="c4614-1172">Pokud služba IIS není restartována, aplikace se restartují a vykazují chování pro předávání vpřed, když jsou jejich pracovní procesy recyklovány a obdrží první požadavek.</span><span class="sxs-lookup"><span data-stu-id="c4614-1172">If IIS isn't restarted, apps restart and exhibit roll-forward behavior when their worker processes are recycled and they receive their first request.</span></span>

> [!NOTE]
> <span data-ttu-id="c4614-1173">Informace o sdílené konfiguraci služby IIS naleznete [v tématu ASP.NET Core Module se sdílenou konfigurací služby IIS](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span><span class="sxs-lookup"><span data-stu-id="c4614-1173">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="c4614-1174">Instalace nasazení webu při publikování pomocí sady Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c4614-1174">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="c4614-1175">Při nasazování aplikací na servery s [nasazením webu](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later)nainstalujte na server nejnovější verzi nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1175">When deploying apps to servers with [Web Deploy](/iis/install/installing-publishing-technologies/installing-and-configuring-web-deploy-on-iis-80-or-later), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="c4614-1176">Chcete-li nainstalovat nasazení webu, použijte [Instalační službu webové platformy (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) nebo získejte instalační program přímo ze [služby Stažení softwaru](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="c4614-1176">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="c4614-1177">Upřednostňovanou metodou je použití webpi.</span><span class="sxs-lookup"><span data-stu-id="c4614-1177">The preferred method is to use WebPI.</span></span> <span data-ttu-id="c4614-1178">WebPI nabízí samostatné nastavení a konfiguraci pro poskytovatele hostingu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1178">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="c4614-1179">Vytvoření webu iis</span><span class="sxs-lookup"><span data-stu-id="c4614-1179">Create the IIS site</span></span>

1. <span data-ttu-id="c4614-1180">V hostitelském systému vytvořte složku, která bude obsahovat publikované složky a soubory aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1180">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="c4614-1181">V následujícím kroku je cesta ke složce k dispozici službu IIS jako fyzická cesta k aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-1181">In a following step, the folder's path is provided to IIS as the physical path to the app.</span></span> <span data-ttu-id="c4614-1182">Další informace o složce nasazení aplikace a <xref:host-and-deploy/directory-structure>rozložení souborů naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-1182">For more information on an app's deployment folder and file layout, see <xref:host-and-deploy/directory-structure>.</span></span>

1. <span data-ttu-id="c4614-1183">Ve Správci služby IIS otevřete uzel serveru v panelu **Připojení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1183">In IIS Manager, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="c4614-1184">Klikněte pravým tlačítkem myši na složku **Weby.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1184">Right-click the **Sites** folder.</span></span> <span data-ttu-id="c4614-1185">V kontextové nabídce vyberte **Přidat web.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1185">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="c4614-1186">Zadejte **název webu** a nastavte **fyzickou cestu** ke složce nasazení aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1186">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="c4614-1187">Zadejte konfiguraci **vazby** a vytvořte web výběrem **možnosti OK**:</span><span class="sxs-lookup"><span data-stu-id="c4614-1187">Provide the **Binding** configuration and create the website by selecting **OK**:</span></span>

   ![V kroku Přidat web zadejte název webu, fyzickou cestu a název hostitele.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="c4614-1189">Vazby se zástupnými`http://*:80/` symboly nejvyšší úrovně ( a `http://+:80`) by **neměly** být používány.</span><span class="sxs-lookup"><span data-stu-id="c4614-1189">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="c4614-1190">Vazby se zástupnými symboly nejvyšší úrovně mohou otevřít vaši aplikaci slabá místa zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="c4614-1190">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="c4614-1191">To platí pro silné i slabé zástupné znaky.</span><span class="sxs-lookup"><span data-stu-id="c4614-1191">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="c4614-1192">Používejte explicitní názvy hostitelů místo zástupných znaků.</span><span class="sxs-lookup"><span data-stu-id="c4614-1192">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="c4614-1193">Vazba se zástupnými znaky subdomény (například) nemá toto bezpečnostní riziko, `*.mysub.com` `*.com`pokud řídíte celou nadřazenou doménu (na rozdíl od , která je zranitelná).</span><span class="sxs-lookup"><span data-stu-id="c4614-1193">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="c4614-1194">Viz [rfc7230 sekce-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) pro více informací.</span><span class="sxs-lookup"><span data-stu-id="c4614-1194">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="c4614-1195">Pod uzlovým serverem vyberte **fondy aplikací**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1195">Under the server's node, select **Application Pools**.</span></span>

1. <span data-ttu-id="c4614-1196">Klikněte pravým tlačítkem myši na fond aplikací webu a v kontextové nabídce vyberte **Základní nastavení.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1196">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="c4614-1197">V okně **Upravit fond aplikací** nastavte verzi **.NET CLR** na **Žádný spravovaný kód**:</span><span class="sxs-lookup"><span data-stu-id="c4614-1197">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code**:</span></span>

   ![Pro verzi CLR rozhraní .NET nenastavte žádný spravovaný kód.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="c4614-1199">ASP.NET Core běží v samostatném procesu a spravuje runtime.</span><span class="sxs-lookup"><span data-stu-id="c4614-1199">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="c4614-1200">ASP.NET Core nespoléhá na načtení plochy CLR (.NET CLR)&mdash;Core Common Language Runtime (CoreCLR) pro .NET Core je spuštěn pro hostování aplikace v pracovním procesu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1200">ASP.NET Core doesn't rely on loading the desktop CLR (.NET CLR)&mdash;the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process.</span></span> <span data-ttu-id="c4614-1201">Nastavení **verze .NET CLR** na **žádný spravovaný kód** je volitelné, ale doporučeno.</span><span class="sxs-lookup"><span data-stu-id="c4614-1201">Setting the **.NET CLR version** to **No Managed Code** is optional but recommended.</span></span>

1. <span data-ttu-id="c4614-1202">*ASP.NET jádra 2.2 nebo novějšího:* Pro 64bitové (x64) [samostatné nasazení,](/dotnet/core/deploying/#self-contained-deployments-scd) které používá [model hostování v procesu](#in-process-hosting-model), zakažte fond aplikací pro 32bitové (x86) procesy.</span><span class="sxs-lookup"><span data-stu-id="c4614-1202">*ASP.NET Core 2.2 or later*: For a 64-bit (x64) [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd) that uses the [in-process hosting model](#in-process-hosting-model), disable the app pool for 32-bit (x86) processes.</span></span>

   <span data-ttu-id="c4614-1203">V postranním panelu **Akce** správce služby IIS > **fondy aplikací**vyberte **možnost Nastavit výchozí nastavení fondu aplikací** nebo **Upřesnit nastavení**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1203">In the **Actions** sidebar of IIS Manager > **Application Pools**, select **Set Application Pool Defaults** or **Advanced Settings**.</span></span> <span data-ttu-id="c4614-1204">Vyhledejte **funkci Povolit 32bitové aplikace** a nastavte hodnotu na . `False`</span><span class="sxs-lookup"><span data-stu-id="c4614-1204">Locate **Enable 32-Bit Applications** and set the value to `False`.</span></span> <span data-ttu-id="c4614-1205">Toto nastavení nemá vliv na aplikace nasazené pro [mimoprocesový hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span><span class="sxs-lookup"><span data-stu-id="c4614-1205">This setting doesn't affect apps deployed for [out-of-process hosting](xref:host-and-deploy/aspnet-core-module#out-of-process-hosting-model).</span></span>

1. <span data-ttu-id="c4614-1206">Potvrďte, že identita modelu procesu má správná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="c4614-1206">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="c4614-1207">Pokud se výchozí identita fondu aplikací **(identita\*\*\*\*procesního modelu** > ) změní z **ApplicationPoolIdentity** na jinou identitu, ověřte, zda nová identita má požadovaná oprávnění pro přístup ke složce, databázi a dalším požadovaným prostředkům aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1207">If the default identity of the app pool (**Process Model** > **Identity**) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="c4614-1208">Fond aplikací například vyžaduje přístup pro čtení a zápis do složek, kde aplikace čte a zapisuje soubory.</span><span class="sxs-lookup"><span data-stu-id="c4614-1208">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="c4614-1209">**Konfigurace ověřování systému Windows (volitelná)**</span><span class="sxs-lookup"><span data-stu-id="c4614-1209">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="c4614-1210">Další informace naleznete v [tématu Configure Windows authentication](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="c4614-1210">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="c4614-1211">Nasazení aplikace</span><span class="sxs-lookup"><span data-stu-id="c4614-1211">Deploy the app</span></span>

<span data-ttu-id="c4614-1212">Nasaďte aplikaci do složky **Fyzické cesty** služby IIS, která byla vytvořena v části Vytvořit [web služby IIS.](#create-the-iis-site)</span><span class="sxs-lookup"><span data-stu-id="c4614-1212">Deploy the app to the IIS **Physical path** folder that was established in the [Create the IIS site](#create-the-iis-site) section.</span></span> <span data-ttu-id="c4614-1213">[Nasazení webu](/iis/publish/using-web-deploy/introduction-to-web-deploy) je doporučený mechanismus pro nasazení, ale existuje několik možností pro přesunutí aplikace ze složky *publikování* projektu do složky nasazení hostitelského systému.</span><span class="sxs-lookup"><span data-stu-id="c4614-1213">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment, but several options exist for moving the app from the project's *publish* folder to the hosting system's deployment folder.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="c4614-1214">Nasazení webu pomocí sady Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c4614-1214">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="c4614-1215">Podívejte se na [profily publikování aplikace Visual Studio pro téma nasazení aplikace ASP.NET Core,](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) kde se dozvíte, jak vytvořit profil publikování pro použití s nasazením webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1215">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="c4614-1216">Pokud poskytovatel hostingu poskytuje profil publikování nebo podporu pro jeho vytvoření, stáhněte si jeho profil a importujte jej pomocí dialogového okna **Publikovat** sady Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="c4614-1216">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog:</span></span>

![Stránka dialogového okna Publikovat](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="c4614-1218">Nasazení webu mimo Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c4614-1218">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="c4614-1219">[Nasazení webu](/iis/publish/using-web-deploy/introduction-to-web-deploy) lze také použít mimo Visual Studio z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="c4614-1219">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="c4614-1220">Další informace naleznete v [tématu Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="c4614-1220">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="c4614-1221">Alternativy k nasazení webu</span><span class="sxs-lookup"><span data-stu-id="c4614-1221">Alternatives to Web Deploy</span></span>

<span data-ttu-id="c4614-1222">Pomocí některé z několika metod přesuňte aplikaci do hostitelského systému, jako je ruční kopírování, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy)nebo [PowerShell](/powershell/).</span><span class="sxs-lookup"><span data-stu-id="c4614-1222">Use any of several methods to move the app to the hosting system, such as manual copy, [Xcopy](/windows-server/administration/windows-commands/xcopy), [Robocopy](/windows-server/administration/windows-commands/robocopy), or [PowerShell](/powershell/).</span></span>

<span data-ttu-id="c4614-1223">Další informace o ASP.NET nasazení jádra do služby IIS naleznete v části [Prostředky nasazení pro správce služby IIS.](#deployment-resources-for-iis-administrators)</span><span class="sxs-lookup"><span data-stu-id="c4614-1223">For more information on ASP.NET Core deployment to IIS, see the [Deployment resources for IIS administrators](#deployment-resources-for-iis-administrators) section.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="c4614-1224">Procházení webu</span><span class="sxs-lookup"><span data-stu-id="c4614-1224">Browse the website</span></span>

<span data-ttu-id="c4614-1225">Po nasazení aplikace do hostitelského systému požádejte o jeden z veřejných koncových bodů aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1225">After the app is deployed to the hosting system, make a request to one of the app's public endpoints.</span></span>

<span data-ttu-id="c4614-1226">V následujícím příkladu je web vázán na název `www.mysite.com` **hostitele** iis na **portu** `80`.</span><span class="sxs-lookup"><span data-stu-id="c4614-1226">In the following example, the site is bound to an IIS **Host name** of `www.mysite.com` on **Port** `80`.</span></span> <span data-ttu-id="c4614-1227">Žádost se podává `http://www.mysite.com`na :</span><span class="sxs-lookup"><span data-stu-id="c4614-1227">A request is made to `http://www.mysite.com`:</span></span>

![Prohlížeč Microsoft Edge načetl úvodní stránku služby IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="c4614-1229">Uzamčené soubory nasazení</span><span class="sxs-lookup"><span data-stu-id="c4614-1229">Locked deployment files</span></span>

<span data-ttu-id="c4614-1230">Soubory ve složce nasazení jsou uzamčeny, když je aplikace spuštěná.</span><span class="sxs-lookup"><span data-stu-id="c4614-1230">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="c4614-1231">Uzamčené soubory nelze během nasazení přepsat.</span><span class="sxs-lookup"><span data-stu-id="c4614-1231">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="c4614-1232">Chcete-li uvolnit uzamčené soubory v nasazení, zastavte fond aplikací pomocí **jednoho z** následujících přístupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-1232">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="c4614-1233">Použijte nasazení webu `Microsoft.NET.Sdk.Web` a odkaz v souboru projektu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1233">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="c4614-1234">Soubor *app_offline.htm* je umístěn v kořenovém adresáři webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1234">An *app_offline.htm* file is placed at the root of the web app directory.</span></span> <span data-ttu-id="c4614-1235">Když je soubor k dispozici, ASP.NET základní modul řádně vypne aplikaci a slouží *souboru app_offline.htm* během nasazení.</span><span class="sxs-lookup"><span data-stu-id="c4614-1235">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the *app_offline.htm* file during the deployment.</span></span> <span data-ttu-id="c4614-1236">Další informace naleznete v [odkazu na konfiguraci ASP.NET core modulem](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span><span class="sxs-lookup"><span data-stu-id="c4614-1236">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#app_offlinehtm).</span></span>
* <span data-ttu-id="c4614-1237">Ručně zastavit fond aplikací ve Správci služby IIS na serveru.</span><span class="sxs-lookup"><span data-stu-id="c4614-1237">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="c4614-1238">Použití Prostředí PowerShell k přetažení *app_offline.htm* (vyžaduje PowerShell 5 nebo novější):</span><span class="sxs-lookup"><span data-stu-id="c4614-1238">Use PowerShell to drop *app_offline.htm* (requires PowerShell 5 or later):</span></span>

  ```powershell
  $pathToApp = 'PATH_TO_APP'

  # Stop the AppPool
  New-Item -Path $pathToApp app_offline.htm

  # Provide script commands here to deploy the app

  # Restart the AppPool
  Remove-Item -Path $pathToApp app_offline.htm

  ```

## <a name="data-protection"></a><span data-ttu-id="c4614-1239">Ochrana dat</span><span class="sxs-lookup"><span data-stu-id="c4614-1239">Data protection</span></span>

<span data-ttu-id="c4614-1240">Zásobník [ASP.NET Core Data Protection](xref:security/data-protection/introduction) používá několik [middlewares](xref:fundamentals/middleware/index)ASP.NET Core , včetně middlewaru používaného při ověřování.</span><span class="sxs-lookup"><span data-stu-id="c4614-1240">The [ASP.NET Core Data Protection stack](xref:security/data-protection/introduction) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="c4614-1241">I v případě, že rozhraní API ochrany dat nejsou volána uživatelským kódem, ochrana dat by měla být nakonfigurována pomocí skriptu nasazení nebo v uživatelském kódu, aby se vytvořilo trvalé úložiště kryptografických [klíčů](xref:security/data-protection/implementation/key-management).</span><span class="sxs-lookup"><span data-stu-id="c4614-1241">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="c4614-1242">Pokud ochrana dat není nakonfigurována, klíče jsou uloženy v paměti a po restartování aplikace zahozeny.</span><span class="sxs-lookup"><span data-stu-id="c4614-1242">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="c4614-1243">Pokud je kroužek klíče uložen v paměti při restartování aplikace:</span><span class="sxs-lookup"><span data-stu-id="c4614-1243">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="c4614-1244">Všechny ověřovací tokeny založené na souborech cookie jsou zrušeny.</span><span class="sxs-lookup"><span data-stu-id="c4614-1244">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="c4614-1245">Uživatelé se musí znovu přihlásit při dalším požadavku.</span><span class="sxs-lookup"><span data-stu-id="c4614-1245">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="c4614-1246">Všechna data chráněná kroužkem klíče již nelze dešifrovat.</span><span class="sxs-lookup"><span data-stu-id="c4614-1246">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="c4614-1247">To může zahrnovat [tokeny CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) a [ASP.NET základní soubory cookie MVC TempData](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="c4614-1247">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="c4614-1248">Chcete-li nakonfigurovat ochranu dat ve službě IIS tak, aby zachycovací byl kroužek klíče, použijte **jeden** z následujících postupů:</span><span class="sxs-lookup"><span data-stu-id="c4614-1248">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="c4614-1249">**Vytvoření klíčů registru ochrany dat**</span><span class="sxs-lookup"><span data-stu-id="c4614-1249">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="c4614-1250">Klíče ochrany dat používané ASP.NET aplikace Core jsou uloženy v registru mimo aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1250">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="c4614-1251">Chcete-li zachovat klíče pro danou aplikaci, vytvořte klíče registru pro fond aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-1251">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="c4614-1252">Pro samostatné instalace služby IIS mimo webfarmu lze [skript prostředí PowerShell Pro poskytování ochrany dat-AutoGenKeys.ps1](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) použít pro každý fond aplikací používaný s aplikací ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-1252">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/dotnet/AspNetCore/blob/master/src/DataProtection/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="c4614-1253">Tento skript vytvoří klíč registru v registru HKLM, který je přístupný pouze pro účet pracovního procesu fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-1253">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="c4614-1254">Klíče jsou šifrovány v klidovém stavu pomocí dpapi s klíčem pro celý počítač.</span><span class="sxs-lookup"><span data-stu-id="c4614-1254">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="c4614-1255">Ve scénářích webové farmy lze aplikaci nakonfigurovat tak, aby k ukládání kroužku klíčů pro ochranu dat používala cestu UNC.</span><span class="sxs-lookup"><span data-stu-id="c4614-1255">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="c4614-1256">Ve výchozím nastavení nejsou klíče ochrany dat šifrovány.</span><span class="sxs-lookup"><span data-stu-id="c4614-1256">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="c4614-1257">Ujistěte se, že oprávnění k souborům pro sdílenou síť ovou složku jsou omezena na účet Windows, pod kterým aplikace běží.</span><span class="sxs-lookup"><span data-stu-id="c4614-1257">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="c4614-1258">Certifikát X509 lze použít k ochraně klíčů v klidovém stavu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1258">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="c4614-1259">Zvažte mechanismus, který uživatelům umožní nahrávat certifikáty: Umístěte certifikáty do úložiště důvěryhodných certifikátů uživatele a ujistěte se, že jsou k dispozici na všech počítačích, kde je spuštěna aplikace uživatele.</span><span class="sxs-lookup"><span data-stu-id="c4614-1259">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="c4614-1260">Podrobnosti [najdete v tématu Konfigurace ochrany základních dat ASP.NET.](xref:security/data-protection/configuration/overview)</span><span class="sxs-lookup"><span data-stu-id="c4614-1260">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="c4614-1261">**Konfigurace fondu aplikací služby IIS pro načtení profilu uživatele**</span><span class="sxs-lookup"><span data-stu-id="c4614-1261">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="c4614-1262">Toto nastavení je v části **Model procesu** v části **Upřesnit nastavení** pro fond aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-1262">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="c4614-1263">Nastavte **profil načtení uživatele** na `True`.</span><span class="sxs-lookup"><span data-stu-id="c4614-1263">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="c4614-1264">Pokud je `True`nastavena možnost , jsou klíče uloženy v adresáři profilu uživatele a chráněny pomocí rozhraní DPAPI klíčem specifickým pro uživatelský účet.</span><span class="sxs-lookup"><span data-stu-id="c4614-1264">When set to `True`, keys are stored in the user profile directory and protected using DPAPI with a key specific to the user account.</span></span> <span data-ttu-id="c4614-1265">Klíče jsou uloženy ve složce *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys.*</span><span class="sxs-lookup"><span data-stu-id="c4614-1265">Keys are persisted to the *%LOCALAPPDATA%/ASP.NET/DataProtection-Keys* folder.</span></span>

  <span data-ttu-id="c4614-1266">[Atribut setProfileEnvironment](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) fondu aplikací musí být také povolen.</span><span class="sxs-lookup"><span data-stu-id="c4614-1266">The app pool's [setProfileEnvironment attribute](/iis/configuration/system.applicationhost/applicationpools/add/processmodel#configuration) must also be enabled.</span></span> <span data-ttu-id="c4614-1267">Výchozí hodnota `setProfileEnvironment` je `true`.</span><span class="sxs-lookup"><span data-stu-id="c4614-1267">The default value of `setProfileEnvironment` is `true`.</span></span> <span data-ttu-id="c4614-1268">V některých scénářích (například `setProfileEnvironment` operační `false`systém Windows) je nastavena na .</span><span class="sxs-lookup"><span data-stu-id="c4614-1268">In some scenarios (for example, Windows OS), `setProfileEnvironment` is set to `false`.</span></span> <span data-ttu-id="c4614-1269">Pokud klíče nejsou uloženy v adresáři profilu uživatele podle očekávání:</span><span class="sxs-lookup"><span data-stu-id="c4614-1269">If keys aren't stored in the user profile directory as expected:</span></span>

  1. <span data-ttu-id="c4614-1270">Přejděte do složky *%windir%/system32/inetsrv/config.*</span><span class="sxs-lookup"><span data-stu-id="c4614-1270">Navigate to the *%windir%/system32/inetsrv/config* folder.</span></span>
  1. <span data-ttu-id="c4614-1271">Otevřete soubor *applicationHost.config.*</span><span class="sxs-lookup"><span data-stu-id="c4614-1271">Open the *applicationHost.config* file.</span></span>
  1. <span data-ttu-id="c4614-1272">Vyhledejte element `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>`.</span><span class="sxs-lookup"><span data-stu-id="c4614-1272">Locate the `<system.applicationHost><applicationPools><applicationPoolDefaults><processModel>` element.</span></span>
  1. <span data-ttu-id="c4614-1273">Zkontrolujte, `setProfileEnvironment` zda atribut není k dispozici, `true`což je výchozí hodnota na `true`, nebo explicitně nastavte hodnotu atributu na .</span><span class="sxs-lookup"><span data-stu-id="c4614-1273">Confirm that the `setProfileEnvironment` attribute isn't present, which defaults the value to `true`, or explicitly set the attribute's value to `true`.</span></span>

* <span data-ttu-id="c4614-1274">**Použití systému souborů jako úložiště kroužků na klíče**</span><span class="sxs-lookup"><span data-stu-id="c4614-1274">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="c4614-1275">Upravte kód aplikace tak, aby [používal systém souborů jako úložiště kroužků klíčů](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="c4614-1275">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="c4614-1276">K ochraně kroužku na klíče a zajištění, že certifikát je důvěryhodný, použijte certifikát X509.</span><span class="sxs-lookup"><span data-stu-id="c4614-1276">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="c4614-1277">Pokud je certifikát podepsaný svým držitelem, umístěte jej do úložiště Důvěryhodného kořenového adresáře.</span><span class="sxs-lookup"><span data-stu-id="c4614-1277">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="c4614-1278">Při použití služby IIS ve webové farmě:</span><span class="sxs-lookup"><span data-stu-id="c4614-1278">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="c4614-1279">Použijte sdílenou složku, ke které mají přístup všechny počítače.</span><span class="sxs-lookup"><span data-stu-id="c4614-1279">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="c4614-1280">Nasazení certifikátu X509 do každého počítače.</span><span class="sxs-lookup"><span data-stu-id="c4614-1280">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="c4614-1281">Konfigurace [ochrany dat v kódu](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="c4614-1281">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="c4614-1282">**Nastavení celopočítačových zásad pro ochranu dat**</span><span class="sxs-lookup"><span data-stu-id="c4614-1282">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="c4614-1283">Systém ochrany dat má omezenou podporu pro nastavení výchozí [zásady celého počítače](xref:security/data-protection/configuration/machine-wide-policy) pro všechny aplikace, které spotřebovávají data protection API.</span><span class="sxs-lookup"><span data-stu-id="c4614-1283">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="c4614-1284">Další informace naleznete v tématu <xref:security/data-protection/introduction>.</span><span class="sxs-lookup"><span data-stu-id="c4614-1284">For more information, see <xref:security/data-protection/introduction>.</span></span>

## <a name="virtual-directories"></a><span data-ttu-id="c4614-1285">Virtuální adresáře</span><span class="sxs-lookup"><span data-stu-id="c4614-1285">Virtual Directories</span></span>

<span data-ttu-id="c4614-1286">[Virtuální adresáře služby IIS](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) nejsou podporovány aplikacemi ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-1286">[IIS Virtual Directories](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#virtual-directories) aren't supported with ASP.NET Core apps.</span></span> <span data-ttu-id="c4614-1287">Aplikace může být hostována jako [podaplikace](#sub-applications).</span><span class="sxs-lookup"><span data-stu-id="c4614-1287">An app can be hosted as a [sub-application](#sub-applications).</span></span>

## <a name="sub-applications"></a><span data-ttu-id="c4614-1288">Dílčí aplikace</span><span class="sxs-lookup"><span data-stu-id="c4614-1288">Sub-applications</span></span>

<span data-ttu-id="c4614-1289">Aplikaci ASP.NET Core lze hostovat jako [podaplikaci služby IIS (podaplikaci).](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications)</span><span class="sxs-lookup"><span data-stu-id="c4614-1289">An ASP.NET Core app can be hosted as an [IIS sub-application (sub-app)](/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis#applications).</span></span> <span data-ttu-id="c4614-1290">Cesta podaplikace se stane součástí adresy URL kořenové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1290">The sub-app's path becomes part of the root app's URL.</span></span>

<span data-ttu-id="c4614-1291">Podaplikace by neměla obsahovat ASP.NET core modul jako obslužnou rutinu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1291">A sub-app shouldn't include the ASP.NET Core Module as a handler.</span></span> <span data-ttu-id="c4614-1292">Pokud je modul přidán jako obslužná rutina do souboru *web.config* podaplikace, při pokusu o procházení podaplikace se zobrazí *interní chyba serveru 500.19* odkazující na vadný konfigurační soubor.</span><span class="sxs-lookup"><span data-stu-id="c4614-1292">If the module is added as a handler in a sub-app's *web.config* file, a *500.19 Internal Server Error* referencing the faulty config file is received when attempting to browse the sub-app.</span></span>

<span data-ttu-id="c4614-1293">Následující příklad ukazuje publikovaný soubor *web.config* pro podaplikaci ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="c4614-1293">The following example shows a published *web.config* file for an ASP.NET Core sub-app:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="c4614-1294">Při hostování podřízené aplikace non-ASP.NET Core pod aplikací ASP.NET Core explicitně odeberte zděděnou obslužnou rutinu v souboru *web.config* pod podřízené aplikace:</span><span class="sxs-lookup"><span data-stu-id="c4614-1294">When hosting a non-ASP.NET Core sub-app underneath an ASP.NET Core app, explicitly remove the inherited handler in the sub-app's *web.config* file:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <remove name="aspNetCore" />
    </handlers>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="c4614-1295">Statické odkazy datových zdrojů v rámci podaplikace`~/`by měly používat zápis tildového lomítka ( ).</span><span class="sxs-lookup"><span data-stu-id="c4614-1295">Static asset links within the sub-app should use tilde-slash (`~/`) notation.</span></span> <span data-ttu-id="c4614-1296">Zápis tildového lomítka aktivuje [pomocníka tagu,](xref:mvc/views/tag-helpers/intro) který předřává základnu cesty podaplikace k vykreslenérelativní vazbě.</span><span class="sxs-lookup"><span data-stu-id="c4614-1296">Tilde-slash notation triggers a [Tag Helper](xref:mvc/views/tag-helpers/intro) to prepend the sub-app's pathbase to the rendered relative link.</span></span> <span data-ttu-id="c4614-1297">Pro podaplikaci `/subapp_path`na adrese , `src="~/image.png"` obrázek `src="/subapp_path/image.png"`spojený s je vykreslen jako .</span><span class="sxs-lookup"><span data-stu-id="c4614-1297">For a sub-app at `/subapp_path`, an image linked with `src="~/image.png"` is rendered as `src="/subapp_path/image.png"`.</span></span> <span data-ttu-id="c4614-1298">Middleware statického souboru kořenové aplikace nezpracovává požadavek na statický soubor.</span><span class="sxs-lookup"><span data-stu-id="c4614-1298">The root app's Static File Middleware doesn't process the static file request.</span></span> <span data-ttu-id="c4614-1299">Požadavek je zpracován middlewarem statického souboru podaplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1299">The request is processed by the sub-app's Static File Middleware.</span></span>

<span data-ttu-id="c4614-1300">Pokud je atribut `src` statického datového zdroje nastaven na `src="/image.png"`absolutní cestu (například), odkaz se vykreslí bez vytvoření cesty podaplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1300">If a static asset's `src` attribute is set to an absolute path (for example, `src="/image.png"`), the link is rendered without the sub-app's pathbase.</span></span> <span data-ttu-id="c4614-1301">Middleware statického souboru kořenové aplikace se pokouší obsluhovat datový zdroj z [kořenového kořenového kořenového adresáře](xref:fundamentals/index#web-root)aplikace , což má za následek odpověď *404 - Not Found,* pokud není statický datový zdroj k dispozici z kořenové aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1301">The root app's Static File Middleware attempts to serve the asset from the root app's [web root](xref:fundamentals/index#web-root), which results in a *404 - Not Found* response unless the static asset is available from the root app.</span></span>

<span data-ttu-id="c4614-1302">Hostování aplikace ASP.NET Core jako podaplikace pod jinou aplikací ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="c4614-1302">To host an ASP.NET Core app as a sub-app under another ASP.NET Core app:</span></span>

1. <span data-ttu-id="c4614-1303">Vytvořte fond aplikací pro podaplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-1303">Establish an app pool for the sub-app.</span></span> <span data-ttu-id="c4614-1304">Nastavte **verzi .NET CLR** na **žádný spravovaný kód,** protože prostředí Core Common Language Runtime (CoreCLR) pro .NET Core je spuštěno pro hostování aplikace v pracovním procesu, nikoli na ploše CLR (.NET CLR).</span><span class="sxs-lookup"><span data-stu-id="c4614-1304">Set the **.NET CLR Version** to **No Managed Code** because the Core Common Language Runtime (CoreCLR) for .NET Core is booted to host the app in the worker process, not the desktop CLR (.NET CLR).</span></span>

1. <span data-ttu-id="c4614-1305">Přidejte kořenový web ve Správci služby IIS s podaplikací ve složce pod kořenovým webem.</span><span class="sxs-lookup"><span data-stu-id="c4614-1305">Add the root site in IIS Manager with the sub-app in a folder under the root site.</span></span>

1. <span data-ttu-id="c4614-1306">Klikněte pravým tlačítkem myši na složku podaplikace ve Správci služby IIS a vyberte **příkaz Převést na aplikaci**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1306">Right-click the sub-app folder in IIS Manager and select **Convert to Application**.</span></span>

1. <span data-ttu-id="c4614-1307">V dialogovém okně **Přidat aplikaci** přiřaďte pomocí tlačítka **Vybrat** pro **fond aplikací** fond aplikací, který jste vytvořili pro podaplikaci.</span><span class="sxs-lookup"><span data-stu-id="c4614-1307">In the **Add Application** dialog, use the **Select** button for the **Application Pool** to assign the app pool that you created for the sub-app.</span></span> <span data-ttu-id="c4614-1308">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1308">Select **OK**.</span></span>

<span data-ttu-id="c4614-1309">Přiřazení samostatného fondu aplikací do podaplikace je požadavek při použití modelu hostování v procesu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1309">The assignment of a separate app pool to the sub-app is a requirement when using the in-process hosting model.</span></span>

<span data-ttu-id="c4614-1310">Další informace o modelu hostování v procesu a konfiguraci <xref:host-and-deploy/aspnet-core-module>ASP.NET core modulu naleznete v tématu .</span><span class="sxs-lookup"><span data-stu-id="c4614-1310">For more information on the in-process hosting model and configuring the ASP.NET Core Module, see <xref:host-and-deploy/aspnet-core-module>.</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="c4614-1311">Konfigurace služby IIS pomocí souboru web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-1311">Configuration of IIS with web.config</span></span>

<span data-ttu-id="c4614-1312">Konfigurace služby IIS `<system.webServer>` je ovlivněna částí *web.config* pro scénáře služby IIS, které jsou funkční pro ASP.NET aplikace Core pomocí ASP.NET core modulem.</span><span class="sxs-lookup"><span data-stu-id="c4614-1312">IIS configuration is influenced by the `<system.webServer>` section of *web.config* for IIS scenarios that are functional for ASP.NET Core apps with the ASP.NET Core Module.</span></span> <span data-ttu-id="c4614-1313">Například konfigurace služby IIS je funkční pro dynamickou kompresi.</span><span class="sxs-lookup"><span data-stu-id="c4614-1313">For example, IIS configuration is functional for dynamic compression.</span></span> <span data-ttu-id="c4614-1314">Pokud je služba IIS nakonfigurována na `<urlCompression>` úrovni serveru pro použití dynamické komprese, prvek v souboru *web.config* aplikace jej může zakázat pro aplikaci ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c4614-1314">If IIS is configured at the server level to use dynamic compression, the `<urlCompression>` element in the app's *web.config* file can disable it for an ASP.NET Core app.</span></span>

<span data-ttu-id="c4614-1315">Další informace najdete v následujících tématech:</span><span class="sxs-lookup"><span data-stu-id="c4614-1315">For more information, see the following topics:</span></span>

* [<span data-ttu-id="c4614-1316">Odkaz na \<konfiguraci pro>system.webServer</span><span class="sxs-lookup"><span data-stu-id="c4614-1316">Configuration reference for \<system.webServer></span></span>](/iis/configuration/system.webServer/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/iis/modules>

<span data-ttu-id="c4614-1317">Chcete-li nastavit proměnné prostředí pro jednotlivé aplikace spuštěné v izolovaných fondech aplikací (podporované pro službu IIS 10.0 nebo novější), přečtěte si část *příkazu AppCmd.exe* v tématu [Environment Variables environmentvariables>\<](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) tématu v referenční dokumentaci služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1317">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="c4614-1318">Konfigurační části web.config</span><span class="sxs-lookup"><span data-stu-id="c4614-1318">Configuration sections of web.config</span></span>

<span data-ttu-id="c4614-1319">Části konfigurace aplikací ASP.NET 4.x v *souboru web.config* nepoužívají aplikace ASP.NET Core pro konfiguraci:</span><span class="sxs-lookup"><span data-stu-id="c4614-1319">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* `<system.web>`
* `<appSettings>`
* `<connectionStrings>`
* `<location>`

<span data-ttu-id="c4614-1320">ASP.NET aplikace Core jsou konfigurovány pomocí jiných poskytovatelů konfigurace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1320">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="c4614-1321">Další informace naleznete v [tématu Konfigurace](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="c4614-1321">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="c4614-1322">Fondy aplikací</span><span class="sxs-lookup"><span data-stu-id="c4614-1322">Application Pools</span></span>

<span data-ttu-id="c4614-1323">Když hostujete více webů na serveru, doporučujeme izolovat aplikace od sebe spuštěním jednotlivých aplikací ve vlastním fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="c4614-1323">When hosting multiple websites on a server, we recommend isolating the apps from each other by running each app in its own app pool.</span></span> <span data-ttu-id="c4614-1324">Dialogové okno **Přidat web** služby IIS je výchozí pro tuto konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="c4614-1324">The IIS **Add Website** dialog defaults to this configuration.</span></span> <span data-ttu-id="c4614-1325">Když je k dispozici **název webu,** text se automaticky přenese do textového pole **Fondu aplikací.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1325">When a **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="c4614-1326">Při přidání webu se vytvoří nový fond aplikací s názvem webu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1326">A new app pool is created using the site name when the site is added.</span></span>

## <a name="application-pool-identity"></a><span data-ttu-id="c4614-1327">Identita fondu aplikací</span><span class="sxs-lookup"><span data-stu-id="c4614-1327">Application Pool Identity</span></span>

<span data-ttu-id="c4614-1328">Účet identity fondu aplikací umožňuje aplikaci spouštět pod jedinečným účtem, aniž by bylo třeba vytvářet a spravovat domény nebo místní účty.</span><span class="sxs-lookup"><span data-stu-id="c4614-1328">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="c4614-1329">Ve službě IIS 8.0 nebo novější vytvoří pracovní proces správce služby IIS (WAS) virtuální účet s názvem nového fondu aplikací a ve výchozím nastavení spustí pracovní procesy fondu aplikací v rámci tohoto účtu.</span><span class="sxs-lookup"><span data-stu-id="c4614-1329">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="c4614-1330">V konzole pro správu služby IIS v části **Upřesnit nastavení** fondu aplikací zkontrolujte, zda je **identita** nastavená na použití **applicationpoolidentity**:</span><span class="sxs-lookup"><span data-stu-id="c4614-1330">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity**:</span></span>

![Dialogové okno Upřesnit nastavení fondu aplikací](index/_static/apppool-identity.png)

<span data-ttu-id="c4614-1332">Proces správy služby IIS vytvoří zabezpečený identifikátor s názvem fondu aplikací v systému zabezpečení systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-1332">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="c4614-1333">Prostředky lze zabezpečit pomocí této identity.</span><span class="sxs-lookup"><span data-stu-id="c4614-1333">Resources can be secured using this identity.</span></span> <span data-ttu-id="c4614-1334">Tato identita však není reálný uživatelský účet a nezobrazuje se v konzole pro správu uživatelů systému Windows.</span><span class="sxs-lookup"><span data-stu-id="c4614-1334">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="c4614-1335">Pokud pracovní proces služby IIS vyžaduje zvýšený přístup k aplikaci, upravte seznam řízení přístupu (ACL) pro adresář obsahující aplikaci:</span><span class="sxs-lookup"><span data-stu-id="c4614-1335">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="c4614-1336">Sem otevřete Průzkumníka Windows a přejděte do adresáře.</span><span class="sxs-lookup"><span data-stu-id="c4614-1336">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="c4614-1337">Klepněte pravým tlačítkem myši na adresář a vyberte příkaz **Vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1337">Right-click on the directory and select **Properties**.</span></span>

1. <span data-ttu-id="c4614-1338">Na kartě **Zabezpečení** vyberte tlačítko **Upravit** a pak **tlačítko Přidat.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1338">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="c4614-1339">Vyberte tlačítko **Umístění** a ujistěte se, že je vybrán systém.</span><span class="sxs-lookup"><span data-stu-id="c4614-1339">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="c4614-1340">Zadejte **\\<<iIS app_pool_name>** **zadejte názvy objektů, které chcete vybrat.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1340">Enter **IIS AppPool\\<app_pool_name>** in **Enter the object names to select** area.</span></span> <span data-ttu-id="c4614-1341">Vyberte tlačítko **Zkontrolovat jména.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1341">Select the **Check Names** button.</span></span> <span data-ttu-id="c4614-1342">Pro *DefaultAppPool* zkontrolujte názvy pomocí **IIS AppPool\DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1342">For the *DefaultAppPool* check the names using **IIS AppPool\DefaultAppPool**.</span></span> <span data-ttu-id="c4614-1343">Když je vybráno tlačítko **Zkontrolovat názvy,** je v oblasti názvů objektů uvedena hodnota **DefaultAppPool.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1343">When the **Check Names** button is selected, a value of **DefaultAppPool** is indicated in the object names area.</span></span> <span data-ttu-id="c4614-1344">Název fondu aplikací není možné zadat přímo do oblasti názvů objektů.</span><span class="sxs-lookup"><span data-stu-id="c4614-1344">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="c4614-1345">Při kontrole názvu objektu použijte<<app_pool_name>formátu \*\*IIS AppPool.\\ \*\*</span><span class="sxs-lookup"><span data-stu-id="c4614-1345">Use the **IIS AppPool\\<app_pool_name>** format when checking for the object name.</span></span>

   ![Dialogové okno Vybrat uživatele nebo skupiny pro složku aplikace: Název fondu aplikací "DefaultAppPool" se připojí k "IIS AppPool\" v oblasti názvů objektů před výběrem možnosti Zkontrolovat názvy".](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="c4614-1347">Vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="c4614-1347">Select **OK**.</span></span>

   ![Dialogové okno Vybrat uživatele nebo skupiny pro složku aplikace: Po výběru možnosti Zkontrolovat názvy se v oblasti názvů objektů zobrazí název objektu DefaultAppPool.](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="c4614-1349">Oprávnění &amp; ke spuštění čtení by měla být udělena ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="c4614-1349">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="c4614-1350">Podle potřeby zadejte další oprávnění.</span><span class="sxs-lookup"><span data-stu-id="c4614-1350">Provide additional permissions as needed.</span></span>

<span data-ttu-id="c4614-1351">Přístup lze také udělit na příkazovém řádku pomocí nástroje **ICACLS.**</span><span class="sxs-lookup"><span data-stu-id="c4614-1351">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="c4614-1352">Jako příklad použijete *defaultapppool,* který používá následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="c4614-1352">Using the *DefaultAppPool* as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="c4614-1353">Další informace naleznete v tématu [icacls.](/windows-server/administration/windows-commands/icacls)</span><span class="sxs-lookup"><span data-stu-id="c4614-1353">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="http2-support"></a><span data-ttu-id="c4614-1354">Podpora HTTP/2</span><span class="sxs-lookup"><span data-stu-id="c4614-1354">HTTP/2 support</span></span>

<span data-ttu-id="c4614-1355">[Protokol HTTP/2](https://httpwg.org/specs/rfc7540.html) je podporován pro mimoprocesová nasazení, která splňují následující základní požadavky:</span><span class="sxs-lookup"><span data-stu-id="c4614-1355">[HTTP/2](https://httpwg.org/specs/rfc7540.html) is supported for out-of-process deployments that meet the following base requirements:</span></span>

* <span data-ttu-id="c4614-1356">Windows Server 2016/Windows 10 nebo novější; IIS 10 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-1356">Windows Server 2016/Windows 10 or later; IIS 10 or later</span></span>
* <span data-ttu-id="c4614-1357">Připojení serveru edge směřující mj. [Kestrel server](xref:fundamentals/servers/kestrel)</span><span class="sxs-lookup"><span data-stu-id="c4614-1357">Public-facing edge server connections use HTTP/2, but the reverse proxy connection to the [Kestrel server](xref:fundamentals/servers/kestrel) uses HTTP/1.1.</span></span>
* <span data-ttu-id="c4614-1358">Cílová architektura: Nevztahuje se na mimoprocesová nasazení, protože připojení HTTP/2 je plně zpracováno službou IIS.</span><span class="sxs-lookup"><span data-stu-id="c4614-1358">Target framework: Not applicable to out-of-process deployments, since the HTTP/2 connection is handled entirely by IIS.</span></span>
* <span data-ttu-id="c4614-1359">Připojení TLS 1.2 nebo novější</span><span class="sxs-lookup"><span data-stu-id="c4614-1359">TLS 1.2 or later connection</span></span>

<span data-ttu-id="c4614-1360">Pokud je navázáno připojení HTTP/2, `HTTP/1.1`protokol [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) hlásí .</span><span class="sxs-lookup"><span data-stu-id="c4614-1360">If an HTTP/2 connection is established, [HttpRequest.Protocol](xref:Microsoft.AspNetCore.Http.HttpRequest.Protocol*) reports `HTTP/1.1`.</span></span>

<span data-ttu-id="c4614-1361">Protokol HTTP/2 je ve výchozím nastavení povolen.</span><span class="sxs-lookup"><span data-stu-id="c4614-1361">HTTP/2 is enabled by default.</span></span> <span data-ttu-id="c4614-1362">Připojení se vrátí na HTTP/1.1, pokud není navázáno připojení HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="c4614-1362">Connections fall back to HTTP/1.1 if an HTTP/2 connection isn't established.</span></span> <span data-ttu-id="c4614-1363">Další informace o konfiguraci protokolu HTTP/2 s nasazením služby IIS naleznete [v tématu HTTP/2 ve službě IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span><span class="sxs-lookup"><span data-stu-id="c4614-1363">For more information on HTTP/2 configuration with IIS deployments, see [HTTP/2 on IIS](/iis/get-started/whats-new-in-iis-10/http2-on-iis).</span></span>

## <a name="cors-preflight-requests"></a><span data-ttu-id="c4614-1364">Požadavky cors kontroly před výstupem</span><span class="sxs-lookup"><span data-stu-id="c4614-1364">CORS preflight requests</span></span>

<span data-ttu-id="c4614-1365">*Tato část se vztahuje pouze na ASP.NET základní aplikace, které se zaměřují na rozhraní .NET Framework.*</span><span class="sxs-lookup"><span data-stu-id="c4614-1365">*This section only applies to ASP.NET Core apps that target the .NET Framework.*</span></span>

<span data-ttu-id="c4614-1366">Pro aplikaci ASP.NET Core, která cílí na rozhraní .NET Framework, nejsou požadavky OPTIONS ve výchozím nastavení ve službách IIS předány do aplikace.</span><span class="sxs-lookup"><span data-stu-id="c4614-1366">For an ASP.NET Core app that targets the .NET Framework, OPTIONS requests aren't passed to the app by default in IIS.</span></span> <span data-ttu-id="c4614-1367">Informace o konfiguraci obslužných rutin služby IIS aplikace v *souboru web.config* tak, aby předávály požadavky OPTIONS, naleznete v tématu [Povolení požadavků napříč původy v ASP.NET webovém rozhraní API 2: Jak funguje cors](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span><span class="sxs-lookup"><span data-stu-id="c4614-1367">To learn how to configure the app's IIS handlers in *web.config* to pass OPTIONS requests, see [Enable cross-origin requests in ASP.NET Web API 2: How CORS Works](/aspnet/web-api/overview/security/enabling-cross-origin-requests-in-web-api#how-cors-works).</span></span>

## <a name="deployment-resources-for-iis-administrators"></a><span data-ttu-id="c4614-1368">Prostředky nasazení pro správce služby IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-1368">Deployment resources for IIS administrators</span></span>

* [<span data-ttu-id="c4614-1369">Dokumentace iis</span><span class="sxs-lookup"><span data-stu-id="c4614-1369">IIS documentation</span></span>](/iis)
* [<span data-ttu-id="c4614-1370">Začínáme se Správcem služby IIS ve službách IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-1370">Getting Started with the IIS Manager in IIS</span></span>](/iis/get-started/getting-started-with-iis/getting-started-with-the-iis-manager-in-iis-7-and-iis-8)
* [<span data-ttu-id="c4614-1371">Nasazení aplikace .NET Core</span><span class="sxs-lookup"><span data-stu-id="c4614-1371">.NET Core application deployment</span></span>](/dotnet/core/deploying/)
* <xref:host-and-deploy/aspnet-core-module>
* <xref:host-and-deploy/directory-structure>
* <xref:host-and-deploy/iis/modules>
* <xref:test/troubleshoot-azure-iis>
* <xref:host-and-deploy/azure-iis-errors-reference>

## <a name="additional-resources"></a><span data-ttu-id="c4614-1372">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="c4614-1372">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:index>
* [<span data-ttu-id="c4614-1373">Oficiální web služby Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-1373">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="c4614-1374">Knihovna technického obsahu systému Windows Server</span><span class="sxs-lookup"><span data-stu-id="c4614-1374">Windows Server technical content library</span></span>](/windows-server/windows-server)
* [<span data-ttu-id="c4614-1375">HTTP/2 ve službě IIS</span><span class="sxs-lookup"><span data-stu-id="c4614-1375">HTTP/2 on IIS</span></span>](/iis/get-started/whats-new-in-iis-10/http2-on-iis)
* <xref:host-and-deploy/iis/transform-webconfig>

::: moniker-end
