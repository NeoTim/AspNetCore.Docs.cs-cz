---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
title: Členství a správu | Microsoft Docs
author: Erikre
description: Tento kurz řady naučit se základy vytváření aplikace webových formulářů ASP.NET pomocí technologie ASP.NET 4.5 a Microsoft Visual Studio Express 2013 pro jsme...
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/08/2014
ms.topic: article
ms.assetid: 732a2316-e49f-4f72-becd-0cd72f14457e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
msc.type: authoredcontent
ms.openlocfilehash: 166bc642ea2083f455be0648e424f0b0ae3b082c
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/10/2018
---
<a name="membership-and-administration"></a><span data-ttu-id="f3419-103">Členství a Správa</span><span class="sxs-lookup"><span data-stu-id="f3419-103">Membership and Administration</span></span>
====================
<span data-ttu-id="f3419-104">Podle [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="f3419-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="f3419-105">[Stáhnout adresář Wingtip Toys ukázkového projektu (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) nebo [stáhnout elektronická kniha (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="f3419-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="f3419-106">Tento kurz řady naučit se základy vytváření aplikace webových formulářů ASP.NET pomocí technologie ASP.NET 4.5 a Microsoft Visual Studio Express 2013 pro Web.</span><span class="sxs-lookup"><span data-stu-id="f3419-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="f3419-107">Visual Studio 2013 [projekt pomocí zdrojového kódu C#](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) dispozici je pro tento kurz řady.</span><span class="sxs-lookup"><span data-stu-id="f3419-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="f3419-108">V tomto kurzu se dozvíte, jak aktualizovat adresář Wingtip Toys ukázkové aplikace a přidat vlastní role pomocí ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="f3419-108">This tutorial shows you how to update the Wingtip Toys sample application to add a custom role and use ASP.NET Identity.</span></span> <span data-ttu-id="f3419-109">Je také ukazuje, jak implementovat stránku správy, ze kterého uživatel s vlastní roli můžete přidávat a odebírat produkty z webu.</span><span class="sxs-lookup"><span data-stu-id="f3419-109">It also shows you how to implement an administration page from which the user with a custom role can add and remove products from the website.</span></span>

<span data-ttu-id="f3419-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) systém členství použít k vytvoření webové aplikace ASP.NET a je k dispozici v technologii ASP.NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="f3419-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) is the membership system used to build ASP.NET web application and is available in ASP.NET 4.5.</span></span> <span data-ttu-id="f3419-111">ASP.NET Identity se používá v šabloně projektů Visual Studio 2013 webových formulářů, jakož i šablon pro [ASP.NET MVC](../../../../mvc/index.md), [rozhraní ASP.NET Web API](../../../../web-api/index.md), a [jedné stránky aplikace ASP.NET](../../../../single-page-application/index.md).</span><span class="sxs-lookup"><span data-stu-id="f3419-111">ASP.NET Identity is used in the Visual Studio 2013 Web Forms project template, as well as the templates for [ASP.NET MVC](../../../../mvc/index.md), [ASP.NET Web API](../../../../web-api/index.md), and [ASP.NET Single Page Application](../../../../single-page-application/index.md).</span></span> <span data-ttu-id="f3419-112">Můžete také konkrétně nainstalovat ASP.NET Identity systému, když začínáte s prázdnou webovou aplikaci pomocí nástroje NuGet.</span><span class="sxs-lookup"><span data-stu-id="f3419-112">You can also specifically install the ASP.NET Identity system using NuGet when you start with an empty Web application.</span></span> <span data-ttu-id="f3419-113">Však použít tento kurz řady **webových formulářů**projecttemplate, která zahrnuje systém identit technologie ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f3419-113">However, in this tutorial series you use the **Web Forms**projecttemplate, which includes the ASP.NET Identity system.</span></span> <span data-ttu-id="f3419-114">ASP.NET Identity lze snadno integrovat data profilu uživatelská data aplikací.</span><span class="sxs-lookup"><span data-stu-id="f3419-114">ASP.NET Identity makes it easy to integrate user-specific profile data with application data.</span></span> <span data-ttu-id="f3419-115">ASP.NET Identity navíc umožňuje vyberte model trvalosti pro profily uživatelů ve vaší aplikaci.</span><span class="sxs-lookup"><span data-stu-id="f3419-115">Also, ASP.NET Identity allows you to choose the persistence model for user profiles in your application.</span></span> <span data-ttu-id="f3419-116">Data můžete uložit do databáze systému SQL Server nebo jiného úložiště dat, včetně *NoSQL* úložiště dat, jako jsou tabulky úložiště služby Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="f3419-116">You can store the data in a SQL Server database or another data store, including *NoSQL* data stores such as Windows Azure Storage Tables.</span></span>

<span data-ttu-id="f3419-117">V tomto kurzu vychází předchozí kurzu s názvem "Najdete v článku věnovaném a platebních s PayPal" v řadě kurz adresář Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="f3419-117">This tutorial builds on the previous tutorial titled "Checkout and Payment with PayPal" in the Wingtip Toys tutorial series.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="f3419-118">Získáte informace:</span><span class="sxs-lookup"><span data-stu-id="f3419-118">What you'll learn:</span></span>

- <span data-ttu-id="f3419-119">Jak přidat vlastní roli a uživatele k aplikaci pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="f3419-119">How to use code to add a custom role and a user to the application.</span></span>
- <span data-ttu-id="f3419-120">Jak omezit přístup pro správu složku a stránky.</span><span class="sxs-lookup"><span data-stu-id="f3419-120">How to restrict access to the administration folder and page.</span></span>
- <span data-ttu-id="f3419-121">Jak poskytnout navigace pro uživatele, který patří do vlastní role.</span><span class="sxs-lookup"><span data-stu-id="f3419-121">How to provide navigation for the user that belongs to the custom role.</span></span>
- <span data-ttu-id="f3419-122">Postup použití vazby modelu k naplnění [rozevírací seznam](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) ovládacího prvku pomocí kategorie produktů.</span><span class="sxs-lookup"><span data-stu-id="f3419-122">How to use model binding to populate a [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) control with product categories.</span></span>
- <span data-ttu-id="f3419-123">Postup nahrání souboru do webové aplikace pomocí [odesílání souborů při odpovědích](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="f3419-123">How to upload a file to the web application using the [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) control.</span></span>
- <span data-ttu-id="f3419-124">Jak používat ovládací prvky pro ověřování k provedení ověření vstupu.</span><span class="sxs-lookup"><span data-stu-id="f3419-124">How to use validation controls to implement input validation.</span></span>
- <span data-ttu-id="f3419-125">Jak přidávat a odebírat produkty z aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-125">How to add and remove products from the application.</span></span>

## <a name="these-features-are-included-in-the-tutorial"></a><span data-ttu-id="f3419-126">Tyto funkce jsou zahrnuté v tomto kurzu:</span><span class="sxs-lookup"><span data-stu-id="f3419-126">These features are included in the tutorial:</span></span>

- <span data-ttu-id="f3419-127">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="f3419-127">ASP.NET Identity</span></span>
- <span data-ttu-id="f3419-128">Konfigurace a autorizace</span><span class="sxs-lookup"><span data-stu-id="f3419-128">Configuration and Authorization</span></span>
- <span data-ttu-id="f3419-129">Vazby modelu</span><span class="sxs-lookup"><span data-stu-id="f3419-129">Model Binding</span></span>
- <span data-ttu-id="f3419-130">Ověření nerušivého</span><span class="sxs-lookup"><span data-stu-id="f3419-130">Unobtrusive Validation</span></span>

<span data-ttu-id="f3419-131">Webové formuláře ASP.NET poskytuje možnosti členství.</span><span class="sxs-lookup"><span data-stu-id="f3419-131">ASP.NET Web Forms provides membership capabilities.</span></span> <span data-ttu-id="f3419-132">Pomocí výchozí šablony, máte členství integrované funkce, které můžete okamžitě použít, když je aplikace spuštěná.</span><span class="sxs-lookup"><span data-stu-id="f3419-132">By using the default template, you have built-in membership functionality that you can immediately use when the application runs.</span></span> <span data-ttu-id="f3419-133">V tomto kurzu se dozvíte, jak používat ASP.NET Identity k přidání vlastní role a přiřazení uživatele k dané roli.</span><span class="sxs-lookup"><span data-stu-id="f3419-133">This tutorial shows you how to use ASP.NET Identity to add a custom role and assign a user to that role.</span></span> <span data-ttu-id="f3419-134">Se dozvíte, jak omezit přístup ke složce pro správu.</span><span class="sxs-lookup"><span data-stu-id="f3419-134">You will learn how to restrict access to the administration folder.</span></span> <span data-ttu-id="f3419-135">Na stránce přidáte do složky správy, která umožňuje uživateli s vlastní roli, přidávat a odebírat produkty a poté, co byl přidán náhled produktu.</span><span class="sxs-lookup"><span data-stu-id="f3419-135">You'll add a page to the administration folder that allows a user with a custom role to add and remove products, and to preview a product after it has been added.</span></span>

## <a name="adding-a-custom-role"></a><span data-ttu-id="f3419-136">Přidání vlastní Role</span><span class="sxs-lookup"><span data-stu-id="f3419-136">Adding a Custom Role</span></span>

<span data-ttu-id="f3419-137">Pomocí ASP.NET Identity, můžete přidat vlastní role a přiřaďte uživatele do této role pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="f3419-137">Using ASP.NET Identity, you can add a custom role and assign a user to that role using code.</span></span>

1. <span data-ttu-id="f3419-138">V **Průzkumníku řešení**, klikněte pravým tlačítkem na *logiku* složky a vytvořte novou třídu.</span><span class="sxs-lookup"><span data-stu-id="f3419-138">In **Solution Explorer**, right-click on the *Logic* folder and create a new class.</span></span>
2. <span data-ttu-id="f3419-139">Pojmenujte novou třídu *RoleActions.cs*.</span><span class="sxs-lookup"><span data-stu-id="f3419-139">Name the new class *RoleActions.cs*.</span></span>
3. <span data-ttu-id="f3419-140">Upravte kód tak, aby se následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="f3419-140">Modify the code so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample1.cs?highlight=8)]
4. <span data-ttu-id="f3419-141">V **Průzkumníku řešení**, otevřete *Global.asax.cs* souboru.</span><span class="sxs-lookup"><span data-stu-id="f3419-141">In **Solution Explorer**, open the *Global.asax.cs* file.</span></span>
5. <span data-ttu-id="f3419-142">Změnit *Global.asax.cs* souboru tak, že přidáte kód zvýrazněných v žlutý tak, aby se následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="f3419-142">Modify the *Global.asax.cs* file by adding the code highlighted in yellow so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample2.cs?highlight=11,26-28)]
6. <span data-ttu-id="f3419-143">Všimněte si, že `AddUserAndRole` je podtržený červeně.</span><span class="sxs-lookup"><span data-stu-id="f3419-143">Notice that `AddUserAndRole` is underlined in red.</span></span> <span data-ttu-id="f3419-144">Dvakrát klikněte na kód AddUserAndRole.</span><span class="sxs-lookup"><span data-stu-id="f3419-144">Double-click the AddUserAndRole code.</span></span>  
   <span data-ttu-id="f3419-145">Bude podtržené písmeno "A" na začátku zvýrazněná metoda.</span><span class="sxs-lookup"><span data-stu-id="f3419-145">The letter "A" at the beginning of the highlighted method will be underlined.</span></span>
7. <span data-ttu-id="f3419-146">Pozastavte ukazatel myši nad písmenem "A" a klikněte na uživatelské rozhraní, které vám umožní generovat metoda zástupnou proceduru pro `AddUserAndRole` metoda.</span><span class="sxs-lookup"><span data-stu-id="f3419-146">Hover over the letter "A" and click the UI that allows you to generate a method stub for the `AddUserAndRole` method.</span></span> 

    ![Členství a Advministration - generovat Stub – metoda](membership-and-administration/_static/image1.png)
8. <span data-ttu-id="f3419-148">Klikněte na možnost s názvem:</span><span class="sxs-lookup"><span data-stu-id="f3419-148">Click the option titled:</span></span>  
    `Generate method stub for "AddUserAndRole" in "WingtipToys.Logic.RoleActions"`
9. <span data-ttu-id="f3419-149">Otevřete *RoleActions.cs* souboru z *logiku* složky.</span><span class="sxs-lookup"><span data-stu-id="f3419-149">Open the *RoleActions.cs* file from the *Logic* folder.</span></span>  
   <span data-ttu-id="f3419-150">`AddUserAndRole` Metoda byla přidána do souboru třídy.</span><span class="sxs-lookup"><span data-stu-id="f3419-150">The `AddUserAndRole` method has been added to the class file.</span></span>
10. <span data-ttu-id="f3419-151">Změnit *RoleActions.cs* souboru odebráním `NotImplementedeException` a přidávání kódu zvýrazněných v žlutý, tak, aby se následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="f3419-151">Modify the *RoleActions.cs* file by removing the `NotImplementedeException` and adding the code highlighted in yellow, so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample3.cs?highlight=5-7,15-51)]

<span data-ttu-id="f3419-152">Výše uvedený kód nejprve vytvoří kontext databáze pro databázi členství.</span><span class="sxs-lookup"><span data-stu-id="f3419-152">The above code first establishes a database context for the membership database.</span></span> <span data-ttu-id="f3419-153">Databáze členství je také uloženo jako *.mdf* v soubor *aplikace\_Data* složky.</span><span class="sxs-lookup"><span data-stu-id="f3419-153">The membership database is also stored as an *.mdf* file in the *App\_Data* folder.</span></span> <span data-ttu-id="f3419-154">Bude moct zobrazit tuto databázi, jakmile prvního uživatel přihlášeného k této webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-154">You will be able to view this database once the first user has signed in to this web application.</span></span> 

> [!NOTE] 
> 
> <span data-ttu-id="f3419-155">Pokud chcete k ukládání dat členství spolu s daty produktu, můžete zvážit použití stejné **DbContext** jste použili k uložení dat produktu ve výše uvedeném kódu.</span><span class="sxs-lookup"><span data-stu-id="f3419-155">If you wish to store the membership data along with the product data, you can consider using the same **DbContext** that you used to store the product data in the above code.</span></span>


 <span data-ttu-id="f3419-156">*Interní* – klíčové slovo je – modifikátor přístupu pro typy (například třídy) a členy typu (například metody nebo vlastnosti).</span><span class="sxs-lookup"><span data-stu-id="f3419-156">The *internal* keyword is an access modifier for types (such as classes) and type members (such as methods or properties).</span></span> <span data-ttu-id="f3419-157">Vnitřní typy nebo členové jsou přístupné pouze v rámci soubory obsažené ve stejném sestavení *(.dll* souboru).</span><span class="sxs-lookup"><span data-stu-id="f3419-157">Internal types or members are accessible only within files contained in the same assembly *(.dll* file).</span></span> <span data-ttu-id="f3419-158">Při vytváření aplikace, soubor sestavení *(.dll*) je vytvořen, obsahuje kód, který se spustí při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-158">When you build your application, an assembly file *(.dll*) is created that contains the code that is executed when you run your application.</span></span> 

<span data-ttu-id="f3419-159">A `RoleStore` objekt, který poskytuje správu rolí, je na základě vytvořit kontext databáze.</span><span class="sxs-lookup"><span data-stu-id="f3419-159">A `RoleStore` object, which provides role management, is created based on the database context.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="f3419-160">Všimněte si, že pokud `RoleStore` je vytvořen objekt používá obecný `IdentityRole` typu.</span><span class="sxs-lookup"><span data-stu-id="f3419-160">Notice that when the `RoleStore` object is created it uses a Generic `IdentityRole` type.</span></span> <span data-ttu-id="f3419-161">To znamená, že `RoleStore` je povoleno pouze tak, aby obsahovala `IdentityRole` objekty.</span><span class="sxs-lookup"><span data-stu-id="f3419-161">This means that the `RoleStore` is only allowed to contain `IdentityRole` objects.</span></span> <span data-ttu-id="f3419-162">Také pomocí obecných typů prostředků v paměti jsou zpracovávány lépe.</span><span class="sxs-lookup"><span data-stu-id="f3419-162">Also by using Generics, resources in memory are handled better.</span></span>


<span data-ttu-id="f3419-163">Dále `RoleManager` objektu, se vytvářejí na základě `RoleStore` objekt, který jste právě vytvořili.</span><span class="sxs-lookup"><span data-stu-id="f3419-163">Next, the `RoleManager` object, is created based on the `RoleStore` object that you just created.</span></span> <span data-ttu-id="f3419-164">`RoleManager` rozhraní API, která umožňuje automaticky uloží změny související s rolemi zpřístupňuje objektu `RoleStore`.</span><span class="sxs-lookup"><span data-stu-id="f3419-164">the `RoleManager` object exposes role related API which can be used to automatically save changes to the `RoleStore`.</span></span> <span data-ttu-id="f3419-165">`RoleManager` Je povoleno pouze tak, aby obsahovala `IdentityRole` objekty vzhledem k tomu, že kód používá `<IdentityRole>` obecného typu.</span><span class="sxs-lookup"><span data-stu-id="f3419-165">The `RoleManager` is only allowed to contain `IdentityRole` objects because the code uses the `<IdentityRole>` Generic type.</span></span>

<span data-ttu-id="f3419-166">Volání `RoleExists` metoda k určení, zda je přítomen v databázi členství role "hodnoty canEdit".</span><span class="sxs-lookup"><span data-stu-id="f3419-166">You call the `RoleExists` method to determine if the "canEdit" role is present in the membership database.</span></span> <span data-ttu-id="f3419-167">Pokud není, můžete vytvořit role.</span><span class="sxs-lookup"><span data-stu-id="f3419-167">If it is not, you create the role.</span></span>

<span data-ttu-id="f3419-168">Vytváření `UserManager` objekt se zdá být složitější než `RoleManager` řídit, ale je téměř stejný.</span><span class="sxs-lookup"><span data-stu-id="f3419-168">Creating the `UserManager` object appears to be more complicated than the `RoleManager` control, however it is nearly the same.</span></span> <span data-ttu-id="f3419-169">Toto pravidlo je zakódovaný jenom na jeden řádek, nikoli několik.</span><span class="sxs-lookup"><span data-stu-id="f3419-169">It is just coded on one line rather than several.</span></span> <span data-ttu-id="f3419-170">Zde je vytvoření parametr, který jste předali instance jako nový objekt součástí v závorkách.</span><span class="sxs-lookup"><span data-stu-id="f3419-170">Here, the parameter that you are passing is instantiating as a new object contained in the parenthesis.</span></span>

<span data-ttu-id="f3419-171">Dále vytvořte uživatele "canEditUser" tak, že vytvoříte novou `ApplicationUser` objektu.</span><span class="sxs-lookup"><span data-stu-id="f3419-171">Next you create the "canEditUser" user by creating a new `ApplicationUser` object.</span></span> <span data-ttu-id="f3419-172">Pak, pokud úspěšně vytvořit uživateli, přidejte uživatele do nové role.</span><span class="sxs-lookup"><span data-stu-id="f3419-172">Then, if you successfully create the user, you add the user to the new role.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="f3419-173">Zpracování chyb bude aktualizován v průběhu z kurzu této série kurz "Zpracování chyb ASP.NET".</span><span class="sxs-lookup"><span data-stu-id="f3419-173">The error handling will be updated during the "ASP.NET Error Handling" tutorial later in this tutorial series.</span></span>


<span data-ttu-id="f3419-174">Při dalším spuštění aplikace s názvem "canEditUser" uživatele budou přidáni jako roli s názvem "hodnoty canEdit" aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-174">The next time the application starts, the user named "canEditUser" will be added as the role named "canEdit" of the application.</span></span> <span data-ttu-id="f3419-175">Později v tomto kurzu se přihlásit jako uživatel "canEditUser" zobrazíte další možnosti, které budou přidány během tohoto kurzu.</span><span class="sxs-lookup"><span data-stu-id="f3419-175">Later in this tutorial, you will login as the "canEditUser" user to display additional capabilities that you will added during this tutorial.</span></span> <span data-ttu-id="f3419-176">Rozhraní API podrobnosti o ASP.NET Identity najdete v tématu [Microsoft.AspNet.Identity Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="f3419-176">For API details about ASP.NET Identity, see the [Microsoft.AspNet.Identity Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span></span> <span data-ttu-id="f3419-177">Další podrobnosti o inicializaci systému ASP.NET Identity naleznete [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span><span class="sxs-lookup"><span data-stu-id="f3419-177">For additional details about initializing the ASP.NET Identity system, see the [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span></span>

### <a name="restricting-access-to-the-administration-page"></a><span data-ttu-id="f3419-178">Omezení přístupu na stránku správy</span><span class="sxs-lookup"><span data-stu-id="f3419-178">Restricting Access to the Administration Page</span></span>

<span data-ttu-id="f3419-179">Ukázkovou aplikaci adresář Wingtip Toys umožňuje anonymní uživatelé i přihlášeného uživatele k zobrazení a zakoupit produkty.</span><span class="sxs-lookup"><span data-stu-id="f3419-179">The Wingtip Toys sample application allows both anonymous users and logged-in users to view and purchase products.</span></span> <span data-ttu-id="f3419-180">Přihlášený uživatel s rolí vlastní hodnoty "canEdit" však může přistupovat k omezenou stránku, aby bylo možné přidávat a odebírat produkty.</span><span class="sxs-lookup"><span data-stu-id="f3419-180">However, the logged-in user that has the custom "canEdit" role can access a restricted page in order to add and remove products.</span></span>

#### <a name="add-an-administration-folder-and-page"></a><span data-ttu-id="f3419-181">Přidat složku správu a stránky</span><span class="sxs-lookup"><span data-stu-id="f3419-181">Add an Administration Folder and Page</span></span>

<span data-ttu-id="f3419-182">V dalším kroku vytvoříte složku s názvem *správce* pro uživatele "canEditUser" patřícího k roli vlastní adresář Wingtip Toys ukázkové aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-182">Next, you will create a folder named *Admin* for the "canEditUser" user belonging to the custom role of the Wingtip Toys sample application.</span></span>

1. <span data-ttu-id="f3419-183">Klikněte pravým tlačítkem na název projektu (**adresář Wingtip Toys**) v **Průzkumníku řešení** a vyberte **přidat**  - &gt; **novou složku**.</span><span class="sxs-lookup"><span data-stu-id="f3419-183">Right-click the project name (**Wingtip Toys**) in **Solution Explorer** and select **Add** -&gt; **New Folder**.</span></span>
2. <span data-ttu-id="f3419-184">Název nové složky *správce*.</span><span class="sxs-lookup"><span data-stu-id="f3419-184">Name the new folder *Admin*.</span></span>
3. <span data-ttu-id="f3419-185">Klikněte pravým tlačítkem myši *správce* složku a potom vyberte **přidat**  - &gt; **novou položku**.</span><span class="sxs-lookup"><span data-stu-id="f3419-185">Right-click the *Admin* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="f3419-186">**Přidat novou položku** se zobrazí dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="f3419-186">The **Add New Item** dialog box is displayed.</span></span>
4. <span data-ttu-id="f3419-187">Vyberte <strong>Visual C#</strong> - &gt; <strong>webové</strong> skupiny šablony na levé straně.</span><span class="sxs-lookup"><span data-stu-id="f3419-187">Select the <strong>Visual C#</strong>-&gt; <strong>Web</strong> templates group on the left.</span></span> <span data-ttu-id="f3419-188">Vyberte ze seznamu střední <strong>webové formuláře se stránkou předlohy</strong>, pojmenujte ji <em>AdminPage.aspx</em><strong>,</strong> a pak vyberte <strong>přidat</strong>.</span><span class="sxs-lookup"><span data-stu-id="f3419-188">From the middle list, select <strong>Web Form with Master Page</strong>,name it <em>AdminPage.aspx</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
5. <span data-ttu-id="f3419-189">Vyberte *Site.Master* souboru jako stránky předlohy a potom vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="f3419-189">Select the *Site.Master* file as the master page, and then choose **OK**.</span></span>

#### <a name="add-a-webconfig-file"></a><span data-ttu-id="f3419-190">Přidá soubor Web.config</span><span class="sxs-lookup"><span data-stu-id="f3419-190">Add a Web.config File</span></span>

<span data-ttu-id="f3419-191">Přidáním *Web.config* do souboru *správce* složky, můžete omezit přístup na stránku obsažené ve složce.</span><span class="sxs-lookup"><span data-stu-id="f3419-191">By adding a *Web.config* file to the *Admin* folder, you can restrict access to the page contained in the folder.</span></span>

1. <span data-ttu-id="f3419-192">Klikněte pravým tlačítkem myši *správce* složky a vyberte **přidat**  - &gt; **novou položku**.</span><span class="sxs-lookup"><span data-stu-id="f3419-192">Right-click the *Admin* folder and select **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="f3419-193">**Přidat novou položku** se zobrazí dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="f3419-193">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="f3419-194">V seznamu webové šablony Visual C# vyberte <strong>soubor webové konfigurace</strong>ze seznamu střední přijměte výchozí název <em>Web.config</em><strong>,</strong> a pak vyberte <strong>Přidat</strong>.</span><span class="sxs-lookup"><span data-stu-id="f3419-194">From the list of Visual C# web templates, select <strong>Web Configuration File</strong>from the middle list, accept the default name of <em>Web.config</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
3. <span data-ttu-id="f3419-195">Nahradit existující obsah XML *Web.config* soubor s následující:</span><span class="sxs-lookup"><span data-stu-id="f3419-195">Replace the existing XML content in the *Web.config* file with the following:</span></span>  

    [!code-xml[Main](membership-and-administration/samples/sample4.xml)]

<span data-ttu-id="f3419-196">Uložit *Web.config* souboru.</span><span class="sxs-lookup"><span data-stu-id="f3419-196">Save the *Web.config* file.</span></span> <span data-ttu-id="f3419-197">*Web.config* souboru Určuje, že pouze uživatel patřící do role "hodnoty canEdit" aplikace můžete přístup ke stránce součástí *správce* složky.</span><span class="sxs-lookup"><span data-stu-id="f3419-197">The *Web.config* file specifies that only user belonging to the "canEdit" role of the application can access the page contained in the *Admin* folder.</span></span>

### <a name="including-custom-role-navigation"></a><span data-ttu-id="f3419-198">Včetně navigační vlastní Role</span><span class="sxs-lookup"><span data-stu-id="f3419-198">Including Custom Role Navigation</span></span>

<span data-ttu-id="f3419-199">Pokud chcete povolit uživatelům roli vlastní hodnoty "canEdit" přejděte do části Správa aplikace, musíte přidat odkaz *Site.Master* stránky.</span><span class="sxs-lookup"><span data-stu-id="f3419-199">To enable the user of the custom "canEdit" role to navigate to the administration section of the application, you must add a link to the *Site.Master* page.</span></span> <span data-ttu-id="f3419-200">Uživatelé, kteří patří k roli "hodnoty canEdit" se moci zobrazit pouze **správce** propojit a přístup v části Správa.</span><span class="sxs-lookup"><span data-stu-id="f3419-200">Only users that belong to the "canEdit" role will be able to see the **Admin** link and access the administration section.</span></span>

1. <span data-ttu-id="f3419-201">V Průzkumníku řešení, najít a otevřít *Site.Master* stránky.</span><span class="sxs-lookup"><span data-stu-id="f3419-201">In Solution Explorer, find and open the *Site.Master* page.</span></span>
2. <span data-ttu-id="f3419-202">Pro vytvoření odkazu pro uživatele "hodnoty canEdit" role, přidejte značku zvýrazněných v žlutý následující neuspořádaný seznam `<ul>` element tak, aby v seznamu se zobrazí jako následuje:</span><span class="sxs-lookup"><span data-stu-id="f3419-202">To create a link for the user of the "canEdit" role, add the markup highlighted in yellow to the following unordered list `<ul>` element so that the list appears as follows:</span></span>  

    [!code-html[Main](membership-and-administration/samples/sample5.html?highlight=2-3)]
3. <span data-ttu-id="f3419-203">Otevřete *Site.Master.cs* souboru.</span><span class="sxs-lookup"><span data-stu-id="f3419-203">Open the *Site.Master.cs* file.</span></span> <span data-ttu-id="f3419-204">Ujistěte se, **správce** viditelné pouze pro uživatele "canEditUser" tak, že přidáte kód zvýrazněných v žlutý na odkaz `Page_Load` obslužné rutiny.</span><span class="sxs-lookup"><span data-stu-id="f3419-204">Make the **Admin** link visible only to the "canEditUser" user by adding the code highlighted in yellow to the `Page_Load` handler.</span></span> <span data-ttu-id="f3419-205">`Page_Load` Obslužná rutina zobrazí následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="f3419-205">The `Page_Load` handler will appear as follows:</span></span>   

    [!code-csharp[Main](membership-and-administration/samples/sample6.cs?highlight=3-6)]

<span data-ttu-id="f3419-206">Když se stránka načte, kód zkontroluje, zda přihlášený uživatel má roli "hodnoty canEdit".</span><span class="sxs-lookup"><span data-stu-id="f3419-206">When the page loads, the code checks whether the logged-in user has the role of "canEdit".</span></span> <span data-ttu-id="f3419-207">Pokud uživatel patří do role "hodnoty canEdit", obsahující odkaz na element span *AdminPage.aspx* stránce (a v důsledku toho odkaz uvnitř značky span) jsou dostupná.</span><span class="sxs-lookup"><span data-stu-id="f3419-207">If the user belongs to the "canEdit" role, the span element containing the link to the *AdminPage.aspx* page (and consequently the link inside the span) is made visible.</span></span>

### <a name="enabling-product-administration"></a><span data-ttu-id="f3419-208">Povolení správy produktu</span><span class="sxs-lookup"><span data-stu-id="f3419-208">Enabling Product Administration</span></span>

<span data-ttu-id="f3419-209">Zatím jste vytvořili roli "hodnoty canEdit" a přidali uživatele s "canEditUser", na složku správu a stránku pro správu.</span><span class="sxs-lookup"><span data-stu-id="f3419-209">So far, you have created the "canEdit" role and added an "canEditUser" user, an administration folder, and an administration page.</span></span> <span data-ttu-id="f3419-210">Nastavili jste přístupová práva pro správu složku a stránky a přidali navigační odkaz pro uživatele "hodnoty canEdit" role do aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-210">You have set access rights for the administration folder and page, and have added a navigation link for the user of the "canEdit" role to the application.</span></span> <span data-ttu-id="f3419-211">Dále přidáte kód k *AdminPage.aspx* stránky a chcete-li kód *AdminPage.aspx.cs* souboru kódu na pozadí, které umožní uživatelům přidávat a odebírat produkty s rolí "hodnoty canEdit".</span><span class="sxs-lookup"><span data-stu-id="f3419-211">Next, you will add markup to the *AdminPage.aspx* page and code to the *AdminPage.aspx.cs* code-behind file that will enable the user with the "canEdit" role to add and remove products.</span></span>

1. <span data-ttu-id="f3419-212">V **Průzkumníku řešení**, otevřete *AdminPage.aspx* souboru z *správce* složky.</span><span class="sxs-lookup"><span data-stu-id="f3419-212">In **Solution Explorer**, open the *AdminPage.aspx* file from the *Admin* folder.</span></span>
2. <span data-ttu-id="f3419-213">Nahraďte stávající značky s následujícími službami:</span><span class="sxs-lookup"><span data-stu-id="f3419-213">Replace the existing markup with the following:</span></span>  

    [!code-aspx[Main](membership-and-administration/samples/sample7.aspx)]
3. <span data-ttu-id="f3419-214">Dále otevřete *AdminPage.aspx.cs* souboru kódu kliknutím pravým tlačítkem myši *AdminPage.aspx* a kliknutím na **kód zobrazení**.</span><span class="sxs-lookup"><span data-stu-id="f3419-214">Next, open the *AdminPage.aspx.cs* code-behind file by right-clicking the *AdminPage.aspx* and clicking **View Code**.</span></span>
4. <span data-ttu-id="f3419-215">Nahraďte stávající kód v *AdminPage.aspx.cs* souboru kódu s následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="f3419-215">Replace the existing code in the *AdminPage.aspx.cs* code-behind file with the following code:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample8.cs)]

<span data-ttu-id="f3419-216">V kódu, který jste zadali pro *AdminPage.aspx.cs* souboru kódu na pozadí, třídu s názvem `AddProducts` ve skutečnosti zajišťuje zpracování přidávání produkty do databáze.</span><span class="sxs-lookup"><span data-stu-id="f3419-216">In the code that you entered for the *AdminPage.aspx.cs* code-behind file, a class called `AddProducts` does the actual work of adding products to the database.</span></span> <span data-ttu-id="f3419-217">Tato třída, dosud neexistuje, můžete ji nyní vytvoří.</span><span class="sxs-lookup"><span data-stu-id="f3419-217">This class doesn't exist yet, so you will create it now.</span></span>

1. <span data-ttu-id="f3419-218">V **Průzkumníku řešení**, klikněte pravým tlačítkem myši *logiku* složku a potom vyberte **přidat**  - &gt; **novou položku**.</span><span class="sxs-lookup"><span data-stu-id="f3419-218">In **Solution Explorer**, right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="f3419-219">**Přidat novou položku** se zobrazí dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="f3419-219">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="f3419-220">Vyberte **Visual C#**  - &gt; **kód** skupiny šablony na levé straně.</span><span class="sxs-lookup"><span data-stu-id="f3419-220">Select the **Visual C#** -&gt; **Code** templates group on the left.</span></span> <span data-ttu-id="f3419-221">Pak vyberte **třída**ze středu seznamu a pojmenujte ji *AddProducts.cs*.</span><span class="sxs-lookup"><span data-stu-id="f3419-221">Then, select **Class**from the middle list and name it *AddProducts.cs*.</span></span>   
   <span data-ttu-id="f3419-222">Zobrazí se nový soubor třídy.</span><span class="sxs-lookup"><span data-stu-id="f3419-222">The new class file is displayed.</span></span>
3. <span data-ttu-id="f3419-223">Nahraďte stávající kód s následujícími službami:</span><span class="sxs-lookup"><span data-stu-id="f3419-223">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample9.cs)]

<span data-ttu-id="f3419-224">*AdminPage.aspx* stránky umožňuje uživatele patřícího k roli "hodnoty canEdit" přidávat a odebírat produkty.</span><span class="sxs-lookup"><span data-stu-id="f3419-224">The *AdminPage.aspx* page allows the user belonging to the "canEdit" role to add and remove products.</span></span> <span data-ttu-id="f3419-225">Při přidání nového produktu, podrobnosti o produktu jsou ověřit a poté zadat do databáze.</span><span class="sxs-lookup"><span data-stu-id="f3419-225">When a new product is added, the details about the product are validated and then entered into the database.</span></span> <span data-ttu-id="f3419-226">Nového produktu je okamžitě k dispozici všem uživatelům webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-226">The new product is immediately available to all users of the web application.</span></span>

#### <a name="unobtrusive-validation"></a><span data-ttu-id="f3419-227">Ověření nerušivého</span><span class="sxs-lookup"><span data-stu-id="f3419-227">Unobtrusive Validation</span></span>

<span data-ttu-id="f3419-228">Podrobnosti o produktu, které poskytuje uživatele na *AdminPage.aspx* stránky se ověřují pomocí ovládacích prvků pro ověřování (`RequiredFieldValidator` a `RegularExpressionValidator`).</span><span class="sxs-lookup"><span data-stu-id="f3419-228">The product details that the user provides on the *AdminPage.aspx* page are validated using validation controls (`RequiredFieldValidator` and `RegularExpressionValidator`).</span></span> <span data-ttu-id="f3419-229">Tyto ovládací prvky automaticky používat nerušivý ověření.</span><span class="sxs-lookup"><span data-stu-id="f3419-229">These controls automatically use unobtrusive validation.</span></span> <span data-ttu-id="f3419-230">Ověření nerušivého umožňuje ověření ovládacích prvků pomocí jazyka JavaScript pro logiku ověřování na straně klienta, což znamená, že stránce nevyžaduje zpráv se serverem, který má být ověřen.</span><span class="sxs-lookup"><span data-stu-id="f3419-230">Unobtrusive validation allows the validation controls to use JavaScript for client-side validation logic, which means the page does not require a trip to the server to be validated.</span></span> <span data-ttu-id="f3419-231">Ve výchozím nastavení, je součástí nerušivý ověření *Web.config* soubor podle nastavení konfigurace se následující:</span><span class="sxs-lookup"><span data-stu-id="f3419-231">By default, unobtrusive validation is included in the *Web.config* file based on the following configuration setting:</span></span>

[!code-xml[Main](membership-and-administration/samples/sample10.xml)]

#### <a name="regular-expressions"></a><span data-ttu-id="f3419-232">Regulární výrazy</span><span class="sxs-lookup"><span data-stu-id="f3419-232">Regular Expressions</span></span>

<span data-ttu-id="f3419-233">Cena produktu na *AdminPage.aspx* stránky se ověří pomocí **RegularExpressionValidator** ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="f3419-233">The product price on the *AdminPage.aspx* page is validated using a **RegularExpressionValidator** control.</span></span> <span data-ttu-id="f3419-234">Tento ovládací prvek ověřuje, zda hodnota přidruženého vstupního ovládacího prvku (textového pole "AddProductPrice") odpovídá vzorku určeného regulární výraz.</span><span class="sxs-lookup"><span data-stu-id="f3419-234">This control validates whether the value of the associated input control (the "AddProductPrice" TextBox) matches the pattern specified by the regular expression.</span></span> <span data-ttu-id="f3419-235">Regulární výraz je zápis porovnávání, která umožňuje rychle najít a porovnat vzory zvláštní znak.</span><span class="sxs-lookup"><span data-stu-id="f3419-235">A regular expression is a pattern-matching notation that enables you to quickly find and match specific character patterns.</span></span> <span data-ttu-id="f3419-236">**RegularExpressionValidator** ovládací prvek obsahuje vlastnost s názvem `ValidationExpression` který obsahuje regulární výraz používaný k ověření vstupu ceny, jak je uvedeno níže:</span><span class="sxs-lookup"><span data-stu-id="f3419-236">The **RegularExpressionValidator** control includes a property named `ValidationExpression` that contains the regular expression used to validate price input, as shown below:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample11.aspx)]

#### <a name="fileupload-control"></a><span data-ttu-id="f3419-237">Ovládací prvek odesílání souborů při odpovědích</span><span class="sxs-lookup"><span data-stu-id="f3419-237">FileUpload Control</span></span>

<span data-ttu-id="f3419-238">Kromě ovládací prvky pro vstup a ověření, jste přidali **odesílání souborů při odpovědích** řídit k *AdminPage.aspx* stránky.</span><span class="sxs-lookup"><span data-stu-id="f3419-238">In addition to the input and validation controls, you added the **FileUpload** control to the *AdminPage.aspx* page.</span></span> <span data-ttu-id="f3419-239">Tento ovládací prvek poskytuje možnost odesílat soubory.</span><span class="sxs-lookup"><span data-stu-id="f3419-239">This control provides the capability to upload files.</span></span> <span data-ttu-id="f3419-240">V takovém případě jsou povolení jenom soubory bitové kopie k odeslání.</span><span class="sxs-lookup"><span data-stu-id="f3419-240">In this case, you are only allowing image files to be uploaded.</span></span> <span data-ttu-id="f3419-241">V souboru kódu na pozadí (*AdminPage.aspx.cs*), když `AddProductButton` po kliknutí na, zkontroluje kód `HasFile` vlastnost **odesílání souborů při odpovědích** ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="f3419-241">In the code-behind file (*AdminPage.aspx.cs*), when the `AddProductButton` is clicked, the code checks the `HasFile` property of the **FileUpload** control.</span></span> <span data-ttu-id="f3419-242">Pokud ovládací prvek má soubor a pokud je povolený typ souboru (založené na příponě souboru), je uloženy bitovou kopii *bitové kopie* složky a *bitové kopie nebo palec* složky aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-242">If the control has a file and if the file type (based on file extension) is allowed, the image is saved to the *Images* folder and the *Images/Thumbs* folder of the application.</span></span>

#### <a name="model-binding"></a><span data-ttu-id="f3419-243">Vazby modelu</span><span class="sxs-lookup"><span data-stu-id="f3419-243">Model Binding</span></span>

<span data-ttu-id="f3419-244">Dříve v této série kurz používá vazby modelu k naplnění **ListView** řízení, **FormsView** řízení, **GridView** řízení a  **DetailView** ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="f3419-244">Earlier in this tutorial series you used model binding to populate a **ListView** control, a **FormsView** control, a **GridView** control, and a **DetailView** control.</span></span> <span data-ttu-id="f3419-245">V tomto kurzu použijete k vyplnění vazby modelu **rozevírací seznam** ovládacího prvku seznam kategorií produktů.</span><span class="sxs-lookup"><span data-stu-id="f3419-245">In this tutorial, you use model binding to populate a **DropDownList** control with a list of product categories.</span></span>

<span data-ttu-id="f3419-246">Kód, který jste přidali do *AdminPage.aspx* soubor obsahuje **rozevírací seznam** ovládací prvek s názvem `DropDownAddCategory`:</span><span class="sxs-lookup"><span data-stu-id="f3419-246">The markup that you added to the *AdminPage.aspx* file contains a **DropDownList** control called `DropDownAddCategory`:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample12.aspx)]

<span data-ttu-id="f3419-247">Použít modelovou vazbu k naplnění to **rozevírací seznam** nastavením `ItemType` atribut a `SelectMethod` atribut.</span><span class="sxs-lookup"><span data-stu-id="f3419-247">You use model binding to populate this **DropDownList** by setting the `ItemType` attribute and the `SelectMethod` attribute.</span></span> <span data-ttu-id="f3419-248">`ItemType` Atribut určuje, že budete používat `WingtipToys.Models.Category` zadejte při naplňování ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="f3419-248">The `ItemType` attribute specifies that you use the `WingtipToys.Models.Category` type when populating the control.</span></span> <span data-ttu-id="f3419-249">Tento typ na začátku tohoto kurzu řady definované vytváření `Category` – třída (zobrazené dole).</span><span class="sxs-lookup"><span data-stu-id="f3419-249">You defined this type at the beginning of this tutorial series by creating the `Category` class (shown below).</span></span> <span data-ttu-id="f3419-250">`Category` Třída je v *modely* složky uvnitř *Category.cs* souboru.</span><span class="sxs-lookup"><span data-stu-id="f3419-250">The `Category` class is in the *Models* folder inside the *Category.cs* file.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample13.cs)]

<span data-ttu-id="f3419-251">`SelectMethod` Atribut **rozevírací seznam** řízení Určuje, že budete používat `GetCategories` – metoda (zobrazené dole) který je součástí souboru kódu na pozadí (*AdminPage.aspx.cs*).</span><span class="sxs-lookup"><span data-stu-id="f3419-251">The `SelectMethod` attribute of the **DropDownList** control specifies that you use the `GetCategories` method (shown below) that is included in the code-behind file (*AdminPage.aspx.cs*).</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample14.cs)]

<span data-ttu-id="f3419-252">Tato metoda určuje, že `IQueryable` rozhraní se používá k vyhodnocení dotazy na data `Category` typu.</span><span class="sxs-lookup"><span data-stu-id="f3419-252">This method specifies that an `IQueryable` interface is used to evaluate a query against a `Category` type.</span></span> <span data-ttu-id="f3419-253">Vrácená hodnota se používá k naplnění **rozevírací seznam** v kódu stránky (*AdminPage.aspx*).</span><span class="sxs-lookup"><span data-stu-id="f3419-253">The returned value is used to populate the **DropDownList** in the markup of the page (*AdminPage.aspx*).</span></span>

<span data-ttu-id="f3419-254">Text zobrazovaný pro každou položku v seznamu se určuje nastavením `DataTextField` atribut.</span><span class="sxs-lookup"><span data-stu-id="f3419-254">The text displayed for each item in the list is specified by setting the `DataTextField` attribute.</span></span> <span data-ttu-id="f3419-255">`DataTextField` Atribut používá `CategoryName` z `Category` – třída (viz výše) pro každou kategorii v zobrazení **rozevírací seznam** ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="f3419-255">The `DataTextField` attribute uses the `CategoryName` of the `Category` class (shown above) to display each category in the **DropDownList** control.</span></span> <span data-ttu-id="f3419-256">Skutečnou hodnotu, která se předá, když je položka vybrána v **rozevírací seznam** ovládací prvek je založen na `DataValueField` atribut.</span><span class="sxs-lookup"><span data-stu-id="f3419-256">The actual value that is passed when an item is selected in the **DropDownList** control is based on the `DataValueField` attribute.</span></span> <span data-ttu-id="f3419-257">`DataValueField` Je nastavena na hodnotu `CategoryID` také definovat v `Category` – třída (viz výše).</span><span class="sxs-lookup"><span data-stu-id="f3419-257">The `DataValueField` attribute is set to the `CategoryID` as define in the `Category` class (shown above).</span></span>

### <a name="how-the-application-will-work"></a><span data-ttu-id="f3419-258">Fungování aplikace</span><span class="sxs-lookup"><span data-stu-id="f3419-258">How the Application Will Work</span></span>

<span data-ttu-id="f3419-259">Když uživatel patřící do role "hodnoty canEdit" přejde na stránku poprvé, `DropDownAddCategory` **rozevírací seznam** ovládací prvek je vyplněný, jak je popsáno výše.</span><span class="sxs-lookup"><span data-stu-id="f3419-259">When the user belonging to the "canEdit" role navigates to the page for the first time, the `DropDownAddCategory`**DropDownList** control is populated as described above.</span></span> <span data-ttu-id="f3419-260">`DropDownRemoveProduct` **Rozevírací seznam** řízení se také zobrazí v produkty, které používají stejný přístup.</span><span class="sxs-lookup"><span data-stu-id="f3419-260">The `DropDownRemoveProduct`**DropDownList** control is also populated with products using the same approach.</span></span> <span data-ttu-id="f3419-261">Vybere typ kategorie uživatele patřícího k roli "hodnoty canEdit" a přidá podrobnosti o produktu (**název**, **popis**, **cena**, a **soubor bitové kopie**).</span><span class="sxs-lookup"><span data-stu-id="f3419-261">The user belonging to the "canEdit" role selects the category type and adds product details (**Name**, **Description**, **Price**, and **Image File**).</span></span> <span data-ttu-id="f3419-262">Když uživatel patřící do role "hodnoty canEdit" klikne **přidat produkt** tlačítko `AddProductButton_Click` obslužné rutiny události se aktivuje.</span><span class="sxs-lookup"><span data-stu-id="f3419-262">When the user belonging to the "canEdit" role clicks the **Add Product** button, the `AddProductButton_Click` event handler is triggered.</span></span> <span data-ttu-id="f3419-263">`AddProductButton_Click` Obslužné rutiny události nachází v souboru kódu na pozadí (*AdminPage.aspx.cs*) zkontroluje, bitové kopie souboru a ujistěte se, odpovídá povoleného typu *(.gif*, *.png*, *.jpeg*, nebo *.jpg*).</span><span class="sxs-lookup"><span data-stu-id="f3419-263">The `AddProductButton_Click` event handler located in the code-behind file (*AdminPage.aspx.cs*) checks the image file to make sure it matches the allowed file types *(.gif*, *.png*, *.jpeg*, or *.jpg*).</span></span> <span data-ttu-id="f3419-264">Pak je soubor obrázku uložen do složky, adresář Wingtip Toys ukázkové aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-264">Then, the image file is saved into a folder of the Wingtip Toys sample application.</span></span> <span data-ttu-id="f3419-265">V dalším kroku nového produktu se přidá do databáze.</span><span class="sxs-lookup"><span data-stu-id="f3419-265">Next, the new product is added to the database.</span></span> <span data-ttu-id="f3419-266">K provedení přidání nového produktu, novou instanci třídy `AddProducts` třída se vytvoří a s názvem produkty.</span><span class="sxs-lookup"><span data-stu-id="f3419-266">To accomplish adding a new product, a new instance of the `AddProducts` class is created and named products.</span></span> <span data-ttu-id="f3419-267">`AddProducts` Třída má metodu s názvem `AddProduct`, a objekt produkty volá tuto metodu za účelem přidání produktů do databáze.</span><span class="sxs-lookup"><span data-stu-id="f3419-267">The `AddProducts` class has a method named `AddProduct`, and the products object calls this method to add products to the database.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample15.cs)]

<span data-ttu-id="f3419-268">Pokud kód úspěšně přidá nového produktu do databáze, je znovu načíst stránku s hodnotou řetězce dotazu `ProductAction=add`.</span><span class="sxs-lookup"><span data-stu-id="f3419-268">If the code successfully adds the new product to the database, the page is reloaded with the query string value `ProductAction=add`.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample16.cs)]

<span data-ttu-id="f3419-269">Když znovu načte stránky, řetězec dotazu je součástí adresy URL.</span><span class="sxs-lookup"><span data-stu-id="f3419-269">When the page reloads, the query string is included in the URL.</span></span> <span data-ttu-id="f3419-270">Opětovným načtením stránky, okamžitě uživatele patřícího k roli "hodnoty canEdit" uvidí aktualizace v **rozevírací seznam** na ovládací prvky *AdminPage.aspx* stránky.</span><span class="sxs-lookup"><span data-stu-id="f3419-270">By reloading the page, the user belonging to the "canEdit" role can immediately see the updates in the **DropDownList** controls on the *AdminPage.aspx* page.</span></span> <span data-ttu-id="f3419-271">Navíc zahrnutím řetězec dotazu s adresou URL stránky zobrazit zpráva o úspěšném provedení pro uživatele patřícího k roli "hodnoty canEdit".</span><span class="sxs-lookup"><span data-stu-id="f3419-271">Also, by including the query string with the URL, the page can display a success message to the user belonging to the "canEdit" role.</span></span>

<span data-ttu-id="f3419-272">Když *AdminPage.aspx* stránky zavážky, `Page_Load` událost je volána.</span><span class="sxs-lookup"><span data-stu-id="f3419-272">When the *AdminPage.aspx* page reloads, the `Page_Load` event is called.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample17.cs)]

<span data-ttu-id="f3419-273">`Page_Load` Obslužné rutiny události kontroluje hodnotu řetězce dotazu a určuje, zda se zobrazit zpráva o úspěšném provedení.</span><span class="sxs-lookup"><span data-stu-id="f3419-273">The `Page_Load` event handler checks the query string value and determines whether to show a success message.</span></span>

## <a name="running-the-application"></a><span data-ttu-id="f3419-274">Spuštění aplikace</span><span class="sxs-lookup"><span data-stu-id="f3419-274">Running the Application</span></span>

<span data-ttu-id="f3419-275">Můžete spustit nyní aplikaci zobrazíte přidání, odstranění a aktualizace položek v nákupní košík.</span><span class="sxs-lookup"><span data-stu-id="f3419-275">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="f3419-276">Celkový počet nákupního košíku se projeví celkové náklady na všechny položky v nákupní košík.</span><span class="sxs-lookup"><span data-stu-id="f3419-276">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="f3419-277">V Průzkumníku řešení, stiskněte klávesu **F5** ke spuštění ukázkové aplikace adresář Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="f3419-277">In Solution Explorer, press **F5** to run the Wingtip Toys sample application.</span></span>  
   <span data-ttu-id="f3419-278">Otevře se prohlížeč a ukazuje *Default.aspx* stránky.</span><span class="sxs-lookup"><span data-stu-id="f3419-278">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="f3419-279">Klikněte **přihlásit** odkaz v horní části stránky.</span><span class="sxs-lookup"><span data-stu-id="f3419-279">Click the **Log in** link at the top of the page.</span></span> 

    ![Členství a správu - protokolu v odkazu](membership-and-administration/_static/image2.png)

   <span data-ttu-id="f3419-281">*Login.aspx* zobrazí se stránka.</span><span class="sxs-lookup"><span data-stu-id="f3419-281">The *Login.aspx* page is displayed.</span></span>
3. <span data-ttu-id="f3419-282">Použijte následující uživatelské jméno a heslo:</span><span class="sxs-lookup"><span data-stu-id="f3419-282">Use the following user name and password:</span></span>  
   <span data-ttu-id="f3419-283">Uživatelské jméno: canEditUser@wingtiptoys.com</span><span class="sxs-lookup"><span data-stu-id="f3419-283">User name: canEditUser@wingtiptoys.com</span></span>  
   <span data-ttu-id="f3419-284">Heslo: Pa$ $word1</span><span class="sxs-lookup"><span data-stu-id="f3419-284">Password: Pa$$word1</span></span> 

    ![Na stránce protokol členství a správu-](membership-and-administration/_static/image3.png)
4. <span data-ttu-id="f3419-286">Klikněte **přihlásit** tlačítko v dolní části stránky.</span><span class="sxs-lookup"><span data-stu-id="f3419-286">Click the **Log in** button near the bottom of the page.</span></span>
5. <span data-ttu-id="f3419-287">V horní části na další stránku, vyberte **správce** odkazu přejděte na *AdminPage.aspx* stránky.</span><span class="sxs-lookup"><span data-stu-id="f3419-287">At the top of the next page, select the **Admin** link to navigate to the *AdminPage.aspx* page.</span></span> 

    ![Členství a správu – Správce odkaz](membership-and-administration/_static/image4.png)
6. <span data-ttu-id="f3419-289">Chcete-li otestovat ověření vstupu, klikněte na tlačítko **přidat produktu** tlačítko bez přidání jakékoli podrobnosti o produktu.</span><span class="sxs-lookup"><span data-stu-id="f3419-289">To test the input validation, click the **Add Product** button without adding any product details.</span></span> 

    ![Členství a správu - stránky pro správu](membership-and-administration/_static/image5.png)

   <span data-ttu-id="f3419-291">Všimněte si, že jsou zobrazené zprávy povinné pole.</span><span class="sxs-lookup"><span data-stu-id="f3419-291">Notice that the required field messages are displayed.</span></span>
7. <span data-ttu-id="f3419-292">Přidat podrobnosti o novém produktu a klikněte **přidat produktu** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="f3419-292">Add the details for a new product, and then click the **Add Product** button.</span></span> 

    ![Členství a správu – přidání produktu](membership-and-administration/_static/image6.png)
8. <span data-ttu-id="f3419-294">Vyberte **produkty** v horním navigačním panelu nabídce zobrazení nového produktu jste přidali.</span><span class="sxs-lookup"><span data-stu-id="f3419-294">Select **Products** from the top navigation menu to view the new product you added.</span></span> 

    ![Členství a správu – zobrazení nového produktu](membership-and-administration/_static/image7.png)
9. <span data-ttu-id="f3419-296">Klikněte **správce** odkaz na návrat na stránku správy.</span><span class="sxs-lookup"><span data-stu-id="f3419-296">Click the **Admin** link to return to the administration page.</span></span>
10. <span data-ttu-id="f3419-297">V **odebrat produkt** části stránky, vyberte nového produktu, které jste přidali v **DropDownListBox**.</span><span class="sxs-lookup"><span data-stu-id="f3419-297">In the **Remove Product** section of the page, select the new product you added in the **DropDownListBox**.</span></span>
11. <span data-ttu-id="f3419-298">Klikněte **odebrat produkt** tlačítko odebrání nového produktu z aplikace.</span><span class="sxs-lookup"><span data-stu-id="f3419-298">Click the **Remove Product** button to remove the new product from the application.</span></span> 

    ![Členství a správu - odebrat produktu](membership-and-administration/_static/image8.png)
12. <span data-ttu-id="f3419-300">Vyberte **produkty** v horním navigačním panelu nabídce potvrďte, že produkt byl odebrán.</span><span class="sxs-lookup"><span data-stu-id="f3419-300">Select **Products** from the top navigation menu to confirm that the product has been removed.</span></span>
13. <span data-ttu-id="f3419-301">Klikněte na tlačítko **Odhlásit** existovat režim pro správu.</span><span class="sxs-lookup"><span data-stu-id="f3419-301">Click **Log off** to exist administration mode.</span></span>   
    <span data-ttu-id="f3419-302">Všimněte si, že se již nenachází v horním navigačním podokně **správce** položku nabídky.</span><span class="sxs-lookup"><span data-stu-id="f3419-302">Notice that the top navigation pane no longer shows the **Admin** menu item.</span></span>

## <a name="summary"></a><span data-ttu-id="f3419-303">Souhrn</span><span class="sxs-lookup"><span data-stu-id="f3419-303">Summary</span></span>

<span data-ttu-id="f3419-304">V tomto kurzu přidat vlastní roli a uživatele patřícího k roli vlastní omezený přístup pro správu složku a stránky a poskytuje navigace pro uživatele patřícího k roli vlastní.</span><span class="sxs-lookup"><span data-stu-id="f3419-304">In this tutorial, you added a custom role and a user belonging to the custom role, restricted access to the administration folder and page, and provided navigation for the user belonging to the custom role.</span></span> <span data-ttu-id="f3419-305">Používá vazby modelu k naplnění **rozevírací seznam** ovládacího prvku s daty.</span><span class="sxs-lookup"><span data-stu-id="f3419-305">You used model binding to populate a **DropDownList** control with data.</span></span> <span data-ttu-id="f3419-306">Můžete implementovat **odesílání souborů při odpovědích** řízení a ovládací prvky pro ověřování.</span><span class="sxs-lookup"><span data-stu-id="f3419-306">You implemented the **FileUpload** control and validation controls.</span></span> <span data-ttu-id="f3419-307">Také jste zjistili, jak přidávat a odebírat produkty z databáze.</span><span class="sxs-lookup"><span data-stu-id="f3419-307">Also, you have learned how to add and remove products from a database.</span></span> <span data-ttu-id="f3419-308">V dalším kurzu dozvíte, jak implementovat směrování ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f3419-308">In the next tutorial, you'll learn how to implement ASP.NET routing.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="f3419-309">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="f3419-309">Additional Resources</span></span>

<span data-ttu-id="f3419-310">[Web.config – autorizace – Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="f3419-310">[Web.config - authorization Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span></span>  
[<span data-ttu-id="f3419-311">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="f3419-311">ASP.NET Identity</span></span>](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md)  
[<span data-ttu-id="f3419-312">Nasazení aplikace zabezpečené rozhraní ASP.NET Web Forms s členství, OAuth a SQL Database k webovému serveru Azure</span><span class="sxs-lookup"><span data-stu-id="f3419-312">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to an Azure Web Site</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)  
[<span data-ttu-id="f3419-313">Microsoft Azure – bezplatná zkušební verze</span><span class="sxs-lookup"><span data-stu-id="f3419-313">Microsoft Azure - Free Trial</span></span>](https://azure.microsoft.com/pricing/free-trial/)

> [!div class="step-by-step"]
> <span data-ttu-id="f3419-314">[Předchozí](checkout-and-payment-with-paypal.md)
> [další](url-routing.md)</span><span class="sxs-lookup"><span data-stu-id="f3419-314">[Previous](checkout-and-payment-with-paypal.md)
[Next](url-routing.md)</span></span>
