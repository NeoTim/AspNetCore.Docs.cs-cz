---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
title: Přiřazení rolí pro uživatele (C#) | Microsoft Docs
author: rick-anderson
description: V tomto kurzu vytvoříme dvě stránek ASP.NET, které pomáhají se správou, kterými se uživatelé patří do jaké rolí. Zařízení, které chcete zobrazit, co bude obsahovat na první stránku...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/24/2008
ms.topic: article
ms.assetid: d522639a-5aca-421e-9a76-d73f95607f57
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
msc.type: authoredcontent
ms.openlocfilehash: a0518cd04f6b7f055a413b2b236712965451839c
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/06/2018
ms.locfileid: "30891383"
---
<a name="assigning-roles-to-users-c"></a><span data-ttu-id="9509b-104">Přiřazení rolí pro uživatele (C#)</span><span class="sxs-lookup"><span data-stu-id="9509b-104">Assigning Roles to Users (C#)</span></span>
====================
<span data-ttu-id="9509b-105">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9509b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9509b-106">[Stáhněte si kód](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) nebo [stáhnout PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="9509b-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span></span>

> <span data-ttu-id="9509b-107">V tomto kurzu vytvoříme dvě stránek ASP.NET, které pomáhají se správou, kterými se uživatelé patří do jaké rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="9509b-108">První stránka bude obsahovat zařízení, které chcete zobrazit, co uživatelé patří do dané role, jaké role konkrétní uživatel patří do a možnost přiřazení nebo odebrání určitého uživatele z konkrétní roli.</span><span class="sxs-lookup"><span data-stu-id="9509b-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="9509b-109">Na druhé stránce jsme posílení ovládacího prvku CreateUserWizard tak, že obsahují krok určit, jaké role nově vytvořeného uživatele patří do.</span><span class="sxs-lookup"><span data-stu-id="9509b-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="9509b-110">To je užitečné v situacích, kde je možné vytvořit nové uživatelské účty správce.</span><span class="sxs-lookup"><span data-stu-id="9509b-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>


## <a name="introduction"></a><span data-ttu-id="9509b-111">Úvod</span><span class="sxs-lookup"><span data-stu-id="9509b-111">Introduction</span></span>

<span data-ttu-id="9509b-112"><a id="_msoanchor_1"> </a> [Předchozí kurzu](creating-and-managing-roles-cs.md) zkontrolován rozhraní role a `SqlRoleProvider`; jsme viděli, jak používat `Roles` třídy pro vytvoření, získání a odstranění rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-cs.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="9509b-113">Kromě vytvoření nebo odstranění rolí, potřebujeme mít možnost přiřazení nebo odebrání uživatele z role.</span><span class="sxs-lookup"><span data-stu-id="9509b-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="9509b-114">ASP.NET bohužel se nedodává s všech webových ovládacích prvků pro správu, kterými se uživatelé patří do jaké rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="9509b-115">Místo toho jsme musíte vytvořit vlastní stránky ASP.NET ke správě těchto přidružení.</span><span class="sxs-lookup"><span data-stu-id="9509b-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="9509b-116">Dobrá zpráva je, že přidání a odebrání uživatele k rolím je poměrně snadné.</span><span class="sxs-lookup"><span data-stu-id="9509b-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="9509b-117">`Roles` Třída obsahuje několik metod pro přidání uživatelů do jedné nebo více rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="9509b-118">V tomto kurzu vytvoříme dvě stránek ASP.NET, které pomáhají se správou, kterými se uživatelé patří do jaké rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="9509b-119">První stránka bude obsahovat zařízení, které chcete zobrazit, co uživatelé patří do dané role, jaké role konkrétní uživatel patří do a možnost přiřazení nebo odebrání určitého uživatele z konkrétní roli.</span><span class="sxs-lookup"><span data-stu-id="9509b-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="9509b-120">Na druhé stránce jsme posílení ovládacího prvku CreateUserWizard tak, že obsahují krok určit, jaké role nově vytvořeného uživatele patří do.</span><span class="sxs-lookup"><span data-stu-id="9509b-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="9509b-121">To je užitečné v situacích, kde je možné vytvořit nové uživatelské účty správce.</span><span class="sxs-lookup"><span data-stu-id="9509b-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="9509b-122">Můžeme začít!</span><span class="sxs-lookup"><span data-stu-id="9509b-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="9509b-123">Výpis kterými se uživatelé patří do jaké rolí</span><span class="sxs-lookup"><span data-stu-id="9509b-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="9509b-124">První obchodní of pořadí v tomto kurzu je vytvoření webové stránky, ze kterého lze přiřadit uživatele k rolím.</span><span class="sxs-lookup"><span data-stu-id="9509b-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="9509b-125">Před jsme týkají označována s přiřazení uživatele k rolím, můžeme nejprve soustředit se jenom na tom, jak zjistit, co uživatelé patří do jaké role.</span><span class="sxs-lookup"><span data-stu-id="9509b-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="9509b-126">Existují dva způsoby, jak zobrazit tyto informace: "role" nebo "uživatelem."</span><span class="sxs-lookup"><span data-stu-id="9509b-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="9509b-127">Jsme by se mohl musí návštěvníka vyberte roli a potom je zobrazit všechny uživatele, které patří k roli ("podle role" displeji) nebo jsme může vyzvat návštěvníka vyberte uživatele a pak je zobrazit role přiřazené pro tohoto uživatele ("uživatelem" displeji).</span><span class="sxs-lookup"><span data-stu-id="9509b-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="9509b-128">Zobrazení "podle role" je užitečné v případech kde návštěvníka chce vědět sadu uživatelů, které patří do konkrétní roli; zobrazení "uživatelem" je ideální pro návštěvníka musí znát rolí konkrétní uživatele.</span><span class="sxs-lookup"><span data-stu-id="9509b-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="9509b-129">Umožňuje mít naší stránce s zahrnují "podle role" i "uživatelem" rozhraní.</span><span class="sxs-lookup"><span data-stu-id="9509b-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="9509b-130">Nemůžeme se spustí s vytvářením rozhraní "uživatelem".</span><span class="sxs-lookup"><span data-stu-id="9509b-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="9509b-131">Toto rozhraní se skládá z rozevíracího seznamu a seznam zaškrtávacích políček.</span><span class="sxs-lookup"><span data-stu-id="9509b-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="9509b-132">Rozevíracím seznamu bude možné naplnit sadu uživatelů systému v systému. Zaškrtávací políčka se zobrazí seznam rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="9509b-133">Výběr uživatele z rozevíracího seznamu zkontroluje tyto role, které uživatel patří.</span><span class="sxs-lookup"><span data-stu-id="9509b-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="9509b-134">Osoba, která na stránce můžete pak zaškrtněte nebo zrušte zaškrtnutí políček můžete přidat nebo odebrat vybrané uživatele z odpovídající role.</span><span class="sxs-lookup"><span data-stu-id="9509b-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="9509b-135">Pomocí rozevíracího seznamu seznamu uživatelských účtů není ideálním řešením pro weby tam, kde může být stovky uživatelské účty.</span><span class="sxs-lookup"><span data-stu-id="9509b-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="9509b-136">Rozevíracím seznamu je navržena k umožnění uživatelům vybrat jednu položku ze seznamu poměrně krátké možností.</span><span class="sxs-lookup"><span data-stu-id="9509b-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="9509b-137">Rychlé naroste nepraktické s růstem počet položek seznamu.</span><span class="sxs-lookup"><span data-stu-id="9509b-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="9509b-138">Pokud vytváříte web, který bude mít potenciálně velkého počtu uživatelských účtů, můžete chtít zvažte použití alternativní uživatelské rozhraní, například stránkovatelné GridView nebo filtrování rozhraní, které jsou uvedené vyzve návštěvníka zvolit písmeno a potom pouze Zobrazuje uživatele, jejichž uživatelské jméno při spuštění vybraného písmeno.</span><span class="sxs-lookup"><span data-stu-id="9509b-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>


## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="9509b-139">Krok 1: Vytvoření uživatelského rozhraní "Uživatelem"</span><span class="sxs-lookup"><span data-stu-id="9509b-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="9509b-140">Otevřete `UsersAndRoles.aspx` stránky.</span><span class="sxs-lookup"><span data-stu-id="9509b-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="9509b-141">V horní části stránky, přidání ovládacího prvku popisek Web s názvem `ActionStatus` a vymažte její `Text` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="9509b-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="9509b-142">Tento popisek použijeme k poskytnutí zpětné vazby akce provést, při zobrazení zprávy, jako je, "Tito uživatele byla přidána do role Správci" nebo "Jisun uživatele byl odebrán z role vedoucí."</span><span class="sxs-lookup"><span data-stu-id="9509b-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="9509b-143">Aby bylo možné tyto zprávy zvýrazní, nastavte jeho `CssClass` vlastnost "Důležité".</span><span class="sxs-lookup"><span data-stu-id="9509b-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample1.aspx)]

<span data-ttu-id="9509b-144">Dál přidejte následující definici třídy CSS na `Styles.css` šablony stylů:</span><span class="sxs-lookup"><span data-stu-id="9509b-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-cs/samples/sample2.css)]

<span data-ttu-id="9509b-145">Tuto definici šablon stylů CSS dostane pokyn, aby zobrazení pomocí velký, červené písmo popisku.</span><span class="sxs-lookup"><span data-stu-id="9509b-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="9509b-146">Obrázek 1 zobrazuje tento efekt prostřednictvím návrháři sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="9509b-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>


<span data-ttu-id="9509b-147">[![Vlastnost CssClass jmenovky výsledkem velký, Red písma](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span></span>

<span data-ttu-id="9509b-148">**Obrázek 1**: popisku `CssClass` vlastnost má za následek velké, písmo červený ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image3.png))</span></span>


<span data-ttu-id="9509b-149">Dále přidejte rozevírací seznam na stránku, nastavte jeho `ID` vlastnost `UserList`a nastavit jeho `AutoPostBack` vlastnost na hodnotu True.</span><span class="sxs-lookup"><span data-stu-id="9509b-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="9509b-150">Seznam všech uživatelů v systému použijeme této rozevírací seznam.</span><span class="sxs-lookup"><span data-stu-id="9509b-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="9509b-151">Tento rozevírací seznam bude vázán na kolekci objektů MembershipUser.</span><span class="sxs-lookup"><span data-stu-id="9509b-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="9509b-152">Vzhledem k tomu, že chceme rozevírací seznam zobrazí uživatelské jméno vlastnost objektu MembershipUser (a použít jako hodnotu položky seznamu), nastavte rozevírací seznam `DataTextField` a `DataValueField` vlastnosti "Uživatelské jméno".</span><span class="sxs-lookup"><span data-stu-id="9509b-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="9509b-153">Pod rozevírací seznam, přidejte opakovače s názvem `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="9509b-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="9509b-154">Tato opakovače zobrazí seznam všech rolí v systému jako řadu zaškrtávací políčka.</span><span class="sxs-lookup"><span data-stu-id="9509b-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="9509b-155">Definování opakovače `ItemTemplate` pomocí následující kód:</span><span class="sxs-lookup"><span data-stu-id="9509b-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample3.aspx)]

<span data-ttu-id="9509b-156">`ItemTemplate` Značek obsahuje jeden ovládací prvek zaškrtávací políčko Web s názvem `RoleCheckBox`.</span><span class="sxs-lookup"><span data-stu-id="9509b-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="9509b-157">Na zaškrtávací políčko `AutoPostBack` je nastavena na hodnotu True a `Text` vlastnost je vázána na `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="9509b-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="9509b-158">Z důvodu syntaxe vazby dat je jednoduše `Container.DataItem` je, že rozhraní role vrátí seznam názvů rolí jako pole řetězců a je toto pole řetězec, který jsme bude vytvoření vazby na opakovače.</span><span class="sxs-lookup"><span data-stu-id="9509b-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="9509b-159">Proč této syntaxe slouží k zobrazení obsahu pole svázán s ovládacím Web data důkladné popis je nad rámec tohoto kurzu.</span><span class="sxs-lookup"><span data-stu-id="9509b-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="9509b-160">Další informace v této věci, najdete v části [skalární hodnota pole vazby na ovládací prvek webového Data](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="9509b-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="9509b-161">V tomto okamžiku deklarativní vaší "uživatelem" rozhraní by měl vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="9509b-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample4.aspx)]

<span data-ttu-id="9509b-162">Teď připravení psát kód pro vazbu sadu uživatelské účty rozevírací seznam a sadu rolí pro opakovače.</span><span class="sxs-lookup"><span data-stu-id="9509b-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="9509b-163">Do třídy kódu stránky, přidejte metodu s názvem `BindUsersToUserList` a druhou s názvem `BindRolesList`, pomocí následujícího kódu:</span><span class="sxs-lookup"><span data-stu-id="9509b-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample5.cs)]

<span data-ttu-id="9509b-164">`BindUsersToUserList` Metoda načte všechny uživatelské účty v systému prostřednictvím [ `Membership.GetAllUsers` metoda](https://msdn.microsoft.com/library/dy8swhya.aspx).</span><span class="sxs-lookup"><span data-stu-id="9509b-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="9509b-165">Tento příkaz vrátí [ `MembershipUserCollection` objekt](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), což je kolekce [ `MembershipUser` instance](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="9509b-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="9509b-166">Tato kolekce je pak vázána `UserList` rozevírací seznam.</span><span class="sxs-lookup"><span data-stu-id="9509b-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="9509b-167">`MembershipUser` Instance tento způsob vytvoření kolekce obsahovat celou řadu vlastností, jako je `UserName`, `Email`, `CreationDate`, a `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="9509b-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="9509b-168">Chcete-li pokyn rozevírací seznam zobrazíte hodnotu `UserName` vlastnost, ujistěte se, že `UserList` na rozevírací seznam `DataTextField` a `DataValueField` vlastnosti byly nastaveny jako "UserName".</span><span class="sxs-lookup"><span data-stu-id="9509b-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="9509b-169">`Membership.GetAllUsers` Metoda má dva přetížení: jeden, který přijímá žádné vstupní parametry a vrátí všechny uživatele a ten, který přebírá celočíselné hodnoty pro index stránky a velikost stránky a vrátí pouze zadané podmnožině uživatelů.</span><span class="sxs-lookup"><span data-stu-id="9509b-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="9509b-170">Po velkých objemů uživatelské účty, které se zobrazuje v element stránkovatelné uživatelského rozhraní se druhý přetížení umožňuje efektivněji stránky do uživatele od vrátí jen přesné dílčí uživatelské účty a ne všechny z nich.</span><span class="sxs-lookup"><span data-stu-id="9509b-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>


<span data-ttu-id="9509b-171">`BindRolesToList` Metoda spustí voláním `Roles` třídy [ `GetAllRoles` metoda](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), která vrací pole řetězců obsahující role v systému.</span><span class="sxs-lookup"><span data-stu-id="9509b-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="9509b-172">Toto pole řetězce je pak vázána opakovače.</span><span class="sxs-lookup"><span data-stu-id="9509b-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="9509b-173">Nakonec je potřeba volat tyto dvě metody při prvním načtení stránky.</span><span class="sxs-lookup"><span data-stu-id="9509b-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="9509b-174">Přidejte následující kód, který `Page_Load` obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="9509b-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample6.cs)]

<span data-ttu-id="9509b-175">S tímto kódem na místě pozorně navštívit stránku prostřednictvím prohlížeče; na obrazovce by měla vypadat podobně jako na obrázku 2.</span><span class="sxs-lookup"><span data-stu-id="9509b-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="9509b-176">Všechny uživatelské účty, naplní se v rozevíracím seznamu a pod, každou roli, zobrazí se jako zaškrtávací políčko.</span><span class="sxs-lookup"><span data-stu-id="9509b-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="9509b-177">Protože jsme nastavena `AutoPostBack` vlastnosti rozevírací seznam a zaškrtávací políčka na hodnotu True, změna vybraného uživatele nebo kontrola nebo zrušte zaškrtnutí role způsobí, že zpětné volání.</span><span class="sxs-lookup"><span data-stu-id="9509b-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="9509b-178">Neprovede se žádná akce, ale protože jsme ještě chcete napsat kód pro zpracování těchto akcí.</span><span class="sxs-lookup"><span data-stu-id="9509b-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="9509b-179">Tyto úlohy v následujících dvou částech jsme budete řešení.</span><span class="sxs-lookup"><span data-stu-id="9509b-179">We'll tackle these tasks in the next two sections.</span></span>


<span data-ttu-id="9509b-180">[![Stránka zobrazí uživatelů a rolí](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span></span>

<span data-ttu-id="9509b-181">**Obrázek 2**: stránka zobrazí uživatelů a rolí ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image6.png))</span></span>


### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="9509b-182">Kontrola role vybraného uživatele patří do</span><span class="sxs-lookup"><span data-stu-id="9509b-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="9509b-183">Při prvním načtení stránky, nebo vždy, když návštěvníka vybere nového uživatele z rozevíracího seznamu, je potřeba aktualizovat `UsersRoleList`na zaškrtnutí jednotlivých políček tak, aby daný roli zaškrtávací políčko je zaškrtnuté pouze v případě, že vybraný uživatel patří do této role.</span><span class="sxs-lookup"><span data-stu-id="9509b-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="9509b-184">K tomu, vytvořte metodu s názvem `CheckRolesForSelectedUser` následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="9509b-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample7.cs)]

<span data-ttu-id="9509b-185">Výše uvedený kód spustí tak, že určíte, který je vybraný uživatel.</span><span class="sxs-lookup"><span data-stu-id="9509b-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="9509b-186">Poté používá třídu role [ `GetRolesForUser(userName)` metoda](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) vrátit zadaný uživatel sadu role jako pole řetězců.</span><span class="sxs-lookup"><span data-stu-id="9509b-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="9509b-187">Dále jsou uvedené položky Opakovači a každá položka `RoleCheckBox` zaškrtávací políčko se odkazuje prostřednictvím kódu programu.</span><span class="sxs-lookup"><span data-stu-id="9509b-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="9509b-188">Zaškrtávací políčko je zaškrtnuté, jenom v případě, že je součástí role odpovídá `selectedUsersRoles` pole řetězců.</span><span class="sxs-lookup"><span data-stu-id="9509b-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="9509b-189">`selectedUserRoles.Contains<string>(...)` Syntaxe nebude kompilovat, pokud používáte technologii ASP.NET verze 2.0.</span><span class="sxs-lookup"><span data-stu-id="9509b-189">The `selectedUserRoles.Contains<string>(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="9509b-190">`Contains<string>` Metoda je součástí [LINQ knihovny](http://en.wikipedia.org/wiki/Language_Integrated_Query), což je nová technologie ASP.NET 3.5.</span><span class="sxs-lookup"><span data-stu-id="9509b-190">The `Contains<string>` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="9509b-191">Pokud stále používáte technologii ASP.NET verze 2.0, použijte [ `Array.IndexOf<string>` metoda](https://msdn.microsoft.com/library/eha9t187.aspx) místo.</span><span class="sxs-lookup"><span data-stu-id="9509b-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf<string>` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>


<span data-ttu-id="9509b-192">`CheckRolesForSelectedUser` Metoda musí být volána ve dvou případech: při prvním načtení stránky a vždy, když `UserList` vybraného indexu na rozevírací seznam se změnilo.</span><span class="sxs-lookup"><span data-stu-id="9509b-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="9509b-193">Proto volat tuto metodu z `Page_Load` obslužné rutiny události (po volání `BindUsersToUserList` a `BindRolesToList`).</span><span class="sxs-lookup"><span data-stu-id="9509b-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="9509b-194">Navíc vytvoření obslužné rutiny události pro rozevírací seznam `SelectedIndexChanged` událostí a volání této metody odtud.</span><span class="sxs-lookup"><span data-stu-id="9509b-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample8.cs)]

<span data-ttu-id="9509b-195">S tímto kódem na místě můžete testovat stránky prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="9509b-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="9509b-196">Ale protože `UsersAndRoles.aspx` stránky aktuálně nemá schopnost přiřadit uživatele k rolím, uživatelé nemají role.</span><span class="sxs-lookup"><span data-stu-id="9509b-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="9509b-197">Vytvoříme rozhraní pro přiřazování uživatelů do rolí ve chvíli, abyste mohli provést Moje slovo, které lze použít tento kód a ověřte, že dělá to tak později, nebo můžete ručně přidat uživatele k rolím vložením záznamů do `aspnet_UsersInRoles` tabulky účely otestování tohoto functi Nyní onality.</span><span class="sxs-lookup"><span data-stu-id="9509b-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="9509b-198">Přiřazení a odebrat uživatele z role</span><span class="sxs-lookup"><span data-stu-id="9509b-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="9509b-199">Když návštěvníka kontroluje nebo zruší tohoto systému zaškrtnutí zaškrtávacího políčka v `UsersRoleList` opakovače je potřeba přidat nebo odebrat vybrané uživatele z odpovídající role.</span><span class="sxs-lookup"><span data-stu-id="9509b-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="9509b-200">Na zaškrtávací políčko `AutoPostBack` je aktuálně nastavena na hodnotu True, což způsobí, že zpětné volání kdykoliv v Opakovači zaškrtávací políčko je zaškrtnuté nebo nezaškrtnuté.</span><span class="sxs-lookup"><span data-stu-id="9509b-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="9509b-201">Stručně řečeno, je potřeba vytvořit obslužnou rutinu události pro na zaškrtávací políčko `CheckChanged` událostí.</span><span class="sxs-lookup"><span data-stu-id="9509b-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="9509b-202">Vzhledem k tomu, že je zaškrtávací políčko v ovládacím prvku opakovače, je potřeba ručně přidat vložení obslužné rutiny událostí.</span><span class="sxs-lookup"><span data-stu-id="9509b-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="9509b-203">Začněte přidáním obslužné rutiny události pro třídu kódu jako `protected` metoda, například takto:</span><span class="sxs-lookup"><span data-stu-id="9509b-203">Start by adding the event handler to the code-behind class as a `protected` method, like so:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample9.cs)]

<span data-ttu-id="9509b-204">Vrátí jsme napsat kód pro této obslužné rutiny události za chvíli.</span><span class="sxs-lookup"><span data-stu-id="9509b-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="9509b-205">První, ale umožňuje dokončení zpracování vložení událostí.</span><span class="sxs-lookup"><span data-stu-id="9509b-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="9509b-206">Z políčka v rámci opakovače `ItemTemplate`, přidejte `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span><span class="sxs-lookup"><span data-stu-id="9509b-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="9509b-207">Vedení vodiče této syntaxe `RoleCheckBox_CheckChanged` obslužná rutina události `RoleCheckBox`na `CheckedChanged` událostí.</span><span class="sxs-lookup"><span data-stu-id="9509b-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample10.aspx)]

<span data-ttu-id="9509b-208">Naše poslední, je k dokončení `RoleCheckBox_CheckChanged` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="9509b-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="9509b-209">Je potřeba spustit tak, že odkazující na ovládací prvek zaškrtávací políčko, který vyvolá událost, protože tato instance políčko víme, jakou roli bylo zaškrtnuté nebo nezaškrtnuté prostřednictvím jeho `Text` a `Checked` vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="9509b-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="9509b-210">Na základě těchto informací společně s uživatelské jméno vybraného uživatele nemůžeme přidat nebo odebrat uživatele z role prostřednictvím `Roles` třídy [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) nebo [ `RemoveUserFromRole` metoda](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span><span class="sxs-lookup"><span data-stu-id="9509b-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample11.cs)]

<span data-ttu-id="9509b-211">Výše uvedený kód spustí prostřednictvím kódu programu odkazem na zaškrtávací políčko, který vyvolá událost, která je k dispozici prostřednictvím `sender` vstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="9509b-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="9509b-212">Pokud je zaškrtnuté políčko, vybraný uživatel přidán do zadané roli, jinak budou odstraněny z role.</span><span class="sxs-lookup"><span data-stu-id="9509b-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="9509b-213">V obou případech `ActionStatus` popisek zobrazí zprávu shrnutí stačí provést akci.</span><span class="sxs-lookup"><span data-stu-id="9509b-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="9509b-214">Za chvíli k otestování této stránce prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="9509b-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="9509b-215">Vyberte uživatele Tito a poté přidejte Tito správci i vedoucí rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>


<span data-ttu-id="9509b-216">[![Tito přidala pro správce a vedoucí role](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span></span>

<span data-ttu-id="9509b-217">**Obrázek 3**: Tito přidala pro správce a role vedoucí ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image9.png))</span></span>


<span data-ttu-id="9509b-218">V dalším kroku vyberte uživatele Bruce z rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="9509b-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="9509b-219">Je zpětné volání a zaškrtávací políčka opakovače jsou aktualizovány pomocí `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="9509b-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="9509b-220">Vzhledem k tomu, že Bruce zatím nepatří do žádné role, jsou zaškrtnuté políčko dvou políček.</span><span class="sxs-lookup"><span data-stu-id="9509b-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="9509b-221">Dál přidejte Bruce k roli dohledu.</span><span class="sxs-lookup"><span data-stu-id="9509b-221">Next, add Bruce to the Supervisors role.</span></span>


<span data-ttu-id="9509b-222">[![Bruce se přidal k roli dohledu](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span></span>

<span data-ttu-id="9509b-223">**Obrázek 4**: Bruce se přidal k roli dohledu ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image12.png))</span></span>


<span data-ttu-id="9509b-224">Provést ještě další ověření funkce `CheckRolesForSelectedUser` metoda, vyberte uživatele, než Tito nebo Bruce.</span><span class="sxs-lookup"><span data-stu-id="9509b-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="9509b-225">Všimněte si, jak jsou automaticky není zaškrtnuto zaškrtávací políčka, které označuje, že jejich nepatří k žádné roli.</span><span class="sxs-lookup"><span data-stu-id="9509b-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="9509b-226">Vraťte se do Tito.</span><span class="sxs-lookup"><span data-stu-id="9509b-226">Return to Tito.</span></span> <span data-ttu-id="9509b-227">Zkontrolovat správci i vedoucí zaškrtávací políčka.</span><span class="sxs-lookup"><span data-stu-id="9509b-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="9509b-228">Krok 2: Vytvoření uživatelského rozhraní "Rolemi"</span><span class="sxs-lookup"><span data-stu-id="9509b-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="9509b-229">V tomto okamžiku jste dokončili rozhraní "uživatelem" a budete připravení zahájit boji se rozhraní "rolemi".</span><span class="sxs-lookup"><span data-stu-id="9509b-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="9509b-230">Rozhraní "rolemi" vyzývá uživatele k roli vyberte z rozevíracího seznamu a potom zobrazí sadu uživatelů, kteří patří do této role v GridView.</span><span class="sxs-lookup"><span data-stu-id="9509b-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="9509b-231">Přidejte další ovládací prvek rozevírací seznam k `UsersAndRoles.aspx` stránky.</span><span class="sxs-lookup"><span data-stu-id="9509b-231">Add another DropDownList control to the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="9509b-232">Platnost této jednu ovládacím prvku Repeater, a pojmenujte ji `RoleList`a nastavit jeho `AutoPostBack` vlastnost na hodnotu True.</span><span class="sxs-lookup"><span data-stu-id="9509b-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="9509b-233">Pod, přidejte GridView a pojmenujte ji `RolesUserList`.</span><span class="sxs-lookup"><span data-stu-id="9509b-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="9509b-234">Tato rutina GridView zobrazí seznam uživatelů, kteří patří do vybrané role.</span><span class="sxs-lookup"><span data-stu-id="9509b-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="9509b-235">Nastavte GridView `AutoGenerateColumns` vlastnost na hodnotu False, přidejte do mřížky TemplateField `Columns` kolekce a nastavte její `HeaderText` vlastnost "Uživatelům".</span><span class="sxs-lookup"><span data-stu-id="9509b-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="9509b-236">Definování TemplateField `ItemTemplate` tak, aby se zobrazí hodnota výrazu datové vazby `Container.DataItem` v `Text` vlastnost štítek s názvem `UserNameLabel`.</span><span class="sxs-lookup"><span data-stu-id="9509b-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="9509b-237">Po přidání a nakonfigurování GridView, deklarativní vaší "podle role" rozhraní by měl vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="9509b-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample12.aspx)]

<span data-ttu-id="9509b-238">Potřebujeme k naplnění `RoleList` rozevírací seznam s sadu rolí v systému.</span><span class="sxs-lookup"><span data-stu-id="9509b-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="9509b-239">Pokud chcete dosáhnout, aktualizovat `BindRolesToList` metoda tak, aby se vazby vrátil pole řetězce `Roles.GetAllRoles` metodu `RolesList` rozevírací seznam (a taky `UsersRoleList` opakovače).</span><span class="sxs-lookup"><span data-stu-id="9509b-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample13.cs)]

<span data-ttu-id="9509b-240">Poslední dva řádky v `BindRolesToList` metoda byly přidány do sadu rolí pro vytvoření vazby `RoleList` ovládací prvek rozevírací seznam.</span><span class="sxs-lookup"><span data-stu-id="9509b-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="9509b-241">Obrázek 5 ukazuje konečný výsledek při zobrazení prostřednictvím prohlížeče – rozevíracího seznamu naplněný role systému.</span><span class="sxs-lookup"><span data-stu-id="9509b-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>


<span data-ttu-id="9509b-242">[![Role jsou zobrazeny v rozevírací seznam RoleList](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span></span>

<span data-ttu-id="9509b-243">**Obrázek 5**: role se zobrazují v `RoleList` rozevírací seznam ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image15.png))</span></span>


### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="9509b-244">Zobrazení uživatelů, kteří patří k vybrané roli</span><span class="sxs-lookup"><span data-stu-id="9509b-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="9509b-245">Při prvním načtení stránky, nebo když je vybrána novou roli z `RoleList` rozevírací seznam, musíme zobrazte seznam uživatelů, kteří patří do této role v GridView.</span><span class="sxs-lookup"><span data-stu-id="9509b-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="9509b-246">Vytvořit metodu s názvem `DisplayUsersBelongingToRole` pomocí následujícího kódu:</span><span class="sxs-lookup"><span data-stu-id="9509b-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample14.cs)]

<span data-ttu-id="9509b-247">Tato metoda začíná získáním vybranou roli z `RoleList` rozevírací seznam.</span><span class="sxs-lookup"><span data-stu-id="9509b-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="9509b-248">Poté použije [ `Roles.GetUsersInRole(roleName)` metoda](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) k načtení pole řetězců uživatelských jmen uživatelů, které patří do této role.</span><span class="sxs-lookup"><span data-stu-id="9509b-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="9509b-249">Toto pole je pak vázána `RolesUserList` GridView.</span><span class="sxs-lookup"><span data-stu-id="9509b-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="9509b-250">Tato metoda musí být volána dvěma způsoby: při počátečním načtení stránky a při vybranou roli v `RoleList` změny rozevírací seznam.</span><span class="sxs-lookup"><span data-stu-id="9509b-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="9509b-251">Proto aktualizovat `Page_Load` obslužné rutiny události tak, aby tato metoda je volána po volání `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="9509b-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="9509b-252">Dále vytvořte obslužnou rutinu události pro `RoleList`na `SelectedIndexChanged` událostí a příliš volat tuto metodu odtud.</span><span class="sxs-lookup"><span data-stu-id="9509b-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample15.cs)]

<span data-ttu-id="9509b-253">S tímto kódem na místě `RolesUserList` GridView má zobrazit uživatelům, kteří patří do vybrané role.</span><span class="sxs-lookup"><span data-stu-id="9509b-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="9509b-254">Jak je vidět na obrázku 6, roli dohledu se skládá z dva členy: Bruce a Tito.</span><span class="sxs-lookup"><span data-stu-id="9509b-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>


<span data-ttu-id="9509b-255">[![GridView uvádí uživatelům, kteří patří k vybrané roli](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span></span>

<span data-ttu-id="9509b-256">**Obrázek 6**: The GridView uvádí těch, které uživatelé, patří do vybrané Role ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image18.png))</span></span>


### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="9509b-257">Odebrat uživatele z vybrané Role.</span><span class="sxs-lookup"><span data-stu-id="9509b-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="9509b-258">Pojďme posílení `RolesUserList` GridView tak, že obsahují sloupec "Odebrat" tlačítka.</span><span class="sxs-lookup"><span data-stu-id="9509b-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="9509b-259">Klepnutím na tlačítko "Odebrat" pro konkrétního uživatele, budou odebrány z této role.</span><span class="sxs-lookup"><span data-stu-id="9509b-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="9509b-260">Začněte přidáním pole tlačítko Odstranit pro GridView.</span><span class="sxs-lookup"><span data-stu-id="9509b-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="9509b-261">Ujistěte se, v tomto poli se zobrazí jako nejvíce archivované doleva a změňte jeho `DeleteText` vlastnost z "Odstranit" (výchozí) na "Odebrat".</span><span class="sxs-lookup"><span data-stu-id="9509b-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>


<span data-ttu-id="9509b-262">[![Přidat](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-262">[![Add the](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span></span>

<span data-ttu-id="9509b-263">**Obrázek 7**: Přidání tlačítka "Odebrat" GridView ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image21.png))</span></span>


<span data-ttu-id="9509b-264">Při kliknutí na tlačítko "Odebrat" vyplývá zpětné volání a prvku GridView `RowDeleting` událost se vyvolá.</span><span class="sxs-lookup"><span data-stu-id="9509b-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="9509b-265">Je potřeba vytvořit obslužnou rutinu události pro tuto událost a napsat kód, který odebere uživatele z vybrané role.</span><span class="sxs-lookup"><span data-stu-id="9509b-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="9509b-266">Vytvoření obslužné rutiny události a poté přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="9509b-266">Create the event handler and then add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample16.cs)]

<span data-ttu-id="9509b-267">Spustí kód tak, že určíte název vybrané role.</span><span class="sxs-lookup"><span data-stu-id="9509b-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="9509b-268">Následně prostřednictvím kódu programu odkazy `UserNameLabel` řízení z řádku, jehož tlačítko "Odebrat" označeného aby mohla určit uživatelské jméno uživatele k odebrání.</span><span class="sxs-lookup"><span data-stu-id="9509b-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="9509b-269">Uživatele se pak odebral z role prostřednictvím volání `Roles.RemoveUserFromRole` metoda.</span><span class="sxs-lookup"><span data-stu-id="9509b-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="9509b-270">`RolesUserList` Neobnovíte GridView a zobrazí se zpráva prostřednictvím `ActionStatus` popisku ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="9509b-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="9509b-271">Tlačítko "Odebrat" nevyžaduje žádné řazení potvrzení od uživatele před odebráním uživatele z role.</span><span class="sxs-lookup"><span data-stu-id="9509b-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="9509b-272">Mohu pozvat můžete přidat určitou úrovní potvrzení uživatele.</span><span class="sxs-lookup"><span data-stu-id="9509b-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="9509b-273">Jedním z nejjednodušších způsobů, jak akci potvrďte je pomocí dialogového okna potvrdit na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="9509b-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="9509b-274">Další informace o této technice najdete v tématu [přidání Client-Side potvrzení při odstranění](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="9509b-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span></span>


<span data-ttu-id="9509b-275">Obrázek 8 ukazuje na stránku uživatele Tito bude po odebrání ze skupiny dohledu.</span><span class="sxs-lookup"><span data-stu-id="9509b-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>


<span data-ttu-id="9509b-276">[![Bohužel Tito již není Supervisor](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span></span>

<span data-ttu-id="9509b-277">**Obrázek 8**: bohužel, Tito již není Supervisor ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image24.png))</span></span>


### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="9509b-278">Přidání nových uživatelů do vybrané Role.</span><span class="sxs-lookup"><span data-stu-id="9509b-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="9509b-279">Společně se odebrat uživatele z vybrané role, návštěvníka na této stránce taky by mohli přidat uživatele do vybrané role.</span><span class="sxs-lookup"><span data-stu-id="9509b-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="9509b-280">Nejlepší rozhraní pro přidání uživatele do vybrané role závisí na počtu uživatelských účtů, které chcete mít.</span><span class="sxs-lookup"><span data-stu-id="9509b-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="9509b-281">Pokud váš web bude obsahovat několika desítek uživatelské účty nebo méně, můžete použít rozevírací seznam v tomto poli.</span><span class="sxs-lookup"><span data-stu-id="9509b-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="9509b-282">Pokud může být tisíce uživatelské účty, by chcete zahrnout uživatelské rozhraní, která umožňuje návštěvníka stránky prostřednictvím účtů, hledání konkrétního účtu, nebo filtrování uživatelské účty nějakým způsobem.</span><span class="sxs-lookup"><span data-stu-id="9509b-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="9509b-283">Pro tuto stránku použijeme velmi jednoduché rozhraní, které funguje bez ohledu na počet uživatelských účtů v systému.</span><span class="sxs-lookup"><span data-stu-id="9509b-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="9509b-284">Konkrétně použijeme textovému poli, zobrazení výzvy zadejte uživatelské jméno uživatele, kterého chce přidat do vybrané role musí návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="9509b-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="9509b-285">Pokud neexistuje žádný uživatel s tímto názvem, nebo pokud uživatel je již členem role, jsme vám zobrazí zpráva v `ActionStatus` popisek.</span><span class="sxs-lookup"><span data-stu-id="9509b-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="9509b-286">Ale pokud uživatel existuje a není členem role, jsme budete je přidejte do role a aktualizujte mřížky.</span><span class="sxs-lookup"><span data-stu-id="9509b-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="9509b-287">Přidáte textové pole a tlačítko pod GridView.</span><span class="sxs-lookup"><span data-stu-id="9509b-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="9509b-288">Nastavit textového pole `ID` k `UserNameToAddToRole` a nastavte na tlačítko `ID` a `Text` vlastnosti, které chcete `AddUserToRoleButton` a "Přidat uživatele k roli", v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="9509b-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample17.aspx)]

<span data-ttu-id="9509b-289">Dále vytvořte `Click` obslužné rutiny události pro `AddUserToRoleButton` a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="9509b-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample18.cs)]

<span data-ttu-id="9509b-290">Většina kód `Click` obslužné rutiny události provádí různé ověřovací kontroly.</span><span class="sxs-lookup"><span data-stu-id="9509b-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="9509b-291">Zajišťuje, že návštěvníka zadané uživatelské jméno v `UserNameToAddToRole` textovému poli, zda uživatel existuje v systému, a zda již nepatří do vybrané role.</span><span class="sxs-lookup"><span data-stu-id="9509b-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="9509b-292">Pokud některý z těchto kontrol selže, zobrazí se příslušná zpráva v `ActionStatus` a obslužné rutiny události je byl ukončen.</span><span class="sxs-lookup"><span data-stu-id="9509b-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="9509b-293">Pokud všechny kontroly úspěšně, uživatel je přidán k roli prostřednictvím `Roles.AddUserToRole` metoda.</span><span class="sxs-lookup"><span data-stu-id="9509b-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="9509b-294">Následující tedy textové pole na `Text` je vlastnost bylo vymazáno, GridView aktualizaci a `ActionStatus` popisek zobrazí zprávu s upozorněním, že zadaný uživatel byl úspěšně přidán do vybrané role.</span><span class="sxs-lookup"><span data-stu-id="9509b-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="9509b-295">Aby se zajistilo, že zadaný uživatel již nepatří do vybrané role, používáme [ `Roles.IsUserInRole(userName, roleName)` metoda](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), která vrací logickou hodnotu, která určuje zda *uživatelské jméno* je členem *roleName*.</span><span class="sxs-lookup"><span data-stu-id="9509b-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="9509b-296">Budeme používat tuto metodu znovu v <a id="_msoanchor_2"> </a> [další kurz](role-based-authorization-cs.md) při se podíváme na ověření na základě role.</span><span class="sxs-lookup"><span data-stu-id="9509b-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-cs.md) when we look at role-based authorization.</span></span>


<span data-ttu-id="9509b-297">Navštívit stránku prostřednictvím prohlížeče a vyberte roli dohledu z `RoleList` rozevírací seznam.</span><span class="sxs-lookup"><span data-stu-id="9509b-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="9509b-298">Zkuste zadat neplatného uživatelského jména – se měla zobrazit zpráva, která vysvětluje, že uživatel neexistuje v systému.</span><span class="sxs-lookup"><span data-stu-id="9509b-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>


<span data-ttu-id="9509b-299">[![Nelze přidat neexistující uživatele k roli](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span></span>

<span data-ttu-id="9509b-300">**Obrázek 9**: nelze přidat neexistující bez uživatele k roli ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image27.png))</span></span>


<span data-ttu-id="9509b-301">Nyní zkuste přidat platného uživatele.</span><span class="sxs-lookup"><span data-stu-id="9509b-301">Now try adding a valid user.</span></span> <span data-ttu-id="9509b-302">Pokračovat a znovu přidat Tito k roli dohledu.</span><span class="sxs-lookup"><span data-stu-id="9509b-302">Go ahead and re-add Tito to the Supervisors role.</span></span>


<span data-ttu-id="9509b-303">[![Tito je ještě jednou Supervisor!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span></span>

<span data-ttu-id="9509b-304">**Obrázek 10**: Tito je ještě jednou Supervisor!</span><span class="sxs-lookup"><span data-stu-id="9509b-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="9509b-305">([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-305">([Click to view full-size image](assigning-roles-to-users-cs/_static/image30.png))</span></span>


## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="9509b-306">Krok 3: Cross aktualizace "Uživatelem" a "Role" rozhraní</span><span class="sxs-lookup"><span data-stu-id="9509b-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="9509b-307">`UsersAndRoles.aspx` Stránka nabízí dvě odlišné rozhraní pro správu uživatelů a rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="9509b-308">V současné době tato dvě rozhraní fungují nezávisle na ostatních, takže je možné, že změny provedené v jedno rozhraní se neprojeví okamžitě v dalších.</span><span class="sxs-lookup"><span data-stu-id="9509b-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="9509b-309">Představte si například, že návštěvníka na stránku vybere roli dohledu z `RoleList` rozevírací seznam, který obsahuje seznam Bruce a Tito jako členy.</span><span class="sxs-lookup"><span data-stu-id="9509b-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="9509b-310">V dalším kroku návštěvníka vybere Tito z `UserList` rozevírací seznam, který kontroluje správci a vedoucí políček v `UsersRoleList` opakovače.</span><span class="sxs-lookup"><span data-stu-id="9509b-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="9509b-311">Pokud návštěvníka pak zruší tohoto systému zaškrtnutí roli nadřízeného z opakovače, Tito je odebrán z role. vedoucí, ale tato úprava se nereflektují v rozhraní "podle role".</span><span class="sxs-lookup"><span data-stu-id="9509b-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="9509b-312">GridView, bude mít Tito jako člena role orgánů dohledu.</span><span class="sxs-lookup"><span data-stu-id="9509b-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="9509b-313">Chcete-li tomu je potřeba aktualizovat GridView vždy, když je role zaškrtnuté nebo nezaškrtnuté z `UsersRoleList` opakovače.</span><span class="sxs-lookup"><span data-stu-id="9509b-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="9509b-314">Podobně musíme aktualizovat opakovače vždy, když uživatel se přidaly nebo odebraly roli z rozhraní "podle role".</span><span class="sxs-lookup"><span data-stu-id="9509b-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="9509b-315">Opakovače v rozhraní "uživatelem" obnovován při volání `CheckRolesForSelectedUser` metoda.</span><span class="sxs-lookup"><span data-stu-id="9509b-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="9509b-316">Rozhraní "podle role" lze upravit `RolesUserList` GridView `RowDeleting` obslužné rutiny události a `AddUserToRoleButton` tlačítka `Click` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="9509b-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="9509b-317">Proto je potřeba volat `CheckRolesForSelectedUser` metoda z každé z těchto metod.</span><span class="sxs-lookup"><span data-stu-id="9509b-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample19.cs)]

<span data-ttu-id="9509b-318">Podobně se aktualizují GridView v rozhraní "podle role" voláním `DisplayUsersBelongingToRole` "uživatelem" rozhraní a metoda je upraveny prostřednictvím `RoleCheckBox_CheckChanged` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="9509b-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="9509b-319">Proto je potřeba volat `DisplayUsersBelongingToRole` metoda z této obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="9509b-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample20.cs)]

<span data-ttu-id="9509b-320">Tyto změny menší kódu "uživatelem" a "role" rozhraní nyní správně cross-update.</span><span class="sxs-lookup"><span data-stu-id="9509b-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="9509b-321">Chcete-li to ověřit, najdete na stránce prostřednictvím prohlížeče a vyberte Tito a vedoucí z `UserList` a `RoleList` DropDownLists, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="9509b-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="9509b-322">Všimněte si, že jako zrušte zaškrtnutí políčka roli vedoucí k Tito z opakovače v rozhraní "uživatelem" Tito automaticky odebrána z GridView v rozhraní "podle role".</span><span class="sxs-lookup"><span data-stu-id="9509b-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="9509b-323">Přidání Tito zpět k roli dohledu z rozhraní "podle role" automaticky znovu ověří políčka vedoucí v rozhraní "uživatelem".</span><span class="sxs-lookup"><span data-stu-id="9509b-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="9509b-324">Krok 4: Přizpůsobení CreateUserWizard zahrnout krok "Zadejte role"</span><span class="sxs-lookup"><span data-stu-id="9509b-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="9509b-325">V <a id="_msoanchor_3"> </a> [ *vytváření uživatelských účtů* ](../membership/creating-user-accounts-cs.md) kurzu jsme viděli, jak používat ovládací prvek webu CreateUserWizard k poskytnutí rozhraní pro vytvoření nového uživatelského účtu.</span><span class="sxs-lookup"><span data-stu-id="9509b-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-cs.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="9509b-326">Ovládací prvek CreateUserWizard lze v jednom ze dvou způsobů:</span><span class="sxs-lookup"><span data-stu-id="9509b-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="9509b-327">Jako prostředek pro návštěvníky vytvořit vlastní uživatelský účet na webu a</span><span class="sxs-lookup"><span data-stu-id="9509b-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="9509b-328">Jako prostředek pro vytvoření nových účtů správce</span><span class="sxs-lookup"><span data-stu-id="9509b-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="9509b-329">V prvním případě použijte návštěvníka na web a vyplní CreateUserWizard, zadáte své informace pro registraci na webu.</span><span class="sxs-lookup"><span data-stu-id="9509b-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="9509b-330">V druhém případě správce vytvoří nový účet jiné osoby.</span><span class="sxs-lookup"><span data-stu-id="9509b-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="9509b-331">Když probíhá vytváření účtu správce pro jinou osobu, může být užitečné umožňují správcům určit, jaké role nový uživatelský účet patří do.</span><span class="sxs-lookup"><span data-stu-id="9509b-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="9509b-332">V <a id="_msoanchor_4"> </a> [ *ukládání* *Další informace o uživateli* ](../membership/storing-additional-user-information-cs.md) kurzu jsme viděli, jak přizpůsobit: můžete přidat další CreateUserWizard `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="9509b-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="9509b-333">Podíváme, jak přidat další krok CreateUserWizard a zadejte nové uživatelské role.</span><span class="sxs-lookup"><span data-stu-id="9509b-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="9509b-334">Otevřete `CreateUserWizardWithRoles.aspx` stránky a přidání ovládacího prvku CreateUserWizard s názvem `RegisterUserWithRoles`.</span><span class="sxs-lookup"><span data-stu-id="9509b-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="9509b-335">Nastavte ovládacího prvku `ContinueDestinationPageUrl` vlastnost "~ / Default.aspx".</span><span class="sxs-lookup"><span data-stu-id="9509b-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="9509b-336">Protože Rada tady je, že správce používat tento ovládací prvek CreateUserWizard k vytvoření nových uživatelských účtů, nastavte ovládacího prvku `LoginCreatedUser` vlastnost na hodnotu False.</span><span class="sxs-lookup"><span data-stu-id="9509b-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="9509b-337">To `LoginCreatedUser` vlastnost určuje, jestli návštěvníka je automaticky přihlášeni jako uživatel právě vytvořili, a je standardně nastavena na hodnotu True.</span><span class="sxs-lookup"><span data-stu-id="9509b-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="9509b-338">Nemůžeme nastavit na hodnotu False, protože když správce vytvoří nový účet chceme, aby mu přihlášení jako sám.</span><span class="sxs-lookup"><span data-stu-id="9509b-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="9509b-339">Potom vyberte "Přidat nebo odebrat `WizardSteps`..."</span><span class="sxs-lookup"><span data-stu-id="9509b-339">Next, select the "Add/Remove `WizardSteps`…"</span></span> <span data-ttu-id="9509b-340">možnost z inteligentních značek CreateUserWizard a přidejte nový `WizardStep`, nastavení jeho `ID` k `SpecifyRolesStep`.</span><span class="sxs-lookup"><span data-stu-id="9509b-340">option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="9509b-341">Přesunout `SpecifyRolesStep WizardStep` tak, aby pochází za krok "Sign k si nový účet", ale před "Úplná" krok.</span><span class="sxs-lookup"><span data-stu-id="9509b-341">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="9509b-342">Nastavte `WizardStep`na `Title` vlastnost "Zadejte role", jeho `StepType` vlastnost `Step`a jeho `AllowReturn` vlastnost na hodnotu False.</span><span class="sxs-lookup"><span data-stu-id="9509b-342">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>


<span data-ttu-id="9509b-343">[![Přidat](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-343">[![Add the](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span></span>

<span data-ttu-id="9509b-344">**Obrázek 11**: přidání "Zadejte rolí" `WizardStep` k CreateUserWizard ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-344">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image33.png))</span></span>


<span data-ttu-id="9509b-345">Po této změně vaší CreateUserWizard deklarativní by měl vypadat následovně:</span><span class="sxs-lookup"><span data-stu-id="9509b-345">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample21.aspx)]

<span data-ttu-id="9509b-346">V části "Zadejte role" `WizardStep`, přidejte třídy CheckBoxList s názvem `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="9509b-346">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList`.</span></span> <span data-ttu-id="9509b-347">Tato CheckBoxList zobrazí seznam dostupných rolí povolení uživatelům na stránce zkontrolujte, jaké role nově vytvořeného uživatele patří do.</span><span class="sxs-lookup"><span data-stu-id="9509b-347">This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="9509b-348">Jsme je tedy dvě úlohy kódování: nejprve musí naplníme `RoleList` CheckBoxList s rolemi systému; druhý, je potřeba přidat vytvořený uživatel na vybrané role, když se uživatel přesune z kroku "Zadejte role" na "Dokončit" krok.</span><span class="sxs-lookup"><span data-stu-id="9509b-348">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="9509b-349">První úlohou jsme můžete provést `Page_Load` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="9509b-349">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="9509b-350">Následující kód prostřednictvím kódu programu odkazy `RoleList` zaškrtávací políčko je na první přejděte na stránku a váže role v systému k němu.</span><span class="sxs-lookup"><span data-stu-id="9509b-350">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample22.cs)]

<span data-ttu-id="9509b-351">Ve výše uvedeném kódu by měla vypadat povědomě.</span><span class="sxs-lookup"><span data-stu-id="9509b-351">The above code should look familiar.</span></span> <span data-ttu-id="9509b-352">V <a id="_msoanchor_5"> </a> [ *ukládání* *Další informace o uživateli* ](../membership/storing-additional-user-information-cs.md) kurzu jsme použili dva `FindControl` příkazy tak, aby odkazovaly ovládací prvek webu z v rámci vlastní `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="9509b-352">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="9509b-353">A kód, který vytvoří vazbu role třídy CheckBoxList byl získán z dříve v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="9509b-353">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="9509b-354">Aby bylo možné provést v druhé úloze programovací potřebujeme vědět při dokončení kroku "Zadejte role".</span><span class="sxs-lookup"><span data-stu-id="9509b-354">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="9509b-355">Odvolání, který má CreateUserWizard `ActiveStepChanged` událost, která aktivuje se pokaždé, když návštěvníka přejde z jednoho kroku do jiné.</span><span class="sxs-lookup"><span data-stu-id="9509b-355">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="9509b-356">Zde jsme můžete určit, pokud uživatel dosáhl "Dokončit" krok; Pokud ano, je potřeba přidat uživatele do vybrané role.</span><span class="sxs-lookup"><span data-stu-id="9509b-356">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="9509b-357">Vytvoření obslužné rutiny událostí `ActiveStepChanged` událostí a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="9509b-357">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample23.cs)]

<span data-ttu-id="9509b-358">Pokud uživatel právě dosáhl "Dokončeno" krok, obslužné rutiny události zobrazí položky `RoleList` CheckBoxList a právě vytvořené uživatelem je přiřazen k vybrané role.</span><span class="sxs-lookup"><span data-stu-id="9509b-358">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="9509b-359">Navštivte tuto stránku prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="9509b-359">Visit this page through a browser.</span></span> <span data-ttu-id="9509b-360">Prvním krokem při CreateUserWizard je standardní krok "Sign k si nový účet", který zobrazí výzvu pro nové uživatelské jméno, heslo, e-mailu a další informace o klíči.</span><span class="sxs-lookup"><span data-stu-id="9509b-360">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="9509b-361">Zadejte informace pro vytvoření nového uživatele s názvem Wanda.</span><span class="sxs-lookup"><span data-stu-id="9509b-361">Enter the information to create a new user named Wanda.</span></span>


<span data-ttu-id="9509b-362">[![Vytvořte nového uživatele s názvem Wanda](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-362">[![Create a New User Named Wanda](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span></span>

<span data-ttu-id="9509b-363">**Obrázek 12**: Vytvořte nový účet uživatele s názvem Wanda ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-363">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image36.png))</span></span>


<span data-ttu-id="9509b-364">Klikněte na tlačítko "Vytvořit uživatele".</span><span class="sxs-lookup"><span data-stu-id="9509b-364">Click the "Create User" button.</span></span> <span data-ttu-id="9509b-365">CreateUserWizard interně volá `Membership.CreateUser` metody vytvoření nového uživatelského účtu a potom pokračuje k dalšímu kroku, "Zadejte role serveru."</span><span class="sxs-lookup"><span data-stu-id="9509b-365">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="9509b-366">Tady jsou uvedené role systému.</span><span class="sxs-lookup"><span data-stu-id="9509b-366">Here the system roles are listed.</span></span> <span data-ttu-id="9509b-367">Zaškrtnutím políčka dohledu a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="9509b-367">Check the Supervisors checkbox and click Next.</span></span>


<span data-ttu-id="9509b-368">[![Nastavte Wanda člena roli dohledu](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-368">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span></span>

<span data-ttu-id="9509b-369">**Obrázek 13**: nastavte Wanda člena roli dohledu ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-369">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image39.png))</span></span>


<span data-ttu-id="9509b-370">Kliknutím na tlačítko Další způsobí, že zpětné volání a aktualizací `ActiveStep` na krok "Dokončeno".</span><span class="sxs-lookup"><span data-stu-id="9509b-370">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="9509b-371">V `ActiveStepChanged` obslužné rutiny události, nedávno vytvořili uživatelský účet je přiřazen k roli dohledu.</span><span class="sxs-lookup"><span data-stu-id="9509b-371">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="9509b-372">Chcete-li to ověřit, vraťte se k `UsersAndRoles.aspx` a vyberte vedoucí z `RoleList` rozevírací seznam.</span><span class="sxs-lookup"><span data-stu-id="9509b-372">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="9509b-373">Jak ukazuje obrázek 14, vedoucí je nyní tvoří tři uživatelé: Bruce, Tito a Wanda.</span><span class="sxs-lookup"><span data-stu-id="9509b-373">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>


<span data-ttu-id="9509b-374">[![Bruce, Tito a Wanda jsou všechny vedoucí](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="9509b-374">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span></span>

<span data-ttu-id="9509b-375">**Obrázek 14**: Bruce, Tito a Wanda jsou všechny vedoucí ([Kliknutím zobrazit obrázek v plné velikosti](assigning-roles-to-users-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="9509b-375">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image42.png))</span></span>


## <a name="summary"></a><span data-ttu-id="9509b-376">Souhrn</span><span class="sxs-lookup"><span data-stu-id="9509b-376">Summary</span></span>

<span data-ttu-id="9509b-377">Rozhraní framework rolí nabízí metody pro načtení informací o rolích a metody pro určení, které uživatelé patří do zadané roli určitého uživatele.</span><span class="sxs-lookup"><span data-stu-id="9509b-377">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="9509b-378">Kromě toho existuje několik metod pro přidávání a odebírání jeden nebo více uživatelů k jedné nebo více rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-378">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="9509b-379">V tomto kurzu jsme zaměřené na právě dva z těchto metod: `AddUserToRole` a `RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="9509b-379">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="9509b-380">Existují další variant určená k přidání více uživatelů do jedné role a přiřadit víc rolí na jednoho uživatele.</span><span class="sxs-lookup"><span data-stu-id="9509b-380">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="9509b-381">V tomto kurzu zahrnuty také podívejte se na rozšíření ovládacího prvku CreateUserWizard zahrnout `WizardStep` můžete zadat role nově vytvořeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="9509b-381">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="9509b-382">Takové krok může pomoct správce zjednodušit proces vytváření uživatelských účtů pro nové uživatele.</span><span class="sxs-lookup"><span data-stu-id="9509b-382">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="9509b-383">V tuto chvíli jsme viděli jste, jak vytvářet a odstraňovat role a jak přidávat a odebírat uživatele z role.</span><span class="sxs-lookup"><span data-stu-id="9509b-383">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="9509b-384">Ale ještě se podívat na použití ověřování na základě rolí.</span><span class="sxs-lookup"><span data-stu-id="9509b-384">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="9509b-385">V <a id="_msoanchor_6"> </a> [následující kurzu](role-based-authorization-cs.md) Podíváme se na definování autorizačních pravidel adres URL na základě rolí role také jak omezit tak jeho funkčnost úrovně stránky na základě rolí aktuálně přihlášeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="9509b-385">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-cs.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="9509b-386">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="9509b-386">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="9509b-387">Další čtení</span><span class="sxs-lookup"><span data-stu-id="9509b-387">Further Reading</span></span>

<span data-ttu-id="9509b-388">Další informace o tématech popsané v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="9509b-388">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="9509b-389">Přehled nástroje pro správu webu ASP.NET</span><span class="sxs-lookup"><span data-stu-id="9509b-389">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="9509b-390">Zkoumání ASP. Členství, role a profil pro NET</span><span class="sxs-lookup"><span data-stu-id="9509b-390">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="9509b-391">Vrácení vlastní nástroj pro správu webu</span><span class="sxs-lookup"><span data-stu-id="9509b-391">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="9509b-392">O autorovi</span><span class="sxs-lookup"><span data-stu-id="9509b-392">About the Author</span></span>

<span data-ttu-id="9509b-393">Scott Meisnerová, vytvořit více knih ASP/ASP.NET a zakladatele 4GuysFromRolla.com, má byla od 1998 práce s technologií Microsoft Web.</span><span class="sxs-lookup"><span data-stu-id="9509b-393">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9509b-394">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="9509b-394">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9509b-395">Jeho nejnovější seznam k  *[Edice nakladatelství Sams naučit sami technologii ASP.NET 2.0 za 24 hodin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="9509b-395">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="9509b-396">Scott lze dosáhnout za [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) nebo prostřednictvím svého blogu v [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="9509b-396">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="9509b-397">Zvláštní poděkování...</span><span class="sxs-lookup"><span data-stu-id="9509b-397">Special Thanks To…</span></span>

<span data-ttu-id="9509b-398">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="9509b-398">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9509b-399">Vést kontrolorem pro tento kurz byl Teresy Murphy.</span><span class="sxs-lookup"><span data-stu-id="9509b-399">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="9509b-400">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="9509b-400">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9509b-401">Pokud ano, vyřaďte mi řádek v [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9509b-401">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9509b-402">[Předchozí](creating-and-managing-roles-cs.md)
> [další](role-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="9509b-402">[Previous](creating-and-managing-roles-cs.md)
[Next](role-based-authorization-cs.md)</span></span>
