---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
title: "Začínáme s databáze Entity Framework 4.0 nejprve a ASP.NET 4 webové formuláře – část 7 | Microsoft Docs"
author: tdykstra
description: "Contoso univerzity ukázkovou webovou aplikaci demonstruje postup vytvoření aplikace webových formulářů ASP.NET používající rozhraní Entity Framework. Vzorová aplikace je..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 12/03/2010
ms.topic: article
ms.assetid: f8afb245-b705-419c-8790-0b295e90d5e2
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
msc.type: authoredcontent
ms.openlocfilehash: aeea122636f5235364e6a40cb6e041b1fe221317
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2018
---
<a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-7"></a><span data-ttu-id="e3f5c-104">Začínáme s databáze Entity Framework 4.0 nejprve a 4 webových formulářů ASP.NET - část 7</span><span class="sxs-lookup"><span data-stu-id="e3f5c-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 7</span></span>
====================
<span data-ttu-id="e3f5c-105">podle [tní Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="e3f5c-106">Contoso univerzity ukázkovou webovou aplikaci demonstruje postup vytvoření aplikace webových formulářů ASP.NET pomocí sady Visual Studio 2010 a Entity Framework 4.0.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="e3f5c-107">Informace o kurzu řady najdete v tématu [první kurz v řadě](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="using-stored-procedures"></a><span data-ttu-id="e3f5c-108">Použití uložených procedur</span><span class="sxs-lookup"><span data-stu-id="e3f5c-108">Using Stored Procedures</span></span>

<span data-ttu-id="e3f5c-109">V tomto kurzu předchozí implementována vzor tabulky na hierarchii dědičnosti.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-109">In the previous tutorial you implemented a table-per-hierarchy inheritance pattern.</span></span> <span data-ttu-id="e3f5c-110">Tento kurz vám ukáže, jak získat lepší kontrolu nad přístup k databázi pomocí uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-110">This tutorial will show you how to use stored procedures to gain more control over database access.</span></span>

<span data-ttu-id="e3f5c-111">Rozhraní Entity Framework umožňuje určit, že se mají používat uložené procedury pro přístup k databázi.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-111">The Entity Framework lets you specify that it should use stored procedures for database access.</span></span> <span data-ttu-id="e3f5c-112">Pro jakýkoli typ entity můžete používat k vytváření, aktualizaci a odstraňování entity typu uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-112">For any entity type, you can specify a stored procedure to use for creating, updating, or deleting entities of that type.</span></span> <span data-ttu-id="e3f5c-113">Potom v datovém modelu přidáte odkazy na uložené procedury, které můžete použít k provádění úloh, jako je například načítání sady entit.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-113">Then in the data model you can add references to stored procedures that you can use to perform tasks such as retrieving sets of entities.</span></span>

<span data-ttu-id="e3f5c-114">Použití uložených procedur je běžné požadavek pro přístup k databázi.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-114">Using stored procedures is a common requirement for database access.</span></span> <span data-ttu-id="e3f5c-115">V některých případech může správce databáze vyžadovat, aby veškerý přístup databáze projít uložené procedury z bezpečnostních důvodů.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-115">In some cases a database administrator may require that all database access go through stored procedures for security reasons.</span></span> <span data-ttu-id="e3f5c-116">V ostatních případech můžete chtít obchodní logiky sestavení do některé z procesů, které rozhraní Entity Framework se používá při aktualizaci databáze.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-116">In other cases you may want to build business logic into some of the processes that the Entity Framework uses when it updates the database.</span></span> <span data-ttu-id="e3f5c-117">Vždy, když se odstraní entitu můžete chtít zkopírujte jej do archivu databáze.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-117">For example, whenever an entity is deleted you might want to copy it to an archive database.</span></span> <span data-ttu-id="e3f5c-118">Nebo při každé aktualizaci řádku můžete chtít zapsat řádek do tabulky protokolování této záznamy, kteří provedli změny.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-118">Or whenever a row is updated you might want to write a row to a logging table that records who made the change.</span></span> <span data-ttu-id="e3f5c-119">Tyto druhy úloh můžete provádět v uložené procedury, která je volána, když rozhraní Entity Framework odstraní entitu nebo aktualizuje entitu.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-119">You can perform these kinds of tasks in a stored procedure that's called whenever the Entity Framework deletes an entity or updates an entity.</span></span>

<span data-ttu-id="e3f5c-120">Jako v předchozích kurzu vytvoříte nejsou žádné nové stránky.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-120">As in the previous tutorial, you'll not create any new pages.</span></span> <span data-ttu-id="e3f5c-121">Místo toho změníte způsob rozhraní Entity Framework přistupovat k databázi pro některý ze stránek, které jste už vytvořili.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-121">Instead, you'll change the way the Entity Framework accesses the database for some of the pages you already created.</span></span>

<span data-ttu-id="e3f5c-122">V tomto kurzu vytvoříte uložené procedury v databázi pro vkládání `Student` a `Instructor` entity.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-122">In this tutorial you'll create stored procedures in the database for inserting `Student` and `Instructor` entities.</span></span> <span data-ttu-id="e3f5c-123">Je přidáte do datového modelu, a specifikujete, že rozhraní Entity Framework by měl použít pro přidání `Student` a `Instructor` entity do databáze.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-123">You'll add them to the data model, and you'll specify that the Entity Framework should use them for adding `Student` and `Instructor` entities to the database.</span></span> <span data-ttu-id="e3f5c-124">Také vytvoříte uložené procedury, která můžete použít k načtení `Course` entity.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-124">You'll also create a stored procedure that you can use to retrieve `Course` entities.</span></span>

## <a name="creating-stored-procedures-in-the-database"></a><span data-ttu-id="e3f5c-125">Vytváření uložené procedury v databázi</span><span class="sxs-lookup"><span data-stu-id="e3f5c-125">Creating Stored Procedures in the Database</span></span>

<span data-ttu-id="e3f5c-126">(Pokud používáte *School.mdf* souboru z projektu, které jsou k dispozici ke stažení v tomto kurzu, můžete přeskočit v této části, protože již existuje uložené procedury.)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-126">(If you're using the *School.mdf* file from the project available for download with this tutorial, you can skip this section because the stored procedures already exist.)</span></span>

<span data-ttu-id="e3f5c-127">V **Průzkumníka serveru**, rozbalte položku *School.mdf*, klikněte pravým tlačítkem na **uložené procedury**a vyberte **přidat novou uloženou proceduru**.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-127">In **Server Explorer**, expand *School.mdf*, right-click **Stored Procedures**, and select **Add New Stored Procedure**.</span></span>

<span data-ttu-id="e3f5c-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span></span>

<span data-ttu-id="e3f5c-129">Zkopírujte následující příkazy SQL a vložte je do okna uložené procedury nahrazení kostru uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-129">Copy the following SQL statements and paste them into the stored procedure window, replacing the skeleton stored procedure.</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample1.sql)]

<span data-ttu-id="e3f5c-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span></span>

<span data-ttu-id="e3f5c-131">`Student`entit obsahuje čtyři vlastnosti: `PersonID`, `LastName`, `FirstName`, a `EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-131">`Student` entities have four properties: `PersonID`, `LastName`, `FirstName`, and `EnrollmentDate`.</span></span> <span data-ttu-id="e3f5c-132">Databáze automaticky generuje hodnotu ID a uložené procedury přijímá parametry pro další tři.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-132">The database generates the ID value automatically, and the stored procedure accepts parameters for the other three.</span></span> <span data-ttu-id="e3f5c-133">Uložená procedura vrací hodnoty klíče záznamu pro nový řádek tak, aby rozhraní Entity Framework můžete sledovat určité, ve verzi entity, který udržuje v paměti.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-133">The stored procedure returns the value of the new row's record key so that the Entity Framework can keep track of that in the version of the entity it keeps in memory.</span></span>

<span data-ttu-id="e3f5c-134">Uložte a zavřete okno uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-134">Save and close the stored procedure window.</span></span>

<span data-ttu-id="e3f5c-135">Vytvoření `InsertInstructor` uložené procedury stejným způsobem, pomocí následujících příkazů SQL:</span><span class="sxs-lookup"><span data-stu-id="e3f5c-135">Create an `InsertInstructor` stored procedure in the same manner, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample2.sql)]

<span data-ttu-id="e3f5c-136">Vytvoření `Update` uložené procedury pro `Student` a `Instructor` entity také.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-136">Create `Update` stored procedures for `Student` and `Instructor` entities also.</span></span> <span data-ttu-id="e3f5c-137">(Databáze již obsahuje `DeletePerson` uložené procedury, která bude funkční pro oba `Instructor` a `Student` entity.)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-137">(The database already has a `DeletePerson` stored procedure which will work for both `Instructor` and `Student` entities.)</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample3.sql)]

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample4.sql)]

<span data-ttu-id="e3f5c-138">V tomto kurzu budete mapovat všechny tři funkce – insert, update a delete – ke každému typu entity.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-138">In this tutorial you'll map all three functions -- insert, update, and delete -- for each entity type.</span></span> <span data-ttu-id="e3f5c-139">Rozhraní Entity Framework verze 4 umožňuje mapovat pouze jeden nebo dva z těchto funkcí k uloženým procedurám bez mapování ostatní, s jednou výjimkou: Pokud namapujete funkce aktualizace, ale není funkce odstranění, rozhraní Entity Framework vyvolá výjimku při můžete došlo k pokusu o odstranění entity.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-139">The Entity Framework version 4 allows you to map just one or two of these functions to stored procedures without mapping the others, with one exception: if you map the update function but not the delete function, the Entity Framework will throw an exception when you attempt to delete an entity.</span></span> <span data-ttu-id="e3f5c-140">V rozhraní Entity Framework verze 3.5 neměl tolik flexibilitu při mapování uložené procedury: Pokud jste namapovali jednu funkci jste potřeba mapovat všechny tři.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-140">In the Entity Framework version 3.5, you did not have this much flexibility in mapping stored procedures: if you mapped one function you were required to map all three.</span></span>

<span data-ttu-id="e3f5c-141">Pokud chcete vytvořit uložené procedury, která čte než aktualizuje data, vytvořte ten, který vybere všechny `Course` entity, pomocí následujících příkazů SQL:</span><span class="sxs-lookup"><span data-stu-id="e3f5c-141">To create a stored procedure that reads rather than updates data, create one that selects all `Course` entities, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample5.sql)]

## <a name="adding-the-stored-procedures-to-the-data-model"></a><span data-ttu-id="e3f5c-142">Přidávání do datového modelu uložené procedury</span><span class="sxs-lookup"><span data-stu-id="e3f5c-142">Adding the Stored Procedures to the Data Model</span></span>

<span data-ttu-id="e3f5c-143">Uložené procedury jsou nyní definována v databázi, ale je nutné je přidat do datového modelu, aby byly dostupné Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-143">The stored procedures are now defined in the database, but they must be added to the data model to make them available to the Entity Framework.</span></span> <span data-ttu-id="e3f5c-144">Otevřete *SchoolModel.edmx*, klikněte pravým tlačítkem na návrhovou plochu a vyberte **aktualizovat Model z databáze**.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-144">Open *SchoolModel.edmx*, right-click the design surface, and select **Update Model from Database**.</span></span> <span data-ttu-id="e3f5c-145">V **přidat** kartě **zvolte si databázové objekty** dialogové okno, rozbalte seznam **uložené procedury**, vyberte nově vytvořenou uložené procedury a `DeletePerson` uložené procedury a potom klikněte na **Dokončit**.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-145">In the **Add** tab of the **Choose Your Database Objects** dialog box, expand **Stored Procedures**, select the newly created stored procedures and the `DeletePerson` stored procedure, and then click **Finish**.</span></span>

<span data-ttu-id="e3f5c-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span></span>

## <a name="mapping-the-stored-procedures"></a><span data-ttu-id="e3f5c-147">Mapování uložené procedury</span><span class="sxs-lookup"><span data-stu-id="e3f5c-147">Mapping the Stored Procedures</span></span>

<span data-ttu-id="e3f5c-148">V Návrháři modelu dat, klikněte pravým tlačítkem myši `Student` entity a vyberte **uložené procedury mapování**.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-148">In the data model designer, right-click the `Student` entity and select **Stored Procedure Mapping**.</span></span>

<span data-ttu-id="e3f5c-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span></span>

<span data-ttu-id="e3f5c-150">**Podrobnosti mapování** zobrazí se okno, ve kterém můžete zadat uložené procedury, které by měl používat rozhraní Entity Framework pro vložení, aktualizaci a odstraňování entit tohoto typu.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-150">The **Mapping Details** window appears, in which you can specify stored procedures that the Entity Framework should use for inserting, updating, and deleting entities of this type.</span></span>

<span data-ttu-id="e3f5c-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span></span>

<span data-ttu-id="e3f5c-152">Nastavte **vložit** funkci, aby se **InsertStudent**.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-152">Set the **Insert** function to **InsertStudent**.</span></span> <span data-ttu-id="e3f5c-153">Okno zobrazuje seznam parametrů uložené procedury, každý z nich musí být namapovaný na vlastnost entity.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-153">The window shows a list of stored procedure parameters, each of which must be mapped to an entity property.</span></span> <span data-ttu-id="e3f5c-154">Dvě z nich jsou mapovány automaticky protože názvy jsou stejné.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-154">Two of these are mapped automatically because the names are the same.</span></span> <span data-ttu-id="e3f5c-155">Neexistuje vlastnost s názvem entity `FirstName`, takže musíte ručně vybrat `FirstMidName` z rozevíracího seznamu, která se zobrazují vlastnosti dostupné entity.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-155">There's no entity property named `FirstName`, so you must manually select `FirstMidName` from a drop-down list that shows available entity properties.</span></span> <span data-ttu-id="e3f5c-156">(Je to proto, že jste změnili název `FirstName` vlastnost `FirstMidName` z prvního kurzu.)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-156">(This is because you changed the name of the `FirstName` property to `FirstMidName` in the first tutorial.)</span></span>

<span data-ttu-id="e3f5c-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span></span>

<span data-ttu-id="e3f5c-158">Ve stejném **podrobnosti mapování** okno, mapy `Update` funkci, aby se `UpdateStudent` uložené procedury (je nutné zadat `FirstMidName` jako hodnota parametru pro `FirstName`, stejně jako u `Insert` uložené procedury) a `Delete` funkci, aby se `DeletePerson` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-158">In the same **Mapping Details** window, map the `Update` function to the `UpdateStudent` stored procedure (make sure you specify `FirstMidName` as the parameter value for `FirstName`, as you did for the `Insert` stored procedure) and the `Delete` function to the `DeletePerson` stored procedure.</span></span>

<span data-ttu-id="e3f5c-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span></span>

<span data-ttu-id="e3f5c-160">Použijte stejný postup mapování insert, update a delete uložené procedury pro vyučující k `Instructor` entity.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-160">Follow the same procedure to map the insert, update, and delete stored procedures for instructors to the `Instructor` entity.</span></span>

<span data-ttu-id="e3f5c-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span></span>

<span data-ttu-id="e3f5c-162">Pro uložené procedury, které čtou místo aktualizace dat, můžete použít **prohlížeče modelu** okno Mapovat uloženou proceduru v entitě typu vrátí.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-162">For stored procedures that read rather than update data, you use the **Model Browser** window to map the stored procedure to the entity type it returns.</span></span> <span data-ttu-id="e3f5c-163">V Návrháři modelu dat, klikněte pravým tlačítkem na návrhové plochy a vyberte možnost **prohlížeče modelu**.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-163">In the data model designer, right-click the design surface and select **Model Browser**.</span></span> <span data-ttu-id="e3f5c-164">Otevřete **SchoolModel.Store** uzel a potom otevřete **uložené procedury** uzlu.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-164">Open the **SchoolModel.Store** node and then open the **Stored Procedures** node.</span></span> <span data-ttu-id="e3f5c-165">Klikněte pravým tlačítkem `GetCourses` uložené procedury a vyberte **přidat importu funkce**.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-165">Then right-click the `GetCourses` stored procedure and select **Add Function Import**.</span></span>

<span data-ttu-id="e3f5c-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span></span>

<span data-ttu-id="e3f5c-167">V **přidat importu funkce** dialogovém **vrátí kolekce z** vyberte **entity**a potom vyberte `Course` vrácena jako typ entity.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-167">In the **Add Function Import** dialog box, under **Returns a Collection Of** select **Entities**, and then select `Course` as the entity type returned.</span></span> <span data-ttu-id="e3f5c-168">Když jste hotovi, klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-168">When you're done, click **OK**.</span></span> <span data-ttu-id="e3f5c-169">Uložte a zavřete *.edmx* souboru.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-169">Save and close the *.edmx* file.</span></span>

<span data-ttu-id="e3f5c-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span></span>

## <a name="using-insert-update-and-delete-stored-procedures"></a><span data-ttu-id="e3f5c-171">Pomocí vložit, aktualizovat a odstraňovat uložené procedury</span><span class="sxs-lookup"><span data-stu-id="e3f5c-171">Using Insert, Update, and Delete Stored Procedures</span></span>

<span data-ttu-id="e3f5c-172">Uložené procedury chcete vložit, aktualizovat a odstraňovat data jsou používány rozhraní Entity Framework automaticky po jejich přidání do datového modelu a mapovat je na odpovídající entity.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-172">Stored procedures to insert, update, and delete data are used by the Entity Framework automatically after you've added them to the data model and mapped them to the appropriate entities.</span></span> <span data-ttu-id="e3f5c-173">Teď můžete spustit *StudentsAdd.aspx* stránky, a pokaždé, když vytvoříte nový student, bude používat rozhraní Entity Framework `InsertStudent` uložené procedury, chcete-li přidat nový řádek, abyste `Student` tabulky.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-173">You can now run the *StudentsAdd.aspx* page, and every time you create a new student, the Entity Framework will use the `InsertStudent` stored procedure to add the new row to the `Student` table.</span></span>

<span data-ttu-id="e3f5c-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span></span>

<span data-ttu-id="e3f5c-175">Spustit *Students.aspx* stránky a Nový student se zobrazí v seznamu.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-175">Run the *Students.aspx* page and the new student appears in the list.</span></span>

<span data-ttu-id="e3f5c-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span></span>

<span data-ttu-id="e3f5c-177">Změňte název ověřte, že funkce aktualizace funguje a pak odstraňte studenty do ověřte, že funkce Odstranit funguje.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-177">Change the name to verify that the update function works, and then delete the student to verify that the delete function works.</span></span>

<span data-ttu-id="e3f5c-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span></span>

## <a name="using-select-stored-procedures"></a><span data-ttu-id="e3f5c-179">Použití vyberte uložených procedur</span><span class="sxs-lookup"><span data-stu-id="e3f5c-179">Using Select Stored Procedures</span></span>

<span data-ttu-id="e3f5c-180">Rozhraní Entity Framework nespustí automaticky uložené procedury, jako `GetCourses`, a nebude možné použít s `EntityDataSource` ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-180">The Entity Framework does not automatically run stored procedures such as `GetCourses`, and you cannot use them with the `EntityDataSource` control.</span></span> <span data-ttu-id="e3f5c-181">Jejich použití, můžete je volat z kódu.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-181">To use them, you call them from code.</span></span>

<span data-ttu-id="e3f5c-182">Otevřete *InstructorsCourses.aspx.cs* souboru.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-182">Open the *InstructorsCourses.aspx.cs* file.</span></span> <span data-ttu-id="e3f5c-183">`PopulateDropDownLists` Metoda používá k načtení všech entit kurzu tak, aby můžete projít v seznamu a zjistit, které z nich je přiřazen lektorem a ty, které nepřiřazené dotaz LINQ entity:</span><span class="sxs-lookup"><span data-stu-id="e3f5c-183">The `PopulateDropDownLists` method uses a LINQ-to-Entities query to retrieve all course entities so that it can loop through the list and determine which ones an instructor is assigned to and which ones are unassigned:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample6.cs)]

<span data-ttu-id="e3f5c-184">Nahraďte ho následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="e3f5c-184">Replace this with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample7.cs)]

<span data-ttu-id="e3f5c-185">Stránka teď používá `GetCourses` uložené procedury načíst seznam všech kurzů.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-185">The page now uses the `GetCourses` stored procedure to retrieve the list of all courses.</span></span> <span data-ttu-id="e3f5c-186">Spusťte stránku a ověřte, že funguje jako předtím.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-186">Run the page to verify that it works as it did before.</span></span>

<span data-ttu-id="e3f5c-187">(Vlastnosti navigace entit získaných pomocí uložené procedury nemusí být automaticky naplněna data související s těmito entitami, v závislosti na `ObjectContext` výchozí nastavení.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-187">(Navigation properties of entities retrieved by a stored procedure might not be automatically populated with the data related to those entities, depending on `ObjectContext` default settings.</span></span> <span data-ttu-id="e3f5c-188">Další informace najdete v tématu [načítání související objekty](https://msdn.microsoft.com/library/bb896272.aspx) v knihovně MSDN.)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-188">For more information, see [Loading Related Objects](https://msdn.microsoft.com/library/bb896272.aspx) in the MSDN Library.)</span></span>

<span data-ttu-id="e3f5c-189">V dalším kurzu dozvíte, jak bylo snazší program a testování pravidla formátování a ověření dat pomocí funkce Dynamická Data.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-189">In the next tutorial, you'll learn how to use Dynamic Data functionality to make it easier to program and test data formatting and validation rules.</span></span> <span data-ttu-id="e3f5c-190">Místo zadání na každý pravidla webové stránky, jako jsou třeba řetězce formátu data a zda pole je požadováno, tato pravidla můžete zadat v metadatech datového modelu a automaticky se použijí na každé stránce.</span><span class="sxs-lookup"><span data-stu-id="e3f5c-190">Instead of specifying on each web page rules such as data format strings and whether or not a field is required, you can specify such rules in data model metadata and they're automatically applied on every page.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="e3f5c-191">[Předchozí](the-entity-framework-and-aspnet-getting-started-part-6.md)
[další](the-entity-framework-and-aspnet-getting-started-part-8.md)</span><span class="sxs-lookup"><span data-stu-id="e3f5c-191">[Previous](the-entity-framework-and-aspnet-getting-started-part-6.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-8.md)</span></span>
