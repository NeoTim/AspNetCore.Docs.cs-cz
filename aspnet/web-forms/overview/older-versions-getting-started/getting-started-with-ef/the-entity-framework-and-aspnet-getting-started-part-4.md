---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
title: Začínáme s databáze Entity Framework 4.0 nejprve a ASP.NET 4 webové formuláře – část 4 | Microsoft Docs
author: tdykstra
description: Contoso univerzity ukázkovou webovou aplikaci demonstruje postup vytvoření aplikace webových formulářů ASP.NET používající rozhraní Entity Framework. Vzorová aplikace je...
ms.author: aspnetcontent
manager: wpickett
ms.date: 12/03/2010
ms.topic: article
ms.assetid: ceb9e60f-957c-4d25-9331-cc527de96a33
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
msc.type: authoredcontent
ms.openlocfilehash: 6bea5f4faeb0a9c11a406a7e4e87c4929eda6a18
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/06/2018
---
<a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-4"></a><span data-ttu-id="ecc50-104">Začínáme s databáze Entity Framework 4.0 nejprve a 4 webových formulářů ASP.NET - část 4</span><span class="sxs-lookup"><span data-stu-id="ecc50-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 4</span></span>
====================
<span data-ttu-id="ecc50-105">Podle [tní Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="ecc50-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="ecc50-106">Contoso univerzity ukázkovou webovou aplikaci demonstruje postup vytvoření aplikace webových formulářů ASP.NET pomocí sady Visual Studio 2010 a Entity Framework 4.0.</span><span class="sxs-lookup"><span data-stu-id="ecc50-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="ecc50-107">Informace o kurzu řady najdete v tématu [první kurz v řadě](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="ecc50-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="working-with-related-data"></a><span data-ttu-id="ecc50-108">Práce s související Data</span><span class="sxs-lookup"><span data-stu-id="ecc50-108">Working with Related Data</span></span>

<span data-ttu-id="ecc50-109">V předchozích kurzu jste použili `EntityDataSource` řízení k filtrování, řazení a data skupiny.</span><span class="sxs-lookup"><span data-stu-id="ecc50-109">In the previous tutorial you used the `EntityDataSource` control to filter, sort, and group data.</span></span> <span data-ttu-id="ecc50-110">V tomto kurzu můžete zobrazit a aktualizovat data v relaci.</span><span class="sxs-lookup"><span data-stu-id="ecc50-110">In this tutorial you'll display and update related data.</span></span>

<span data-ttu-id="ecc50-111">Vytvoříte vyučující stránky, která obsahuje seznam vyučující.</span><span class="sxs-lookup"><span data-stu-id="ecc50-111">You'll create the Instructors page that shows a list of instructors.</span></span> <span data-ttu-id="ecc50-112">Když vyberete lektorem, zobrazí se seznam kurzů výukové podle této lektorem.</span><span class="sxs-lookup"><span data-stu-id="ecc50-112">When you select an instructor, you see a list of courses taught by that instructor.</span></span> <span data-ttu-id="ecc50-113">Když vyberete kurzu, najdete v podrobnostech během a seznam studenty zařazen do kurzu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-113">When you select a course, you see details for the course and a list of students enrolled in the course.</span></span> <span data-ttu-id="ecc50-114">Můžete upravit název lektorem, datum přijetí a přiřazení office.</span><span class="sxs-lookup"><span data-stu-id="ecc50-114">You can edit the instructor name, hire date, and office assignment.</span></span> <span data-ttu-id="ecc50-115">Přiřazení office je sada samostatné entity, které přistupujete prostřednictvím navigační vlastnost.</span><span class="sxs-lookup"><span data-stu-id="ecc50-115">The office assignment is a separate entity set that you access through a navigation property.</span></span>

<span data-ttu-id="ecc50-116">Hlavní data můžete propojit podrobná data v kódu nebo v kódu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-116">You can link master data to detail data in markup or in code.</span></span> <span data-ttu-id="ecc50-117">V této části kurzu budete používat obě metody.</span><span class="sxs-lookup"><span data-stu-id="ecc50-117">In this part of the tutorial, you'll use both methods.</span></span>

<span data-ttu-id="ecc50-118">[![Image01](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ecc50-118">[![Image01](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span></span>

## <a name="displaying-and-updating-related-entities-in-a-gridview-control"></a><span data-ttu-id="ecc50-119">Zobrazení a aktualizace entit v relaci v ovládacím prvku GridView</span><span class="sxs-lookup"><span data-stu-id="ecc50-119">Displaying and Updating Related Entities in a GridView Control</span></span>

<span data-ttu-id="ecc50-120">Vytvořit novou webovou stránku s názvem *Instructors.aspx* používající *Site.Master* hlavní stránky a přidejte následující kód do `Content` ovládací prvek s názvem `Content2`:</span><span class="sxs-lookup"><span data-stu-id="ecc50-120">Create a new web page named *Instructors.aspx* that uses the *Site.Master* master page, and add the following markup to the `Content` control named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample1.aspx)]

<span data-ttu-id="ecc50-121">Tento kód vytvoří `EntityDataSource` ovládací prvek, který vybere vyučující a umožňuje aktualizace.</span><span class="sxs-lookup"><span data-stu-id="ecc50-121">This markup creates an `EntityDataSource` control that selects instructors and enables updates.</span></span> <span data-ttu-id="ecc50-122">`div` Element konfiguruje značky k vykreslení na levé straně, aby sloupec na pravé straně můžete přidat později.</span><span class="sxs-lookup"><span data-stu-id="ecc50-122">The `div` element configures markup to render on the left so that you can add a column on the right later.</span></span>

<span data-ttu-id="ecc50-123">Mezi `EntityDataSource` kódu a zavření `</div>` značky, přidejte následující kód, který vytvoří `GridView` řízení a `Label` ovládací prvek, který budete používat pro chybové zprávy:</span><span class="sxs-lookup"><span data-stu-id="ecc50-123">Between the `EntityDataSource` markup and the closing `</div>` tag, add the following markup that creates a `GridView` control and a `Label` control that you'll use for error messages:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample2.aspx)]

<span data-ttu-id="ecc50-124">To `GridView` řízení umožňuje výběr řádků, označuje vybraný řádek s světla šedou barvu a určuje obslužné rutiny (které vytvoříte později) `SelectedIndexChanged` a `Updating` události.</span><span class="sxs-lookup"><span data-stu-id="ecc50-124">This `GridView` control enables row selection, highlights the selected row with a light gray background color, and specifies handlers (which you'll create later) for the `SelectedIndexChanged` and `Updating` events.</span></span> <span data-ttu-id="ecc50-125">Určuje také `PersonID` pro `DataKeyNames` vlastnost tak, aby hodnota klíče vybraného řádku můžete předat na jiný ovládací prvek, který bude potřeba přidat později.</span><span class="sxs-lookup"><span data-stu-id="ecc50-125">It also specifies `PersonID` for the `DataKeyNames` property, so that the key value of the selected row can be passed to another control that you'll add later.</span></span>

<span data-ttu-id="ecc50-126">Poslední sloupec obsahuje přiřazení office lektorem, která je uložena v vlastnost navigace `Person` entity protože pochází z související entity.</span><span class="sxs-lookup"><span data-stu-id="ecc50-126">The last column contains the instructor's office assignment, which is stored in a navigation property of the `Person` entity because it comes from an associated entity.</span></span> <span data-ttu-id="ecc50-127">Všimněte si, že `EditItemTemplate` určuje element `Eval` místo `Bind`, protože `GridView` ovládacího prvku nelze vytvořit vazbu přímo na navigační vlastnosti za účelem jejich aktualizace.</span><span class="sxs-lookup"><span data-stu-id="ecc50-127">Notice that the `EditItemTemplate` element specifies `Eval` instead of `Bind`, because the `GridView` control cannot directly bind to navigation properties in order to update them.</span></span> <span data-ttu-id="ecc50-128">Budete aktualizovat office přiřazení v kódu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-128">You'll update the office assignment in code.</span></span> <span data-ttu-id="ecc50-129">Kvůli tomu budete potřebovat odkaz na `TextBox` řízení a budete získat a že v Uložit `TextBox` ovládacího prvku `Init` událostí.</span><span class="sxs-lookup"><span data-stu-id="ecc50-129">To do that, you'll need a reference to the `TextBox` control, and you'll get and save that in the `TextBox` control's `Init` event.</span></span>

<span data-ttu-id="ecc50-130">Následující `GridView` ovládacího prvku `Label` ovládací prvek, který se používá pro chybové zprávy.</span><span class="sxs-lookup"><span data-stu-id="ecc50-130">Following the `GridView` control is a `Label` control that's used for error messages.</span></span> <span data-ttu-id="ecc50-131">Ovládacího prvku `Visible` vlastnost je `false`, a stav zobrazení je vypnutý, tak, aby popisek se zobrazí, pouze pokud kód je viditelný v odpovědi na chybu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-131">The control's `Visible` property is `false`, and view state is turned off, so that the label will appear only when code makes it visible in response to an error.</span></span>

<span data-ttu-id="ecc50-132">Otevřete *Instructors.aspx.cs* souboru a přidejte následující `using` příkaz:</span><span class="sxs-lookup"><span data-stu-id="ecc50-132">Open the *Instructors.aspx.cs* file and add the following `using` statement:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample3.cs)]

<span data-ttu-id="ecc50-133">Přidáte pole Soukromá třída okamžitě po deklaraci název částečné třídy pro uložení odkaz na textového pole přiřazení office.</span><span class="sxs-lookup"><span data-stu-id="ecc50-133">Add a private class field immediately after the partial-class name declaration to hold a reference to the office assignment text box.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample4.cs)]

<span data-ttu-id="ecc50-134">Přidat zástupnou proceduru pro `SelectedIndexChanged` obslužné rutiny události, že přidáte kód pro pozdější.</span><span class="sxs-lookup"><span data-stu-id="ecc50-134">Add a stub for the `SelectedIndexChanged` event handler that you'll add code for later.</span></span> <span data-ttu-id="ecc50-135">Také přidat obslužnou rutinu pro přiřazení office `TextBox` ovládacího prvku `Init` událostí tak, aby uchováváte odkaz na `TextBox` ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="ecc50-135">Also add a handler for the office assignment `TextBox` control's `Init` event so that you can store a reference to the `TextBox` control.</span></span> <span data-ttu-id="ecc50-136">Tento odkaz budete používat k získání hodnoty zadané uživatelem za účelem aktualizace entity přidružené navigační vlastnost.</span><span class="sxs-lookup"><span data-stu-id="ecc50-136">You'll use this reference to get the value the user entered in order to update the entity associated with the navigation property.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample5.cs)]

<span data-ttu-id="ecc50-137">Budete používat `GridView` ovládacího prvku `Updating` událost aktualizace `Location` vlastnosti přidruženého `OfficeAssignment` entity.</span><span class="sxs-lookup"><span data-stu-id="ecc50-137">You'll use the `GridView` control's `Updating` event to update the `Location` property of the associated `OfficeAssignment` entity.</span></span> <span data-ttu-id="ecc50-138">Přidejte následující obslužnou rutinu pro `Updating` událostí:</span><span class="sxs-lookup"><span data-stu-id="ecc50-138">Add the following handler for the `Updating` event:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample6.cs)]

<span data-ttu-id="ecc50-139">Tento kód se spustí, když uživatel klikne **aktualizace** v `GridView` řádek.</span><span class="sxs-lookup"><span data-stu-id="ecc50-139">This code is run when the user clicks **Update** in a `GridView` row.</span></span> <span data-ttu-id="ecc50-140">Kód používá technologii LINQ to Entities načíst `OfficeAssignment` entity, který je spojen s aktuálním `Person` entity, pomocí `PersonID` vybraného řádku z argumentu události.</span><span class="sxs-lookup"><span data-stu-id="ecc50-140">The code uses LINQ to Entities to retrieve the `OfficeAssignment` entity that's associated with the current `Person` entity, using the `PersonID` of the selected row from the event argument.</span></span>

<span data-ttu-id="ecc50-141">Jeden z následujících akcí v závislosti na hodnotě v kód pak dojde `InstructorOfficeTextBox` ovládacího prvku:</span><span class="sxs-lookup"><span data-stu-id="ecc50-141">The code then takes one of the following actions depending on the value in the `InstructorOfficeTextBox` control:</span></span>

- <span data-ttu-id="ecc50-142">Pokud se textové pole má hodnotu a je žádné `OfficeAssignment` entity, které chcete aktualizovat, vytvoří jeden.</span><span class="sxs-lookup"><span data-stu-id="ecc50-142">If the text box has a value and there's no `OfficeAssignment` entity to update, it creates one.</span></span>
- <span data-ttu-id="ecc50-143">Pokud textového pole má hodnotu a dojde `OfficeAssignment` entity, aktualizuje `Location` hodnotu vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="ecc50-143">If the text box has a value and there's an `OfficeAssignment` entity, it updates the `Location` property value.</span></span>
- <span data-ttu-id="ecc50-144">Pokud jsou textové pole je prázdné a `OfficeAssignment` entita existuje, odstraní entitu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-144">If the text box is empty and an `OfficeAssignment` entity exists, it deletes the entity.</span></span>

<span data-ttu-id="ecc50-145">Po této uloží změny do databáze.</span><span class="sxs-lookup"><span data-stu-id="ecc50-145">After this, it saves the changes to the database.</span></span> <span data-ttu-id="ecc50-146">Pokud dojde k výjimce, zobrazí chybovou zprávu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-146">If an exception occurs, it displays an error message.</span></span>

<span data-ttu-id="ecc50-147">Spuštění stránky.</span><span class="sxs-lookup"><span data-stu-id="ecc50-147">Run the page.</span></span>

<span data-ttu-id="ecc50-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ecc50-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span></span>

<span data-ttu-id="ecc50-149">Klikněte na tlačítko **upravit** a změnit všechna pole do textových polí.</span><span class="sxs-lookup"><span data-stu-id="ecc50-149">Click **Edit** and all fields change to text boxes.</span></span>

<span data-ttu-id="ecc50-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="ecc50-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span></span>

<span data-ttu-id="ecc50-151">Změna těchto hodnot, včetně **Office přiřazení**.</span><span class="sxs-lookup"><span data-stu-id="ecc50-151">Change any of these values, including **Office Assignment**.</span></span> <span data-ttu-id="ecc50-152">Klikněte na tlačítko **aktualizace** a uvidíte provedené změny v seznamu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-152">Click **Update** and you'll see the changes reflected in the list.</span></span>

## <a name="displaying-related-entities-in-a-separate-control"></a><span data-ttu-id="ecc50-153">Zobrazení entit v relaci v samostatných ovládacího prvku</span><span class="sxs-lookup"><span data-stu-id="ecc50-153">Displaying Related Entities in a Separate Control</span></span>

<span data-ttu-id="ecc50-154">Každý lektorem můžete naučit jeden nebo více kurzy, takže přidáte `EntityDataSource` řízení a `GridView` ovládacího prvku seznam kurzy spojené s kteroukoli lektorem je vybraný v vyučující `GridView` ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="ecc50-154">Each instructor can teach one or more courses, so you'll add an `EntityDataSource` control and a `GridView` control to list the courses associated with whichever instructor is selected in the instructors `GridView` control.</span></span> <span data-ttu-id="ecc50-155">K vytvoření nadpisu a `EntityDataSource` řízení pro kurzy entity, přidejte následující kód mezi chybová zpráva `Label` řízení a zavření `</div>` značky:</span><span class="sxs-lookup"><span data-stu-id="ecc50-155">To create a heading and the `EntityDataSource` control for courses entities, add the following markup between the error message `Label` control and the closing `</div>` tag:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample7.aspx)]

<span data-ttu-id="ecc50-156">`Where` Parametr obsahuje hodnotu `PersonID` z lektorem, jejichž řádek je vybrán v `InstructorsGridView` ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="ecc50-156">The `Where` parameter contains the value of the `PersonID` of the instructor whose row is selected in the `InstructorsGridView` control.</span></span> <span data-ttu-id="ecc50-157">`Where` Vlastnost obsahuje výběru příkaz, který získá všechny přidružené `Person` entity z `Course` entity `People` navigační vlastnost a vybere `Course` entity jenom Pokud jeden z přidružených `Person`entity obsahuje vybranou `PersonID` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-157">The `Where` property contains a subselect command that gets all associated `Person` entities from a `Course` entity's `People` navigation property and selects the `Course` entity only if one of the associated `Person` entities contains the selected `PersonID` value.</span></span>

<span data-ttu-id="ecc50-158">K vytvoření `GridView` řízení. přidejte následující kód bezprostředně po `CoursesEntityDataSource` ovládací prvek (před uzavírací `</div>` značka):</span><span class="sxs-lookup"><span data-stu-id="ecc50-158">To create the `GridView` control., add the following markup immediately following the `CoursesEntityDataSource` control (before the closing `</div>` tag):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample8.aspx)]

<span data-ttu-id="ecc50-159">Protože žádné kurzy se zobrazí, pokud je vybrána žádná lektorem, `EmptyDataTemplate` element je součástí.</span><span class="sxs-lookup"><span data-stu-id="ecc50-159">Because no courses will be displayed if no instructor is selected, an `EmptyDataTemplate` element is included.</span></span>

<span data-ttu-id="ecc50-160">Spuštění stránky.</span><span class="sxs-lookup"><span data-stu-id="ecc50-160">Run the page.</span></span>

<span data-ttu-id="ecc50-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ecc50-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span></span>

<span data-ttu-id="ecc50-162">Vyberte lektorem, který má jeden nebo více kurzy přiřazen, a kurz nebo kurzy, které jsou uvedeny v tomto seznamu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-162">Select an instructor who has one or more courses assigned, and the course or courses appear in the list.</span></span> <span data-ttu-id="ecc50-163">(Poznámka: Přestože schéma databáze umožňuje více kurzy, v testovací dat uvedených v databázi žádná lektorem ve skutečnosti má více než jeden kurzu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-163">(Note: although the database schema allows multiple courses, in the test data supplied with the database no instructor actually has more than one course.</span></span> <span data-ttu-id="ecc50-164">Můžete přidat kurzy k databázi sami pomocí **Průzkumníka serveru** okno nebo *CoursesAdd.aspx* stránky, které přidáte novější kurzu.)</span><span class="sxs-lookup"><span data-stu-id="ecc50-164">You can add courses to the database yourself using the **Server Explorer** window or the *CoursesAdd.aspx* page, which you'll add in a later tutorial.)</span></span>

<span data-ttu-id="ecc50-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ecc50-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span></span>

<span data-ttu-id="ecc50-166">`CoursesGridView` Ovládací prvek se zobrazuje pouze několik polí kurzu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-166">The `CoursesGridView` control shows only a few course fields.</span></span> <span data-ttu-id="ecc50-167">Pokud chcete zobrazit všechny podrobnosti kurzu, budete používat `DetailsView` ovládací prvek pro kurz, který si uživatel vybere.</span><span class="sxs-lookup"><span data-stu-id="ecc50-167">To display all the details for a course, you'll use a `DetailsView` control for the course that the user selects.</span></span> <span data-ttu-id="ecc50-168">V *Instructors.aspx*, přidejte následující kód po zavření `</div>` značky (ujistěte se, umístěte tento kód **po** div uzavírací značku neplatný před):</span><span class="sxs-lookup"><span data-stu-id="ecc50-168">In *Instructors.aspx*, add the following markup after the closing `</div>` tag (make sure you place this markup **after** the closing div tag, not before it):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample9.aspx)]

<span data-ttu-id="ecc50-169">Tento kód vytvoří `EntityDataSource` ovládací prvek, který je vázána `Courses` sady entit.</span><span class="sxs-lookup"><span data-stu-id="ecc50-169">This markup creates an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span> <span data-ttu-id="ecc50-170">`Where` Vlastnost vybere kurzu pomocí `CourseID` hodnotu vybraného řádku na kurzech `GridView` ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="ecc50-170">The `Where` property selects a course using the `CourseID` value of the selected row in the courses `GridView` control.</span></span> <span data-ttu-id="ecc50-171">Určuje kód obslužné rutiny pro `Selected` událost, která později budete používat pro zobrazení známek studentů, což je jinou úroveň níže v hierarchii.</span><span class="sxs-lookup"><span data-stu-id="ecc50-171">The markup specifies a handler for the `Selected` event, which you'll use later for displaying student grades, which is another level lower in the hierarchy.</span></span>

<span data-ttu-id="ecc50-172">V *Instructors.aspx.cs*, vytvořte následující se zakázaným inzerováním pro `CourseDetailsEntityDataSource_Selected` metoda.</span><span class="sxs-lookup"><span data-stu-id="ecc50-172">In *Instructors.aspx.cs*, create the following stub for the `CourseDetailsEntityDataSource_Selected` method.</span></span> <span data-ttu-id="ecc50-173">(Budete vyplnit tento se zakázaným inzerováním později v tomto kurzu, momentálně se to potřebujete, aby se zkompilování a spuštění stránky.)</span><span class="sxs-lookup"><span data-stu-id="ecc50-173">(You'll fill this stub out later in the tutorial; for now, you need it so that the page will compile and run.)</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample10.cs)]

<span data-ttu-id="ecc50-174">Spuštění stránky.</span><span class="sxs-lookup"><span data-stu-id="ecc50-174">Run the page.</span></span>

<span data-ttu-id="ecc50-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="ecc50-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span></span>

<span data-ttu-id="ecc50-176">Původně nejsou žádné podrobnosti o kurzu vzhledem k tomu, že je vybrána žádná kurzu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-176">Initially there are no course details because no course is selected.</span></span> <span data-ttu-id="ecc50-177">Vyberte lektorem, který má kurzu přiřazen a pak vyberte kurzu a zobrazit podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="ecc50-177">Select an instructor who has a course assigned, and then select a course to see the details.</span></span>

<span data-ttu-id="ecc50-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ecc50-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span></span>

## <a name="using-the-entitydatasource-selected-event-to-display-related-data"></a><span data-ttu-id="ecc50-179">Pomocí EntityDataSource "vybranou" událost pro zobrazení souvisejících dat</span><span class="sxs-lookup"><span data-stu-id="ecc50-179">Using the EntityDataSource "Selected" Event to Display Related Data</span></span>

<span data-ttu-id="ecc50-180">Nakonec chcete zobrazit všechny zaregistrovaná studenty a jejich tříd pro vybraný kurz.</span><span class="sxs-lookup"><span data-stu-id="ecc50-180">Finally, you want to show all of the enrolled students and their grades for the selected course.</span></span> <span data-ttu-id="ecc50-181">K tomuto účelu použijete `Selected` události `EntityDataSource` ovládací prvek vázán ke kurzu `DetailsView`.</span><span class="sxs-lookup"><span data-stu-id="ecc50-181">To do this, you'll use the `Selected` event of the `EntityDataSource` control bound to the course `DetailsView`.</span></span>

<span data-ttu-id="ecc50-182">V *Instructors.aspx*, přidejte následující kód po `DetailsView` ovládacího prvku:</span><span class="sxs-lookup"><span data-stu-id="ecc50-182">In *Instructors.aspx*, add the following markup after the `DetailsView` control:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample11.aspx)]

<span data-ttu-id="ecc50-183">Tento kód vytvoří `ListView` ovládací prvek, který zobrazí seznam studenty a jejich tříd pro vybraný kurz.</span><span class="sxs-lookup"><span data-stu-id="ecc50-183">This markup creates a `ListView` control that displays a list of students and their grades for the selected course.</span></span> <span data-ttu-id="ecc50-184">Není zadán žádný zdroj dat, protože budete databind ovládacího prvku v kódu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-184">No data source is specified because you'll databind the control in code.</span></span> <span data-ttu-id="ecc50-185">`EmptyDataTemplate` Element poskytuje zprávu zobrazit, pokud je vybrána žádná kurzu – v takovém případě neexistují žádné studenty k zobrazení.</span><span class="sxs-lookup"><span data-stu-id="ecc50-185">The `EmptyDataTemplate` element provides a message to display when no course is selected—in that case, there are no students to display.</span></span> <span data-ttu-id="ecc50-186">`LayoutTemplate` Element vytvoří tabulky HTML k zobrazení seznamu a `ItemTemplate` určuje sloupce k zobrazení.</span><span class="sxs-lookup"><span data-stu-id="ecc50-186">The `LayoutTemplate` element creates an HTML table to display the list, and the `ItemTemplate` specifies the columns to display.</span></span> <span data-ttu-id="ecc50-187">Student ID a student úrovni jsou z `StudentGrade` entity a název student je z `Person` entita, která zpřístupňuje rozhraní Entity Framework v `Person` vlastnost navigace `StudentGrade` entity.</span><span class="sxs-lookup"><span data-stu-id="ecc50-187">The student ID and the student grade are from the `StudentGrade` entity, and the student name is from the `Person` entity that the Entity Framework makes available in the `Person` navigation property of the `StudentGrade` entity.</span></span>

<span data-ttu-id="ecc50-188">V *Instructors.aspx.cs*, nahraďte prázdná out `CourseDetailsEntityDataSource_Selected` metoda následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="ecc50-188">In *Instructors.aspx.cs*, replace the stubbed-out `CourseDetailsEntityDataSource_Selected` method with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample12.cs)]

<span data-ttu-id="ecc50-189">Vybraná data ve formě kolekci, která má nulové položky, pokud není nic vybráno nebo o jednu položku poskytuje argumentu události pro tuto událost, pokud `Course` entity je vybrána.</span><span class="sxs-lookup"><span data-stu-id="ecc50-189">The event argument for this event provides the selected data in the form of a collection, which will have zero items if nothing is selected or one item if a `Course` entity is selected.</span></span> <span data-ttu-id="ecc50-190">Pokud `Course` entity je vybraná, kód používá `First` způsobů, jak převést kolekci pro jediný objekt.</span><span class="sxs-lookup"><span data-stu-id="ecc50-190">If a `Course` entity is selected, the code uses the `First` method to convert the collection to a single object.</span></span> <span data-ttu-id="ecc50-191">Potom získá `StudentGrade` entity z navigační vlastnost, je převede na kolekci a váže `GradesListView` ovládacího prvku do kolekce.</span><span class="sxs-lookup"><span data-stu-id="ecc50-191">It then gets `StudentGrade` entities from the navigation property, converts them to a collection, and binds the `GradesListView` control to the collection.</span></span>

<span data-ttu-id="ecc50-192">Toto je dostatečná k zobrazení tříd, ale chcete zajistit, že zpráva v šabloně prázdné data se zobrazí stránka se zobrazí v prvním a vždy, když není vybraná kurzu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-192">This is sufficient to display grades, but you want to make sure that the message in the empty data template is displayed the first time the page is displayed and whenever a course is not selected.</span></span> <span data-ttu-id="ecc50-193">To lze provést, vytvořte následující metodu, která budete volat ze dvou míst:</span><span class="sxs-lookup"><span data-stu-id="ecc50-193">To do that, create the following method, which you'll call from two places:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample13.cs)]

<span data-ttu-id="ecc50-194">Tato nová metoda z volání `Page_Load` metodu pro zobrazení doby šablony první dat prázdná stránka se zobrazí.</span><span class="sxs-lookup"><span data-stu-id="ecc50-194">Call this new method from the `Page_Load` method to display the empty data template the first time the page is displayed.</span></span> <span data-ttu-id="ecc50-195">A volat z `InstructorsGridView_SelectedIndexChanged` metoda vzhledem k tomu, že událost se vyvolá, když je vybrána lektorem, což znamená, že nové kurzy jsou načteny do kurzy `GridView` řízení a žádná zatím není vybraná.</span><span class="sxs-lookup"><span data-stu-id="ecc50-195">And call it from the `InstructorsGridView_SelectedIndexChanged` method because that event is raised when an instructor is selected, which means new courses are loaded into the courses `GridView` control and none is selected yet.</span></span> <span data-ttu-id="ecc50-196">Zde jsou dvě volání:</span><span class="sxs-lookup"><span data-stu-id="ecc50-196">Here are the two calls:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample14.cs)]

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample15.cs)]

<span data-ttu-id="ecc50-197">Spuštění stránky.</span><span class="sxs-lookup"><span data-stu-id="ecc50-197">Run the page.</span></span>

<span data-ttu-id="ecc50-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="ecc50-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span></span>

<span data-ttu-id="ecc50-199">Vyberte lektorem, který má kurzu přiřazené a pak vyberte kurzu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-199">Select an instructor that has a course assigned, and then select the course.</span></span>

<span data-ttu-id="ecc50-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="ecc50-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span></span>

<span data-ttu-id="ecc50-201">Nyní jste viděli několik způsobů, jak pracovat s související data.</span><span class="sxs-lookup"><span data-stu-id="ecc50-201">You have now seen a few ways to work with related data.</span></span> <span data-ttu-id="ecc50-202">V následujícím kurzu budete informace o postupu přidání vztahy mezi existující entity, jak odebrat relace a postup přidání nové entity, která má vztah na stávající entitu.</span><span class="sxs-lookup"><span data-stu-id="ecc50-202">In the following tutorial, you'll learn how to add relationships between existing entities, how to remove relationships, and how to add a new entity that has a relationship to an existing entity.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ecc50-203">[Předchozí](the-entity-framework-and-aspnet-getting-started-part-3.md)
> [další](the-entity-framework-and-aspnet-getting-started-part-5.md)</span><span class="sxs-lookup"><span data-stu-id="ecc50-203">[Previous](the-entity-framework-and-aspnet-getting-started-part-3.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-5.md)</span></span>
