---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: Interakci se stránkou předlohy ze stránky obsahu (VB) | Microsoft Docs
author: rick-anderson
description: Prozkoumá tom, jak volat metody, nastavte vlastnosti, atd. hlavní stránky z kódu na stránce obsahu.
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/11/2008
ms.topic: article
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 7e92e7abbc69a0998d7563db0d5b206d7ba3d6be
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/06/2018
---
<a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="9afd6-103">Interakci se stránkou předlohy ze stránky obsahu (VB)</span><span class="sxs-lookup"><span data-stu-id="9afd6-103">Interacting with the Master Page from the Content Page (VB)</span></span>
====================
<span data-ttu-id="9afd6-104">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9afd6-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9afd6-105">[Stáhněte si kód](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) nebo [stáhnout PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="9afd6-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="9afd6-106">Prozkoumá tom, jak volat metody, nastavte vlastnosti, atd. hlavní stránky z kódu na stránce obsahu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>


## <a name="introduction"></a><span data-ttu-id="9afd6-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="9afd6-107">Introduction</span></span>

<span data-ttu-id="9afd6-108">V průběhu posledních pět kurzy mít jsme se podívali na tom, jak vytvořit stránku předlohy, definovat oblasti obsahu, vazby stránek ASP.NET na stránku předlohy a specifické pro stránku obsahu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="9afd6-109">Pokud návštěvník požádá o konkrétní stránky obsahu, obsah a kód hlavní stránky jsou začleněny za běhu, což vede k vykreslování hierarchie jednotné řízení.</span><span class="sxs-lookup"><span data-stu-id="9afd6-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="9afd6-110">Proto jsme již viděli jeden způsobem v, které mohou komunikovat stránky předlohy a jeden z jeho obsahu stránky: obsahu stránce vidět značky k transfuse do ovládacích prvků ContentPlaceHolder stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="9afd6-111">Co se musí ještě zkontrolujte je, jak stránky předlohy a stránky obsahu mohou komunikovat prostřednictvím kódu programu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="9afd6-112">Kromě definování značek pro ovládací prvky ContentPlaceHolder stránky předlohy, stránky obsahu můžete přiřadit hodnoty k hlavní stránce veřejné vlastnosti a vyvolání jeho veřejné metody.</span><span class="sxs-lookup"><span data-stu-id="9afd6-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="9afd6-113">Podobně hlavní stránky může komunikovat s jeho obsahem stránky.</span><span class="sxs-lookup"><span data-stu-id="9afd6-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="9afd6-114">Sice méně častých než interakce mezi jejich deklarativní označení programové interakce mezi hlavní a obsahu stránce, existuje mnoho scénářů, kde je potřeba takový programové interakce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="9afd6-115">V tomto kurzu jsme zkontrolujte, jak mohou stránku obsahu prostřednictvím kódu programu komunikovat s jeho stránky předlohy; v dalším kurzu se podíváme na tom, jak mohou stránky předlohy podobně komunikovat s jeho obsahu stránky.</span><span class="sxs-lookup"><span data-stu-id="9afd6-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="9afd6-116">Příklady programové interakce mezi stránky obsahu a jeho stránky předlohy</span><span class="sxs-lookup"><span data-stu-id="9afd6-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="9afd6-117">Konkrétní oblast stránky musí být konfigurováno na základě po stránkách, použijeme ContentPlaceHolder ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="9afd6-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="9afd6-118">Ale co o situacích, kdy se většina stránek zapotřebí pro vydávání určité výstup, ale malý počet stránek muset změnit a zobrazit něco jiného?</span><span class="sxs-lookup"><span data-stu-id="9afd6-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="9afd6-119">Jeden takový příklad, který jsme se zaměřili [ *více ContentPlaceHolders a výchozí obsahu* ](multiple-contentplaceholders-and-default-content-vb.md) kurzu zahrnuje zobrazení rozhraní přihlášení na každé stránce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="9afd6-120">Zatímco většina stránek by měla obsahovat rozhraní přihlášení, se má výjimka potlačit pro několik stránky, jako například: hlavní přihlašovací stránky (`Login.aspx`); na stránce vytvořit účet; a další stránky, které jsou přístupné pro ověřené uživatele.</span><span class="sxs-lookup"><span data-stu-id="9afd6-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="9afd6-121">[ *Více ContentPlaceHolders a výchozí obsah* ](multiple-contentplaceholders-and-default-content-vb.md) kurz vám ukázal, jak definovat výchozí obsah pro ContentPlaceHolder na hlavní stránce a pak stránky postupu přepsání v těch, kde výchozí obsah nebyl chtěli.</span><span class="sxs-lookup"><span data-stu-id="9afd6-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="9afd6-122">Další možností je vytvoření veřejné vlastnosti nebo metody v rámci stránky předlohy, která určuje, jestli se mají zobrazit či skrýt rozhraní přihlášení.</span><span class="sxs-lookup"><span data-stu-id="9afd6-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="9afd6-123">Například stránky předlohy mohou zahrnovat veřejná vlastnost s názvem `ShowLoginUI` jehož hodnota byl použitý při instalaci `Visible` vlastnost ovládací prvek pro přihlášení na hlavní stránce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="9afd6-124">Potom prostřednictvím kódu programu nastavit tyto obsahu stránky, kde má být potlačeno uživatelského rozhraní pro přihlášení `ShowLoginUI` vlastnost `False`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="9afd6-125">Nejčastější obsahu a interakce stránky předlohy pravděpodobně nastane, když v je nutné aktualizovat po některé akce vypršel obsahu stránce stránky předlohy zobrazí data.</span><span class="sxs-lookup"><span data-stu-id="9afd6-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="9afd6-126">Vezměte v úvahu, že hlavní stránky, který zahrnuje GridView, která zobrazuje pět naposledy přidat záznamy z konkrétní databázové tabulky a že jeden z jeho stránky obsahu zahrnuje rozhraní pro přidání nových záznamů do stejné tabulky.</span><span class="sxs-lookup"><span data-stu-id="9afd6-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="9afd6-127">Pokud uživatel navštíví stránku a přidejte nový záznam, uživatel uvidí, že pěti naposledy přidat záznamy zobrazené na hlavní stránce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="9afd6-128">Po vyplnění hodnoty pro sloupce nový záznam, uživatel formulář odešle.</span><span class="sxs-lookup"><span data-stu-id="9afd6-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="9afd6-129">Za předpokladu, že má rutina GridView na hlavní stránce jeho `EnableViewState` vlastnost nastavena na hodnotu True (výchozí), jeho obsah je znovu načíst ze zobrazení stavu, a v důsledku toho se zobrazí pět stejné záznamy, i když novější záznam byla právě přidána do databáze.</span><span class="sxs-lookup"><span data-stu-id="9afd6-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="9afd6-130">To může zmást uživatele.</span><span class="sxs-lookup"><span data-stu-id="9afd6-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="9afd6-131">I v případě, že stav zobrazení GridView zakážete tak, aby znovu připojí k jeho základní zdroj dat na každé zpětné volání, stále nezobrazí záznam právě přidané protože data je vázána na GridView dříve v průběhu životního cyklu stránky než při přidání nového záznamu do datab App Service Environment.</span><span class="sxs-lookup"><span data-stu-id="9afd6-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>


<span data-ttu-id="9afd6-132">Chcete-li to opravit tak, aby na hlavní stránce se zobrazí právě přidat záznam adresy GridView na zpětné volání, potřebujeme dáte pokyn, aby GridView se svázat svůj zdroj dat *po* nový záznam se přidal do databáze.</span><span class="sxs-lookup"><span data-stu-id="9afd6-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="9afd6-133">To vyžaduje interakci mezi obsah a hlavní stránky, protože je rozhraní pro přidávání nového záznamu (a její obslužné rutiny událostí) jsou v obsahu stránce, ale GridView, který je třeba aktualizovat stránku v stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="9afd6-134">Protože aktualizovat zobrazení stránky předlohy z obslužné rutiny události na stránce obsahu je jedním z nejčastějších potřeby obsah a interakce stránky předlohy, podíváme se na toto téma podrobněji.</span><span class="sxs-lookup"><span data-stu-id="9afd6-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="9afd6-135">Ke stažení pro tento kurz zahrnuje databáze Microsoft SQL Server 2005 Express Edition s názvem `NORTHWIND.MDF` na webu `App_Data` složky.</span><span class="sxs-lookup"><span data-stu-id="9afd6-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="9afd6-136">Databáze Northwind ukládá produktu, zaměstnance a informace o prodeji pro fiktivní společnosti Northwind Traders.</span><span class="sxs-lookup"><span data-stu-id="9afd6-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="9afd6-137">Krok 1 nevystavíte slabé stránky zabezpečení prostřednictvím zobrazení pěti naposledy přidat produkty v GridView na hlavní stránce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="9afd6-138">Krok 2 vytvoří obsahu stránce pro přidání nové produkty.</span><span class="sxs-lookup"><span data-stu-id="9afd6-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="9afd6-139">Krok 3 porovná vytvoření veřejné vlastnosti a metody na hlavní stránce a krok 4 ukazuje, jak se prostřednictvím kódu programu rozhraní s tyto vlastnosti a metody ze stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="9afd6-140">V tomto kurzu není pustíte do specifikace práci s daty v technologii ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="9afd6-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="9afd6-141">Kroky pro vytvoření stránky předlohy pro zobrazení dat a obsahu stránce pro vkládání dat jsou kompletní, ještě breezy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="9afd6-142">Pro podrobnější pohled na zobrazení a vkládání dat a použití ovládacích prvků SqlDataSource a GridView najdete v části Další odečty prostředky na konci tohoto kurzu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>


## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="9afd6-143">Krok 1: Zobrazení pět naposledy přidat produkty stránka předlohy</span><span class="sxs-lookup"><span data-stu-id="9afd6-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="9afd6-144">Otevřete stránku předlohy Site.master a přidejte štítky a ovládacího prvku GridView k `leftContent` `<div>`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="9afd6-145">Zrušte si jeho `Text` vlastnost, nastavte jeho `EnableViewState` vlastnost, která má `False`a jeho `ID` vlastnost `GridMessage`; nastavit prvku GridView `ID` vlastnost `RecentProducts`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="9afd6-146">Z návrháře, dále rozbalte prvku GridView inteligentních značek a vyberte pro vytvoření vazby ke zdroji dat nové.</span><span class="sxs-lookup"><span data-stu-id="9afd6-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="9afd6-147">Spustí se Průvodce konfigurací zdroje dat služby.</span><span class="sxs-lookup"><span data-stu-id="9afd6-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="9afd6-148">Vzhledem k tomu, že databáze Northwind `App_Data` složky je databáze Microsoft SQL Server, můžete vytvořit SqlDataSource výběrem (viz obrázek 1); název SqlDataSource `RecentProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>


<span data-ttu-id="9afd6-149">[![Vytvoření vazby GridView do ovládacího prvku SqlDataSource s názvem RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9afd6-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="9afd6-150">**Obrázek 01**: vazby na ovládací prvek SqlDataSource s názvem GridView `RecentProductsDataSource` ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="9afd6-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>


<span data-ttu-id="9afd6-151">Dalším krokem požádá nám určit, co se připojit k databázi.</span><span class="sxs-lookup"><span data-stu-id="9afd6-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="9afd6-152">Vyberte `NORTHWIND.MDF` databáze soubor z rozevíracího seznamu a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="9afd6-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="9afd6-153">Protože je prvním použili jsme tuto databázi, průvodce bude nabízet uložit připojovací řetězec v `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="9afd6-154">Jej uložit připojovací řetězec pomocí názvu `NorthwindConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>


<span data-ttu-id="9afd6-155">[![Připojení k databázi Northwind](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="9afd6-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="9afd6-156">**Obrázek 02**: připojení k databázi Northwind ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9afd6-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>


<span data-ttu-id="9afd6-157">Průvodce konfigurace zdroje dat poskytuje dva prostředky, které lze zadat dotaz, použít k načtení dat:</span><span class="sxs-lookup"><span data-stu-id="9afd6-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="9afd6-158">Zadáním vlastního příkazu SQL nebo uloženou proceduru nebo</span><span class="sxs-lookup"><span data-stu-id="9afd6-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="9afd6-159">Výběr tabulku nebo zobrazení a potom zadáte sloupce, které chcete vrátit</span><span class="sxs-lookup"><span data-stu-id="9afd6-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="9afd6-160">Vzhledem k tomu, že chceme vrátit pouze pět naposledy přidat produktů, je potřeba zadat vlastní příkaz SQL.</span><span class="sxs-lookup"><span data-stu-id="9afd6-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="9afd6-161">Použijte následující `SELECT` dotazu:</span><span class="sxs-lookup"><span data-stu-id="9afd6-161">Use the following `SELECT` query:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="9afd6-162">`TOP 5` – Klíčové slovo vrátí pouze prvních pět záznamů z dotazu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="9afd6-163">`Products` Primární klíč tabulky `ProductID`, je `IDENTITY` sloupec, který nám zaručuje, že každý nový produkt přidán do tabulky budou mít větší hodnotu než předchozí položce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="9afd6-164">Proto řazení výsledků podle `ProductID` v sestupném pořadí vrátí produkty od verze naposledy vytvořený ty.</span><span class="sxs-lookup"><span data-stu-id="9afd6-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>


<span data-ttu-id="9afd6-165">[![Vrátí pět nedávno přidané produkty](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9afd6-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="9afd6-166">**Obrázek 03**: vrátit pět nejvíce nedávno přidán produkty ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="9afd6-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>


<span data-ttu-id="9afd6-167">Po dokončení průvodce, Visual Studio vytvoří dvě BoundFields pro GridView zobrazíte `ProductName` a `UnitPrice` pole vrácená z databáze.</span><span class="sxs-lookup"><span data-stu-id="9afd6-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="9afd6-168">Hlavní stránka deklarativní v tomto okamžiku by měla obsahovat značek podobný následujícímu:</span><span class="sxs-lookup"><span data-stu-id="9afd6-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>


[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="9afd6-169">Jak vidíte, obsahuje kód: ovládací prvek popisek webu (`GridMessage`); GridView `RecentProducts`, s dvěma BoundFields; a SqlDataSource ovládací prvek, který vrátí pěti naposledy přidat produkty.</span><span class="sxs-lookup"><span data-stu-id="9afd6-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="9afd6-170">Tato rutina GridView vytvořen a jeho prvek SqlDataSource nakonfigurované přejděte na webovou stránku prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="9afd6-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="9afd6-171">Jak ukazuje obrázek 4, zobrazí se, že mřížky v levém dolním rohu, které uvádí pět naposledy přidat produkty.</span><span class="sxs-lookup"><span data-stu-id="9afd6-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>


<span data-ttu-id="9afd6-172">[![GridView zobrazí pět nedávno přidané produkty](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="9afd6-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="9afd6-173">**Obrázek 04**: GridView zobrazí pět nejvíce nedávno přidán produktů ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9afd6-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>


> [!NOTE]
> <span data-ttu-id="9afd6-174">Nebojte se, že vyčištění vzhled GridView.</span><span class="sxs-lookup"><span data-stu-id="9afd6-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="9afd6-175">Některé návrhy zahrnovat formátování zobrazené `UnitPrice` hodnotu jako měny a pomocí písma a barvy pozadí k vylepšení vzhledu mřížky.</span><span class="sxs-lookup"><span data-stu-id="9afd6-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>


## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="9afd6-176">Krok 2: Vytvoření stránky obsahu přidat nové produkty</span><span class="sxs-lookup"><span data-stu-id="9afd6-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="9afd6-177">Naše dalším krokem je vytvoření obsahu stránce, ze kterého uživatel může přidat nového produktu na `Products` tabulky.</span><span class="sxs-lookup"><span data-stu-id="9afd6-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="9afd6-178">Přidat novou stránku obsahu, aby `Admin` složku s názvem `AddProduct.aspx`, které opravdu pro vytvoření vazby na `Site.master` stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="9afd6-179">Obrázek 5 ukazuje Průzkumník řešení po přidání této stránky na web.</span><span class="sxs-lookup"><span data-stu-id="9afd6-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>


<span data-ttu-id="9afd6-180">[![Přidat novou stránku ASP.NET ke složce Admin](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="9afd6-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="9afd6-181">**Obrázek 05**: Přidat novou stránku ASP.NET do `Admin` složky ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="9afd6-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>


<span data-ttu-id="9afd6-182">Odvolat, že [ *zadáte název, značky Meta a ostatní hlavičky HTML na hlavní stránce* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) kurzu jsme vytvořili vlastní základní stránky třídy s názvem `BasePage` , pokud byla vygenerována nadpis stránky není explicitně nastaven.</span><span class="sxs-lookup"><span data-stu-id="9afd6-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="9afd6-183">Přejděte na `AddProduct.aspx` kódu stránky třídy a ji odvodit z `BasePage` (místo z `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="9afd6-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="9afd6-184">Nakonec aktualizujte `Web.sitemap` souboru záznam pro tento účel.</span><span class="sxs-lookup"><span data-stu-id="9afd6-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="9afd6-185">Přidejte následující kód pod `<siteMapNode>` pro lekce řízení ID pojmenování problémy:</span><span class="sxs-lookup"><span data-stu-id="9afd6-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>


[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="9afd6-186">Jak je znázorněno na obrázku 6, přidání tohoto `<siteMapNode>` element se odrazí v seznamu lekce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="9afd6-187">Vraťte se do `AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="9afd6-188">V ovládacím prvku obsahu pro `MainContent` ContentPlaceHolder, přidání ovládacího prvku DetailsView a pojmenujte ji `NewProduct`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="9afd6-189">Vytvoření vazby DetailsView do ovládacího prvku nové SqlDataSource s názvem `NewProductDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="9afd6-190">Jako s SqlDataSource v kroku 1, nakonfigurovat průvodce tak, aby používala databázi Northwind a zvolte zadat vlastní příkaz SQL.</span><span class="sxs-lookup"><span data-stu-id="9afd6-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="9afd6-191">Protože DetailsView se použije k přidávání položek do databáze, je potřeba zadat oba seznamy `SELECT` příkaz a `INSERT` příkaz.</span><span class="sxs-lookup"><span data-stu-id="9afd6-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="9afd6-192">Použijte následující `SELECT` dotazu:</span><span class="sxs-lookup"><span data-stu-id="9afd6-192">Use the following `SELECT` query:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="9afd6-193">Potom na kartě Vložení přidejte následující `INSERT` příkaz:</span><span class="sxs-lookup"><span data-stu-id="9afd6-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="9afd6-194">Po dokončení Průvodce přejít na ovládacím prvku DetailsView inteligentních značek a zaškrtnutím políčka "Povolit vložení".</span><span class="sxs-lookup"><span data-stu-id="9afd6-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="9afd6-195">Tento postup přidá CommandField do DetailsView s jeho `ShowInsertButton` vlastností nastavenou na hodnotu True.</span><span class="sxs-lookup"><span data-stu-id="9afd6-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="9afd6-196">Vzhledem k tomu tento DetailsView se použije výhradně pro vkládání dat, nastavit DetailsView `DefaultMode` vlastnost `Insert`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="9afd6-197">To je všechno je k němu!</span><span class="sxs-lookup"><span data-stu-id="9afd6-197">That's all there is to it!</span></span> <span data-ttu-id="9afd6-198">Tato stránka umožňuje otestovat.</span><span class="sxs-lookup"><span data-stu-id="9afd6-198">Let's test this page.</span></span> <span data-ttu-id="9afd6-199">Navštivte `AddProduct.aspx` prostřednictvím prohlížeče, zadejte název a cena (viz obrázek 6).</span><span class="sxs-lookup"><span data-stu-id="9afd6-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>


<span data-ttu-id="9afd6-200">[![Přidání nového produktu do databáze](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="9afd6-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="9afd6-201">**Obrázek 06**: Přidání nového produktu k databázi ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="9afd6-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>


<span data-ttu-id="9afd6-202">Po zadání názvu a ceny pro nového produktu, klikněte na tlačítko Vložit.</span><span class="sxs-lookup"><span data-stu-id="9afd6-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="9afd6-203">To způsobí, že formulář odeslat zpět.</span><span class="sxs-lookup"><span data-stu-id="9afd6-203">This causes the form to postback.</span></span> <span data-ttu-id="9afd6-204">Na zpětné volání, ovládacího prvku SqlDataSource na `INSERT` spustit příkaz; jeho dva parametry se naplní hodnot zadaných uživatelem v ovládacím prvku DetailsView dvou ovládacích prvků textového pole.</span><span class="sxs-lookup"><span data-stu-id="9afd6-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="9afd6-205">Bohužel neexistuje žádné visual zpětnou vazbu, která typu vložení došlo k chybě.</span><span class="sxs-lookup"><span data-stu-id="9afd6-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="9afd6-206">Je dobrý tak, aby měl zpráva, potvrzení, že byl přidán nový záznam.</span><span class="sxs-lookup"><span data-stu-id="9afd6-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="9afd6-207">Nechat to jako cvičení pro čtečku.</span><span class="sxs-lookup"><span data-stu-id="9afd6-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="9afd6-208">Také po přidání nového záznamu z DetailsView GridView na hlavní stránce se zobrazuje stejné pět záznamů jako před; neobsahuje právě přidat záznam.</span><span class="sxs-lookup"><span data-stu-id="9afd6-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="9afd6-209">Podíváme, jak chcete-li to opravit v nadcházející krocích.</span><span class="sxs-lookup"><span data-stu-id="9afd6-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="9afd6-210">Kromě přidání určitou formu visual zpětnou vazbu, která vložení proběhla úspěšně, I by doporučujeme, abyste také aktualizovat rozhraní vložení prvku DetailsView zahrnout ověření.</span><span class="sxs-lookup"><span data-stu-id="9afd6-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="9afd6-211">V současné době není k dispozici žádné ověření.</span><span class="sxs-lookup"><span data-stu-id="9afd6-211">Currently, there is no validation.</span></span> <span data-ttu-id="9afd6-212">Pokud uživatel zadá neplatnou hodnotu pro `UnitPrice` pole, například "příliš nákladné," na zpětné volání být vyvolána výjimka, když se systém pokusí tento řetězec převést na datový typ decimal.</span><span class="sxs-lookup"><span data-stu-id="9afd6-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="9afd6-213">Další informace o přizpůsobení vkládání rozhraní, použijte [ *přizpůsobení rozhraní pro úpravu dat* kurzu](https://asp.net/learn/data-access/tutorial-20-vb.aspx) z mé [práce s kurz datové řady](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="9afd6-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>


## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="9afd6-214">Krok 3: Vytvoření veřejné vlastnosti a metody na hlavní stránce</span><span class="sxs-lookup"><span data-stu-id="9afd6-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="9afd6-215">V kroku 1 jsme přidali ovládací prvek popisek Web s názvem `GridMessage` výše GridView na hlavní stránce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="9afd6-216">Tento popisek má volitelně zobrazit zprávu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="9afd6-217">Například po přidání nového záznamu do `Products` tabulky, může chceme zobrazit zprávu, která čte: "*ProductName* byla přidána do databáze."</span><span class="sxs-lookup"><span data-stu-id="9afd6-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="9afd6-218">Místo pevný kódu text pro tento popisek na hlavní stránce může chceme zpráva, která má být přizpůsobitelné podle obsahu stránky.</span><span class="sxs-lookup"><span data-stu-id="9afd6-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="9afd6-219">Protože ovládací prvek popisek je implementovaný jako chráněný členské proměnné na hlavní stránce nelze získat přístup přímo ze stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="9afd6-220">Za účelem práce s popisek v rámci stránky předlohy ze stránky obsahu (nebo k tomuto účelu, všechny ovládací prvek webu na hlavní stránce), je nutné vytvořit na hlavní stránce, který zveřejňuje ovládací prvek webu nebo slouží jako proxy server, ve které jedna z vlastností může být veřejná vlastnost  získat přístup.</span><span class="sxs-lookup"><span data-stu-id="9afd6-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="9afd6-221">Přidejte následující syntaxi do třídy kódu stránky předlohy vystavit jmenovky `Text` vlastnost:</span><span class="sxs-lookup"><span data-stu-id="9afd6-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="9afd6-222">Po přidání nového záznamu do `Products` tabulku ze stránky obsahu `RecentProducts` GridView na hlavní stránce rebind svůj základní zdroj dat je potřeba.</span><span class="sxs-lookup"><span data-stu-id="9afd6-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="9afd6-223">Se svázat volání GridView jeho `DataBind` metoda.</span><span class="sxs-lookup"><span data-stu-id="9afd6-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="9afd6-224">Vzhledem k tomu, že rutina GridView na hlavní stránce není přístupné prostřednictvím kódu programu na stránky obsahu, budeme muset vytvořit veřejnou metodu na hlavní stránce, která při volání, znovu připojí data k GridView.</span><span class="sxs-lookup"><span data-stu-id="9afd6-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="9afd6-225">Přidejte následující metodu do třídy stránky předlohy kódu:</span><span class="sxs-lookup"><span data-stu-id="9afd6-225">Add the following method to the master page's code-behind class:</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="9afd6-226">S `GridMessageText` vlastnost a `RefreshRecentProductsGrid` metodu, všechny stránky obsahu prostřednictvím kódu programu nastavit nebo načíst hodnotu `GridMessage` popisku `Text` vlastnost nebo rebind data, která mají `RecentProducts` GridView.</span><span class="sxs-lookup"><span data-stu-id="9afd6-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="9afd6-227">Krok 4 prověří jak získat přístup k hlavní stránce veřejné vlastnosti a metody ze stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="9afd6-228">Nezapomeňte označit vlastnosti a metody jako stránky předlohy `Public`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="9afd6-229">Pokud jste není označují explicitně tyto vlastnosti a metody jako `Public`, nebudou přístupné ze stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>


## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="9afd6-230">Krok 4: Volání veřejné členy stránky předlohy ze stránky obsahu</span><span class="sxs-lookup"><span data-stu-id="9afd6-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="9afd6-231">Nyní, když stránky předlohy nezbytné veřejné vlastnosti a metody, je připraven k vyvolání těchto vlastností a metod z `AddProduct.aspx` stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="9afd6-232">Konkrétně je potřeba nastavit stránku předlohy `GridMessageText` vlastnost a volání jeho `RefreshRecentProductsGrid` metoda po přidání nového produktu do databáze.</span><span class="sxs-lookup"><span data-stu-id="9afd6-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="9afd6-233">Všechna data webové ovládací prvky ASP.NET vyvolání události bezprostředně před a po dokončení různé úkoly, které usnadňují vývojáři stránek určitou akci programový před nebo po úlohu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="9afd6-234">Například pokud koncový uživatel klikne na tlačítko Vložit prvku DetailsView, na odeslat zpět vyvolá DetailsView jeho `ItemInserting` událostí před zahájením vkládání pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="9afd6-235">Potom vloží záznam do databáze.</span><span class="sxs-lookup"><span data-stu-id="9afd6-235">It then inserts the record into the database.</span></span> <span data-ttu-id="9afd6-236">Následující, vyvolá DetailsView jeho `ItemInserted` událostí.</span><span class="sxs-lookup"><span data-stu-id="9afd6-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="9afd6-237">Proto, aby pracovaly se stránkou předlohy po přidání nového produktu, vytvoření obslužné rutiny události pro prvku DetailsView `ItemInserted` událostí.</span><span class="sxs-lookup"><span data-stu-id="9afd6-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="9afd6-238">Existují dva způsoby, které stránky obsahu můžete programově rozhraní s jeho hlavní stránky:</span><span class="sxs-lookup"><span data-stu-id="9afd6-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="9afd6-239">Pomocí `Page.Master` vlastnost, která vrací volného typu odkaz na hlavní stránce, nebo</span><span class="sxs-lookup"><span data-stu-id="9afd6-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="9afd6-240">Zadejte cestu nebo typu souboru stránky předlohy stránky prostřednictvím `@MasterType` direktivy; to automaticky přidá vlastnost silného typu na stránku s názvem `Master`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="9afd6-241">Podívejme se na obou přístupů.</span><span class="sxs-lookup"><span data-stu-id="9afd6-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="9afd6-242">Pomocí volného typu`Page.Master`vlastnost</span><span class="sxs-lookup"><span data-stu-id="9afd6-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="9afd6-243">Všechny webové stránky ASP.NET musí být odvozeny od `Page` třídy, která se nachází v `System.Web.UI` oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="9afd6-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="9afd6-244">`Page` Obsahuje třídy [ `Master` vlastnost](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) , vrátí odkaz na hlavní stránky.</span><span class="sxs-lookup"><span data-stu-id="9afd6-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="9afd6-245">Pokud stránky nemá na hlavní stránce `Master` vrátí `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="9afd6-246">`Master` Vlastnost vrací objekt typu [ `MasterPage` ](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (také umístěný v `System.Web.UI` oboru názvů) což je základní typ, ze kterého všechny hlavní stránky odvozen z.</span><span class="sxs-lookup"><span data-stu-id="9afd6-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="9afd6-247">Proto pro použití veřejné vlastnosti nebo metody definované v našem webu stránky předlohy jsme musíte vysílat `MasterPage` objekt vrácený `Master` vlastnost příslušného typu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="9afd6-248">Protože jsme pojmenovali naše soubor předlohové stránky `Site.master`, se s názvem třídy kódu `Site`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="9afd6-249">Proto následující kód přetypování `Page.Master` vlastnost, která má instance `Site` třídy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="9afd6-250">Teď, když máme převedena volného typu `Page.Master` vlastnost typu lokality jsme odkazovat vlastnosti a metody, které jsou specifické pro lokalitu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="9afd6-251">Jak je vidět na obrázku 7, veřejné vlastnosti `GridMessageText` se zobrazí v rozevírací IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="9afd6-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>


<span data-ttu-id="9afd6-252">[![IntelliSense zobrazí veřejné vlastnosti a metody naše stránky předlohy](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="9afd6-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="9afd6-253">**Obrázek 07**: IntelliSense zobrazí veřejné vlastnosti a metody naše stránky předlohy ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="9afd6-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>


> [!NOTE]
> <span data-ttu-id="9afd6-254">Pokud název souboru hlavní stránky `MasterPage.master` je název třídy kódu stránky předlohy `MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="9afd6-255">To může vést k nejednoznačný kód při přetypování z typu `System.Web.UI.MasterPage` k vaší `MasterPage` třídy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="9afd6-256">Stručně řečeno budete muset plně kvalifikaci typu, které jsou přetypování, což může být poněkud složité, při použití modelu webový projekt.</span><span class="sxs-lookup"><span data-stu-id="9afd6-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="9afd6-257">Můj návrh může být buď se ujistěte, že při vytváření stránky předlohy ji pojmenujete jiné než `MasterPage.master` nebo i lepší vytvořit odkaz silného typu k hlavní stránce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>


### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="9afd6-258">Vytváření silného typu odkaz s`@MasterType`– direktiva</span><span class="sxs-lookup"><span data-stu-id="9afd6-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="9afd6-259">Pokud najít úzce uvidíte, třída kódu stránky ASP.NET je konkrétní třídu (Poznámka: `Partial` – klíčové slovo v definici třídy).</span><span class="sxs-lookup"><span data-stu-id="9afd6-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="9afd6-260">Částečné třídy byly zavedeny v C# a Visual Basic with.NET Framework 2.0 a stručně řečeno, povolit pro členy třídy a definovat v rámci více souborů.</span><span class="sxs-lookup"><span data-stu-id="9afd6-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="9afd6-261">Třída souboru kódu na pozadí - `AddProduct.aspx.vb`, například – obsahuje kód, který jsme vývojář stránky vytvořit.</span><span class="sxs-lookup"><span data-stu-id="9afd6-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="9afd6-262">Kromě kódu modul ASP.NET s vlastnostmi automaticky vytvoří soubor samostatné třídy a obslužné rutiny událostí v tom, že převede deklarativní na stránky hierarchii tříd.</span><span class="sxs-lookup"><span data-stu-id="9afd6-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="9afd6-263">Automatické vytváření kódu, k níž dojde vždy, když je navštívené stránky ASP.NET dláždí některé možnosti místo zajímavé a užitečné.</span><span class="sxs-lookup"><span data-stu-id="9afd6-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="9afd6-264">V případě hlavní stránky, pokud nám říct modulu ASP.NET, jaké stránky předlohy je stále používán naší obsahu stránce generuje silného typu `Master` vlastnost pro nás.</span><span class="sxs-lookup"><span data-stu-id="9afd6-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="9afd6-265">Použití [ `@MasterType` – direktiva](https://msdn.microsoft.com/library/ms228274.aspx) k informování modul ASP.NET typu obsahu stránce stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="9afd6-266">`@MasterType` – Direktiva může přijmout, buď název typu stránky předlohy nebo jeho cesta k souboru.</span><span class="sxs-lookup"><span data-stu-id="9afd6-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="9afd6-267">Chcete-li určit, že `AddProduct.aspx` stránka používá `Site.master` jako jeho stránku předlohy, přidejte následující direktivu na začátek `AddProduct.aspx`:</span><span class="sxs-lookup"><span data-stu-id="9afd6-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>


[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="9afd6-268">Tato direktiva dá pokyn modulu ASP.NET pro přidání odkazu na silného typu k hlavní stránce prostřednictvím vlastnost s názvem `Master`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="9afd6-269">S `@MasterType` direktivy na místě, můžete říkáme `Site.master` hlavní stránky veřejné vlastnosti a metody, které jsou přímo pomocí `Master` vlastnost bez žádné přetypování.</span><span class="sxs-lookup"><span data-stu-id="9afd6-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="9afd6-270">V případě vynechání `@MasterType` – direktiva, syntaxe `Page.Master` a `Master` vrátit samé: objekt na hlavní stránky a volného typu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="9afd6-271">Pokud zahrnete `@MasterType` – direktiva pak `Master` vrátí silného typu odkaz na zadaný stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="9afd6-272">`Page.Master`, ale stále vrátí volného typu odkaz.</span><span class="sxs-lookup"><span data-stu-id="9afd6-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="9afd6-273">Pro podrobnější pohled na důvod, proč je tomu a jak `Master` vlastnost je vytvořený při `@MasterType` – direktiva je zahrnuté naleznete [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)na položce blogu [ `@MasterType` v technologii ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span><span class="sxs-lookup"><span data-stu-id="9afd6-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>


### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="9afd6-274">Aktualizaci stránky předlohy po přidání nového produktu</span><span class="sxs-lookup"><span data-stu-id="9afd6-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="9afd6-275">Teď, když budeme vědět, jak má být vyvolán veřejné vlastnosti a metody ze stránky obsahu stránky předlohy, je připraven k aktualizaci `AddProduct.aspx` stránky tak, aby stránky předlohy se aktualizují po přidání nového produktu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="9afd6-276">Na začátku kroku 4 jsme vytvořili obslužné rutiny události pro ovládací prvek DetailsView `ItemInserting` událost, která spustí ihned po nového produktu se přidal do databáze.</span><span class="sxs-lookup"><span data-stu-id="9afd6-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="9afd6-277">Přidejte následující kód do této obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="9afd6-277">Add the following code to that event handler:</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="9afd6-278">Výše uvedený kód používá, i volného typu `Page.Master` vlastnosti a silného typu `Master` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="9afd6-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="9afd6-279">Všimněte si, že `GridMessageText` je nastavena na "*ProductName* přidat k mřížce..." Produkt právě přidané hodnoty jsou k dispozici prostřednictvím `e.Values` kolekce; jak můžete vidět, právě přidané `ProductName` hodnotu přistupuje prostřednictvím `e.Values("ProductName")`.</span><span class="sxs-lookup"><span data-stu-id="9afd6-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="9afd6-280">Obrázek 8 ukazuje `AddProduct.aspx` stránka ihned po novém produktu - Scott na Soda - byla přidána do databáze.</span><span class="sxs-lookup"><span data-stu-id="9afd6-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="9afd6-281">Všimněte si, že je název právě přidané produktu uvedených v popisku stránky předlohy a že GridView aktualizaci produktu a jeho cenu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>


<span data-ttu-id="9afd6-282">[![Popisek a zobrazit GridView produktu právě přidané stránky předlohy](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="9afd6-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="9afd6-283">**Obrázek 08**: popisek hlavní stránky a GridView zobrazit Just-Added produktu ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="9afd6-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>


## <a name="summary"></a><span data-ttu-id="9afd6-284">Souhrn</span><span class="sxs-lookup"><span data-stu-id="9afd6-284">Summary</span></span>

<span data-ttu-id="9afd6-285">V ideálním případě stránky předlohy a stránky jeho obsahu jsou zcela oddělené od sebe navzájem a nevyžadují žádné úrovně interakce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="9afd6-286">Při hlavní stránky a stránky obsahu by se měly navrhovat s Pamatujte, že cílem, existuje několik běžných scénářů, ve kterých musí obsahu stránce rozhraní s jeho stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="9afd6-287">Jedním z nejčastějších důvodů soustředí kolem aktualizace konkrétní části stránku předlohy pro zobrazení na základě některé akce, který, k čemu na stránce obsahu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="9afd6-288">Dobrá zpráva je, že je relativně jednoduché tak, aby měl stránky obsahu prostřednictvím kódu programu interakci s jeho stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="9afd6-289">Začněte vytvořením veřejné vlastnosti nebo metody na hlavní stránce zapouzdřující funkce, které je potřeba vyvolat stránku obsahu.</span><span class="sxs-lookup"><span data-stu-id="9afd6-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="9afd6-290">Pak na stránce obsahu přístup k hlavní stránce vlastnosti a metody prostřednictvím volného typu `Page.Master` vlastnost nebo použijte `@MasterType` – direktiva k vytvoření odkazu silného typu k hlavní stránce.</span><span class="sxs-lookup"><span data-stu-id="9afd6-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="9afd6-291">V dalším kurzu jsme zkontrolujte jak vám má prostřednictvím kódu programu interakci s jedním z jeho stránky obsahu stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="9afd6-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="9afd6-292">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="9afd6-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="9afd6-293">Další čtení</span><span class="sxs-lookup"><span data-stu-id="9afd6-293">Further Reading</span></span>

<span data-ttu-id="9afd6-294">Další informace o tématech popsané v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="9afd6-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="9afd6-295">Přístup k informacím a aktualizace dat v technologii ASP.NET</span><span class="sxs-lookup"><span data-stu-id="9afd6-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="9afd6-296">ASP.NET hlavní stránky: Tipy, triky a depeše</span><span class="sxs-lookup"><span data-stu-id="9afd6-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="9afd6-297">`@MasterType` v technologii ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="9afd6-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="9afd6-298">Předávání informací mezi obsah a stránky předlohy</span><span class="sxs-lookup"><span data-stu-id="9afd6-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="9afd6-299">Práce s daty v kurzech ASP.NET</span><span class="sxs-lookup"><span data-stu-id="9afd6-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="9afd6-300">O autorovi</span><span class="sxs-lookup"><span data-stu-id="9afd6-300">About the Author</span></span>

<span data-ttu-id="9afd6-301">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor více knih ASP/ASP.NET a zakladatele 4GuysFromRolla.com, pracuje s technologií Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="9afd6-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9afd6-302">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="9afd6-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9afd6-303">Jeho nejnovější seznam k [ *Edice nakladatelství Sams naučit sami technologie ASP.NET 3.5 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="9afd6-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="9afd6-304">Scott lze dosáhnout za [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu v [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="9afd6-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="9afd6-305">Zvláštní poděkování</span><span class="sxs-lookup"><span data-stu-id="9afd6-305">Special Thanks To</span></span>

<span data-ttu-id="9afd6-306">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="9afd6-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9afd6-307">Vést kontrolorem pro tento kurz byl Zack Petr.</span><span class="sxs-lookup"><span data-stu-id="9afd6-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="9afd6-308">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="9afd6-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9afd6-309">Pokud ano, vyřaďte mi řádek v [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9afd6-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9afd6-310">[Předchozí](control-id-naming-in-content-pages-vb.md)
> [další](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="9afd6-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>
