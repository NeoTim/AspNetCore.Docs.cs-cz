---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-content-page-from-the-master-page-cs
title: "Interakci s stránky obsahu ze stránky předlohy (C#) | Microsoft Docs"
author: rick-anderson
description: "Prozkoumá tom, jak volat metody, nastavte vlastnosti atd stránky obsahu z kódu na hlavní stránce."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/11/2008
ms.topic: article
ms.assetid: 3282df5e-516c-4972-8666-313828b90fb5
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-content-page-from-the-master-page-cs
msc.type: authoredcontent
ms.openlocfilehash: 4d7f6eeac084f3516ab470adf8973351cf08a7f1
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2018
---
<a name="interacting-with-the-content-page-from-the-master-page-c"></a><span data-ttu-id="a5ca5-103">Interakci s stránky obsahu ze stránky předlohy (C#)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-103">Interacting with the Content Page from the Master Page (C#)</span></span>
====================
<span data-ttu-id="a5ca5-104">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a5ca5-105">[Stáhněte si kód](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_07_CS.zip) nebo [stáhnout PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_07_CS.pdf)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_07_CS.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_07_CS.pdf)</span></span>

> <span data-ttu-id="a5ca5-106">Prozkoumá tom, jak volat metody, nastavte vlastnosti atd stránky obsahu z kódu na hlavní stránce.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-106">Examines how to call methods, set properties, etc. of the Content Page from code in the Master Page.</span></span>


## <a name="introduction"></a><span data-ttu-id="a5ca5-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="a5ca5-107">Introduction</span></span>

<span data-ttu-id="a5ca5-108">Předchozí kurzu zkoumat jak vám má stránky obsahu prostřednictvím kódu programu interakci s jeho stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-108">The preceding tutorial examined how to have the content page programmatically interact with its master page.</span></span> <span data-ttu-id="a5ca5-109">Odvolání, že byl aktualizován stránky předlohy GridView ovládací prvek, který pět uveden naposledy přidat produkty.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-109">Recall that we updated the master page to include a GridView control that listed the five most recently added products.</span></span> <span data-ttu-id="a5ca5-110">Potom jsme vytvořili obsahu stránce, ze kterého uživatel může přidávat nového produktu.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-110">We then created a content page from which the user could add a new product.</span></span> <span data-ttu-id="a5ca5-111">Při přidání nového produktu, stránky obsahu potřeba dáte pokyn, aby stránka předlohy a aktualizujte jeho GridView tak, aby ho by mělo zahrnovat právě přidané produktu.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-111">Upon adding a new product, the content page needed to instruct the master page to refresh its GridView so that it would include the just-added product.</span></span> <span data-ttu-id="a5ca5-112">Tato funkce byla provést přidáním veřejnou metodu k hlavní stránce že aktualizovat data vázána na GridView, a pak volání této metody ze stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-112">This functionality was accomplished by adding a public method to the master page that refreshed the data bound to the GridView, and then invoking that method from the content page.</span></span>

<span data-ttu-id="a5ca5-113">Nejběžnější formu obsahu a interakce stránky předlohy pochází ze stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-113">The most common form of content and master page interaction originates from the content page.</span></span> <span data-ttu-id="a5ca5-114">Nicméně je možné stránky předlohy pro rouse aktuální stránky obsahu do akce a takové funkce může být potřeba, pokud stránka předlohy obsahuje prvky uživatelského rozhraní, které umožňují uživatelům měnit data, která se také zobrazí na stránce obsahu.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-114">However, it is possible for the master page to rouse the current content page into action, and such functionality may be needed if the master page contains user interface elements that enable users to modify data that is also displayed on the content page.</span></span> <span data-ttu-id="a5ca5-115">Vezměte v úvahu stránky obsahu, zobrazí informace o produkty v GridView řízení a hlavní stránky, který obsahuje tlačítko řídit, která při kliknutí na, zdvojnásobí ceny všech produktů.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-115">Consider a content page that displays the products information in a GridView control and a master page that includes a Button control that, when clicked, doubles the prices of all products.</span></span> <span data-ttu-id="a5ca5-116">Podobně jako v příkladu v tomto kurzu předchozí GridView musí aktualizovat po dvojité cenu, kterou tak, aby zobrazila nové ceny po kliknutí na tlačítko, ale v tomto scénáři je vyžadující rouse stránky obsahu do akce stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-116">Much like the example in the preceding tutorial, the GridView needs to be refreshed after the double price Button is clicked so that it displays the new prices, but in this scenario it's the master page that needs to rouse the content page into action.</span></span>

<span data-ttu-id="a5ca5-117">Tento tento kurz popisuje, jak vám má vyvolání funkce je definována v stránky obsahu stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-117">This tutorial explores how to have the master page invoke functionality defined in the content page.</span></span>

### <a name="instigating-programmatic-interaction-via-an-event-and-event-handlers"></a><span data-ttu-id="a5ca5-118">Pokus programové interakce prostřednictvím událost a obslužné rutiny událostí</span><span class="sxs-lookup"><span data-stu-id="a5ca5-118">Instigating Programmatic Interaction via an Event and Event Handlers</span></span>

<span data-ttu-id="a5ca5-119">Vyvolání funkce stránky obsahu ze stránky předlohy je další náročné než opačným způsobem.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-119">Invoking content page functionality from a master page is more challenging than the other way around.</span></span> <span data-ttu-id="a5ca5-120">Protože obsahu stránce má jednu stránku předlohy, když pokus programové interakci ze stránky obsahu víme veřejné metody a vlastnosti jsou naše k dispozici.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-120">Because a content page has a single master page, when instigating the programmatic interaction from the content page we know what public methods and properties are at our disposal.</span></span> <span data-ttu-id="a5ca5-121">Na hlavní stránce, ale může mít mnoho různých obsahu stránky, každou s vlastní sadu vlastností a metod.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-121">A master page, however, can have many different content pages, each with its own set of properties and methods.</span></span> <span data-ttu-id="a5ca5-122">Jak potom můžete jsme psát kód na hlavní stránce provádět některé akce na stránce s jejím obsahu, když nevíme, jaké stránky obsahu, který bude vyvolán dokud runtime?</span><span class="sxs-lookup"><span data-stu-id="a5ca5-122">How, then, can we write code in the master page to perform some action in its content page when we don't know what content page will be invoked until runtime?</span></span>

<span data-ttu-id="a5ca5-123">Vezměte v úvahu ovládací prvek ASP.NET Web, jako je například ovládacího prvku tlačítko.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-123">Consider an ASP.NET Web control, such as the Button control.</span></span> <span data-ttu-id="a5ca5-124">Ovládací prvek tlačítko se objeví na libovolný počet stránek ASP.NET a potřebuje mechanismus, pomocí kterého ho může upozornit, stránky, aby bylo stisknuto.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-124">A Button control can appear on any number of ASP.NET pages and needs a mechanism by which it can alert the page that it has been clicked.</span></span> <span data-ttu-id="a5ca5-125">Toho dosahuje pomocí *události*.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-125">This is accomplished using *events*.</span></span> <span data-ttu-id="a5ca5-126">Konkrétně ovládacího prvku tlačítko vyvolá jeho `Click` událostí po klepnutí; stránky ASP.NET, která obsahuje tlačítko můžete volitelně reagovat na tomto oznámení prostřednictvím *obslužné rutiny události*.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-126">In particular, the Button control raises its `Click` event when it is clicked; the ASP.NET page that contains the Button can optionally respond to that notification via an *event handler*.</span></span>

<span data-ttu-id="a5ca5-127">Tento stejný vzor umožňuje mít je aktivační událost funkce stránky předlohy v jeho obsahu stránky:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-127">This same pattern can be used to have a master page trigger functionality in its content pages:</span></span>

1. <span data-ttu-id="a5ca5-128">Přidání události k hlavní stránce.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-128">Add an event to the master page.</span></span>
2. <span data-ttu-id="a5ca5-129">Vyvolejte událost vždy, když je komunikovat s jeho stránky obsahu stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-129">Raise the event whenever the master page needs to communicate with its content page.</span></span> <span data-ttu-id="a5ca5-130">Například pokud stránky předlohy potřebuje obsahu stránce s jejím upozornění, že uživatel má se používají tyto ceny, jeho události by vydána ihned po ceny byl se používají.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-130">For example, if the master page needs to alert its content page that the user has doubled the prices, its event would be raised immediately after the prices have been doubled.</span></span>
3. <span data-ttu-id="a5ca5-131">Vytvoření obslužné rutiny události v těchto obsahu stránek, které vyžadují určitou akci.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-131">Create an event handler in those content pages that need to take some action.</span></span>

<span data-ttu-id="a5ca5-132">Tento zbývající část tohoto kurzu implementuje uvedené v úvodu; stránky obsahu, která jsou uvedeny produkty, v databázi a hlavní stránky, který obsahuje tlačítko konkrétně, řídit poklikejte ceny.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-132">This remainder of this tutorial implements the example outlined in the Introduction; namely, a content page that lists the products in the database and a master page that includes a Button control to double the prices.</span></span>

## <a name="step-1-displaying-products-in-a-content-page"></a><span data-ttu-id="a5ca5-133">Krok 1: Zobrazení produkty obsahu stránce</span><span class="sxs-lookup"><span data-stu-id="a5ca5-133">Step 1: Displaying Products in a Content Page</span></span>

<span data-ttu-id="a5ca5-134">Naše první of obchodní pořadí je vytvoření stránky obsahu, která jsou uvedeny produkty z databáze Northwind.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-134">Our first order of business is to create a content page that lists the products from the Northwind database.</span></span> <span data-ttu-id="a5ca5-135">(Databázi Northwind do projektu jsme přidali v předchozím kurzu [ *interakci se stránkou předlohy ze stránky obsahu*](interacting-with-the-master-page-from-the-content-page-cs.md).) Začněte přidáním nové stránky ASP.NET do `~/Admin` složku s názvem `Products.aspx`, které opravdu pro vytvoření vazby na `Site.master` stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-135">(We added the Northwind database to the project in the preceding tutorial, [*Interacting with the Master Page from the Content Page*](interacting-with-the-master-page-from-the-content-page-cs.md).) Start by adding a new ASP.NET page to the `~/Admin` folder named `Products.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="a5ca5-136">Obrázek 1 zobrazuje Průzkumník řešení po přidání této stránky na web.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-136">Figure 1 shows the Solution Explorer after this page has been added to the website.</span></span>


<span data-ttu-id="a5ca5-137">[![Přidat novou stránku ASP.NET ke složce Admin](interacting-with-the-content-page-from-the-master-page-cs/_static/image2.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-137">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-content-page-from-the-master-page-cs/_static/image2.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image1.png)</span></span>

<span data-ttu-id="a5ca5-138">**Obrázek 01**: Přidat novou stránku ASP.NET do `Admin` složky ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="a5ca5-138">**Figure 01**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image3.png))</span></span>


<span data-ttu-id="a5ca5-139">Odvolat, že [ *zadáte název, značky Meta a ostatní hlavičky HTML na hlavní stránce* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) kurzu jsme vytvořili vlastní základní stránky třídy s názvem `BasePage` který generuje nadpis stránky, pokud není explicitně nastaven.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-139">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) tutorial we created a custom base page class named `BasePage` that generates the page's title if it is not explicitly set.</span></span> <span data-ttu-id="a5ca5-140">Přejděte na `Products.aspx` kódu stránky třídy a ji odvodit z `BasePage` (místo z `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="a5ca5-140">Go to the `Products.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="a5ca5-141">Nakonec aktualizujte `Web.sitemap` souboru záznam pro tento účel.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-141">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="a5ca5-142">Přidejte následující kód pod `<siteMapNode>` pro obsah na hlavní stránce interakce lekce:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-142">Add the following markup beneath the `<siteMapNode>` for the Content to Master Page Interaction lesson:</span></span>


[!code-xml[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample1.xml)]

<span data-ttu-id="a5ca5-143">Přidání tohoto `<siteMapNode>` element se odrazí v poznatky seznamu (viz obrázek 5).</span><span class="sxs-lookup"><span data-stu-id="a5ca5-143">The addition of this `<siteMapNode>` element is reflected in the Lessons list (see Figure 5).</span></span>

<span data-ttu-id="a5ca5-144">Vraťte se do `Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-144">Return to `Products.aspx`.</span></span> <span data-ttu-id="a5ca5-145">V ovládacím prvku obsahu pro `MainContent`, přidání ovládacího prvku GridView a pojmenujte ji `ProductsGrid`.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-145">In the Content control for `MainContent`, add a GridView control and name it `ProductsGrid`.</span></span> <span data-ttu-id="a5ca5-146">Vytvoření vazby GridView do ovládacího prvku nové SqlDataSource s názvem `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-146">Bind the GridView to a new SqlDataSource control named `ProductsDataSource`.</span></span>


<span data-ttu-id="a5ca5-147">[![Vytvoření vazby GridView do ovládacího prvku nové SqlDataSource](interacting-with-the-content-page-from-the-master-page-cs/_static/image5.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-147">[![Bind the GridView to a New SqlDataSource Control](interacting-with-the-content-page-from-the-master-page-cs/_static/image5.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image4.png)</span></span>

<span data-ttu-id="a5ca5-148">**Obrázek 02**: vazby GridView do ovládacího prvku nové SqlDataSource ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a5ca5-148">**Figure 02**: Bind the GridView to a New SqlDataSource Control  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image6.png))</span></span>


<span data-ttu-id="a5ca5-149">Nakonfigurujte průvodce tak, aby používala databázi Northwind.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-149">Configure the wizard so that it uses the Northwind database.</span></span> <span data-ttu-id="a5ca5-150">Pokud jste pracovali prostřednictvím předchozí kurz, pak byste již měli mít připojovací řetězec s názvem `NorthwindConnectionString` v `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-150">If you worked through the previous tutorial then you should already have a connection string named `NorthwindConnectionString` in `Web.config`.</span></span> <span data-ttu-id="a5ca5-151">V rozevíracím seznamu vyberte tento připojovací řetězec, jak je znázorněno na obrázku 3.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-151">Choose this connection string from the drop-down list, as shown in Figure 3.</span></span>


<span data-ttu-id="a5ca5-152">[![Konfigurace SqlDataSource k použití databáze Northwind](interacting-with-the-content-page-from-the-master-page-cs/_static/image8.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-152">[![Configure the SqlDataSource to Use the Northwind Database](interacting-with-the-content-page-from-the-master-page-cs/_static/image8.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image7.png)</span></span>

<span data-ttu-id="a5ca5-153">**Obrázek 03**: Konfigurace SqlDataSource chcete použít databázi Northwind ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="a5ca5-153">**Figure 03**: Configure the SqlDataSource to Use the Northwind Database  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image9.png))</span></span>


<span data-ttu-id="a5ca5-154">Potom zadejte ovládacího prvku zdroje dat `SELECT` příkaz zvolením tabulky produktů z rozevíracího seznamu a vrací `ProductName` a `UnitPrice` sloupce (viz obrázek 4).</span><span class="sxs-lookup"><span data-stu-id="a5ca5-154">Next, specify the data source control's `SELECT` statement by choosing the Products table from the drop-down list and returning the `ProductName` and `UnitPrice` columns (see Figure 4).</span></span> <span data-ttu-id="a5ca5-155">Klikněte na tlačítko Další a pak dokončete průvodce Konfigurace zdroje dat dokončit.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-155">Click Next and then Finish to complete the Configure Data Source wizard.</span></span>


<span data-ttu-id="a5ca5-156">[![Vrátí pole UnitPrice a ProductName z tabulky produktů](interacting-with-the-content-page-from-the-master-page-cs/_static/image11.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-156">[![Return the ProductName and UnitPrice Fields from the Products Table](interacting-with-the-content-page-from-the-master-page-cs/_static/image11.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image10.png)</span></span>

<span data-ttu-id="a5ca5-157">**Obrázek 04**: vrátit `ProductName` a `UnitPrice` pole z `Products` tabulky ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a5ca5-157">**Figure 04**: Return the `ProductName` and `UnitPrice` Fields from the `Products` Table  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image12.png))</span></span>


<span data-ttu-id="a5ca5-158">To je všechno je k němu!</span><span class="sxs-lookup"><span data-stu-id="a5ca5-158">That's all there is to it!</span></span> <span data-ttu-id="a5ca5-159">Visual Studio po dokončení průvodce přidá dva BoundFields GridView pro dvě pole vrácené ovládacího prvku SqlDataSource zrcadlení.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-159">After completing the wizard Visual Studio adds two BoundFields to the GridView to mirror the two fields returned by the SqlDataSource control.</span></span> <span data-ttu-id="a5ca5-160">Rutina GridView a SqlDataSource prvky značek následuje.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-160">The GridView and SqlDataSource controls' markup follows.</span></span> <span data-ttu-id="a5ca5-161">Obrázek 5 ukazuje výsledky při zobrazení prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-161">Figure 5 shows the results when viewed through a browser.</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample2.aspx)]


<span data-ttu-id="a5ca5-162">[![Každý produkt a jeho cena je uvedena v prvku GridView.](interacting-with-the-content-page-from-the-master-page-cs/_static/image14.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-162">[![Each Product and its Price is Listed in the GridView](interacting-with-the-content-page-from-the-master-page-cs/_static/image14.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image13.png)</span></span>

<span data-ttu-id="a5ca5-163">**Obrázek 05**: každý produkt a jeho cena je uvedena v prvku GridView ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="a5ca5-163">**Figure 05**: Each Product and its Price is Listed in the GridView  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a5ca5-164">Nebojte se, že vyčištění vzhled GridView.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-164">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="a5ca5-165">Některé návrhy patří formátování zobrazená hodnota UnitPrice jako měny a používání písma a barvy pozadí k vylepšení vzhledu mřížky.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-165">Some suggestions include formatting the displayed UnitPrice value as a currency and using background colors and fonts to improve the grid's appearance.</span></span> <span data-ttu-id="a5ca5-166">Další informace o zobrazení a formátování dat v technologii ASP.NET, najdete v části Moje [práce s kurz datové řady](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="a5ca5-166">For more information on displaying and formatting data in ASP.NET, refer to my [Working with Data tutorial series](../../data-access/index.md).</span></span>


## <a name="step-2-adding-a-double-prices-button-to-the-master-page"></a><span data-ttu-id="a5ca5-167">Krok 2: Přidání tlačítka dvojitý ceny na hlavní stránku</span><span class="sxs-lookup"><span data-stu-id="a5ca5-167">Step 2: Adding a Double Prices Button to the Master Page</span></span>

<span data-ttu-id="a5ca5-168">Naše dalším krokem je přidání ovládacího prvku tlačítko webové k hlavní stránky, která po kliknutí na bude double cenu všechny produkty v databázi.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-168">Our next task is to add a Button Web control to the master page that, when clicked, will double the price of all products in the database.</span></span> <span data-ttu-id="a5ca5-169">Otevřete `Site.master` hlavní stránky a přetáhněte ji na tlačítko z panelu nástrojů na návrháře pod jeho umístění `RecentProductsDataSource` prvek SqlDataSource jsme přidali v předchozím kurzu.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-169">Open the `Site.master` master page and drag a Button from the Toolbox onto the Designer, placing it beneath the `RecentProductsDataSource` SqlDataSource control we added in the previous tutorial.</span></span> <span data-ttu-id="a5ca5-170">Nastavte na tlačítko `ID` vlastnost `DoublePrice` a jeho `Text` vlastnost "Dvojité ceny produktů".</span><span class="sxs-lookup"><span data-stu-id="a5ca5-170">Set the Button's `ID` property to `DoublePrice` and its `Text` property to "Double Product Prices".</span></span>

<span data-ttu-id="a5ca5-171">Dál přidejte ovládacího prvku SqlDataSource na hlavní stránku pojmenování ho `DoublePricesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-171">Next, add a SqlDataSource control to the master page, naming it `DoublePricesDataSource`.</span></span> <span data-ttu-id="a5ca5-172">Tato SqlDataSource se použít ke spuštění `UPDATE` příkaz zdvojnásobit všechny ceny.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-172">This SqlDataSource will be used to execute the `UPDATE` statement to double all prices.</span></span> <span data-ttu-id="a5ca5-173">Konkrétně je potřeba nastavit jeho `ConnectionString` a `UpdateCommand` vlastnosti odpovídající připojovací řetězec a `UPDATE` příkaz.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-173">Specifically, we need to set its `ConnectionString` and `UpdateCommand` properties to the appropriate connection string and `UPDATE` statement.</span></span> <span data-ttu-id="a5ca5-174">Pak je potřeba volat tento ovládací prvek SqlDataSource `Update` metoda při `DoublePrice` po kliknutí na tlačítko.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-174">Then we need to call this SqlDataSource control's `Update` method when the `DoublePrice` Button is clicked.</span></span> <span data-ttu-id="a5ca5-175">Chcete-li nastavit `ConnectionString` a `UpdateCommand` vlastnosti, vyberte ovládací prvek SqlDataSource a potom přejděte do okna vlastností.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-175">To set the `ConnectionString` and `UpdateCommand` properties, select the SqlDataSource control and then go to the Properties window.</span></span> <span data-ttu-id="a5ca5-176">`ConnectionString` Těchto připojovací řetězce, který je už uložený v seznamech vlastností `Web.config` v rozevíracím seznamu; zvolte `NorthwindConnectionString` možnost, jak je znázorněno na obrázku 6.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-176">The `ConnectionString` property lists those connection strings already stored in `Web.config` in a drop-down list; choose the `NorthwindConnectionString` option as shown in Figure 6.</span></span>


<span data-ttu-id="a5ca5-177">[![Konfigurace SqlDataSource používat NorthwindConnectionString](interacting-with-the-content-page-from-the-master-page-cs/_static/image17.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-177">[![Configure the SqlDataSource to Use the NorthwindConnectionString](interacting-with-the-content-page-from-the-master-page-cs/_static/image17.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image16.png)</span></span>

<span data-ttu-id="a5ca5-178">**Obrázek 06**: Konfigurace SqlDataSource pro použití `NorthwindConnectionString` ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a5ca5-178">**Figure 06**: Configure the SqlDataSource to Use the `NorthwindConnectionString` ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image18.png))</span></span>


<span data-ttu-id="a5ca5-179">Chcete-li nastavit `UpdateCommand` vlastnost, vyhledejte možnost UpdateQuery v okně Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-179">To set the `UpdateCommand` property, locate the UpdateQuery option in the Properties window.</span></span> <span data-ttu-id="a5ca5-180">Tato vlastnost, pokud vybraná, zobrazí tlačítko se třemi tečkami; Kliknutím na toto tlačítko zobrazit dialogové okno Editor kolekce parametrů vidět na obrázku 7.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-180">This property, when selected, displays a button with ellipses; click this button to display the Command and Parameter Editor dialog box shown in Figure 7.</span></span> <span data-ttu-id="a5ca5-181">Zadejte následující příkaz `UPDATE` příkaz do textového pole dialogových oken:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-181">Type the following `UPDATE` statement into the dialog box's textbox:</span></span>


[!code-sql[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample3.sql)]

<span data-ttu-id="a5ca5-182">Tento příkaz při spuštění, bude dvakrát `UnitPrice` hodnotu pro každý záznam v `Products` tabulky.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-182">This statement, when executed, will double the `UnitPrice` value for each record in the `Products` table.</span></span>


<span data-ttu-id="a5ca5-183">[![Nastavte vlastnost UpdateCommand SqlDataSource společnosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image20.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-183">[![Set SqlDataSource's UpdateCommand Property](interacting-with-the-content-page-from-the-master-page-cs/_static/image20.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image19.png)</span></span>

<span data-ttu-id="a5ca5-184">**Obrázek 07**: nastavte SqlDataSource `UpdateCommand` vlastnost ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="a5ca5-184">**Figure 07**: Set SqlDataSource's `UpdateCommand` Property  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image21.png))</span></span>


<span data-ttu-id="a5ca5-185">Po nastavení těchto vlastností, deklarativní vaší a SqlDataSource ovládacích prvků by měl vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-185">After setting these properties, your Button and SqlDataSource controls' declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample4.aspx)]

<span data-ttu-id="a5ca5-186">Zbývá volat jeho `Update` metoda při `DoublePrice` po kliknutí na tlačítko.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-186">All that remains is to call its `Update` method when the `DoublePrice` Button is clicked.</span></span> <span data-ttu-id="a5ca5-187">Vytvoření `Click` obslužné rutiny události pro `DoublePrice` tlačítko a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-187">Create a `Click` event handler for the `DoublePrice` Button and add the following code:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample5.cs)]

<span data-ttu-id="a5ca5-188">Pokud chcete vyzkoušet tuto funkci, navštivte `~/Admin/Products.aspx` stránky jsme vytvořili v kroku 1 a klikněte na tlačítko "Dvojité ceny produktů".</span><span class="sxs-lookup"><span data-stu-id="a5ca5-188">To test this functionality, visit the `~/Admin/Products.aspx` page we created in Step 1 and click the "Double Product Prices" button.</span></span> <span data-ttu-id="a5ca5-189">Kliknutím na tlačítko způsobí, že zpětné volání a provede `DoublePrice` tlačítka `Click` obslužné rutiny události, zvýší ceny všech produktů.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-189">Clicking the button causes a postback and executes the `DoublePrice` Button's `Click` event handler, doubling the prices of all products.</span></span> <span data-ttu-id="a5ca5-190">Pak znovu vykreslení stránky a kód je vrátí a znovu se zobrazí v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-190">The page is then re-rendered and the markup is returned and re-displayed in the browser.</span></span> <span data-ttu-id="a5ca5-191">Rutina GridView obsahu stránce, ale uvádí stejné ceny jako před "Dvojité produktu ceny" bylo stisknuto tlačítko.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-191">The GridView in the content page, however, lists the same prices as before the "Double Product Prices" button was clicked.</span></span> <span data-ttu-id="a5ca5-192">Je to proto, že data původně načten do GridView měla stavu uložené v zobrazení stavu, takže není znovu na postback nevydá.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-192">This is because the data initially loaded in the GridView had its state stored in view state, so it's not reloaded on postbacks unless instructed otherwise.</span></span> <span data-ttu-id="a5ca5-193">Pokud navštívíte na jinou stránku a pak se vraťte do `~/Admin/Products.aspx` stránky se zobrazí aktualizovaná ceny.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-193">If you visit a different page and then return to the `~/Admin/Products.aspx` page you'll see the updated prices.</span></span>

## <a name="step-3-raising-an-event-when-the-prices-are-doubled"></a><span data-ttu-id="a5ca5-194">Krok 3: Vyvolávání událostí události při the ceny jsou se používají.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-194">Step 3: Raising an Event When the Prices are Doubled</span></span>

<span data-ttu-id="a5ca5-195">Protože rutina GridView v `~/Admin/Products.aspx` stránky nezohledňuje okamžitě zvýší ceny, uživatel může understandably myslíte, že není klikněte na tlačítko "Dvojité ceny produktů" nebo že nefungovala.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-195">Because the GridView in the `~/Admin/Products.aspx` page does not immediately reflect the price doubling, a user may understandably think that they did not click the "Double Product Prices" button, or that it didn't work.</span></span> <span data-ttu-id="a5ca5-196">Se mohou zkuste klepnutím na tlačítko několik dalších krát, zvýší se ceny znovu a znovu.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-196">They may try clicking the button a few more times, doubling the prices again and again.</span></span> <span data-ttu-id="a5ca5-197">Chcete-li tomu je potřeba mít mřížky v obsahu stránce zobrazit nové ceny ihned po jejich zdvojnásobí.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-197">To fix this we need to have the grid in the content page display the new prices immediately after they are doubled.</span></span>

<span data-ttu-id="a5ca5-198">Jak je popsáno výše v tomto kurzu, musíme aktivuje událost na hlavní stránce vždy, když uživatel klikne `DoublePrice` tlačítko.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-198">As discussed earlier in this tutorial, we need to raise an event in the master page whenever the user clicks the `DoublePrice` Button.</span></span> <span data-ttu-id="a5ca5-199">Událost je způsob, jak jednu třídu (vydavatel události) oznámit jiné sadu jiné třídy (odběratele událostí), které něčeho zajímavého došlo k chybě.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-199">An event is a way for one class (an event publisher) to notify another a set of other classes (the event subscribers) that something interesting has occurred.</span></span> <span data-ttu-id="a5ca5-200">V tomto příkladu je stránka předlohy vydavatel události; ty obsahu stránky, které jsou pro vás o při zpracování `DoublePrice` po kliknutí na tlačítko se odběratele.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-200">In this example, the master page is the event publisher; those content pages that care about when the `DoublePrice` Button is clicked are the subscribers.</span></span>

<span data-ttu-id="a5ca5-201">Třída jako odběratel u událost vytvořením *obslužné rutiny události*, což je metoda, která se spustí v reakci na událost se vyvolá.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-201">A class subscribes to an event by creating an *event handler*, which is a method that is executed in response to the event being raised.</span></span> <span data-ttu-id="a5ca5-202">Vydavatel definuje události, kterou vyvolá definováním *delegát události*.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-202">The publisher defines the events he raises by defining an *event delegate*.</span></span> <span data-ttu-id="a5ca5-203">Delegát události Určuje, jaké vstupní parametry obslužné rutiny události musí přijmout.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-203">The event delegate specifies what input parameters the event handler must accept.</span></span> <span data-ttu-id="a5ca5-204">V rozhraní .NET Framework – delegáti událostí není vrátí všechny hodnoty a přijmout dva vstupní parametry:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-204">In the .NET Framework, event delegates do not return any value and accept two input parameters:</span></span>

- <span data-ttu-id="a5ca5-205">`Object`, Který identifikuje zdroji událostí a</span><span class="sxs-lookup"><span data-stu-id="a5ca5-205">An `Object`, which identifies the event source, and</span></span>
- <span data-ttu-id="a5ca5-206">Třídy odvozené od`System.EventArgs`</span><span class="sxs-lookup"><span data-stu-id="a5ca5-206">A class derived from `System.EventArgs`</span></span>

<span data-ttu-id="a5ca5-207">Druhý parametr předaný obslužné rutiny události může obsahovat další informace o události.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-207">The second parameter passed to an event handler can include additional information about the event.</span></span> <span data-ttu-id="a5ca5-208">Při základní `EventArgs` třída nepředává podél žádné informace, rozhraní .NET Framework zahrnuje několik tříd, které rozšiřují `EventArgs` a zahrnovat další vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-208">While the base `EventArgs` class does not pass along any information, the .NET Framework includes a number of classes that extend `EventArgs` and encompass additional properties.</span></span> <span data-ttu-id="a5ca5-209">Například `CommandEventArgs` instance předána obslužné rutiny událostí, které reagují na `Command` události a zahrnuje dvě informační vlastnosti: `CommandArgument` a `CommandName`.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-209">For example, a `CommandEventArgs` instance is passed to event handlers that respond to the `Command` event, and includes two informational properties: `CommandArgument` and `CommandName`.</span></span>

> [!NOTE]
> <span data-ttu-id="a5ca5-210">Další informace o vytváření vyvolání a zpracování událostí, najdete v části [události a delegáti](https://msdn.microsoft.com/library/17sde2xt.aspx) a [– delegáti událostí v jednoduchých anglické](http://www.codeproject.com/KB/cs/eventdelegates.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5ca5-210">For more information on creating, raising, and handling events, see [Events and Delegates](https://msdn.microsoft.com/library/17sde2xt.aspx) and [Event Delegates in Simple English](http://www.codeproject.com/KB/cs/eventdelegates.aspx).</span></span>


<span data-ttu-id="a5ca5-211">Chcete-li definovat událost použijte následující syntaxi:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-211">To define an event use the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample6.cs)]

<span data-ttu-id="a5ca5-212">Protože je potřeba upozornit stránky obsahu, když uživatel klikne `DoublePrice` tlačítko a není potřeba předají jakýchkoli dalších informací, můžeme použít delegát události `EventHandler`, která definuje obslužnou rutinu události, který přijímá jako jeho parametr objekt typu `System.EventArgs`.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-212">Because we only need to alert the content page when the user has clicked the `DoublePrice` Button and do not need to pass along any other additional information, we can use the event delegate `EventHandler`, which defines an event handler that accepts as its second parameter an object of type `System.EventArgs`.</span></span> <span data-ttu-id="a5ca5-213">Pokud chcete vytvořit událost na hlavní stránce, přidejte následující řádek kódu do třídy kódu stránky předlohy:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-213">To create the event in the master page, add the following line of code to the master page's code-behind class:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample7.cs)]

<span data-ttu-id="a5ca5-214">Výše uvedený kód přidá veřejnou událost na hlavní stránku s názvem `PricesDoubled`.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-214">The above code adds a public event to the master page named `PricesDoubled`.</span></span> <span data-ttu-id="a5ca5-215">Nyní potřebujeme Vyvolejte tuto událost po ceny byl se používají.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-215">We now need to raise this event after the prices have been doubled.</span></span> <span data-ttu-id="a5ca5-216">Umožňuje aktivovat události použijte následující syntaxi:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-216">To raise an event use the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample8.cs)]

<span data-ttu-id="a5ca5-217">Kde *odesílatele* a *eventArgs* jsou hodnoty chcete předat obslužné rutiny události odběratele.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-217">Where *sender* and *eventArgs* are the values you want to pass to the subscriber's event handler.</span></span>

<span data-ttu-id="a5ca5-218">Aktualizace `DoublePrice` `Click` obslužné rutiny události s následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-218">Update the `DoublePrice` `Click` event handler with the following code:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample9.cs)]

<span data-ttu-id="a5ca5-219">Jako předtím `Click` obslužné rutiny události spustí voláním `DoublePricesDataSource` prvek SqlDataSource `Update` metoda zdvojnásobit ceny všech produktů.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-219">As before, the `Click` event handler starts by calling the `DoublePricesDataSource` SqlDataSource control's `Update` method to double the prices of all products.</span></span> <span data-ttu-id="a5ca5-220">Následující, že existují dvě dodatky k obslužné rutině událostí.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-220">Following that there are two additions to the event handler.</span></span> <span data-ttu-id="a5ca5-221">Nejdřív `RecentProducts` GridView data se aktualizují.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-221">First, the `RecentProducts` GridView's data is refreshed.</span></span> <span data-ttu-id="a5ca5-222">Tato rutina GridView byl přidán k hlavní stránce v předchozím kurzu a zobrazí pět nejvíce nedávno přidané produkty.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-222">This GridView was added to the master page in the preceding tutorial and displays the five most recently-added products.</span></span> <span data-ttu-id="a5ca5-223">Je potřeba aktualizovat mřížce tak, aby se zobrazí ceny se právě používají pro tyto produkty pět.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-223">We need to refresh this grid so that it shows the just-doubled prices for these five products.</span></span> <span data-ttu-id="a5ca5-224">Následující, která `PricesDoubled` událost se vyvolá.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-224">Following that, the `PricesDoubled` event is raised.</span></span> <span data-ttu-id="a5ca5-225">Odkaz na hlavní stránce samotné (`this`) se odešle do obslužné rutiny události jako zdroje událostí a prázdnou `EventArgs` objekt se odešle jako argumenty událostí.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-225">A reference to the master page itself (`this`) is sent to the event handler as the event source and an empty `EventArgs` object is sent as the event arguments.</span></span>

## <a name="step-4-handling-the-event-in-the-content-page"></a><span data-ttu-id="a5ca5-226">Krok 4: Zpracování událostí v stránky obsahu</span><span class="sxs-lookup"><span data-stu-id="a5ca5-226">Step 4: Handling the Event in the Content Page</span></span>

<span data-ttu-id="a5ca5-227">V tomto okamžiku stránky předlohy vyvolá jeho `PricesDoubled` událost vždy, když `DoublePrice` po kliknutí na tlačítko – ovládací prvek.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-227">At this point the master page raises its `PricesDoubled` event whenever the `DoublePrice` Button control is clicked.</span></span> <span data-ttu-id="a5ca5-228">Ale toto je pouze poloviční boj – musíme zpracovat událost v odběrateli.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-228">However, this is only half the battle - we still need to handle the event in the subscriber.</span></span> <span data-ttu-id="a5ca5-229">To zahrnuje dva kroky: vytvoření obslužné rutiny události a přidání kód kabeláž události tak, aby při vyvolání události se spustí obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-229">This involves two steps: creating the event handler and adding event wiring code so that when the event is raised the event handler is executed.</span></span>

<span data-ttu-id="a5ca5-230">Začněte vytvořením obslužné rutiny události s názvem `Master_PricesDoubled`.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-230">Start by creating an event handler named `Master_PricesDoubled`.</span></span> <span data-ttu-id="a5ca5-231">Z důvodu jak jsme definovali `PricesDoubled` událostí na hlavní stránce dvou vstupních parametrů obslužné rutiny události musí být typu `Object` a `EventArgs`, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-231">Because of how we defined the `PricesDoubled` event in the master page the event handler's two input parameters must be of types `Object` and `EventArgs`, respectively.</span></span> <span data-ttu-id="a5ca5-232">Ve volání obslužné rutiny událostí `ProductsGrid` GridView `DataBind` metoda se svázat data k mřížce.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-232">In the event handler call the `ProductsGrid` GridView's `DataBind` method to rebind the data to the grid.</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample10.cs)]

<span data-ttu-id="a5ca5-233">Kód pro obslužnou rutinu události dokončení, ale zatím jsme na propojit stránky předlohy `PricesDoubled` událost, která má této obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-233">The code for the event handler is complete but we've yet to wire the master page's `PricesDoubled` event to this event handler.</span></span> <span data-ttu-id="a5ca5-234">Odběratel vedení událost vodiče na obslužnou rutinu události pomocí následující syntaxe:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-234">The subscriber wires an event to an event handler via the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample11.cs)]

<span data-ttu-id="a5ca5-235">*Vydavatel* je odkaz na objekt, který nabízí událost *eventName*, a *methodName* je název obslužné rutiny události definované v odběrateli, který má odpovídající podpis na *eventDelegate*.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-235">*publisher* is a reference to the object that offers the event *eventName*, and *methodName* is the name of the event handler defined in the subscriber that has a signature corresponding to the *eventDelegate*.</span></span> <span data-ttu-id="a5ca5-236">Jinými slovy, pokud událost delegovat je `EventHandler`, pak *methodName* musí být název metody v odběrateli, která nevrátí hodnotu a přijímá dva vstupní parametry typů `Object` a `EventArgs`, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-236">In other words, if the event delegate is `EventHandler`, then *methodName* must be the name of a method in the subscriber that does not return a value and accepts two input parameters of types `Object` and `EventArgs`, respectively.</span></span>

<span data-ttu-id="a5ca5-237">Tento kód kabeláž událostí je třeba spustit na první návštěvě stránky a následné zpětná vystavení a má probíhat na bod v průběhu životního cyklu stránky, předcházejícího při událost může být vyvolána.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-237">This event wiring code must be executed on the first page visit and subsequent postbacks and should occur at a point in the page lifecycle that precedes when the event may be raised.</span></span> <span data-ttu-id="a5ca5-238">Ve fázi PreInit, který probíhá velmi brzy v životním cyklu stránky je vhodná doba přidat kód kabeláž události.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-238">A good time to add event wiring code is in the PreInit stage, which occurs very early in the page lifecycle.</span></span>

<span data-ttu-id="a5ca5-239">Otevřete `~/Admin/Products.aspx` a vytvořte `Page_PreInit` obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-239">Open `~/Admin/Products.aspx` and create a `Page_PreInit` event handler:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample12.cs)]

<span data-ttu-id="a5ca5-240">Chcete-li dokončit tento kód kabeláž potřebujeme programový odkaz na hlavní stránce ze stránky obsahu.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-240">In order to complete this wiring code we need a programmatic reference to the master page from the content page.</span></span> <span data-ttu-id="a5ca5-241">Jak jsme uvedli v předchozím kurzu, existují dva způsoby, jak to udělat:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-241">As noted in the previous tutorial, there are two ways to do this:</span></span>

- <span data-ttu-id="a5ca5-242">Pomocí přetypování volného typu `Page.Master` vlastnost, která má typ příslušné stránky předlohy nebo</span><span class="sxs-lookup"><span data-stu-id="a5ca5-242">By casting the loosely-typed `Page.Master` property to the appropriate master page type, or</span></span>
- <span data-ttu-id="a5ca5-243">Přidáním `@MasterType` direktivy v `.aspx` stránku a pak pomocí silného typu `Master` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-243">By adding a `@MasterType` directive in the `.aspx` page and then using the strongly-typed `Master` property.</span></span>

<span data-ttu-id="a5ca5-244">Umožňuje použít pozdější přístup.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-244">Let's use the latter approach.</span></span> <span data-ttu-id="a5ca5-245">Přidejte následující `@MasterType` direktivy do horní části stránky deklarativní značky:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-245">Add the following `@MasterType` directive to the top of the page's declarative markup:</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample13.aspx)]

<span data-ttu-id="a5ca5-246">Přidejte následující kód kabeláž událostí v `Page_PreInit` obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-246">Then add the following event wiring code in the `Page_PreInit` event handler:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample14.cs)]

<span data-ttu-id="a5ca5-247">S tímto kódem na místě, se aktualizují GridView obsahu stránce vždy, když `DoublePrice` po kliknutí na tlačítko.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-247">With this code in place, the GridView in the content page is refreshed whenever the `DoublePrice` Button is clicked.</span></span>

<span data-ttu-id="a5ca5-248">Toto chování je znázorněn 8 obrázky a 9.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-248">Figures 8 and 9 illustrate this behavior.</span></span> <span data-ttu-id="a5ca5-249">Obrázek 8 ukazuje na stránku při první navštívené.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-249">Figure 8 shows the page when first visited.</span></span> <span data-ttu-id="a5ca5-250">Všimněte si, že cena hodnoty v obou `RecentProducts` GridView (v levém sloupci stránky předlohy) a `ProductsGrid` GridView (v obsahu stránce).</span><span class="sxs-lookup"><span data-stu-id="a5ca5-250">Note that price values in both the `RecentProducts` GridView (in the left column of the master page) and the `ProductsGrid` GridView (in the content page).</span></span> <span data-ttu-id="a5ca5-251">Obrázek 9 ukazuje stejné obrazovce ihned po `DoublePrice` bylo stisknuto tlačítko.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-251">Figure 9 shows the same screen immediately after the `DoublePrice` Button has been clicked.</span></span> <span data-ttu-id="a5ca5-252">Jak vidíte, nové ceny se okamžitě projeví v obou GridViews.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-252">As you can see, the new prices are instantaneously reflected in both GridViews.</span></span>


<span data-ttu-id="a5ca5-253">[![Počáteční cena hodnoty](interacting-with-the-content-page-from-the-master-page-cs/_static/image23.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-253">[![The Initial Price Values](interacting-with-the-content-page-from-the-master-page-cs/_static/image23.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image22.png)</span></span>

<span data-ttu-id="a5ca5-254">**Obrázek 08**: počáteční hodnoty cen ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="a5ca5-254">**Figure 08**: The Initial Price Values  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image24.png))</span></span>


<span data-ttu-id="a5ca5-255">[![Ceny Just-Doubled se zobrazují v GridViews](interacting-with-the-content-page-from-the-master-page-cs/_static/image26.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-255">[![The Just-Doubled Prices are Displayed in the GridViews](interacting-with-the-content-page-from-the-master-page-cs/_static/image26.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image25.png)</span></span>

<span data-ttu-id="a5ca5-256">**Obrázek 09**: The Just-Doubled ceny jsou zobrazeny v GridViews ([Kliknutím zobrazit obrázek v plné velikosti](interacting-with-the-content-page-from-the-master-page-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="a5ca5-256">**Figure 09**: The Just-Doubled Prices are Displayed in the GridViews  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="a5ca5-257">Souhrn</span><span class="sxs-lookup"><span data-stu-id="a5ca5-257">Summary</span></span>

<span data-ttu-id="a5ca5-258">V ideálním případě stránky předlohy a stránky jeho obsahu jsou zcela oddělené od sebe navzájem a nevyžadují žádné úrovně interakce.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-258">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="a5ca5-259">Ale pokud máte na hlavní stránku nebo stránky obsahu, která zobrazí data, která je možné upravovat na hlavní stránku nebo stránky obsahu, pak může musíte mít stránky předlohy upozornění obsahu stránce (nebo naopak) změny dat, aby bylo možné aktualizovat zobrazení.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-259">However, if you have a master page or content page that displays data that can be modified from the master page or content page, then you may need to have the master page alert the content page (or vice-a-versa) when data is modified so that the display can be updated.</span></span> <span data-ttu-id="a5ca5-260">V předchozím kurzu jsme viděli, jak mají stránky obsahu prostřednictvím kódu programu interakci s jeho stránky předlohy; v tomto kurzu jsme se podívali na postup mít spuštění stránky předlohy interakce.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-260">In the preceding tutorial we saw how to have a content page programmatically interact with its master page; in this tutorial we looked at how to have a master page initiate the interaction.</span></span>

<span data-ttu-id="a5ca5-261">Při programové interakce mezi obsah a hlavní stránce můžete pocházejí z obsah nebo stránky předlohy, vzoru interakce použít závisí na místem původu.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-261">While programmatic interaction between a content and master page can originate from either the content or master page, the interaction pattern used depends on the origination.</span></span> <span data-ttu-id="a5ca5-262">Rozdíly jsou vzhledem k tomu, že obsahu stránce má jednu stránku předlohy, ale na hlavní stránce může mít mnoho různých obsahu stránky.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-262">The differences are due to the fact that a content page has a single master page, but a master page can have many different content pages.</span></span> <span data-ttu-id="a5ca5-263">Místo na hlavní stránce přímo komunikovat s stránky obsahu, je vhodnější se se vyvolat událost signál, že některé akce proběhla stránky předlohy.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-263">Rather than having a master page directly interact with a content page, a better approach is to have the master page raise an event to signal that some action has taken place.</span></span> <span data-ttu-id="a5ca5-264">Obslužné rutiny událostí můžete vytvořit tyto stránky obsahu, které jsou pro vás o akci.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-264">Those content pages that care about the action can create event handlers.</span></span>

<span data-ttu-id="a5ca5-265">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="a5ca5-265">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="a5ca5-266">Další čtení</span><span class="sxs-lookup"><span data-stu-id="a5ca5-266">Further Reading</span></span>

<span data-ttu-id="a5ca5-267">Další informace o tématech popsané v tomto kurzu najdete v následujících zdrojích informací:</span><span class="sxs-lookup"><span data-stu-id="a5ca5-267">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="a5ca5-268">Přístup k informacím a aktualizace dat v technologii ASP.NET</span><span class="sxs-lookup"><span data-stu-id="a5ca5-268">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="a5ca5-269">Události a delegáti</span><span class="sxs-lookup"><span data-stu-id="a5ca5-269">Events and Delegates</span></span>](https://msdn.microsoft.com/library/17sde2xt.aspx)
- [<span data-ttu-id="a5ca5-270">Předávání informací mezi obsah a stránky předlohy</span><span class="sxs-lookup"><span data-stu-id="a5ca5-270">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="a5ca5-271">Práce s daty v kurzech ASP.NET</span><span class="sxs-lookup"><span data-stu-id="a5ca5-271">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="a5ca5-272">O autorovi</span><span class="sxs-lookup"><span data-stu-id="a5ca5-272">About the Author</span></span>

<span data-ttu-id="a5ca5-273">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor více knih ASP/ASP.NET a zakladatele 4GuysFromRolla.com, pracuje s technologií Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-273">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a5ca5-274">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-274">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a5ca5-275">Jeho nejnovější seznam k [ *Edice nakladatelství Sams naučit sami technologie ASP.NET 3.5 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a5ca5-275">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="a5ca5-276">Scott lze dosáhnout za [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu v [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="a5ca5-276">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="a5ca5-277">Zvláštní poděkování</span><span class="sxs-lookup"><span data-stu-id="a5ca5-277">Special Thanks To</span></span>

<span data-ttu-id="a5ca5-278">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-278">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a5ca5-279">Vést kontrolorem pro tento kurz byl Suchi Banerjee.</span><span class="sxs-lookup"><span data-stu-id="a5ca5-279">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="a5ca5-280">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="a5ca5-280">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a5ca5-281">Pokud ano, vyřaďte mi řádek v[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-281">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="a5ca5-282">[Předchozí](interacting-with-the-master-page-from-the-content-page-cs.md)
[další](master-pages-and-asp-net-ajax-cs.md)</span><span class="sxs-lookup"><span data-stu-id="a5ca5-282">[Previous](interacting-with-the-master-page-from-the-content-page-cs.md)
[Next](master-pages-and-asp-net-ajax-cs.md)</span></span>
