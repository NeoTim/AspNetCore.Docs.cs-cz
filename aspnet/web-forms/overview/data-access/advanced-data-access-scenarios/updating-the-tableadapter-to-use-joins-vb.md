---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: Aktualizace pro použití TableAdapter spojí (VB) | Microsoft Docs
author: rick-anderson
description: Při práci s databází je běžné pro data požadavku, která je rozdělena mezi více tabulek. Načíst data ze dvou různých tabulek můžeme použít buď...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 91d700f3de02dc78692e933644e221e2ac8175a1
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/06/2018
---
<a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="28e0d-104">Aktualizace pro použití TableAdapter spojí (VB)</span><span class="sxs-lookup"><span data-stu-id="28e0d-104">Updating the TableAdapter to Use JOINs (VB)</span></span>
====================
<span data-ttu-id="28e0d-105">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="28e0d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="28e0d-106">[Stáhněte si kód](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) nebo [stáhnout PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="28e0d-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="28e0d-107">Při práci s databází je běžné pro data požadavku, která je rozdělena mezi více tabulek.</span><span class="sxs-lookup"><span data-stu-id="28e0d-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="28e0d-108">Načíst data ze dvou různých tabulek jsme můžete použít korelační poddotazu nebo operace spojení.</span><span class="sxs-lookup"><span data-stu-id="28e0d-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="28e0d-109">V tomto kurzu jsme porovnejte korelační poddotazy a syntaxe spojení před prohlížení vytváření TableAdapter, který zahrnuje spojení v jeho hlavní dotazu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="28e0d-110">Úvod</span><span class="sxs-lookup"><span data-stu-id="28e0d-110">Introduction</span></span>

<span data-ttu-id="28e0d-111">Pomocí relačních databází je často data, která jsme zájem o práci s rozdělena mezi více tabulek.</span><span class="sxs-lookup"><span data-stu-id="28e0d-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="28e0d-112">Například při zobrazení informací o produktu pravděpodobně chceme seznamu každý odpovídající kategorie produktů s a dodavatele s názvy.</span><span class="sxs-lookup"><span data-stu-id="28e0d-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="28e0d-113">`Products` Tabulka má `CategoryID` a `SupplierID` hodnoty, ale skutečné názvy kategorií a dodavatele jsou v `Categories` a `Suppliers` tabulek, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="28e0d-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="28e0d-114">Pro načtení informací z jiného, související tabulky jsme můžete buď používat *korelační poddotazy* nebo `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="28e0d-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="28e0d-115">Korelační poddotaz je vnořený `SELECT` dotaz, který odkazuje na sloupce ve vnějším dotazu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="28e0d-116">Například v [vytváření Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) jsme použili dva korelační poddotazy v kurzu `ProductsTableAdapter` s hlavní dotaz vrátí název kategorie a dodavatele pro každý produkt.</span><span class="sxs-lookup"><span data-stu-id="28e0d-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="28e0d-117">A `JOIN` je konstrukce SQL, která sloučí související řádky ze dvou různých tabulek.</span><span class="sxs-lookup"><span data-stu-id="28e0d-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="28e0d-118">Použili jsme `JOIN` v [dotazování dat pomocí ovládacího prvku SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) kurzu zobrazíte informace o kategoriích vedle každého produktu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="28e0d-119">Z důvodu jsme mít zdržel pomocí `JOIN` s s TableAdapters je z důvodu omezení v Průvodci TableAdapter s pro automatické generování odpovídající `INSERT`, `UPDATE`, a `DELETE` příkazy.</span><span class="sxs-lookup"><span data-stu-id="28e0d-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="28e0d-120">Přesněji řečeno pokud hlavní dotazu TableAdapter s obsahuje některý `JOIN` s, TableAdapter nelze automaticky vytvořit příkazy SQL ad-hoc nebo uložené procedury pro jeho `InsertCommand`, `UpdateCommand`, a `DeleteCommand` vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="28e0d-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="28e0d-121">V tomto kurzu stručně porovnáme a kontrast korelační poddotazy a `JOIN` s před zkoumat vytváření TableAdapter, která zahrnuje `JOIN` s v jeho hlavní dotazu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="28e0d-122">Porovnávání a kontrastní korelační poddotazy a`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="28e0d-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="28e0d-123">Odvolat, který `ProductsTableAdapter` vytvořené v z prvního kurzu `Northwind` datová sada používá korelační poddotazy tak, aby každý s odpovídající kategorii a dodavatele název produktu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="28e0d-124">`ProductsTableAdapter` s hlavním dotazu jsou uvedeny níže.</span><span class="sxs-lookup"><span data-stu-id="28e0d-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="28e0d-125">Dva korelační poddotazy - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` a `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` -jsou `SELECT` dotazů, které vrátí jednu hodnotu na produkt jako další sloupec ve vnější `SELECT` příkaz s seznamu sloupců.</span><span class="sxs-lookup"><span data-stu-id="28e0d-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="28e0d-126">Alternativně `JOIN` lze použít k vrácení každý název dodavatele a kategorie produktu s.</span><span class="sxs-lookup"><span data-stu-id="28e0d-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="28e0d-127">Následující dotaz vrátí stejné výstup jako výše, ale používá `JOIN` s místo poddotazy:</span><span class="sxs-lookup"><span data-stu-id="28e0d-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="28e0d-128">A `JOIN` slučuje záznamy z jedné tabulky se záznamy z jiné tabulky, na základě některé kritérií.</span><span class="sxs-lookup"><span data-stu-id="28e0d-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="28e0d-129">Ve výše uvedeném dotazu, například `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` SQL serveru pokyn ke sloučení každý záznam produktu v kategorii záznam, jehož `CategoryID` hodnota odpovídá produktu s `CategoryID` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="28e0d-130">Sloučené výsledek umožňuje pracovat s odpovídající pole kategorií každého produktu (například `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="28e0d-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="28e0d-131">`JOIN` s běžně se používají při dotazování na data z relační databáze.</span><span class="sxs-lookup"><span data-stu-id="28e0d-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="28e0d-132">Pokud jste ještě `JOIN` syntaxe nebo potřeba zdokonalit v práci s trochu jeho využití, doporučujeme I d [kurzu připojení k SQL](http://www.w3schools.com/sql/sql_join.asp) v [škol W3](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="28e0d-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="28e0d-133">Také vhodné čtení jsou [ `JOIN` Základy](https://msdn.microsoft.com/library/ms191517.aspx) a [poddotazu Základy](https://msdn.microsoft.com/library/ms189575.aspx) části [dokumentaci knihy Online SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="28e0d-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="28e0d-134">Vzhledem k tomu `JOIN` s a korelační poddotazy obě slouží k načtení dat v relaci z jiné tabulky, celá řada vývojářů nezbývají hrabání jejich oznámení a vás zajímá, jaký přístup k použití.</span><span class="sxs-lookup"><span data-stu-id="28e0d-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="28e0d-135">Všechny SQL gurus I sunout mluvili do mají uvedená zhruba samé, to nemá t skutečně vás performance-wise spojitá plány zhruba identické spuštění systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="28e0d-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="28e0d-136">Jejich poradenství, pak je pomocí technik, které vám a vašemu týmu jsou nejvíce vyhovuje.</span><span class="sxs-lookup"><span data-stu-id="28e0d-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="28e0d-137">Ho věci poznamenat, že po vodorovně tuto žádost tyto odborníky okamžitě express jejich předvolbu `JOIN` s přes korelační poddotazy.</span><span class="sxs-lookup"><span data-stu-id="28e0d-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="28e0d-138">Při sestavování Data Access Layer pomocí typové datové sady, nástroje fungují lépe při použití poddotazy.</span><span class="sxs-lookup"><span data-stu-id="28e0d-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="28e0d-139">Konkrétně Průvodce nastavením TableAdapter s nebude automaticky generovat odpovídající `INSERT`, `UPDATE`, a `DELETE` příkazy Pokud hlavní dotaz obsahuje některý `JOIN` s, ale bude automaticky generovat tyto příkazy při korelační poddotazy se používají.</span><span class="sxs-lookup"><span data-stu-id="28e0d-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="28e0d-140">Chcete-li prozkoumat tohoto nedostatku, vytvořit dočasný typové datové sady v `~/App_Code/DAL` složky.</span><span class="sxs-lookup"><span data-stu-id="28e0d-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="28e0d-141">Během Průvodce konfigurací TableAdapter rozhodnout používat příkazy SQL ad-hoc a zadejte následující `SELECT` dotazu (viz obrázek 1):</span><span class="sxs-lookup"><span data-stu-id="28e0d-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]


<span data-ttu-id="28e0d-142">[![Zadejte hlavní dotaz, který obsahuje spojení](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="28e0d-143">**Obrázek 1**: Zadejte hlavní dotaz, který obsahuje `JOIN` s ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>


<span data-ttu-id="28e0d-144">Ve výchozím nastavení, se automaticky vytvoří TableAdapter `INSERT`, `UPDATE`, a `DELETE` příkazy založená na hlavní dotazu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="28e0d-145">Pokud kliknete na tlačítko Upřesnit uvidíte, že je tato funkce povolená.</span><span class="sxs-lookup"><span data-stu-id="28e0d-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="28e0d-146">Bez ohledu na toto nastavení TableAdapter nebude možné vytvořit `INSERT`, `UPDATE`, a `DELETE` příkazy protože hlavním dotazu obsahuje `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Zadejte hlavní dotaz, který obsahuje spojení](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="28e0d-148">**Obrázek 2**: Zadejte hlavní dotaz, který obsahuje `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="28e0d-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="28e0d-149">Kliknutím na tlačítko Dokončit ukončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="28e0d-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="28e0d-150">V tomto okamžiku vaše datová sada s Designer bude obsahovat jeden TableAdapter s DataTable s sloupce pro každé pole, vrátí se v `SELECT` seznamu sloupců dotazu s.</span><span class="sxs-lookup"><span data-stu-id="28e0d-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="28e0d-151">To zahrnuje `CategoryName` a `SupplierName`, jak je vidět na obrázku 3.</span><span class="sxs-lookup"><span data-stu-id="28e0d-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![DataTable obsahuje sloupec pro každé pole, vrátí se v seznamu sloupců](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="28e0d-153">**Obrázek 3**: DataTable obsahuje sloupec pro každé pole, vrátí se v seznamu sloupců</span><span class="sxs-lookup"><span data-stu-id="28e0d-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="28e0d-154">Zatímco DataTable má odpovídající sloupce, TableAdapter chybí hodnoty pro jeho `InsertCommand`, `UpdateCommand`, a `DeleteCommand` vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="28e0d-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="28e0d-155">Chcete-li to ověřit, klikněte na TableAdapter v návrháři a potom přejděte do okna vlastností.</span><span class="sxs-lookup"><span data-stu-id="28e0d-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="28e0d-156">Existuje, uvidíte `InsertCommand`, `UpdateCommand`, a `DeleteCommand` vlastnosti jsou nastaveny na (žádný).</span><span class="sxs-lookup"><span data-stu-id="28e0d-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="28e0d-157">[![Událost InsertCommand, vlastnost UpdateCommand a DeleteCommand vlastnosti jsou nastaveny na (žádný)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="28e0d-158">**Obrázek 4**: `InsertCommand`, `UpdateCommand`, a `DeleteCommand` vlastnosti jsou nastaveny na hodnotu (None) ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>


<span data-ttu-id="28e0d-159">Obejít tohoto nedostatku, můžete ručně poskytujeme příkazů SQL a parametry `InsertCommand`, `UpdateCommand`, a `DeleteCommand` vlastnosti prostřednictvím okna Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="28e0d-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="28e0d-160">Alternativně může začneme nakonfigurováním hlavní dotazu TableAdapter s k *není* obsahovat žádné `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="28e0d-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="28e0d-161">To vám umožní `INSERT`, `UPDATE`, a `DELETE` příkazy, čímž automaticky vygeneruje pro nás.</span><span class="sxs-lookup"><span data-stu-id="28e0d-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="28e0d-162">Po dokončení průvodce, jsme může potom ručně aktualizovat TableAdapter s `SelectCommand` z okna vlastností, které zahrnuje `JOIN` syntaxe.</span><span class="sxs-lookup"><span data-stu-id="28e0d-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="28e0d-163">I když se tento přístup funguje, je velmi křehká po překonfigurovat pomocí Průvodce automaticky vygenerované pomocí dotazů ad-hoc SQL, protože kdykoli hlavní dotazu TableAdapter s `INSERT`, `UPDATE`, a `DELETE` příkazy se znovu vytvoří.</span><span class="sxs-lookup"><span data-stu-id="28e0d-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="28e0d-164">To znamená, že všechny úpravy jsme provedli později by dojít ke ztrátě, pokud jsme klepli pravým tlačítkem myši na TableAdapter, zvolili konfigurace v místní nabídce a dokončit průvodce znovu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="28e0d-165">Brittleness souboru s nastavením TableAdapter automaticky generovaný `INSERT`, `UPDATE`, a `DELETE` příkazy je naštěstí omezené na ad hoc příkazů SQL.</span><span class="sxs-lookup"><span data-stu-id="28e0d-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="28e0d-166">Pokud vaše TableAdapter používá uložené procedury, můžete upravit `SelectCommand`, `InsertCommand`, `UpdateCommand`, nebo `DeleteCommand` uložené procedury a znovu spusťte Průvodce nastavením TableAdapter konfigurace bez nutnosti se obávat, že se budou uložené procedury upravit.</span><span class="sxs-lookup"><span data-stu-id="28e0d-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="28e0d-167">Přes další několik kroků vytvoříme TableAdapter, standardně používá hlavní dotaz, který vynechá žádné `JOIN` s tak, aby k odpovídající položce vložit, aktualizovat a odstranit uložené procedury bude automaticky generovaný.</span><span class="sxs-lookup"><span data-stu-id="28e0d-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="28e0d-168">Pak bude aktualizován `SelectCommand` , která používá `JOIN` , vrátí další sloupce z tabulky v relaci.</span><span class="sxs-lookup"><span data-stu-id="28e0d-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="28e0d-169">Nakonec jsme vytvoříte třídu odpovídající vrstvu obchodní logiky a demonstruje použití TableAdapter na webovou stránku ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="28e0d-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="28e0d-170">Krok 1: Vytváření TableAdapter použití zjednodušené hlavní dotazu</span><span class="sxs-lookup"><span data-stu-id="28e0d-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="28e0d-171">V tomto kurzu přidáme TableAdapter a silného typu DataTable pro `Employees` tabulky v `NorthwindWithSprocs` datovou sadu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="28e0d-172">`Employees` Tabulka obsahuje `ReportsTo` pole, která zadána `EmployeeID` zaměstnanec s správce.</span><span class="sxs-lookup"><span data-stu-id="28e0d-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="28e0d-173">Například zaměstnanců má Dana příjmení `ReportTo` hodnotu 5, která je `EmployeeID` z Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="28e0d-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="28e0d-174">V důsledku toho Dana sestav Steven manažerovi.</span><span class="sxs-lookup"><span data-stu-id="28e0d-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="28e0d-175">Společně s reporting každý zaměstnanec s `ReportsTo` hodnotu, jsme také chtít získat název svého správce.</span><span class="sxs-lookup"><span data-stu-id="28e0d-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="28e0d-176">Můžete to provést pomocí `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="28e0d-177">Ale pomocí `JOIN` při vytváření původně TableAdapter vylučuje Průvodce automatického generování odpovídající vložení, aktualizace a odstranění možnosti.</span><span class="sxs-lookup"><span data-stu-id="28e0d-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="28e0d-178">Proto bude začneme vytvořením TableAdapter jejichž hlavní dotazu neobsahuje žádné `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="28e0d-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="28e0d-179">Potom v kroku 2, budeme aktualizovat hlavní dotazu uložený postup získat název manager s prostřednictvím `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="28e0d-180">Začněte otevřením `NorthwindWithSprocs` datovou sadu v `~/App_Code/DAL` složky.</span><span class="sxs-lookup"><span data-stu-id="28e0d-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="28e0d-181">Klikněte pravým tlačítkem na návrháře, vyberte možnost přidat v místní nabídce a vyberte položku nabídky TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="28e0d-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="28e0d-182">Tím se spustí Průvodce nastavením TableAdapter konfigurací.</span><span class="sxs-lookup"><span data-stu-id="28e0d-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="28e0d-183">Jak znázorňuje obrázek 5, aby průvodce vytvořit nové uložené procedury a klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="28e0d-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="28e0d-184">Pro aktualizační program na vytváření nových uložené procedury z Průvodce nastavením TableAdapter s, najdete [vytváření nové uložených procedur, pro typové datové sady s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>


<span data-ttu-id="28e0d-185">[![Vyberte nové uložené procedury vytvořit možnost](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="28e0d-186">**Obrázek 5**: Vyberte vytvořením nové uložené procedury možnost ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>


<span data-ttu-id="28e0d-187">Použijte následující `SELECT` příkaz dotazu TableAdapter s hlavní:</span><span class="sxs-lookup"><span data-stu-id="28e0d-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="28e0d-188">Vzhledem k tomu, že tento dotaz neobsahuje žádné `JOIN` s, TableAdapter průvodce automaticky vytvoří uložené procedury s odpovídajícími `INSERT`, `UPDATE`, a `DELETE` příkazy, stejně jako uložené procedury pro provádění hlavní dotaz.</span><span class="sxs-lookup"><span data-stu-id="28e0d-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="28e0d-189">Následující krok umožňuje název TableAdapter s uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="28e0d-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="28e0d-190">Použít názvy `Employees_Select`, `Employees_Insert`, `Employees_Update`, a `Employees_Delete`, jak je znázorněno na obrázku 6.</span><span class="sxs-lookup"><span data-stu-id="28e0d-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="28e0d-191">[![Název TableAdapter s uložené procedury](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="28e0d-192">**Obrázek 6**: název uložené procedury s TableAdapter ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>


<span data-ttu-id="28e0d-193">V posledním kroku vyzve nám název metody TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="28e0d-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="28e0d-194">Použití `Fill` a `GetEmployees` jako názvy metoda.</span><span class="sxs-lookup"><span data-stu-id="28e0d-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="28e0d-195">Nezapomeňte také ponechat vytvořit metody k odeslání aktualizací přímo do databáze (generatedbdirectmethods –) políčko zaškrtnuto.</span><span class="sxs-lookup"><span data-stu-id="28e0d-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="28e0d-196">[![Název výplně TableAdapter s metody a GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="28e0d-197">**Obrázek 7**: název TableAdapter s metody `Fill` a `GetEmployees` ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>


<span data-ttu-id="28e0d-198">Po dokončení průvodce, pozorně zkontrolujte uložené procedury v databázi.</span><span class="sxs-lookup"><span data-stu-id="28e0d-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="28e0d-199">Měli byste vidět čtyři nové: `Employees_Select`, `Employees_Insert`, `Employees_Update`, a `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="28e0d-200">Dále zkontrolujte `EmployeesDataTable` a `EmployeesTableAdapter` právě vytvořili.</span><span class="sxs-lookup"><span data-stu-id="28e0d-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="28e0d-201">DataTable obsahuje sloupec pro každé pole vrácené dotazem hlavní.</span><span class="sxs-lookup"><span data-stu-id="28e0d-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="28e0d-202">Klikněte na TableAdapter a potom přejděte do okna vlastností.</span><span class="sxs-lookup"><span data-stu-id="28e0d-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="28e0d-203">Existuje, uvidíte `InsertCommand`, `UpdateCommand`, a `DeleteCommand` vlastnosti jsou správně nakonfigurovány k volání odpovídající uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="28e0d-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="28e0d-204">[![TableAdapter obsahuje příkaz Insert, Update a odstranit možnosti](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="28e0d-205">**Obrázek 8**: TableAdapter zahrnuje vložení, aktualizace a odstranění možnosti ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>


<span data-ttu-id="28e0d-206">S vložit, aktualizovat a odstraňovat uložené procedury automaticky vytvoří a `InsertCommand`, `UpdateCommand`, a `DeleteCommand` vlastnosti správně nakonfigurovaný, jsme připraveni k přizpůsobení `SelectCommand` s uložené procedury vrátit další informace o jednotlivých zaměstnanců s správci.</span><span class="sxs-lookup"><span data-stu-id="28e0d-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="28e0d-207">Konkrétně je potřeba aktualizovat `Employees_Select` uložené procedury sloužící `JOIN` a vrátíte se správce s `FirstName` a `LastName` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="28e0d-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="28e0d-208">Po aktualizaci uložené procedury, budeme muset aktualizovat DataTable tak, že obsahují tyto další sloupce.</span><span class="sxs-lookup"><span data-stu-id="28e0d-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="28e0d-209">Jsme budete řešení tyto dvě úlohy v kroky 2 a 3.</span><span class="sxs-lookup"><span data-stu-id="28e0d-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="28e0d-210">Krok 2: Přizpůsobení uložené procedury, která patří`JOIN`</span><span class="sxs-lookup"><span data-stu-id="28e0d-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="28e0d-211">Start, přejděte do Průzkumníka serveru, procházení k podrobnostem do složky Northwind databáze s uložené procedury a otevírání `Employees_Select` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="28e0d-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="28e0d-212">Pokud nevidíte tuto uloženou proceduru, klikněte pravým tlačítkem na složku, uložené procedury a zvolte aktualizace.</span><span class="sxs-lookup"><span data-stu-id="28e0d-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="28e0d-213">Aktualizace uložené procedury tak, aby používala `LEFT JOIN` nejprve vrátit správce s a příjmení:</span><span class="sxs-lookup"><span data-stu-id="28e0d-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="28e0d-214">Po aktualizaci `SELECT` příkaz Uložit změny přechodem do nabídky soubor a zvolením Uložit `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="28e0d-215">Případně můžete kliknutím na ikonu Uložit na panelu nástrojů nebo stiskněte kombinaci kláves Ctrl + S.</span><span class="sxs-lookup"><span data-stu-id="28e0d-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="28e0d-216">Po uložení změn, klikněte pravým tlačítkem na `Employees_Select` uložené procedury v Průzkumníku serveru a zvolte spustit.</span><span class="sxs-lookup"><span data-stu-id="28e0d-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="28e0d-217">Tato akce spuštění uložené procedury a zobrazit své výsledky v okně výstupu (viz obrázek 9).</span><span class="sxs-lookup"><span data-stu-id="28e0d-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="28e0d-218">[![Výsledky uložené procedury jsou zobrazeny v okně výstupu](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="28e0d-219">**Obrázek 9**: uložené procedury výsledky se zobrazí v okně výstupu ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="28e0d-220">Krok 3: Aktualizace sloupců s DataTable</span><span class="sxs-lookup"><span data-stu-id="28e0d-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="28e0d-221">V tomto okamžiku `Employees_Select` uložené procedury vrátí `ManagerFirstName` a `ManagerLastName` hodnoty, ale `EmployeesDataTable` chybí tyto sloupce.</span><span class="sxs-lookup"><span data-stu-id="28e0d-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="28e0d-222">Tyto chybějící sloupce lze přidat do DataTable v jednom ze dvou způsobů:</span><span class="sxs-lookup"><span data-stu-id="28e0d-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="28e0d-223">**Ručně** – klikněte pravým tlačítkem na DataTable v Návrháři DataSet a z nabídky přidat, zvolte sloupce.</span><span class="sxs-lookup"><span data-stu-id="28e0d-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="28e0d-224">Můžete pak zadejte název sloupce a odpovídajícím způsobem nastavit jeho vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="28e0d-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="28e0d-225">**Automaticky** – Průvodce konfigurací TableAdapter bude aktualizovat sloupce s DataTable tak, aby odrážela pole vrácené `SelectCommand` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="28e0d-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="28e0d-226">Při použití příkazů SQL ad-hoc, budou odebrány také Průvodce `InsertCommand`, `UpdateCommand`, a `DeleteCommand` vlastnosti od `SelectCommand` nyní obsahuje `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="28e0d-227">Ale při použití uložených procedur, tyto vlastnosti příkaz zůstanou beze změn.</span><span class="sxs-lookup"><span data-stu-id="28e0d-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="28e0d-228">Ruční přidání sloupce DataTable jsme jste prozkoumali v předchozí kurzy, včetně [hlavní/podrobností s odrážkami seznamu v hlavní záznamů pomocí DataList podrobnosti](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) a [nahrávání souborů](../working-with-binary-files/uploading-files-vb.md), a provedeme Podívejte se na tento proces znovu podrobněji v našem kurzu Další.</span><span class="sxs-lookup"><span data-stu-id="28e0d-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="28e0d-229">V tomto kurzu ale umožní používat automatické přístup prostřednictvím Průvodce konfigurací TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="28e0d-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="28e0d-230">Začněte tím, že pravým tlačítkem myši na `EmployeesTableAdapter` a výběrem konfigurace v místní nabídce.</span><span class="sxs-lookup"><span data-stu-id="28e0d-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="28e0d-231">Otevře Průvodce konfigurací TableAdapter, kde jsou uvedeny uložené procedury používané pro výběr, vkládání, aktualizaci a odstraňování spolu s jejich návratové hodnoty a parametry (pokud existuje).</span><span class="sxs-lookup"><span data-stu-id="28e0d-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="28e0d-232">Obrázek 10 ukazuje tohoto průvodce.</span><span class="sxs-lookup"><span data-stu-id="28e0d-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="28e0d-233">Zde jsme uvidíte, že `Employees_Select` uložené procedury nyní vrátí `ManagerFirstName` a `ManagerLastName` pole.</span><span class="sxs-lookup"><span data-stu-id="28e0d-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="28e0d-234">[![Průvodce zobrazí v seznamu aktualizované sloupce Employees_Select uložené procedury](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="28e0d-235">**Obrázek 10**: Průvodce zobrazí seznam aktualizovat sloupec pro `Employees_Select` uloženou proceduru ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>


<span data-ttu-id="28e0d-236">Dokončete průvodce kliknutím na tlačítko Dokončit.</span><span class="sxs-lookup"><span data-stu-id="28e0d-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="28e0d-237">Při vrácení k návrháře DataSet `EmployeesDataTable` obsahuje dva další sloupce: `ManagerFirstName` a `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="28e0d-238">[![EmployeesDataTable obsahuje dva nové sloupce](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="28e0d-239">**Obrázek 11**: `EmployeesDataTable` obsahuje dva nové sloupce ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>


<span data-ttu-id="28e0d-240">Pro ilustraci, aktualizovaná `Employees_Select` uložené procedury je v platnosti, vložit, aktualizovat a odstraňovat možnosti TableAdapter je funkční, a umožní s vytvořit webovou stránku, která umožňuje uživatelům zobrazit a odstranění zaměstnanci.</span><span class="sxs-lookup"><span data-stu-id="28e0d-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="28e0d-241">Vytvoříme tyto stránek, ale musíme nejprve vytvořte novou třídu v vrstvu obchodní logiky pro práci se zaměstnanci `NorthwindWithSprocs` datovou sadu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="28e0d-242">V kroku 4, vytvoříme `EmployeesBLLWithSprocs` třídy.</span><span class="sxs-lookup"><span data-stu-id="28e0d-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="28e0d-243">V kroku 5 budeme používat tato třída ze stránky ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="28e0d-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="28e0d-244">Krok 4: Implementace vrstvu obchodní logiky</span><span class="sxs-lookup"><span data-stu-id="28e0d-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="28e0d-245">Vytvořte nový soubor – třída v `~/App_Code/BLL` složku s názvem `EmployeesBLLWithSprocs.vb`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="28e0d-246">Tato třída napodobuje sémantika existující `EmployeesBLL` třídy, tento nový jeden poskytuje méně metody a používá `NorthwindWithSprocs` datovou sadu (místo `Northwind` datové sady).</span><span class="sxs-lookup"><span data-stu-id="28e0d-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="28e0d-247">Přidejte následující kód, který `EmployeesBLLWithSprocs` třídy.</span><span class="sxs-lookup"><span data-stu-id="28e0d-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="28e0d-248">`EmployeesBLLWithSprocs` Třídu s `Adapter` vlastnost vrací instanci třídy `NorthwindWithSprocs` datovou sadu s `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="28e0d-249">Toto je používáno třídu s `GetEmployees` a `DeleteEmployee` metody.</span><span class="sxs-lookup"><span data-stu-id="28e0d-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="28e0d-250">`GetEmployees` Volání metod `EmployeesTableAdapter` s odpovídající `GetEmployees` metodu, která volá `Employees_Select` uložené procedury a naplní své výsledky v `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="28e0d-251">`DeleteEmployee` Metoda podobně volá `EmployeesTableAdapter` s `Delete` metodu, která volá `Employees_Delete` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="28e0d-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="28e0d-252">Krok 5: Práce s daty v prezentační vrstvě</span><span class="sxs-lookup"><span data-stu-id="28e0d-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="28e0d-253">Pomocí `EmployeesBLLWithSprocs` třída dokončení jsme re připravené k práci s daty zaměstnanec prostřednictvím stránky ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="28e0d-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="28e0d-254">Otevřete `JOINs.aspx` stránku `AdvancedDAL` složku a přetáhněte GridView z panelu nástrojů na návrháře nastavení jeho `ID` vlastnost, která má `Employees`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="28e0d-255">V dalším kroku ze inteligentní značky GridView s vazby mřížce do ovládacího prvku ObjectDataSource nové s názvem `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="28e0d-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="28e0d-256">Konfigurace ObjectDataSource používat `EmployeesBLLWithSprocs` třídy a z karty vyberte a odstranit, ujistěte se, že `GetEmployees` a `DeleteEmployee` metody jsou vybraný z rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="28e0d-257">Klikněte na tlačítko Dokončit k dokončení konfigurace s ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="28e0d-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="28e0d-258">[![Konfigurace ObjectDataSource použití třídy EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="28e0d-259">**Obrázek 12**: Konfigurace ObjectDataSource pro použití `EmployeesBLLWithSprocs` – třída ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>


<span data-ttu-id="28e0d-260">[![Mají použití ObjectDataSource GetEmployees a DeleteEmployee metody](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="28e0d-261">**Obrázek 13**: mít použití ObjectDataSource `GetEmployees` a `DeleteEmployee` metody ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>


<span data-ttu-id="28e0d-262">Visual Studio se přidá BoundField do GridView pro každou z `EmployeesDataTable` s sloupce.</span><span class="sxs-lookup"><span data-stu-id="28e0d-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="28e0d-263">Odeberte všechny tyto BoundFields s výjimkou `Title`, `LastName`, `FirstName`, `ManagerFirstName`, a `ManagerLastName` a přejmenujte `HeaderText` vlastnosti pro poslední čtyři BoundFields příjmení, křestní jméno, křestní jméno správce s, a Správce s příjmení, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="28e0d-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="28e0d-264">Povolit uživatelům odstranit zaměstnanci z této stránky je potřeba udělat dvě věci.</span><span class="sxs-lookup"><span data-stu-id="28e0d-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="28e0d-265">Požádejte nejprve GridView zajistit odstraňování možnosti kontrolou možnost Povolit odstranění z jeho inteligentních značek.</span><span class="sxs-lookup"><span data-stu-id="28e0d-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="28e0d-266">Druhý, změnit ObjectDataSource s `OldValuesParameterFormatString` vlastnost z hodnoty nastavit průvodcem ObjectDataSource (`original_{0}`) na výchozí hodnotu (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="28e0d-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="28e0d-267">Po provedení těchto změn, vaše GridView a ObjectDataSource s deklarativní by měl vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="28e0d-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="28e0d-268">Otestování stránce návštěvou prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="28e0d-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="28e0d-269">Jak ukazuje obrázek 14, stránky se zobrazí seznam každý zaměstnanec a své manager s názvem (za předpokladu, že mají jednu).</span><span class="sxs-lookup"><span data-stu-id="28e0d-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="28e0d-270">[![SPOJENÍ v Employees_Select uložené procedury vrátí název s Manager](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="28e0d-271">**Obrázek 14**: `JOIN` v `Employees_Select` uložený postup vrátí Manager s názvem ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>


<span data-ttu-id="28e0d-272">Kliknutím na tlačítko Odstranit spuštění pracovního postupu, odstraňování, které culminates za běhu `Employees_Delete` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="28e0d-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="28e0d-273">Ale pokus o `DELETE` příkaz v uložené proceduře nezdaří z důvodu narušení omezení cizího klíče (viz obrázek 15).</span><span class="sxs-lookup"><span data-stu-id="28e0d-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="28e0d-274">Konkrétně každý zaměstnanec má jeden nebo více záznamů `Orders` tabulky, způsobí odstranění k selhání.</span><span class="sxs-lookup"><span data-stu-id="28e0d-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="28e0d-275">[![Odstraňování zaměstnanec, který má odpovídající objednávky výsledky v narušení omezení pro cizí klíč](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="28e0d-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="28e0d-276">**Obrázek 15**: odstranění zaměstnanec, který má odpovídající objednávky výsledky v narušení omezení pro cizí klíč ([Kliknutím zobrazit obrázek v plné velikosti](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="28e0d-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>


<span data-ttu-id="28e0d-277">Povolit zaměstnance, který bude odstraněn, vám může:</span><span class="sxs-lookup"><span data-stu-id="28e0d-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="28e0d-278">Aktualizace omezení cizího klíče kaskádové odstranění,</span><span class="sxs-lookup"><span data-stu-id="28e0d-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="28e0d-279">Ručně odstraňte záznamy ze `Orders` tabulky pro zaměstnance, kterou chcete odstranit, nebo</span><span class="sxs-lookup"><span data-stu-id="28e0d-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="28e0d-280">Aktualizace `Employees_Delete` uložené procedury nejprve odstranit související záznamy z `Orders` tabulky před odstraněním `Employees` záznamu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="28e0d-281">Jsme probírali v tento postup [použití existující uložené procedury, pro typové datové sady s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="28e0d-282">Nechat to jako cvičení pro čtečku.</span><span class="sxs-lookup"><span data-stu-id="28e0d-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="28e0d-283">Souhrn</span><span class="sxs-lookup"><span data-stu-id="28e0d-283">Summary</span></span>

<span data-ttu-id="28e0d-284">Při práci s relačních databází, je běžné dotazy načítat data z více, související tabulky.</span><span class="sxs-lookup"><span data-stu-id="28e0d-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="28e0d-285">Korelační poddotazy a `JOIN` s zadejte dvě různé metody pro přístup k datům ze souvisejících tabulek v dotazu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="28e0d-286">V předchozích kurzy jsme provedli nejčastěji použít korelační poddotazů, protože TableAdapter nelze automaticky generovat `INSERT`, `UPDATE`, a `DELETE` příkazy pro dotazy zahrnující `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="28e0d-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="28e0d-287">Při tyto hodnoty lze zadat ručně, při použití příkazů SQL ad-hoc po dokončení Průvodce konfigurací TableAdapter se přepíší všechna vlastní nastavení.</span><span class="sxs-lookup"><span data-stu-id="28e0d-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="28e0d-288">Naštěstí TableAdapters vytvořené pomocí uložené procedury se nebude vyskytovat ze stejné brittleness jako vytvořené pomocí příkazů SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="28e0d-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="28e0d-289">Proto je vhodná k vytváření TableAdapter jejichž hlavní dotaz používá `JOIN` při použití uložených procedur.</span><span class="sxs-lookup"><span data-stu-id="28e0d-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="28e0d-290">V tomto kurzu jsme viděli, jak vytvořit takové TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="28e0d-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="28e0d-291">Spuštění pomocí `JOIN`-menší `SELECT` dotazu TableAdapter s hlavním dotazu tak, aby odpovídající insert, update a delete uložené procedury bude vytvořen automaticky.</span><span class="sxs-lookup"><span data-stu-id="28e0d-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="28e0d-292">TableAdapter s počáteční dokončení konfigurace, jsme rozšířen `SelectCommand` uložené procedury sloužící `JOIN` a znovu se spustil Průvodce konfigurací TableAdapter aktualizovat `EmployeesDataTable` sloupce s.</span><span class="sxs-lookup"><span data-stu-id="28e0d-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="28e0d-293">Opětovné spuštění Průvodce konfigurací TableAdapter automaticky aktualizuje `EmployeesDataTable` sloupce tak, aby odrážela datová pole vrácené `Employees_Select` uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="28e0d-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="28e0d-294">Alternativně jsme může přidali tyto sloupce ručně do DataTable.</span><span class="sxs-lookup"><span data-stu-id="28e0d-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="28e0d-295">Se podíváme na ruční přidávání sloupců do DataTable v dalším kurzu.</span><span class="sxs-lookup"><span data-stu-id="28e0d-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="28e0d-296">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="28e0d-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="28e0d-297">O autorovi</span><span class="sxs-lookup"><span data-stu-id="28e0d-297">About the Author</span></span>

<span data-ttu-id="28e0d-298">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a zakladatele z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje s technologií Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="28e0d-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="28e0d-299">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="28e0d-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="28e0d-300">Jeho nejnovější seznam k [ *Edice nakladatelství Sams naučit sami technologii ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="28e0d-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="28e0d-301">Dosažitelný v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu, který najdete na [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="28e0d-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="28e0d-302">Zvláštní poděkování</span><span class="sxs-lookup"><span data-stu-id="28e0d-302">Special Thanks To</span></span>

<span data-ttu-id="28e0d-303">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="28e0d-303">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="28e0d-304">Vést kontroloři pro účely tohoto kurzu byly Hilton Geisenow David Suru a Teresy Murphy.</span><span class="sxs-lookup"><span data-stu-id="28e0d-304">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="28e0d-305">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="28e0d-305">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="28e0d-306">Pokud ano, vyřaďte mi řádek v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="28e0d-306">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="28e0d-307">[Předchozí](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [další](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="28e0d-307">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
