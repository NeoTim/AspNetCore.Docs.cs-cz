---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb
title: "Provádění dávkové aktualizace (VB) | Microsoft Docs"
author: rick-anderson
description: "Naučte se vytvářet plně nelze upravit upravit DataList, kde jsou všechny jeho položky v režimu a jejichž hodnoty můžete uložit kliknutím tlačítko Aktualizovat vše na..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: 8dac22a7-91de-4e3b-888f-a4c438b03851
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb
msc.type: authoredcontent
ms.openlocfilehash: df22a7c4aedb5e5fef183817e9d2b1e4c4a919ee
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2018
---
<a name="performing-batch-updates-vb"></a><span data-ttu-id="09b37-103">Provádění dávkové aktualizace (VB)</span><span class="sxs-lookup"><span data-stu-id="09b37-103">Performing Batch Updates (VB)</span></span>
====================
<span data-ttu-id="09b37-104">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="09b37-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="09b37-105">[Stáhněte si ukázkovou aplikaci](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_VB.exe) nebo [stáhnout PDF](performing-batch-updates-vb/_static/datatutorial37vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="09b37-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_VB.exe) or [Download PDF](performing-batch-updates-vb/_static/datatutorial37vb1.pdf)</span></span>

> <span data-ttu-id="09b37-106">Naučte se vytvářet plně nelze upravit upravit DataList, kde jsou všechny jeho položky v režimu a jejichž hodnoty můžete uložit kliknutím tlačítko "Vše aktualizace" na stránce.</span><span class="sxs-lookup"><span data-stu-id="09b37-106">Learn how to create a fully-editable DataList where all of its items are in edit mode and whose values can be saved by clicking an "Update All" button on the page.</span></span>


## <a name="introduction"></a><span data-ttu-id="09b37-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="09b37-107">Introduction</span></span>

<span data-ttu-id="09b37-108">V [předchozí kurzu](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md) jsme se zaměřili na tom, jak vytvořit DataList na úrovni položek.</span><span class="sxs-lookup"><span data-stu-id="09b37-108">In the [preceding tutorial](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md) we examined how to create an item-level DataList.</span></span> <span data-ttu-id="09b37-109">Jako standardní upravitelné GridView každou položku v prvku DataList zahrnuté tlačítko upravíte, při kliknutí na, by zkontrolujte položky upravovat.</span><span class="sxs-lookup"><span data-stu-id="09b37-109">Like the standard editable GridView, each item in the DataList included an Edit button that, when clicked, would make the item editable.</span></span> <span data-ttu-id="09b37-110">Když to úrovni položek úpravy funguje dobře pro data, která je jenom příležitostně aktualizovat, určitých scénářích případů použití vyžadovat, aby uživatel k úpravě mnoho záznamů.</span><span class="sxs-lookup"><span data-stu-id="09b37-110">While this item-level editing works well for data that is only updated occasionally, certain use case scenarios require the user to edit many records.</span></span> <span data-ttu-id="09b37-111">Pokud je uživatel nemůže upravovat desítek záznamů a je nucen se klikněte na tlačítko Upravit, změnit jejich a kliknutím na tlačítko Aktualizovat u každé z nich, může omezovat množství kliknutím na jeho produktivitu.</span><span class="sxs-lookup"><span data-stu-id="09b37-111">If a user needs to edit dozens of records and is forced to click Edit, make their changes, and click Update for each one, the amount of clicking can hamper her productivity.</span></span> <span data-ttu-id="09b37-112">V takových situacích je lepší volbou poskytnout plně upravitelné DataList, kde jeden *všechny* jeho položek jsou v režimu úprav a jejichž hodnoty můžete upravit kliknutím tlačítko Aktualizovat vše na stránce (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="09b37-112">In such situations, a better option is to provide a fully-editable DataList, one where *all* of its items are in edit mode and whose values can be edited by clicking an Update All button on the page (see Figure 1).</span></span>


<span data-ttu-id="09b37-113">[![Každá položka v plně upravitelné DataList je možné upravit.](performing-batch-updates-vb/_static/image2.png)](performing-batch-updates-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="09b37-113">[![Each Item in a Fully Editable DataList can be Modified](performing-batch-updates-vb/_static/image2.png)](performing-batch-updates-vb/_static/image1.png)</span></span>

<span data-ttu-id="09b37-114">**Obrázek 1**: je možné upravit každou položku ve plně upravitelné DataList ([Kliknutím zobrazit obrázek v plné velikosti](performing-batch-updates-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="09b37-114">**Figure 1**: Each Item in a Fully Editable DataList can be Modified ([Click to view full-size image](performing-batch-updates-vb/_static/image3.png))</span></span>


<span data-ttu-id="09b37-115">V tomto kurzu podíváme, jak povolit uživatelům aktualizovat informace o adrese dodavatelé pomocí plně upravitelné DataList.</span><span class="sxs-lookup"><span data-stu-id="09b37-115">In this tutorial we'll examine how to enable users to update suppliers address information using a fully editable DataList.</span></span>

## <a name="step-1-create-the-editable-user-interface-in-the-datalist-s-itemtemplate"></a><span data-ttu-id="09b37-116">Krok 1: Vytvoření upravitelné uživatelské rozhraní ve vlastnosti ItemTemplate s</span><span class="sxs-lookup"><span data-stu-id="09b37-116">Step 1: Create the Editable User Interface in the DataList s ItemTemplate</span></span>

<span data-ttu-id="09b37-117">V předchozím kurzu, kde vytváření upravitelné DataList standardní, na úrovni položek, jsme použili jsme dvě šablony:</span><span class="sxs-lookup"><span data-stu-id="09b37-117">In the preceding tutorial, where we creating a standard, item-level editable DataList, we used two templates:</span></span>

- <span data-ttu-id="09b37-118">`ItemTemplate`obsahuje jen pro čtení uživatelské rozhraní (popisek webové ovládací prvky zobrazení každý s názvem produktu a ceny).</span><span class="sxs-lookup"><span data-stu-id="09b37-118">`ItemTemplate` contained the read-only user interface (the Label Web controls for displaying each product s name and price).</span></span>
- <span data-ttu-id="09b37-119">`EditItemTemplate`obsahuje úpravy režimu uživatelské rozhraní (dva textové pole webové kontroly).</span><span class="sxs-lookup"><span data-stu-id="09b37-119">`EditItemTemplate` contained the edit mode user interface (the two TextBox Web controls).</span></span>

<span data-ttu-id="09b37-120">DataList s `EditItemIndex` vlastnost stanoví, co `DataListItem` (pokud existuje) je vykreslen pomocí `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="09b37-120">The DataList s `EditItemIndex` property dictates what `DataListItem` (if any) is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="09b37-121">Konkrétně `DataListItem` jejichž `ItemIndex` hodnota odpovídá DataList s `EditItemIndex` vlastnost je vykreslen pomocí `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="09b37-121">In particular, the `DataListItem` whose `ItemIndex` value matches the DataList s `EditItemIndex` property is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="09b37-122">Tento model funguje dobře, pokud lze upravit jen jednu položku na dobu, ale od sebe spadá při vytváření plně upravitelné DataList.</span><span class="sxs-lookup"><span data-stu-id="09b37-122">This model works well when only one item can be edited at a time, but falls apart when creating a fully-editable DataList.</span></span>

<span data-ttu-id="09b37-123">Pro plně upravitelné DataList, chceme *všechny* z `DataListItem` s k vykreslení pomocí rozhraní upravovat.</span><span class="sxs-lookup"><span data-stu-id="09b37-123">For a fully editable DataList, we want *all* of the `DataListItem` s to render using the editable interface.</span></span> <span data-ttu-id="09b37-124">Nejjednodušší způsob, jak se má definovat upravitelné rozhraní v `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="09b37-124">The simplest way to accomplish this is to define the editable interface in the `ItemTemplate`.</span></span> <span data-ttu-id="09b37-125">Úpravy informace o adrese dodavatelů, upravovat rozhraní obsahuje název dodavatele jako text a pak textová pole pro adresu, Město a země hodnoty.</span><span class="sxs-lookup"><span data-stu-id="09b37-125">For modifying the suppliers address information, the editable interface contains the supplier name as text and then TextBoxes for the address, city, and country values.</span></span>

<span data-ttu-id="09b37-126">Začněte otevřením `BatchUpdate.aspx` stránky, přidání ovládacího prvku DataList a nastavit jeho `ID` vlastnost `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="09b37-126">Start by opening the `BatchUpdate.aspx` page, add a DataList control, and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="09b37-127">Z inteligentních značek DataList s opt přidání nové ovládacího prvku ObjectDataSource s názvem `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="09b37-127">From the DataList s smart tag, opt to add a new ObjectDataSource control named `SuppliersDataSource`.</span></span>


<span data-ttu-id="09b37-128">[![Vytvořit nový ObjectDataSource s názvem SuppliersDataSource](performing-batch-updates-vb/_static/image5.png)](performing-batch-updates-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="09b37-128">[![Create a New ObjectDataSource Named SuppliersDataSource](performing-batch-updates-vb/_static/image5.png)](performing-batch-updates-vb/_static/image4.png)</span></span>

<span data-ttu-id="09b37-129">**Obrázek 2**: vytvoření nové ObjectDataSource s názvem `SuppliersDataSource` ([Kliknutím zobrazit obrázek v plné velikosti](performing-batch-updates-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="09b37-129">**Figure 2**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](performing-batch-updates-vb/_static/image6.png))</span></span>


<span data-ttu-id="09b37-130">Konfigurace ObjectDataSource k načtení dat pomocí `SuppliersBLL` třídu s `GetSuppliers()` – metoda (viz obrázek 3).</span><span class="sxs-lookup"><span data-stu-id="09b37-130">Configure the ObjectDataSource to retrieve data using the `SuppliersBLL` class s `GetSuppliers()` method (see Figure 3).</span></span> <span data-ttu-id="09b37-131">Stejně jako u předchozí kurz, nikoli aktualizaci informací dodavatele prostřednictvím ObjectDataSource, jsme budete pracovat přímo s vrstvu obchodní logiky.</span><span class="sxs-lookup"><span data-stu-id="09b37-131">As with the preceding tutorial, rather than updating the supplier information through the ObjectDataSource, we'll work directly with the Business Logic Layer.</span></span> <span data-ttu-id="09b37-132">Proto nastavit rozevíracím seznamu (None) na kartě aktualizace (viz obrázek 4).</span><span class="sxs-lookup"><span data-stu-id="09b37-132">Therefore, set the drop-down list to (None) in the UPDATE tab (see Figure 4).</span></span>


<span data-ttu-id="09b37-133">[![Načíst informace o dodavateli metodou GetSuppliers()](performing-batch-updates-vb/_static/image8.png)](performing-batch-updates-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="09b37-133">[![Retrieve Supplier Information Using the GetSuppliers() Method](performing-batch-updates-vb/_static/image8.png)](performing-batch-updates-vb/_static/image7.png)</span></span>

<span data-ttu-id="09b37-134">**Obrázek 3**: načtení dodavatele informací pomocí `GetSuppliers()` – metoda ([Kliknutím zobrazit obrázek v plné velikosti](performing-batch-updates-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="09b37-134">**Figure 3**: Retrieve Supplier Information Using the `GetSuppliers()` Method ([Click to view full-size image](performing-batch-updates-vb/_static/image9.png))</span></span>


<span data-ttu-id="09b37-135">[![Nastavit rozevíracím seznamu (None) na kartě aktualizace](performing-batch-updates-vb/_static/image11.png)](performing-batch-updates-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="09b37-135">[![Set the Drop-Down List to (None) in the UPDATE Tab](performing-batch-updates-vb/_static/image11.png)](performing-batch-updates-vb/_static/image10.png)</span></span>

<span data-ttu-id="09b37-136">**Obrázek 4**: nastavit rozevíracím seznamu (None) na kartě aktualizace ([Kliknutím zobrazit obrázek v plné velikosti](performing-batch-updates-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="09b37-136">**Figure 4**: Set the Drop-Down List to (None) in the UPDATE Tab ([Click to view full-size image](performing-batch-updates-vb/_static/image12.png))</span></span>


<span data-ttu-id="09b37-137">Po dokončení průvodce, Visual Studio automaticky vygeneruje DataList s `ItemTemplate` pro každé datové pole vrácené zdroji dat v ovládacím prvku popisek webové zobrazení.</span><span class="sxs-lookup"><span data-stu-id="09b37-137">After completing the wizard, Visual Studio automatically generates the DataList s `ItemTemplate` to display each data field returned by the data source in a Label Web control.</span></span> <span data-ttu-id="09b37-138">Potřebujeme upravit tuto šablonu tak, aby místo toho poskytuje rozhraní pro úpravy.</span><span class="sxs-lookup"><span data-stu-id="09b37-138">We need to modify this template so that it provides the editing interface instead.</span></span> <span data-ttu-id="09b37-139">`ItemTemplate` Lze přizpůsobit pomocí Designer pomocí možnosti Upravit šablony ze DataList s inteligentním nebo přímo pomocí deklarativní syntaxe.</span><span class="sxs-lookup"><span data-stu-id="09b37-139">The `ItemTemplate` can be customized through the Designer using the Edit Templates option from the DataList s smart tag or directly through the declarative syntax.</span></span>

<span data-ttu-id="09b37-140">Za chvíli vytvořit úpravy rozhraní, které zobrazuje název dodavatele s jako text, ale zahrnuje textová pole pro adresu s jiného dodavatele, Město a země hodnoty.</span><span class="sxs-lookup"><span data-stu-id="09b37-140">Take a moment to create an editing interface that displays the supplier s name as text, but includes TextBoxes for the supplier s address, city, and country values.</span></span> <span data-ttu-id="09b37-141">Po provedení těchto změn, deklarativní syntaxi stránky s by měl vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="09b37-141">After making these changes, your page s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](performing-batch-updates-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="09b37-142">Jako u předchozí kurzu DataList v tomto kurzu musí mít svůj stav zobrazení, které jsou povolené.</span><span class="sxs-lookup"><span data-stu-id="09b37-142">As with the preceding tutorial, the DataList in this tutorial must have its view state enabled.</span></span>


<span data-ttu-id="09b37-143">V `ItemTemplate` I m pomocí dva nové třídy CSS, `SupplierPropertyLabel` a `SupplierPropertyValue`, které jsou přidané do `Styles.css` třídy a nakonfigurovaná pro použití stejné nastavení jako styl `ProductPropertyLabel` a `ProductPropertyValue` tříd CSS.</span><span class="sxs-lookup"><span data-stu-id="09b37-143">In the `ItemTemplate` I m using two new CSS classes, `SupplierPropertyLabel` and `SupplierPropertyValue`, which have been added to the `Styles.css` class and configured to use the same style settings as the `ProductPropertyLabel` and `ProductPropertyValue` CSS classes.</span></span>


[!code-css[Main](performing-batch-updates-vb/samples/sample2.css)]

<span data-ttu-id="09b37-144">Po provedení těchto změn, najdete na této stránce prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="09b37-144">After making these changes, visit this page through a browser.</span></span> <span data-ttu-id="09b37-145">Jak je vidět na obrázku 5, každá položka DataList zobrazí název dodavatele jako text a pomocí textových polí zobrazí adresa, Město a zemi.</span><span class="sxs-lookup"><span data-stu-id="09b37-145">As Figure 5 shows, each DataList item displays the supplier name as text and uses TextBoxes to display the address, city, and country.</span></span>


<span data-ttu-id="09b37-146">[![Každý poskytovatel v prvku DataList není upravit](performing-batch-updates-vb/_static/image14.png)](performing-batch-updates-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="09b37-146">[![Each Supplier in the DataList is Editable](performing-batch-updates-vb/_static/image14.png)](performing-batch-updates-vb/_static/image13.png)</span></span>

<span data-ttu-id="09b37-147">**Obrázek 5**: každý dodavatele v prvku DataList je upravit ([Kliknutím zobrazit obrázek v plné velikosti](performing-batch-updates-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="09b37-147">**Figure 5**: Each Supplier in the DataList is Editable ([Click to view full-size image](performing-batch-updates-vb/_static/image15.png))</span></span>


## <a name="step-2-adding-an-update-all-button"></a><span data-ttu-id="09b37-148">Krok 2: Přidání aktualizaci všech tlačítko</span><span class="sxs-lookup"><span data-stu-id="09b37-148">Step 2: Adding an Update All Button</span></span>

<span data-ttu-id="09b37-149">Při každé dodavatele z obrázku 5, má svou adresu, města a zobrazí do textového pole. pole země, aktuálně není aktualizace tlačítko k dispozici.</span><span class="sxs-lookup"><span data-stu-id="09b37-149">While each supplier in Figure 5 has its address, city, and country fields displayed in a TextBox, there currently is no Update button available.</span></span> <span data-ttu-id="09b37-150">Místo na tlačítko Aktualizovat na položku, s plně upravitelné DataLists je obvykle jedno tlačítko Aktualizovat vše na stránce, která po kliknutí na aktualizace *všechny* záznamy v prvku DataList.</span><span class="sxs-lookup"><span data-stu-id="09b37-150">Rather than having an Update button per item, with fully editable DataLists there is typically a single Update All button on the page that, when clicked, updates *all* of the records in the DataList.</span></span> <span data-ttu-id="09b37-151">V tomto kurzu mohli s přidat dvě Aktualizovat vše tlačítka – jeden v horní části stránky a jeden v dolní části (i když kliknete na tlačítko buď bude mít stejný účinek).</span><span class="sxs-lookup"><span data-stu-id="09b37-151">For this tutorial, let s add two Update All buttons - one at the top of the page and one at the bottom (although clicking either button will have the same effect).</span></span>

<span data-ttu-id="09b37-152">Spuštění přidáním ovládacího prvku tlačítko webové nad DataList a sadu jeho `ID` vlastnost `UpdateAll1`.</span><span class="sxs-lookup"><span data-stu-id="09b37-152">Start by adding a Button Web control above the DataList and set its `ID` property to `UpdateAll1`.</span></span> <span data-ttu-id="09b37-153">V dalším kroku přidejte druhý ovládací prvek tlačítko webu pod DataList, nastavení jeho `ID` k `UpdateAll2`.</span><span class="sxs-lookup"><span data-stu-id="09b37-153">Next, add the second Button Web control beneath the DataList, setting its `ID` to `UpdateAll2`.</span></span> <span data-ttu-id="09b37-154">Nastavte `Text` vlastnosti pro dvě tlačítka Aktualizovat vše.</span><span class="sxs-lookup"><span data-stu-id="09b37-154">Set the `Text` properties for the two Buttons to Update All.</span></span> <span data-ttu-id="09b37-155">Nakonec vytváření obslužných rutin událostí pro obě tlačítka `Click` události.</span><span class="sxs-lookup"><span data-stu-id="09b37-155">Lastly, create event handlers for both Buttons `Click` events.</span></span> <span data-ttu-id="09b37-156">Místo duplikování logiku aktualizace v každé z obslužné rutiny událostí, umožňují s Refaktorovat tuto logiku třetí metodu, `UpdateAllSupplierAddresses`, s obslužné rutiny událostí jednoduše volání této metody třetí.</span><span class="sxs-lookup"><span data-stu-id="09b37-156">Rather than duplicating the update logic in each of the event handlers, let s refactor that logic to a third method, `UpdateAllSupplierAddresses`, having the event handlers simply invoking this third method.</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample3.vb)]

<span data-ttu-id="09b37-157">Obrázek 6 zobrazuje stránku po přidání tlačítka Aktualizovat vše.</span><span class="sxs-lookup"><span data-stu-id="09b37-157">Figure 6 shows the page after the Update All buttons have been added.</span></span>


<span data-ttu-id="09b37-158">[![Dvě tlačítka všechny aktualizace byly přidány na stránku](performing-batch-updates-vb/_static/image17.png)](performing-batch-updates-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="09b37-158">[![Two Update All Buttons have been Added to the Page](performing-batch-updates-vb/_static/image17.png)](performing-batch-updates-vb/_static/image16.png)</span></span>

<span data-ttu-id="09b37-159">**Obrázek 6**: dvě tlačítka všechny aktualizace byly přidány na stránku ([Kliknutím zobrazit obrázek v plné velikosti](performing-batch-updates-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="09b37-159">**Figure 6**: Two Update All Buttons have been Added to the Page ([Click to view full-size image](performing-batch-updates-vb/_static/image18.png))</span></span>


## <a name="step-3-updating-all-of-the-suppliers-address-information"></a><span data-ttu-id="09b37-160">Krok 3: Aktualizace všechny informace o adrese dodavatelů</span><span class="sxs-lookup"><span data-stu-id="09b37-160">Step 3: Updating All of the Suppliers Address Information</span></span>

<span data-ttu-id="09b37-161">S všechny položky s DataList zobrazení úpravy rozhraní a přidání tlačítka Aktualizovat všechny všechno, co zůstane zapisuje kód k provedení aktualizace dávky.</span><span class="sxs-lookup"><span data-stu-id="09b37-161">With all of the DataList s items displaying the editing interface and with the addition of the Update All buttons, all that remains is writing the code to perform the batch update.</span></span> <span data-ttu-id="09b37-162">Konkrétně budeme muset projít DataList s položky a volání `SuppliersBLL` třídu s `UpdateSupplierAddress` metoda pro každé z nich.</span><span class="sxs-lookup"><span data-stu-id="09b37-162">Specifically, we need to loop through the DataList s items and call the `SuppliersBLL` class s `UpdateSupplierAddress` method for each one.</span></span>

<span data-ttu-id="09b37-163">Kolekce `DataListItem` instance tento způsob vytvoření prvku DataList je přístupná prostřednictvím DataList s [ `Items` vlastnost](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx).</span><span class="sxs-lookup"><span data-stu-id="09b37-163">The collection of `DataListItem` instances that makeup the DataList can be accessed via the DataList s [`Items` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx).</span></span> <span data-ttu-id="09b37-164">S odkazem na `DataListItem`, jsme můžete získat odpovídající `SupplierID` z `DataKeys` kolekce a programově TextBox webové ovládací prvky v rámci odkaz `ItemTemplate` jak ukazuje následující kód:</span><span class="sxs-lookup"><span data-stu-id="09b37-164">With a reference to a `DataListItem`, we can grab the corresponding `SupplierID` from the `DataKeys` collection and programmatically reference the TextBox Web controls within the `ItemTemplate` as the following code illustrates:</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample4.vb)]

<span data-ttu-id="09b37-165">Po klepnutí na Aktualizovat vše tlačítka `UpdateAllSupplierAddresses` metoda iteruje v rámci každé `DataListItem` v `Suppliers` DataList a volání `SuppliersBLL` třídu s `UpdateSupplierAddress` metody předávání v odpovídající hodnoty.</span><span class="sxs-lookup"><span data-stu-id="09b37-165">When the user clicks one of the Update All buttons, the `UpdateAllSupplierAddresses` method iterates through each `DataListItem` in the `Suppliers` DataList and calls the `SuppliersBLL` class s `UpdateSupplierAddress` method, passing in the corresponding values.</span></span> <span data-ttu-id="09b37-166">Hodnota je hodnota není zadaná pro adresu, město nebo země předává `Nothing` k `UpdateSupplierAddress` (místo prázdný řetězec), což vede databázi `NULL` pro základní pole záznamu s.</span><span class="sxs-lookup"><span data-stu-id="09b37-166">A non-entered value for address, city, or country passes is a value of `Nothing` to `UpdateSupplierAddress` (rather than a blank string), which results in a database `NULL` for the underlying record s fields.</span></span>

> [!NOTE]
> <span data-ttu-id="09b37-167">Jako vylepšení můžete přidat stav ovládací prvek popisek webu na stránku, která po provedení aktualizace batch poskytuje některé potvrzovací zpráva.</span><span class="sxs-lookup"><span data-stu-id="09b37-167">As an enhancement, you may want to add a status Label Web control to the page that provides some confirmation message after the batch update is performed.</span></span>


## <a name="updating-only-those-addresses-that-have-been-modified"></a><span data-ttu-id="09b37-168">Aktualizace pouze adresy, které byly upraveny</span><span class="sxs-lookup"><span data-stu-id="09b37-168">Updating Only Those Addresses That Have Been Modified</span></span>

<span data-ttu-id="09b37-169">Algoritmus aktualizace batch použít pro tento kurz volání `UpdateSupplierAddress` metodu pro *každých* dodavatele v DataList, bez ohledu na to, jestli se změnil informace o jejich adres.</span><span class="sxs-lookup"><span data-stu-id="09b37-169">The batch update algorithm used for this tutorial calls the `UpdateSupplierAddress` method for *every* supplier in the DataList, regardless of whether their address information has been changed.</span></span> <span data-ttu-id="09b37-170">Při takové blind aktualizací t nejsou obvykle problémy výkonem, mohou vést nadbytečné záznamy li níž auditování změn do databázové tabulky.</span><span class="sxs-lookup"><span data-stu-id="09b37-170">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="09b37-171">Například, pokud používáte k zaznamenání všechny aktivační události `UPDATE` s k `Suppliers` tabulka, která se auditování tabulka pokaždé, když uživatel klikne na tlačítko Aktualizovat vše nový záznam auditu budou vytvořeny pro každého dodavatele v systému, bez ohledu na to, jestli uživatel provedeny žádné změny.</span><span class="sxs-lookup"><span data-stu-id="09b37-171">For example, if you use triggers to record all `UPDATE` s to the `Suppliers` table to an auditing table, every time a user clicks the Update All button a new audit record will be created for each supplier in the system, regardless of whether the user made any changes.</span></span>

<span data-ttu-id="09b37-172">Třídy ADO.NET DataTable a DataAdapter jsou navrženy pro podporu dávková aktualizace kde pouze změny, odstraněných a nové záznamy výsledkem komunikace žádné databáze.</span><span class="sxs-lookup"><span data-stu-id="09b37-172">The ADO.NET DataTable and DataAdapter classes are designed to support batch updates where only modified, deleted, and new records results in any database communication.</span></span> <span data-ttu-id="09b37-173">Každý řádek v DataTable má [ `RowState` vlastnost](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) určující, zda řádek byl přidán do DataTable, z ho změnit, odstranit nebo zůstává beze změny.</span><span class="sxs-lookup"><span data-stu-id="09b37-173">Each row in the DataTable has a [`RowState` property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) that indicates whether the row has been added to the DataTable, deleted from it, modified, or remains unchanged.</span></span> <span data-ttu-id="09b37-174">Pokud původně naplnění DataTable všechny řádky jsou označeny beze změny.</span><span class="sxs-lookup"><span data-stu-id="09b37-174">When a DataTable is initially populated, all rows are marked unchanged.</span></span> <span data-ttu-id="09b37-175">Změna hodnoty sloupce s řádků označí řádek, jako je upravit.</span><span class="sxs-lookup"><span data-stu-id="09b37-175">Changing the value of any of the row s columns marks the row as modified.</span></span>

<span data-ttu-id="09b37-176">V `SuppliersBLL` jsme aktualizovat informace o adrese zadané dodavatele s první čtení v záznamu o jediného poskytovatele do třídy `SuppliersDataTable` a poté nastavte `Address`, `City`, a `Country` hodnoty ve sloupcích pomocí následujícího kódu:</span><span class="sxs-lookup"><span data-stu-id="09b37-176">In the `SuppliersBLL` class we update the specified supplier s address information by first reading in the single supplier record into a `SuppliersDataTable` and then set the `Address`, `City`, and `Country` column values using the following code:</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample5.vb)]

<span data-ttu-id="09b37-177">Tento kód naively přiřadí předané adresu, Město a země hodnoty `SuppliersRow` v `SuppliersDataTable` bez ohledu na to, zda hodnoty změnily.</span><span class="sxs-lookup"><span data-stu-id="09b37-177">This code naively assigns the passed-in address, city, and country values to the `SuppliersRow` in the `SuppliersDataTable` regardless of whether or not the values have changed.</span></span> <span data-ttu-id="09b37-178">Tyto úpravy způsobit, že `SuppliersRow` s `RowState` vlastnost, která má být označena jako upravená.</span><span class="sxs-lookup"><span data-stu-id="09b37-178">These modifications cause the `SuppliersRow` s `RowState` property to be marked as modified.</span></span> <span data-ttu-id="09b37-179">Při Data Access Layer s `Update` metoda je volána, se zobrazí, který `SupplierRow` byl upraven a proto odešle `UPDATE` příkazu k databázi.</span><span class="sxs-lookup"><span data-stu-id="09b37-179">When the Data Access Layer s `Update` method is called, it sees that the `SupplierRow` has been modified and therefore sends an `UPDATE` command to the database.</span></span>

<span data-ttu-id="09b37-180">Představte si, ale, že jsme přidali kód pro tuto metodu za účelem pouze přiřadit předané adresu, Město a hodnoty země, pokud se liší od `SuppliersRow` s existující hodnoty.</span><span class="sxs-lookup"><span data-stu-id="09b37-180">Imagine, however, that we added code to this method to only assign the passed-in address, city, and country values if they differ from the `SuppliersRow` s existing values.</span></span> <span data-ttu-id="09b37-181">V případě, kdy stejný jako stávající data jsou adresy, města a země, nebudou provedeny žádné změny a `SupplierRow` s `RowState` nebude změněno vlevo označen jako.</span><span class="sxs-lookup"><span data-stu-id="09b37-181">In the case where the address, city, and country are the same as the existing data, no changes will be made and the `SupplierRow` s `RowState` will be left marked as unchanged.</span></span> <span data-ttu-id="09b37-182">Net výsledkem je, že když DAL s `Update` metoda je volána, bez volání databáze bude možné provést, protože `SuppliersRow` nebyl změněn.</span><span class="sxs-lookup"><span data-stu-id="09b37-182">The net result is that when the DAL s `Update` method is called, no database call will be made because the `SuppliersRow` has not been modified.</span></span>

<span data-ttu-id="09b37-183">Chcete-li tato změna uplatní, nahraďte příkazy, které slepě přiřazení adres předané, města a země hodnoty následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="09b37-183">To enact this change, replace the statements that blindly assign the passed-in address, city, and country values with the following code:</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample6.vb)]

<span data-ttu-id="09b37-184">S tímto přidali kód, DAL s `Update` metoda odešle `UPDATE` příkaz pro databázi pouze záznamy, jejichž hodnoty související s adresu změnily.</span><span class="sxs-lookup"><span data-stu-id="09b37-184">With this added code, the DAL s `Update` method sends an `UPDATE` statement to the database for only those records whose address-related values have changed.</span></span>

<span data-ttu-id="09b37-185">Alternativně jsme může sledovat jestli existují případné rozdíly mezi pole předané adresy a databázových dat a, pokud jsou none, jednoduše vynechat volání DAL s `Update` metoda.</span><span class="sxs-lookup"><span data-stu-id="09b37-185">Alternatively, we could keep track of whether there are any differences between the passed-in address fields and the database data and, if there are none, simply bypass the call to the DAL s `Update` method.</span></span> <span data-ttu-id="09b37-186">Tento postup funguje dobře v případě, že níž pomocí databáze přímá metoda, protože předán t DB přímá metoda neběží `SuppliersRow` instance, jehož `RowState` lze zkontrolovat, určete, zda je skutečně potřeba volání databáze.</span><span class="sxs-lookup"><span data-stu-id="09b37-186">This approach works well if you re using the DB direct method, since the DB direct method isn t passed a `SuppliersRow` instance whose `RowState` can be checked to determine whether a database call is actually needed.</span></span>

> [!NOTE]
> <span data-ttu-id="09b37-187">Pokaždé, když `UpdateSupplierAddress` metoda je volána, k načtení informací o aktualizovaný záznam Přišla žádost o do databáze.</span><span class="sxs-lookup"><span data-stu-id="09b37-187">Each time the `UpdateSupplierAddress` method is invoked, a call is made to the database to retrieve information about the updated record.</span></span> <span data-ttu-id="09b37-188">Poté pokud existují změny v datech, jiné do databáze Přišla žádost o aktualizaci řádku tabulky.</span><span class="sxs-lookup"><span data-stu-id="09b37-188">Then, if there are any changes in data, another call to the database is made to update the table row.</span></span> <span data-ttu-id="09b37-189">Tento pracovní postup může být optimalizovaná tak, že vytvoříte `UpdateSupplierAddress` přetížení metody, která přijímá `EmployeesDataTable` instanci, která má *všechny* změn z `BatchUpdate.aspx` stránky.</span><span class="sxs-lookup"><span data-stu-id="09b37-189">This workflow could be optimized by creating an `UpdateSupplierAddress` method overload that accepts an `EmployeesDataTable` instance that has *all* of the changes from the `BatchUpdate.aspx` page.</span></span> <span data-ttu-id="09b37-190">Poté může nastavit jeden volání do databáze s cílem získat všechny záznamy z `Suppliers` tabulky.</span><span class="sxs-lookup"><span data-stu-id="09b37-190">Then, it could make one call to the database to get all of the records from the `Suppliers` table.</span></span> <span data-ttu-id="09b37-191">Dva resultsets pak ve výčtu a nelze ji aktualizovat pouze záznamy, kde mají změny došlo k chybě.</span><span class="sxs-lookup"><span data-stu-id="09b37-191">The two resultsets could then be enumerated and only those records where changes have occurred could be updated.</span></span>


## <a name="summary"></a><span data-ttu-id="09b37-192">Souhrn</span><span class="sxs-lookup"><span data-stu-id="09b37-192">Summary</span></span>

<span data-ttu-id="09b37-193">V tomto kurzu jsme viděli, jak vytvořit plně upravitelné DataList, umožňuje uživatelům rychle změnit informace o adrese pro více dodavatelů.</span><span class="sxs-lookup"><span data-stu-id="09b37-193">In this tutorial we saw how to create a fully editable DataList, allowing a user to quickly modify the address information for multiple suppliers.</span></span> <span data-ttu-id="09b37-194">Spuštění definováním úpravy rozhraní ovládacího prvku webového textového pole pro adresu s jiného dodavatele, města a země hodnoty v DataList s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="09b37-194">We started by defining the editing interface a TextBox Web control for the supplier s address, city, and country values in the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="09b37-195">V dalším kroku jsme přidali Aktualizovat vše tlačítka nahoru a dolů DataList.</span><span class="sxs-lookup"><span data-stu-id="09b37-195">Next, we added Update All buttons above and below the DataList.</span></span> <span data-ttu-id="09b37-196">Poté, co uživatel má jeho změny a kliknutí na jednu z tlačítka Aktualizovat vše `DataListItem` s jsou uvedené a volání `SuppliersBLL` třídu s `UpdateSupplierAddress` metoda provádí.</span><span class="sxs-lookup"><span data-stu-id="09b37-196">After a user has made his changes and clicked one of the Update All buttons, the `DataListItem` s are enumerated and a call to the `SuppliersBLL` class s `UpdateSupplierAddress` method is made.</span></span>

<span data-ttu-id="09b37-197">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="09b37-197">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="09b37-198">O autorovi</span><span class="sxs-lookup"><span data-stu-id="09b37-198">About the Author</span></span>

<span data-ttu-id="09b37-199">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a zakladatele z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje s technologií Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="09b37-199">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="09b37-200">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="09b37-200">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="09b37-201">Jeho nejnovější seznam k [ *Edice nakladatelství Sams naučit sami technologii ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="09b37-201">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="09b37-202">Dosažitelný v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu, který najdete na [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="09b37-202">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="09b37-203">Zvláštní poděkování</span><span class="sxs-lookup"><span data-stu-id="09b37-203">Special Thanks To</span></span>

<span data-ttu-id="09b37-204">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="09b37-204">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="09b37-205">Vést kontroloři pro účely tohoto kurzu byly Zack Petr a Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="09b37-205">Lead reviewers for this tutorial were Zack Jones and Ken Pespisa.</span></span> <span data-ttu-id="09b37-206">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="09b37-206">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="09b37-207">Pokud ano, vyřaďte mi řádek v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="09b37-207">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="09b37-208">[Předchozí](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md)
[další](handling-bll-and-dal-level-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="09b37-208">[Previous](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md)
[Next](handling-bll-and-dal-level-exceptions-vb.md)</span></span>
