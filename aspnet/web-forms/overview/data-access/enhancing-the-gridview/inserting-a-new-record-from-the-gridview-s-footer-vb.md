---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: Vkládání nového záznamu z prvku GridView zápatí (VB) | Microsoft Docs
author: rick-anderson
description: Při prvek GridView neposkytuje integrovanou podporu pro vložení nového záznamu dat, tento kurz ukazuje, jak k posílení GridView zahrnout...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/06/2007
ms.topic: article
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 32f3cb23805813135bf463720e7479f5f819deb7
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888367"
---
<a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="74a7a-103">Vkládání nového záznamu z prvku GridView zápatí (VB)</span><span class="sxs-lookup"><span data-stu-id="74a7a-103">Inserting a New Record from the GridView's Footer (VB)</span></span>
====================
<span data-ttu-id="74a7a-104">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="74a7a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="74a7a-105">[Stáhněte si ukázkovou aplikaci](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) nebo [stáhnout PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="74a7a-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="74a7a-106">Při prvek GridView neposkytuje integrovanou podporu pro vložení nového záznamu dat, tento kurz ukazuje, jak k posílení GridView zahrnout vkládání rozhraní.</span><span class="sxs-lookup"><span data-stu-id="74a7a-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="74a7a-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="74a7a-107">Introduction</span></span>

<span data-ttu-id="74a7a-108">Jak je popsáno v [přehled o vložení, aktualizace a odstranění dat](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) kurz, GridView DetailsView a FormView webové ovládací prvky každý zahrnují funkce integrované dat úpravy.</span><span class="sxs-lookup"><span data-stu-id="74a7a-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="74a7a-109">Při použití s ovládacími prvky zdroje deklarativní data, tyto tři ovládací prvky webového lze rychle a snadno nastavit upravit data – a ve scénářích bez nutnosti napsat jediný řádek kódu.</span><span class="sxs-lookup"><span data-stu-id="74a7a-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="74a7a-110">Bohužel pouze ovládací prvky DetailsView a FormView poskytovat předdefinované vkládání, úpravy a odstraňování možnosti.</span><span class="sxs-lookup"><span data-stu-id="74a7a-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="74a7a-111">GridView pouze nabízí úpravy a odstraňování podpory.</span><span class="sxs-lookup"><span data-stu-id="74a7a-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="74a7a-112">S malým množstvím Pravoúhlá jeho, můžeme však posílení GridView zahrnout vkládání rozhraní.</span><span class="sxs-lookup"><span data-stu-id="74a7a-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="74a7a-113">V přidání vkládání funkcí do GridView, jsou zodpovědní za rozhodování o tom, jak nové záznamy se přidá, vytváření rozhraní vkládání a psaní kódu vložit nový záznam.</span><span class="sxs-lookup"><span data-stu-id="74a7a-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="74a7a-114">V tomto kurzu se podíváme na přidávání rozhraní vkládání do zápatí s GridView řádek (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="74a7a-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="74a7a-115">Zápatí buňky pro každý sloupec obsahuje příslušná data kolekce element uživatelského rozhraní (textové pole pro název produktu s, rozevírací seznam pro dodavatele a tak dále).</span><span class="sxs-lookup"><span data-stu-id="74a7a-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="74a7a-116">Potřebujeme sloupec pro Add tlačítko, při kliknutí na způsobit zpětné volání a vložit nový záznam do `Products` pomocí hodnoty zadané v řádku zápatí tabulky.</span><span class="sxs-lookup"><span data-stu-id="74a7a-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>


<span data-ttu-id="74a7a-117">[![Řádek zápatí poskytuje rozhraní pro přidání nové produkty](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="74a7a-118">**Obrázek 1**: řádku zápatí poskytuje rozhraní pro přidání nové produkty ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>


## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="74a7a-119">Krok 1: Zobrazení informací o produktu v GridView</span><span class="sxs-lookup"><span data-stu-id="74a7a-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="74a7a-120">Před jsme týkají označována s vytvářením rozhraní vkládání v zápatí s GridView, umožní s první zaměřit na přidávání GridView na stránku, který obsahuje seznam produktů v databázi.</span><span class="sxs-lookup"><span data-stu-id="74a7a-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="74a7a-121">Začněte otevřením `InsertThroughFooter.aspx` stránky v `EnhancedGridView` složku a přetáhněte GridView z panelu nástrojů na návrháře nastavení GridView s `ID` vlastnost `Products`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="74a7a-122">Pak pomocí inteligentních značek s GridView pro vazbu k nové ObjectDataSource s názvem `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>


<span data-ttu-id="74a7a-123">[![Vytvořit nový ObjectDataSource s názvem ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="74a7a-124">**Obrázek 2**: vytvoření nové ObjectDataSource s názvem `ProductsDataSource` ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>


<span data-ttu-id="74a7a-125">Konfigurace ObjectDataSource používat `ProductsBLL` třídu s `GetProducts()` metodu za účelem načtení informací o produktu.</span><span class="sxs-lookup"><span data-stu-id="74a7a-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="74a7a-126">V tomto kurzu umožňují zaměřit s výhradně na přidání vkládání funkcí a nestarat se o úpravy a odstranění.</span><span class="sxs-lookup"><span data-stu-id="74a7a-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="74a7a-127">Proto se ujistěte, že rozevíracím seznamu na kartě Vložení je nastavena na `AddProduct()` a jestli rozevírací seznamy na kartách aktualizace a odstranění jsou nastavené na (žádný).</span><span class="sxs-lookup"><span data-stu-id="74a7a-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>


<span data-ttu-id="74a7a-128">[![Map – metoda AddProduct metodu Insert() s ObjectDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="74a7a-129">**Obrázek 3**: mapy `AddProduct` metodu ObjectDataSource s `Insert()` – metoda ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>


<span data-ttu-id="74a7a-130">[![Nastavte rozevírací seznamy aktualizace a odstranění karty na (žádný)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="74a7a-131">**Obrázek 4**: nastavte aktualizace a odstranění karty rozevírací seznamy (None) ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>


<span data-ttu-id="74a7a-132">Po dokončení průvodce Konfigurace zdroje dat s ObjectDataSource, Visual Studio automaticky přidá pole do GridView pro každé pole odpovídající data.</span><span class="sxs-lookup"><span data-stu-id="74a7a-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="74a7a-133">Teď ponechejte všechna pole přidat Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="74a7a-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="74a7a-134">Později v tomto kurzu jsme budete vraťte a odebrat některá pole, jejichž hodnoty nejsou zobrazeny t muset zadat při přidávání nového záznamu.</span><span class="sxs-lookup"><span data-stu-id="74a7a-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="74a7a-135">Vzhledem k tomu, že je blízko 80 produktů v databázi, uživatel bude muset posuňte se úplně dolů webové stránky, chcete-li přidat nový záznam.</span><span class="sxs-lookup"><span data-stu-id="74a7a-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="74a7a-136">Proto umožní s povolit stránkování, aby rozhraní vkládání víc viditelné a přístupné.</span><span class="sxs-lookup"><span data-stu-id="74a7a-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="74a7a-137">Chcete-li na stránkování, stačí zaškrtněte políčko Povolit stránkování z GridView s inteligentním.</span><span class="sxs-lookup"><span data-stu-id="74a7a-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="74a7a-138">Rutina GridView a ObjectDataSource s deklarativní v tomto okamžiku by měl vypadat podobně jako následující:</span><span class="sxs-lookup"><span data-stu-id="74a7a-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]


<span data-ttu-id="74a7a-139">[![Všechna datová pole produktu se zobrazují v GridView stránkovaného fondu](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="74a7a-140">**Obrázek 5**: všechna Data pole produktu se zobrazují v GridView stránkovaného fondu ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>


## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="74a7a-141">Krok 2: Přidání řádek zápatí</span><span class="sxs-lookup"><span data-stu-id="74a7a-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="74a7a-142">Spolu s jeho záhlaví a řádky dat zahrnuje GridView řádek zápatí stránky.</span><span class="sxs-lookup"><span data-stu-id="74a7a-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="74a7a-143">Řádky záhlaví a zápatí se zobrazují v závislosti na hodnoty GridView s [ `ShowHeader` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) a [ `ShowFooter` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="74a7a-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="74a7a-144">Chcete-li zobrazit zápatí řádek, jednoduše nastavte `ShowFooter` vlastnost `True`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="74a7a-145">Jak ukazuje obrázek 6, nastavení `ShowFooter` vlastnost `True` přidá řádek zápatí k mřížce.</span><span class="sxs-lookup"><span data-stu-id="74a7a-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>


<span data-ttu-id="74a7a-146">[![Chcete-li zobrazit zápatí řádek, nastavte ShowFooter na hodnotu True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="74a7a-147">**Obrázek 6**: K zobrazení řádku zápatí nastavit `ShowFooter` k `True` ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>


<span data-ttu-id="74a7a-148">Všimněte si, že má řádek zápatí barvu pozadí tmavý red.</span><span class="sxs-lookup"><span data-stu-id="74a7a-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="74a7a-149">Je to z důvodu DataWebControls motiv jsme vytvoří a použijí na všechny stránky zpět v [zobrazení dat pomocí ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="74a7a-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="74a7a-150">Konkrétně `GridView.skin` nakonfiguruje souboru `FooterStyle` vlastnost, takový, který se používá `FooterStyle` třídu CSS.</span><span class="sxs-lookup"><span data-stu-id="74a7a-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="74a7a-151">`FooterStyle` Třída definovaná v `Styles.css` následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="74a7a-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>


[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="74a7a-152">Jsme jste prozkoumali v předchozí kurzy řádku GridView s zápatí.</span><span class="sxs-lookup"><span data-stu-id="74a7a-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="74a7a-153">V případě potřeby odkazovat zpět [informace souhrn zobrazení v prvku GridView zápatí](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) kurzu aktualizačního programu.</span><span class="sxs-lookup"><span data-stu-id="74a7a-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>


<span data-ttu-id="74a7a-154">Po nastavení `ShowFooter` vlastnost `True`, zobrazte výstup v prohlížeči za chvíli.</span><span class="sxs-lookup"><span data-stu-id="74a7a-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="74a7a-155">Aktuálně t zápatí řádek nemá obsahovat jakýkoli text nebo ovládací prvky webového.</span><span class="sxs-lookup"><span data-stu-id="74a7a-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="74a7a-156">V kroku 3 jsme budete zápatí pro každé pole GridView upravit tak, že obsahují rozhraní odpovídající vkládání.</span><span class="sxs-lookup"><span data-stu-id="74a7a-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>


<span data-ttu-id="74a7a-157">[![Zápatí prázdný řádek je zobrazen výše stránkování rozhraní ovládací prvky](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="74a7a-158">**Obrázek 7**: zápatí prázdný řádek je zobrazen výše stránkování rozhraní ovládacích prvků ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>


## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="74a7a-159">Krok 3: Přizpůsobení řádku zápatí</span><span class="sxs-lookup"><span data-stu-id="74a7a-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="74a7a-160">Zpět v [pomocí TemplateFields v ovládacím prvku GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) kurzu jsme viděli výrazně přizpůsobení zobrazení konkrétní sloupec GridView pomocí TemplateFields (na rozdíl od BoundFields nebo CheckBoxFields); v [ Přizpůsobení rozhraní pro úpravu dat](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) jsme se podívali na použití TemplateFields k přizpůsobení úpravy rozhraní v GridView.</span><span class="sxs-lookup"><span data-stu-id="74a7a-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="74a7a-161">Odvolání, TemplateField se skládá z řady šablon definující směs značky, ovládací prvky webového a syntaxe datové vazby používá pro určité typy řádků.</span><span class="sxs-lookup"><span data-stu-id="74a7a-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="74a7a-162">`ItemTemplate`, Například k šabloně použité pro řádky jen pro čtení, určuje při `EditItemTemplate` definuje šablonu pro upravovatelné řádek.</span><span class="sxs-lookup"><span data-stu-id="74a7a-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="74a7a-163">Spolu s `ItemTemplate` a `EditItemTemplate`, TemplateField také zahrnuje `FooterTemplate` určující obsah pro řádek zápatí.</span><span class="sxs-lookup"><span data-stu-id="74a7a-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="74a7a-164">Proto jsme můžete přidat ovládací prvky webového potřebné pro každé pole s vkládání rozhraní do `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="74a7a-165">Pokud chcete spustit, převeďte na TemplateFields všechna pole v GridView.</span><span class="sxs-lookup"><span data-stu-id="74a7a-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="74a7a-166">To můžete provést kliknutím na odkaz Upravit sloupce v GridView s inteligentní značky, výběrem každé pole v levém dolním rohu a kliknutím na převést toto pole na TemplateField odkaz.</span><span class="sxs-lookup"><span data-stu-id="74a7a-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>


![Převést každé pole TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="74a7a-168">**Obrázek 8**: převést každé pole TemplateField</span><span class="sxs-lookup"><span data-stu-id="74a7a-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>


<span data-ttu-id="74a7a-169">Toto pole do TemplateField kliknete převést změní aktuální typ pole do ekvivalentní TemplateField.</span><span class="sxs-lookup"><span data-stu-id="74a7a-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="74a7a-170">Například každý BoundField nahrazuje TemplateField s `ItemTemplate` obsahující popisek, který zobrazuje odpovídající pole data a `EditItemTemplate` který zobrazí pole dat do textového pole.</span><span class="sxs-lookup"><span data-stu-id="74a7a-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="74a7a-171">`ProductName` BoundField byl převeden do následující kód TemplateField:</span><span class="sxs-lookup"><span data-stu-id="74a7a-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="74a7a-172">Podobně `Discontinued` Vlastnost CheckBoxField byl převeden do TemplateField jehož `ItemTemplate` a `EditItemTemplate` obsahují ovládací prvek zaškrtávací políčko Web (s `ItemTemplate` s zaškrtávací políčko Zakázat).</span><span class="sxs-lookup"><span data-stu-id="74a7a-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="74a7a-173">Jen pro čtení `ProductID` BoundField byl převeden do TemplateField pomocí ovládacího prvku popisek v obou `ItemTemplate` a `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="74a7a-174">Stručně řečeno převod existující GridView pole do TemplateField je rychlý a snadný způsob, jak přepnout na další přizpůsobitelné TemplateField bez ztráty stávajících pole s funkcí.</span><span class="sxs-lookup"><span data-stu-id="74a7a-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="74a7a-175">Od GridView jsme re práce nemá t podpora úpravy můžete bez obav odstranit `EditItemTemplate` z každé TemplateField ponechat jenom `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="74a7a-176">Po této, vaše GridView s deklarativní by měl vypadat následovně:</span><span class="sxs-lookup"><span data-stu-id="74a7a-176">After doing this, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="74a7a-177">Teď, když každé pole GridView byl převeden do TemplateField, jsme zadejte odpovídající rozhraní vkládání do každého pole s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="74a7a-178">Některá pole nebude mít vkládání rozhraní (`ProductID`, například); ostatní se bude lišit ve webových ovládacích prvcích používá ke shromažďování nové informace o produktu s.</span><span class="sxs-lookup"><span data-stu-id="74a7a-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="74a7a-179">Vytvoření rozhraní úprav, vyberte GridView s inteligentním na odkaz Upravit šablony.</span><span class="sxs-lookup"><span data-stu-id="74a7a-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="74a7a-180">Pak v rozevíracím seznamu vyberte odpovídající pole s `FooterTemplate` a přetáhněte ji vhodný ovládací prvek z panelu nástrojů na návrháře.</span><span class="sxs-lookup"><span data-stu-id="74a7a-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>


<span data-ttu-id="74a7a-181">[![Přidejte příslušné vkládání rozhraní, každý s FooterTemplate pole](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="74a7a-182">**Obrázek 9**: přidejte příslušné vkládání rozhraní s každou pole `FooterTemplate` ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>


<span data-ttu-id="74a7a-183">V následujícím seznamu zobrazí pole GridView zadání vkládání rozhraní, které chcete přidat:</span><span class="sxs-lookup"><span data-stu-id="74a7a-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="74a7a-184">`ProductID` Žádné.</span><span class="sxs-lookup"><span data-stu-id="74a7a-184">`ProductID` none.</span></span>
- <span data-ttu-id="74a7a-185">`ProductName` přidat textové pole a nastavit jeho `ID` k `NewProductName`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="74a7a-186">Přidání ovládacího prvku RequiredFieldValidator také zajistit, aby uživatel zadal hodnotu pro název nového produktu s.</span><span class="sxs-lookup"><span data-stu-id="74a7a-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="74a7a-187">`SupplierID` Žádné.</span><span class="sxs-lookup"><span data-stu-id="74a7a-187">`SupplierID` none.</span></span>
- <span data-ttu-id="74a7a-188">`CategoryID` Žádné.</span><span class="sxs-lookup"><span data-stu-id="74a7a-188">`CategoryID` none.</span></span>
- <span data-ttu-id="74a7a-189">`QuantityPerUnit` přidat textové pole, nastavení jeho `ID` k `NewQuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="74a7a-190">`UnitPrice` přidat textové pole s názvem `NewUnitPrice` a CompareValidator, které zajišťuje, aby zadaná hodnota je currency hodnota větší než nebo rovna hodnotě nula.</span><span class="sxs-lookup"><span data-stu-id="74a7a-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="74a7a-191">`UnitsInStock` použijte textové pole jehož `ID` je nastaven na `NewUnitsInStock`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="74a7a-192">Zahrnout CompareValidator, která zajišťuje, že zadaná hodnota je celé číslo větší než nebo rovna hodnotě nula.</span><span class="sxs-lookup"><span data-stu-id="74a7a-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="74a7a-193">`UnitsOnOrder` použijte textové pole jehož `ID` je nastaven na `NewUnitsOnOrder`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="74a7a-194">Zahrnout CompareValidator, která zajišťuje, že zadaná hodnota je celé číslo větší než nebo rovna hodnotě nula.</span><span class="sxs-lookup"><span data-stu-id="74a7a-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="74a7a-195">`ReorderLevel` použijte textové pole jehož `ID` je nastaven na `NewReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="74a7a-196">Zahrnout CompareValidator, která zajišťuje, že zadaná hodnota je celé číslo větší než nebo rovna hodnotě nula.</span><span class="sxs-lookup"><span data-stu-id="74a7a-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="74a7a-197">`Discontinued` Přidat zaškrtávací políčko, nastavení jeho `ID` k `NewDiscontinued`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="74a7a-198">`CategoryName` Přidejte rozevírací seznam a nastavte její `ID` k `NewCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="74a7a-199">Navázat jej na nové ObjectDataSource s názvem `CategoriesDataSource` a nakonfigurujte ho na používání `CategoriesBLL` třídu s `GetCategories()` metoda.</span><span class="sxs-lookup"><span data-stu-id="74a7a-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="74a7a-200">Mít rozevírací seznam s `ListItem` s zobrazení `CategoryName` data pole, pomocí `CategoryID` datové pole jako jejich hodnoty.</span><span class="sxs-lookup"><span data-stu-id="74a7a-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="74a7a-201">`SupplierName` Přidejte rozevírací seznam a nastavte její `ID` k `NewSupplierID`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="74a7a-202">Navázat jej na nové ObjectDataSource s názvem `SuppliersDataSource` a nakonfigurujte ho na používání `SuppliersBLL` třídu s `GetSuppliers()` metoda.</span><span class="sxs-lookup"><span data-stu-id="74a7a-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="74a7a-203">Mít rozevírací seznam s `ListItem` s zobrazení `CompanyName` data pole, pomocí `SupplierID` datové pole jako jejich hodnoty.</span><span class="sxs-lookup"><span data-stu-id="74a7a-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="74a7a-204">Pro každou ovládacích prvků ověřování, vymažte `ForeColor` vlastnost tak, aby `FooterStyle` šablon stylů CSS třídu s bílým popředí barva se použije místo výchozího red.</span><span class="sxs-lookup"><span data-stu-id="74a7a-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="74a7a-205">Také použít `ErrorMessage` podrobný popis, ale hodnota nastavena `Text` vlastnost hvězdičku.</span><span class="sxs-lookup"><span data-stu-id="74a7a-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="74a7a-206">Abyste zabránili text pro ovládací prvek s ověření působit rozhraní vkládání zabalit do dvou řádků, nastavte `FooterStyle` s `Wrap` vlastnost na hodnotu false pro jednotlivé `FooterTemplate` s, použijte ovládací prvek ověření.</span><span class="sxs-lookup"><span data-stu-id="74a7a-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="74a7a-207">Nakonec přidejte ovládacího prvku ValidationSummary pod GridView a sadu jeho `ShowMessageBox` vlastnost `True` a jeho `ShowSummary` vlastnost `False`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="74a7a-208">Při přidání nového produktu, je potřeba zadat `CategoryID` a `SupplierID`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="74a7a-209">Tyto informace pořízen prostřednictvím DropDownLists v zápatí buňky `CategoryName` a `SupplierName` pole.</span><span class="sxs-lookup"><span data-stu-id="74a7a-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="74a7a-210">Se rozhodli používat tato pole naproti tomu `CategoryID` a `SupplierID` TemplateFields, protože v mřížce s řádky dat uživatele je více pravděpodobně nepotřebujete vidět názvy kategorií a dodavatele, nikoli jejich hodnoty ID.</span><span class="sxs-lookup"><span data-stu-id="74a7a-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="74a7a-211">Vzhledem k tomu `CategoryID` a `SupplierID` hodnoty jsou nyní zaznamenávané v `CategoryName` a `SupplierName` pole s vkládáním rozhraní, jsme odebrat `CategoryID` a `SupplierID` TemplateFields z GridView.</span><span class="sxs-lookup"><span data-stu-id="74a7a-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="74a7a-212">Podobně `ProductID` se nepoužívá při přidání nového produktu, proto `ProductID` TemplateField lze také odebrat.</span><span class="sxs-lookup"><span data-stu-id="74a7a-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="74a7a-213">Ale nechat s ponechte `ProductID` pole v mřížce.</span><span class="sxs-lookup"><span data-stu-id="74a7a-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="74a7a-214">Kromě textových polí, DropDownLists, zaškrtávací políčka a ovládací prvky ověřování, která tvoří rozhraní vkládání, je třeba také Add tlačítko, která po kliknutí na provede logiku pro přidání nového produktu do databáze.</span><span class="sxs-lookup"><span data-stu-id="74a7a-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="74a7a-215">V kroku 4 budete tlačítko Přidat v rozhraní vkládání v zahrnuta `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="74a7a-216">Nebojte se, že vylepšení vzhledu různá pole GridView.</span><span class="sxs-lookup"><span data-stu-id="74a7a-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="74a7a-217">Například můžete chtít formátu `UnitPrice` hodnoty jako měny, vpravo align `UnitsInStock`, `UnitsOnOrder`, a `ReorderLevel` pole a aktualizace `HeaderText` hodnoty TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="74a7a-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="74a7a-218">Po vytvoření slew vložení rozhraní `FooterTemplate` s, odebrání `SupplierID`, a `CategoryID` TemplateFields a vylepšuje estetiku mřížky prostřednictvím formátování a zarovnání TemplateFields, vaše GridView s deklarativní Kód by měl vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="74a7a-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="74a7a-219">Při zobrazení prostřednictvím prohlížeče, řádku GridView s zápatí nyní zahrnuje dokončené vkládání rozhraní (viz obrázek 10).</span><span class="sxs-lookup"><span data-stu-id="74a7a-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="74a7a-220">V tomto okamžiku vkládání nemá t rozhraní zahrnují znamená pro uživatele znamená, že s she zadaná data pro nového produktu a chce vložit nový záznam do databáze.</span><span class="sxs-lookup"><span data-stu-id="74a7a-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="74a7a-221">Také jsme jste ještě chcete vyřešit, jak budou data zadaná do zápatí převede na nový záznam v `Products` databáze.</span><span class="sxs-lookup"><span data-stu-id="74a7a-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="74a7a-222">V kroku 4 podíváme postup zahrnují tlačítko Přidat rozhraní vkládání a ke spouštění kódu na odeslat zpět kdy ji s klikli.</span><span class="sxs-lookup"><span data-stu-id="74a7a-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="74a7a-223">Krok 5 ukazuje, jak chcete-li vložit nový záznam pomocí dat z zápatí.</span><span class="sxs-lookup"><span data-stu-id="74a7a-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>


<span data-ttu-id="74a7a-224">[![Rutina GridView zápatí poskytuje rozhraní pro přidávání nového záznamu](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="74a7a-225">**Obrázek 10**: zápatí GridView poskytuje rozhraní pro přidávání nového záznamu ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>


## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="74a7a-226">Krok 4: Včetně tlačítko Přidat v vkládání rozhraní</span><span class="sxs-lookup"><span data-stu-id="74a7a-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="74a7a-227">Musíme zahrnout tlačítko Přidat někde v rozhraní vkládání vzhledem k tomu, že s řádek zápatí stránky, který je aktuálně vkládání rozhraní chybí znamená pro uživatele k označení, že nebude dokončena zadáním nové informace o produktu s.</span><span class="sxs-lookup"><span data-stu-id="74a7a-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="74a7a-228">To může umístěné v jednom z existujících `FooterTemplate` s nebo jsme může přidat nový sloupec do mřížky pro tento účel.</span><span class="sxs-lookup"><span data-stu-id="74a7a-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="74a7a-229">V tomto kurzu umožňují s umístit na tlačítko Přidat v `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="74a7a-230">Z návrháře, klikněte na odkaz Upravit šablony v GridView s inteligentním a potom vyberte `ProductID` pole s `FooterTemplate` z rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="74a7a-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="74a7a-231">Přidání ovládacího prvku tlačítko webové (nebo LinkButton nebo ImageButton, pokud dáváte přednost) do šablony, nastavení jeho ID na `AddProduct`, jeho `CommandName` k vložení a jeho `Text` vlastnost přidat, jak ukazuje obrázek 11.</span><span class="sxs-lookup"><span data-stu-id="74a7a-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>


<span data-ttu-id="74a7a-232">[![Umístit na tlačítko Přidat FooterTemplate s ProductID TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="74a7a-233">**Obrázek 11**: umístit na tlačítko Přidat v `ProductID` TemplateField s `FooterTemplate` ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>


<span data-ttu-id="74a7a-234">Jakmile jste již zahrnut na tlačítko Přidat, otestování stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="74a7a-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="74a7a-235">Všimněte si, že při kliknutí na tlačítko Přidat se neplatná data v vkládání rozhraní zpětné volání je prostě circuited a ovládacího prvku ValidationSummary označuje neplatná data (viz obrázek 12).</span><span class="sxs-lookup"><span data-stu-id="74a7a-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="74a7a-236">U příslušné zadaná data klepnutím na tlačítko Přidat způsobí zpětné volání.</span><span class="sxs-lookup"><span data-stu-id="74a7a-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="74a7a-237">Žádný záznam se přidá do databáze, ale.</span><span class="sxs-lookup"><span data-stu-id="74a7a-237">No record is added to the database, however.</span></span> <span data-ttu-id="74a7a-238">Je potřeba zapsat malou část kódu, aby mohly skutečně provést úlohy insert.</span><span class="sxs-lookup"><span data-stu-id="74a7a-238">We will need to write a bit of code to actually perform the insert.</span></span>


<span data-ttu-id="74a7a-239">[![Přidat tlačítko s zpětné volání je krátký Circuited Pokud je v rozhraní vkládání neplatná Data.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="74a7a-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="74a7a-240">**Obrázek 12**: přidat tlačítko s zpětné volání je krátký Circuited případě neplatná Data v rozhraní vložení ([Kliknutím zobrazit obrázek v plné velikosti](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="74a7a-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="74a7a-241">Ovládací prvky ověřování v rozhraní vkládání nebyly přiřazeny do skupiny ověření.</span><span class="sxs-lookup"><span data-stu-id="74a7a-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="74a7a-242">Tento postup funguje bez problémů, tak dlouho, dokud vkládání rozhraní je pouze sadu ověřovacích ovládacích prvků na stránce.</span><span class="sxs-lookup"><span data-stu-id="74a7a-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="74a7a-243">Pokud jsou však další ověření ovládací prvky na stránce (například ověření ovládací prvky v mřížce s úpravy rozhraní), ověření ovládacích prvků v vkládání rozhraní a přidejte tlačítko s `ValidationGroup` vlastnosti by se měla přiřadit stejnou hodnotu tak, aby Tyto ovládací prvky přidružte konkrétní ověřovací skupiny.</span><span class="sxs-lookup"><span data-stu-id="74a7a-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="74a7a-244">V tématu [Rozvěrače ověřovacích ovládacích prvků v technologii ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) Další informace o vytváření oddílů tlačítka na stránku a ovládací prvky pro ověřování do skupin ověření.</span><span class="sxs-lookup"><span data-stu-id="74a7a-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>


## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="74a7a-245">Krok 5: Vkládání nových záznamů do`Products`tabulky</span><span class="sxs-lookup"><span data-stu-id="74a7a-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="74a7a-246">Při použití funkce integrované úprav GridView, GridView automaticky zpracovává všechny pracovní potřebné k provedení aktualizace.</span><span class="sxs-lookup"><span data-stu-id="74a7a-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="74a7a-247">Zejména při kliknutí na tlačítko Aktualizovat kopíruje hodnoty zadané z rozhraní úprav na parametry ObjectDataSource s `UpdateParameters` kolekce a zejména kopance vypnout aktualizace vyvoláním ObjectDataSource s `Update()` metoda.</span><span class="sxs-lookup"><span data-stu-id="74a7a-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="74a7a-248">Vzhledem k tomu, že GridView neposkytuje takové integrovanou funkci pro vložení, musíme implementovat kód, který volá ObjectDataSource s `Insert()` metoda a zkopíruje hodnoty ze vkládání rozhraní k ObjectDataSource s `InsertParameters` kolekce .</span><span class="sxs-lookup"><span data-stu-id="74a7a-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="74a7a-249">Tato logika insert se má provést po klepnutí na tlačítko Přidat.</span><span class="sxs-lookup"><span data-stu-id="74a7a-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="74a7a-250">Jak je popsáno v [přidávání a reagovat na tlačítka v GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) kurzu, kdykoliv tlačítko, LinkButton nebo ImageButton v GridView po kliknutí na GridView s `RowCommand` aktivuje událost na zpětné volání.</span><span class="sxs-lookup"><span data-stu-id="74a7a-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="74a7a-251">Tato událost se aktivuje, zda tlačítko, LinkButton nebo ImageButton byla explicitně přidat například na tlačítko Přidat v řádku zápatí nebo pokud byl automaticky přidat pomocí GridView (například LinkButtons v horní části každého sloupce, pokud je vybraná možnost Povolit řazení, nebo LinkButtons v rozhraní stránkování, pokud je vybrána povolit stránkování).</span><span class="sxs-lookup"><span data-stu-id="74a7a-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="74a7a-252">Proto reakce na kliknutí na tlačítko Přidat uživatele, je potřeba vytvořit obslužnou rutinu události pro GridView s `RowCommand` událostí.</span><span class="sxs-lookup"><span data-stu-id="74a7a-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="74a7a-253">Vzhledem k tomu, že tato událost se aktivuje vždy, když *všechny* po kliknutí na tlačítko, LinkButton nebo ImageButton v GridView, je důležité, že jsme pouze pokračovat s vkládáním logiku by s `CommandName` vlastnost předán do mapy obslužné rutiny událostí `CommandName` hodnotu na tlačítko Přidat (Vložit).</span><span class="sxs-lookup"><span data-stu-id="74a7a-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="74a7a-254">Kromě toho jsme také pokračujte, pouze pokud ovládací prvky pro ověřování sestav platná data.</span><span class="sxs-lookup"><span data-stu-id="74a7a-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="74a7a-255">K tomuto požadavku vyhovělo, vytvoření obslužné rutiny událostí `RowCommand` událostí s následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="74a7a-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="74a7a-256">Asi vás zajímá, proč obslužné rutiny události bothers kontrola `Page.IsValid` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="74a7a-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="74a7a-257">Po všech získaných t zpětné volání potlačit, pokud je zadaná neplatná data v vkládání rozhraní?</span><span class="sxs-lookup"><span data-stu-id="74a7a-257">After all, won t the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="74a7a-258">Tento předpoklad je správná, tak dlouho, dokud uživatel nebyl zakázán JavaScript nebo má provedených kroků k obcházení logiku ověřování na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="74a7a-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="74a7a-259">Stručně řečeno jeden se nikdy spoléhají výhradně na ověření na straně klienta; serverové kontrolu platnosti vždy je třeba provést před zahájením práce s daty.</span><span class="sxs-lookup"><span data-stu-id="74a7a-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>


<span data-ttu-id="74a7a-260">V kroku 1 jsme vytvořili `ProductsDataSource` ObjectDataSource tak, aby jeho `Insert()` metoda je namapována na `ProductsBLL` třídu s `AddProduct` metoda.</span><span class="sxs-lookup"><span data-stu-id="74a7a-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="74a7a-261">Chcete-li vložit nový záznam do `Products` tabulky, můžeme jednoduše vyvolat ObjectDataSource s `Insert()` metoda:</span><span class="sxs-lookup"><span data-stu-id="74a7a-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="74a7a-262">Teď, když `Insert()` byla volána metoda, všechny, který zbývá ke kopírování hodnoty z rozhraní vkládání k parametrům předaný `ProductsBLL` třídu s `AddProduct` metoda.</span><span class="sxs-lookup"><span data-stu-id="74a7a-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="74a7a-263">Jak jsme viděli zpět v [zkoumání události spojené s vložení, aktualizace a odstranění](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) kurz, můžete to provést prostřednictvím ObjectDataSource s `Inserting` událostí.</span><span class="sxs-lookup"><span data-stu-id="74a7a-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="74a7a-264">V `Inserting` událostí musíme programově odkazovat ovládacích prvků z `Products` zápatí s GridView řádek a jejich hodnoty pro přiřazení `e.InputParameters` kolekce.</span><span class="sxs-lookup"><span data-stu-id="74a7a-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="74a7a-265">Pokud uživatel vynechá hodnotu třeba ponechat `ReorderLevel` textové pole prázdné, je potřeba určit, aby hodnota vložená do databáze `NULL`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="74a7a-266">Vzhledem k tomu `AddProducts` metoda přijímá typy s možnou hodnotou Null pro pole v databázi s povolenou hodnotou Null, jednoduše používat typ s možnou hodnotou Null a jeho hodnotu nastavte `Nothing` v případě, kdy je vynechán vstup uživatele.</span><span class="sxs-lookup"><span data-stu-id="74a7a-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="74a7a-267">S `Inserting` obslužné rutiny události dokončit nové záznamy lze přidat do `Products` databázové tabulky prostřednictvím řádku GridView s zápatí.</span><span class="sxs-lookup"><span data-stu-id="74a7a-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="74a7a-268">Pokračujte a zkuste přidat několik nových produktů.</span><span class="sxs-lookup"><span data-stu-id="74a7a-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="74a7a-269">Rozšíření a přizpůsobení operace přidání</span><span class="sxs-lookup"><span data-stu-id="74a7a-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="74a7a-270">V současné době klepnutím na tlačítko Přidat přidá do tabulky databáze nový záznam ale neposkytuje žádné řazení vizuální zpětnou vazbu záznam úspěšně přidán.</span><span class="sxs-lookup"><span data-stu-id="74a7a-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="74a7a-271">V ideálním případě by popisek webové ovládací prvek nebo klienta výstrahy pole informujte uživatele, že jejich vložení má byl úspěšně dokončen.</span><span class="sxs-lookup"><span data-stu-id="74a7a-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="74a7a-272">Nechat to jako cvičení pro čtečku.</span><span class="sxs-lookup"><span data-stu-id="74a7a-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="74a7a-273">Rutina GridView použili v tomto kurzu se nevztahuje žádné řazení uvedené produkty tomu koncového uživatele k řazení dat. ani.</span><span class="sxs-lookup"><span data-stu-id="74a7a-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="74a7a-274">V důsledku toho jsou záznamy seřazené jako v databázi tak, že jejich primárního klíče.</span><span class="sxs-lookup"><span data-stu-id="74a7a-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="74a7a-275">Vzhledem k tomu, že každý nový záznam má `ProductID` hodnotu vyšší než poslední, při každém přidání nového produktu ho je standardní konci mřížky.</span><span class="sxs-lookup"><span data-stu-id="74a7a-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="74a7a-276">Proto můžete automaticky odesílat uživatele na poslední stránku GridView po přidání nového záznamu.</span><span class="sxs-lookup"><span data-stu-id="74a7a-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="74a7a-277">Můžete to provést přidáním následující kód po volání `ProductsDataSource.Insert()` v `RowCommand` obslužné rutiny události indikující, že uživatel musí k odeslání na poslední stránku po vazbě dat na GridView:</span><span class="sxs-lookup"><span data-stu-id="74a7a-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="74a7a-278">`SendUserToLastPage` je logická hodnota proměnné úrovně stránky, která je původně přiřazena hodnota `False`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="74a7a-279">V GridView s `DataBound` obslužné rutiny události, pokud `SendUserToLastPage` je nastavena hodnota false, `PageIndex` vlastnost se aktualizuje na uživateli odeslat na poslední stránce.</span><span class="sxs-lookup"><span data-stu-id="74a7a-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="74a7a-280">Z důvodu `PageIndex` je nastavena `DataBound` obslužné rutiny události (Naproti tomu `RowCommand` obslužné rutiny události) je, protože při `RowCommand` jsme obslužnou rutinu události aktivuje jste ještě pro přidání nového záznamu `Products` databázové tabulky.</span><span class="sxs-lookup"><span data-stu-id="74a7a-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="74a7a-281">Proto v `RowCommand` obslužné rutiny události poslední index stránky (`PageCount - 1`) představuje poslední index stránky *před* byl přidán nový produkt.</span><span class="sxs-lookup"><span data-stu-id="74a7a-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="74a7a-282">Pro většinu produkty, které přidávají poslední index stránky je stejná po přidání nového produktu.</span><span class="sxs-lookup"><span data-stu-id="74a7a-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="74a7a-283">Ale když přidané produktu výsledkem nový poslední index stránky, pokud nesprávně aktualizujeme `PageIndex` v `RowCommand` obslužné rutiny události pak jsme budete přesměrováni na druhý na poslední stránce (poslední index stránky před přidáním nového produktu) oproti nové poslední stránky i Ndex.</span><span class="sxs-lookup"><span data-stu-id="74a7a-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="74a7a-284">Vzhledem k tomu `DataBound` obslužné rutiny události aktivuje se po byl přidán nový produkt a data odrážejí do mřížky, a to nastavením `PageIndex` existuje vlastnost víme jsme re získávání správné poslední index stránky.</span><span class="sxs-lookup"><span data-stu-id="74a7a-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="74a7a-285">Nakonec GridView použili v tomto kurzu je velmi široký kvůli počet polí, které je třeba shromažďovat pro přidání nového produktu.</span><span class="sxs-lookup"><span data-stu-id="74a7a-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="74a7a-286">Z důvodu této šířku může být svislém rozložení s DetailsView upřednostňované.</span><span class="sxs-lookup"><span data-stu-id="74a7a-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="74a7a-287">Rutina GridView s může být snížit celkovou šířku shromažďování méně vstupy.</span><span class="sxs-lookup"><span data-stu-id="74a7a-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="74a7a-288">Možná jsme nejsou zobrazeny potřeba t shromažďovat `UnitsOnOrder`, `UnitsInStock`, a `ReorderLevel` polí při přidání nového produktu, v takovém případě tato pole nebylo možné odebrat z GridView.</span><span class="sxs-lookup"><span data-stu-id="74a7a-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="74a7a-289">Chcete-li upravit data shromážděná, můžeme použít jednu ze dvou následujících metod:</span><span class="sxs-lookup"><span data-stu-id="74a7a-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="74a7a-290">Nadále používat `AddProduct` metoda, která očekává hodnoty `UnitsOnOrder`, `UnitsInStock`, a `ReorderLevel` pole.</span><span class="sxs-lookup"><span data-stu-id="74a7a-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="74a7a-291">V `Inserting` obslužné rutiny události, zadejte pevně, výchozí hodnoty pro tyto vstupních hodnot, které byly odebrány z rozhraní vkládání.</span><span class="sxs-lookup"><span data-stu-id="74a7a-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="74a7a-292">Vytvoření nové přetížení `AddProduct` metoda v `ProductsBLL` třídu, která nepřijímá vstupy pro `UnitsOnOrder`, `UnitsInStock`, a `ReorderLevel` pole.</span><span class="sxs-lookup"><span data-stu-id="74a7a-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="74a7a-293">Potom nakonfigurujte na stránce ASP.NET ObjectDataSource používat tento nový přetížení.</span><span class="sxs-lookup"><span data-stu-id="74a7a-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="74a7a-294">Jednu z možností bude fungovat stejně také.</span><span class="sxs-lookup"><span data-stu-id="74a7a-294">Either option will work equally as well.</span></span> <span data-ttu-id="74a7a-295">V minulosti kurzy jsme použili druhou možnost, vytváření více přetížení pro `ProductsBLL` třídu s `UpdateProduct` metoda.</span><span class="sxs-lookup"><span data-stu-id="74a7a-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="74a7a-296">Souhrn</span><span class="sxs-lookup"><span data-stu-id="74a7a-296">Summary</span></span>

<span data-ttu-id="74a7a-297">Integrované funkce vkládání nalezených v DetailsView a FormView chybí GridView, ale s trochu úsilí vkládání rozhraní lze přidat na řádek zápatí stránky.</span><span class="sxs-lookup"><span data-stu-id="74a7a-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="74a7a-298">Zobrazit zápatí řádek v GridView jednoduše nastavte její `ShowFooter` vlastnost `True`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="74a7a-299">Obsah zápatí řádku lze přizpůsobit pro každé pole převedením pole na TemplateField a přidání vkládání rozhraní na `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="74a7a-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="74a7a-300">Jak jsme viděli v tomto kurzu `FooterTemplate` může obsahovat tlačítka, textových polí, DropDownLists, zaškrtávací políčka, ovládací prvky zdroje dat pro naplnění datové ovládací prvky webového (například DropDownLists) a ovládací prvky pro ověřování.</span><span class="sxs-lookup"><span data-stu-id="74a7a-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="74a7a-301">Společně s ovládací prvky pro vstup uživatele s shromažďování je požadován přidání tlačítka, LinkButton nebo ImageButton.</span><span class="sxs-lookup"><span data-stu-id="74a7a-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="74a7a-302">Když přidat po kliknutí na tlačítko, ObjectDataSource s `Insert()` metoda je volána vkládání workflow spusťte.</span><span class="sxs-lookup"><span data-stu-id="74a7a-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="74a7a-303">ObjectDataSource bude potom volejte metodu nakonfigurované insert ( `ProductsBLL` třídu s `AddProduct` metody v tomto kurzu).</span><span class="sxs-lookup"><span data-stu-id="74a7a-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="74a7a-304">Jsme musí zkopírujte hodnoty z s GridView vkládání rozhraní ObjectDataSource s `InsertParameters` kolekce před ke kterému volaná metoda insert.</span><span class="sxs-lookup"><span data-stu-id="74a7a-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="74a7a-305">Můžete to provést prostřednictvím kódu programu odkazem vkládání ovládacích prvků webové rozhraní v ObjectDataSource s `Inserting` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="74a7a-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="74a7a-306">V tomto kurzu dokončení naše pohled na techniky rozšíření vzhled s GridView.</span><span class="sxs-lookup"><span data-stu-id="74a7a-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="74a7a-307">Jak pracovat s binární data, jako jsou bitové kopie, souborů PDF, dokumentů aplikace Word a tak dále a data ovládací prvky webového bude vyhledejte sadu další kurzy.</span><span class="sxs-lookup"><span data-stu-id="74a7a-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="74a7a-308">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="74a7a-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="74a7a-309">O autorovi</span><span class="sxs-lookup"><span data-stu-id="74a7a-309">About the Author</span></span>

<span data-ttu-id="74a7a-310">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a zakladatele z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje s technologií Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="74a7a-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="74a7a-311">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="74a7a-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="74a7a-312">Jeho nejnovější seznam k [ *Edice nakladatelství Sams naučit sami technologii ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="74a7a-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="74a7a-313">Dosažitelný v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu, který najdete na [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="74a7a-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="74a7a-314">Zvláštní poděkování</span><span class="sxs-lookup"><span data-stu-id="74a7a-314">Special Thanks To</span></span>

<span data-ttu-id="74a7a-315">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="74a7a-315">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="74a7a-316">Vést kontrolorem pro tento kurz byl Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="74a7a-316">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="74a7a-317">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="74a7a-317">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="74a7a-318">Pokud ano, vyřaďte mi řádek v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="74a7a-318">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="74a7a-319">Předchozí</span><span class="sxs-lookup"><span data-stu-id="74a7a-319">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)
