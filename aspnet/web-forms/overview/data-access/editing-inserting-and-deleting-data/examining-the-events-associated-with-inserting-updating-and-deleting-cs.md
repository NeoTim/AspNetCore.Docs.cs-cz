---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs
title: "Zkoumání události související s vkládání, aktualizaci nebo odstranění (C#) | Microsoft Docs"
author: rick-anderson
description: "V tomto kurzu podíváme pomocí události, které nastaly před, během a po typu vložení aktualizaci nebo odstranění operace dat ASP.NET ovládací prvek webu. W..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: dab291a0-a8b5-46fa-9dd8-3d35b249201f
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs
msc.type: authoredcontent
ms.openlocfilehash: 93da23d58d1ba73c5b97f42631d036dd364de24d
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2018
---
<a name="examining-the-events-associated-with-inserting-updating-and-deleting-c"></a><span data-ttu-id="09370-104">Zkoumání události související s vkládání, aktualizaci nebo odstranění (C#)</span><span class="sxs-lookup"><span data-stu-id="09370-104">Examining the Events Associated with Inserting, Updating, and Deleting (C#)</span></span>
====================
<span data-ttu-id="09370-105">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="09370-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="09370-106">[Stáhněte si ukázkovou aplikaci](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_CS.exe) nebo [stáhnout PDF](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/datatutorial17cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="09370-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_CS.exe) or [Download PDF](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/datatutorial17cs1.pdf)</span></span>

> <span data-ttu-id="09370-107">V tomto kurzu podíváme pomocí události, které nastaly před, během a po typu vložení aktualizaci nebo odstranění operace dat ASP.NET ovládací prvek webu.</span><span class="sxs-lookup"><span data-stu-id="09370-107">In this tutorial we'll examine using the events that occur before, during, and after an insert, update, or delete operation of an ASP.NET data Web control.</span></span> <span data-ttu-id="09370-108">Také jsme zobrazí postup přizpůsobení úpravy rozhraní, které chcete aktualizovat pouze podmnožinu pole produktu.</span><span class="sxs-lookup"><span data-stu-id="09370-108">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>


## <a name="introduction"></a><span data-ttu-id="09370-109">Úvod</span><span class="sxs-lookup"><span data-stu-id="09370-109">Introduction</span></span>

<span data-ttu-id="09370-110">Pokud používáte integrované vkládání, úpravy nebo odstranění funkce ovládacích prvků GridView, DetailsView nebo FormView, transpire celou řadu kroků při koncový uživatel dokončí proces přidávání nového záznamu nebo aktualizaci nebo odstranění existujícího záznamu.</span><span class="sxs-lookup"><span data-stu-id="09370-110">When using the built-in inserting, editing, or deleting features of the GridView, DetailsView, or FormView controls, a variety of steps transpire when the end user completes the process of adding a new record or updating or deleting an existing record.</span></span> <span data-ttu-id="09370-111">Jak již bylo zmíněno [předchozí kurzu](an-overview-of-inserting-updating-and-deleting-data-cs.md), když upravíte řádek v GridView tlačítko Upravit je nahrazena aktualizace a zrušit tlačítka a zapněte BoundFields do textových polí.</span><span class="sxs-lookup"><span data-stu-id="09370-111">As we discussed in the [previous tutorial](an-overview-of-inserting-updating-and-deleting-data-cs.md), when a row is edited in the GridView the Edit button is replaced by Update and Cancel buttons and the BoundFields turn into TextBoxes.</span></span> <span data-ttu-id="09370-112">Až koncový uživatel aktualizuje data a klikne na aktualizace, následující kroky se provádějí v zpětné volání:</span><span class="sxs-lookup"><span data-stu-id="09370-112">After the end user updates the data and clicks Update, the following steps are performed on postback:</span></span>

1. <span data-ttu-id="09370-113">GridView naplní jeho ObjectDataSource `UpdateParameters` s upravený záznam jedinečné identifikační polí (prostřednictvím `DataKeyNames` vlastnost) společně s hodnoty zadané uživatelem.</span><span class="sxs-lookup"><span data-stu-id="09370-113">The GridView populates its ObjectDataSource's `UpdateParameters` with the edited record's unique identifying field(s) (via the `DataKeyNames` property) along with the values entered by the user</span></span>
2. <span data-ttu-id="09370-114">GridView vyvolá jeho ObjectDataSource `Update()` metodu, která zase vyvolá odpovídající metodu podkladového objektu (`ProductsDAL.UpdateProduct`, v našem kurzu předchozí)</span><span class="sxs-lookup"><span data-stu-id="09370-114">The GridView invokes its ObjectDataSource's `Update()` method, which in turn invokes the appropriate method in the underlying object (`ProductsDAL.UpdateProduct`, in our previous tutorial)</span></span>
3. <span data-ttu-id="09370-115">Zdrojová data, která nyní obsahuje aktualizované změny, je odrážejí na GridView</span><span class="sxs-lookup"><span data-stu-id="09370-115">The underlying data, which now includes the updated changes, is rebound to the GridView</span></span>

<span data-ttu-id="09370-116">Během tato posloupnost kroků provést určitý počet událostí, to nám umožňuje vytváření obslužných rutin událostí pro přidání vlastní logiky tam, kde je potřeba.</span><span class="sxs-lookup"><span data-stu-id="09370-116">During this sequence of steps, a number of events fire, enabling us to create event handlers to add custom logic where needed.</span></span> <span data-ttu-id="09370-117">Například před kroku 1, GridView na `RowUpdating` je aktivována událost.</span><span class="sxs-lookup"><span data-stu-id="09370-117">For example, prior to Step 1, the GridView's `RowUpdating` event fires.</span></span> <span data-ttu-id="09370-118">Pokud se některé Chyba ověření můžete v tomto okamžiku zrušení žádost o aktualizaci.</span><span class="sxs-lookup"><span data-stu-id="09370-118">We can, at this point, cancel the update request if there is some validation error.</span></span> <span data-ttu-id="09370-119">Když `Update()` metoda je volána, ObjectDataSource `Updating` aktivuje událost, že poskytuje možnost Přidat nebo upravit hodnoty každého `UpdateParameters`.</span><span class="sxs-lookup"><span data-stu-id="09370-119">When the `Update()` method is invoked, the ObjectDataSource's `Updating` event fires, providing an opportunity to add or customize the values of any of the `UpdateParameters`.</span></span> <span data-ttu-id="09370-120">Po zdrojové ObjectDataSource metody objektu dokončil provádění ObjectDataSource `Updated` událost se vyvolá.</span><span class="sxs-lookup"><span data-stu-id="09370-120">After the ObjectDataSource's underlying object's method has completed executing, the ObjectDataSource's `Updated` event is raised.</span></span> <span data-ttu-id="09370-121">Obslužné rutiny události pro `Updated` událostí můžete prohlédnout podrobnosti o operaci aktualizace, jako je například situace měla vliv na tom, kolik řádků a zda došlo k výjimce.</span><span class="sxs-lookup"><span data-stu-id="09370-121">An event handler for the `Updated` event can inspect the details about the update operation, such as how many rows were affected and whether or not an exception occurred.</span></span> <span data-ttu-id="09370-122">Nakonec po kroku 2, GridView na `RowUpdated` aktivuje událost; obslužnou rutinu pro tuto událost může vyhledejte další informace o právě aktualizace operaci provést.</span><span class="sxs-lookup"><span data-stu-id="09370-122">Finally, after Step 2, the GridView's `RowUpdated` event fires; an event handler for this event can examine additional information about the update operation just performed.</span></span>

<span data-ttu-id="09370-123">Obrázek 1 znázorňuje tuto řadu událostí a kroků při aktualizaci GridView.</span><span class="sxs-lookup"><span data-stu-id="09370-123">Figure 1 depicts this series of events and steps when updating a GridView.</span></span> <span data-ttu-id="09370-124">Vzor událostí na obrázku 1 není jedinečný aktualizace s GridView.</span><span class="sxs-lookup"><span data-stu-id="09370-124">The event pattern in Figure 1 is not unique to updating with a GridView.</span></span> <span data-ttu-id="09370-125">Vkládání, aktualizaci nebo odstranění dat z GridView, DetailsView nebo FormView vysráží stejnou sekvenci před a po úroveň události pro ovládací prvek webu data i ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="09370-125">Inserting, updating, or deleting data from the GridView, DetailsView, or FormView precipitates the same sequence of pre- and post-level events for both the data Web control and the ObjectDataSource.</span></span>


<span data-ttu-id="09370-126">[![Řadu před a po události Fire při aktualizaci dat v GridView](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="09370-126">[![A Series of Pre- and Post-Events Fire When Updating Data in a GridView](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image1.png)</span></span>

<span data-ttu-id="09370-127">**Obrázek 1**: A řady z před a po ještě efektivněji při aktualizaci Data událostí v GridView ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="09370-127">**Figure 1**: A Series of Pre- and Post-Events Fire When Updating Data in a GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image3.png))</span></span>


<span data-ttu-id="09370-128">V tomto kurzu podíváme pomocí těchto událostí rozšířit předdefinovaný vložení aktualizace a odstranění možnosti dat ASP.NET Web ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="09370-128">In this tutorial we'll examine using these events to extend the built-in inserting, updating, and deleting capabilities of the ASP.NET data Web controls.</span></span> <span data-ttu-id="09370-129">Také jsme zobrazí postup přizpůsobení úpravy rozhraní, které chcete aktualizovat pouze podmnožinu pole produktu.</span><span class="sxs-lookup"><span data-stu-id="09370-129">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="step-1-updating-a-productsproductnameandunitpricefields"></a><span data-ttu-id="09370-130">Krok 1: Aktualizace produktu`ProductName`a`UnitPrice`pole</span><span class="sxs-lookup"><span data-stu-id="09370-130">Step 1: Updating a Product's`ProductName`and`UnitPrice`Fields</span></span>

<span data-ttu-id="09370-131">Úpravy rozhraní z předchozí kurzu *všechny* polí produktu, které nebyly jen pro čtení musí být zahrnut.</span><span class="sxs-lookup"><span data-stu-id="09370-131">In the editing interfaces from the previous tutorial *all* product fields that were not read-only had to be included.</span></span> <span data-ttu-id="09370-132">Pokud nám chcete pole odebrat z GridView - vyslovení `QuantityPerUnit` – aktualizace dat ovládací prvek webu dat nebude nastavena ObjectDataSource `QuantityPerUnit` `UpdateParameters` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="09370-132">If we were to remove a field from the GridView - say `QuantityPerUnit` - when updating the data the data Web control would not set the ObjectDataSource's `QuantityPerUnit` `UpdateParameters` value.</span></span> <span data-ttu-id="09370-133">ObjectDataSource by pak předejte `null` hodnotu do `UpdateProduct` obchodní logiky vrstvy (BLL) metodu, která by způsobila změnu záznam upravená databáze `QuantityPerUnit` sloupec, který se `NULL` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="09370-133">The ObjectDataSource would then pass in a `null` value into the `UpdateProduct` Business Logic Layer (BLL) method, which would change the edited database record's `QuantityPerUnit` column to a `NULL` value.</span></span> <span data-ttu-id="09370-134">Podobně, pokud povinné pole, například `ProductName`, se odebere z rozhraní úpravy se aktualizace nezdaří s "*'ProductName' sloupec nepovoluje hodnoty Null*" výjimka.</span><span class="sxs-lookup"><span data-stu-id="09370-134">Similarly, if a required field, such as `ProductName`, is removed from the editing interface, the update will fail with a "*Column 'ProductName' does not allow nulls*" exception.</span></span> <span data-ttu-id="09370-135">Důvod pro toto chování se, protože ObjectDataSource byla nakonfigurována pro volání `ProductsBLL` třídy `UpdateProduct` metodu, která očekává vstupního parametru pro každé pole produktu.</span><span class="sxs-lookup"><span data-stu-id="09370-135">The reason for this behavior was because the ObjectDataSource was configured to call the `ProductsBLL` class's `UpdateProduct` method, which expected an input parameter for each of the product fields.</span></span> <span data-ttu-id="09370-136">Proto ObjectDataSource na `UpdateParameters` kolekce obsahovala parametr pro každou metodu je vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="09370-136">Therefore, the ObjectDataSource's `UpdateParameters` collection contained a parameter for each of the method's input parameters.</span></span>

<span data-ttu-id="09370-137">Pokud chceme poskytují data ovládací prvek webu, která umožňuje koncovým uživatelům aktualizovat pouze podmnožinu pole, pak je potřeba buď programově nastavit chybějící `UpdateParameters` hodnoty v prvku ObjectDataSource `Updating` obslužné rutiny události nebo vytvořte a volání metody BLL, který očekává jenom podmnožinu pole.</span><span class="sxs-lookup"><span data-stu-id="09370-137">If we want to provide a data Web control that allows the end user to only update a subset of fields, then we need to either programmatically set the missing `UpdateParameters` values in the ObjectDataSource's `Updating` event handler or create and call a BLL method that expects only a subset of the fields.</span></span> <span data-ttu-id="09370-138">Podíváme se na tento pozdější přístup.</span><span class="sxs-lookup"><span data-stu-id="09370-138">Let's explore this latter approach.</span></span>

<span data-ttu-id="09370-139">Konkrétně můžeme vytvořit stránku, která zobrazuje jenom na `ProductName` a `UnitPrice` polí v upravitelné GridView.</span><span class="sxs-lookup"><span data-stu-id="09370-139">Specifically, let's create a page that displays just the `ProductName` and `UnitPrice` fields in an editable GridView.</span></span> <span data-ttu-id="09370-140">Tato rutina GridView úpravy rozhraní pouze umožní uživatelům aktualizovat dvě zobrazené pole, `ProductName` a `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="09370-140">This GridView's editing interface will only allow the user to update the two displayed fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="09370-141">Vzhledem k tomu, že toto úpravy rozhraní zobrazuje pouze podmnožinu pole produktů, musíme buď vytvořit ObjectDataSource, který používá existující BLL `UpdateProduct` metoda a chybějící hodnoty polí produktu nastavil prostřednictvím kódu programu v jeho `Updating` událostí Obslužná rutina nebo jsme muset vytvořit nové BLL metodu, která očekává pouze dílčí sadu pole definovaná v GridView.</span><span class="sxs-lookup"><span data-stu-id="09370-141">Since this editing interface only provides a subset of a product's fields, we either need to create an ObjectDataSource that uses the existing BLL's `UpdateProduct` method and has the missing product field values set programmatically in its `Updating` event handler, or we need to create a new BLL method that expects only the subset of fields defined in the GridView.</span></span> <span data-ttu-id="09370-142">V tomto kurzu budeme, použijte druhou možnost a přetížit `UpdateProduct` metoda, ten, který přebírá jenom tři vstupní parametry: `productName`, `unitPrice`, a `productID`:</span><span class="sxs-lookup"><span data-stu-id="09370-142">For this tutorial, let's use the latter option and create an overload of the `UpdateProduct` method, one that takes in just three input parameters: `productName`, `unitPrice`, and `productID`:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample1.cs)]

<span data-ttu-id="09370-143">Jako původní `UpdateProduct` metoda, toto přetížení začne zjišťujeme, pokud je v databázi se zadaným produktem `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="09370-143">Like the original `UpdateProduct` method, this overload starts by checking to see if there is a product in the database with the specified `ProductID`.</span></span> <span data-ttu-id="09370-144">Pokud ne, vrátí hodnotu `false`, což indikuje, že žádost o aktualizaci informací o produktu se nezdařila.</span><span class="sxs-lookup"><span data-stu-id="09370-144">If not, it returns `false`, indicating that the request to update the product information failed.</span></span> <span data-ttu-id="09370-145">V opačném případě aktualizuje stávající záznam produktu `ProductName` a `UnitPrice` polí s odpovídajícím způsobem a potvrdí aktualizace voláním TableAdpater `Update()` předávání v případě metody `ProductsRow` instance.</span><span class="sxs-lookup"><span data-stu-id="09370-145">Otherwise it updates the existing product record's `ProductName` and `UnitPrice` fields accordingly and commits the update by calling the TableAdpater's `Update()` method, passing in the `ProductsRow` instance.</span></span>

<span data-ttu-id="09370-146">Pomocí tohoto přidání do našich `ProductsBLL` třídy, je vše připraveno k vytvoření zjednodušené rozhraní GridView.</span><span class="sxs-lookup"><span data-stu-id="09370-146">With this addition to our `ProductsBLL` class, we're ready to create the simplified GridView interface.</span></span> <span data-ttu-id="09370-147">Otevřete `DataModificationEvents.aspx` v `EditInsertDelete` složky a přidat GridView na stránku.</span><span class="sxs-lookup"><span data-stu-id="09370-147">Open the `DataModificationEvents.aspx` in the `EditInsertDelete` folder and add a GridView to the page.</span></span> <span data-ttu-id="09370-148">Vytvoření nové ObjectDataSource a nakonfigurujte ho na použití `ProductsBLL` třídy s jeho `Select()` metoda mapování na `GetProducts` a jeho `Update()` metoda mapování `UpdateProduct` přetížení, které přijímá pouze v `productName`, `unitPrice`, a `productID` vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="09370-148">Create a new ObjectDataSource and configure it to use the `ProductsBLL` class with its `Select()` method mapping to `GetProducts` and its `Update()` method mapping to the `UpdateProduct` overload that takes in only the `productName`, `unitPrice`, and `productID` input parameters.</span></span> <span data-ttu-id="09370-149">Obrázek 2 ukazuje průvodce vytvořit zdroj dat při mapování ObjectDataSource `Update()` metodu `ProductsBLL` třída je nové `UpdateProduct` přetížení metody.</span><span class="sxs-lookup"><span data-stu-id="09370-149">Figure 2 shows the Create Data Source wizard when mapping the ObjectDataSource's `Update()` method to the `ProductsBLL` class's new `UpdateProduct` method overload.</span></span>


<span data-ttu-id="09370-150">[![Map – Metoda Update() ObjectDataSource nové UpdateProduct přetížení](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="09370-150">[![Map the ObjectDataSource's Update() Method to the New UpdateProduct Overload](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image4.png)</span></span>

<span data-ttu-id="09370-151">**Obrázek 2**: mapování ObjectDataSource `Update()` metodu pro nový `UpdateProduct` přetížení ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="09370-151">**Figure 2**: Map the ObjectDataSource's `Update()` Method to the New `UpdateProduct` Overload ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image6.png))</span></span>


<span data-ttu-id="09370-152">Vzhledem k tomu, že naše ukázka původně právě potřebovat možnost upravovat data, ale není pro vložení nebo odstranit záznamy, pozorně explicitně označuje, že ObjectDataSource `Insert()` a `Delete()` metody by neměla být namapované na žádnou `ProductsBLL` třídy a metody přejdete na kartách INSERT a DELETE a zvolením (None) z rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="09370-152">Since our example will initially just need the ability to edit data, but not to insert or delete records, take a moment to explicitly indicate that the ObjectDataSource's `Insert()` and `Delete()` methods shouldn't be mapped to any of the `ProductsBLL` class's methods by going to the INSERT and DELETE tabs and choosing (None) from the drop-down list.</span></span>


<span data-ttu-id="09370-153">[![Zvolte (žádný) z rozevíracího seznamu pro příkaz INSERT a DELETE karty](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="09370-153">[![Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image7.png)</span></span>

<span data-ttu-id="09370-154">**Obrázek 3**: Zvolte (žádný) z rozevíracím seznamu pro vložení a odstranit karty ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="09370-154">**Figure 3**: Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image9.png))</span></span>


<span data-ttu-id="09370-155">Po dokončení tohoto průvodce zaškrtněte políčko Povolit úpravy z prvku GridView inteligentních značek.</span><span class="sxs-lookup"><span data-stu-id="09370-155">After completing this wizard check the Enable Editing checkbox from the GridView's smart tag.</span></span>

<span data-ttu-id="09370-156">Visual Studio s dokončením průvodce vytvořte zdroj dat a který vytvoření vazby na GridView vytvořil deklarativní syntaxi pro oba ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="09370-156">With the completion of the Create Data Source wizard and binding that to the GridView, Visual Studio has created the declarative syntax for both controls.</span></span> <span data-ttu-id="09370-157">Přejdete na zobrazení zdroje, chcete-li prověřit ObjectDataSource deklarativní značky, které jsou uvedeny níže:</span><span class="sxs-lookup"><span data-stu-id="09370-157">Go to the Source view to inspect the ObjectDataSource's declarative markup, which is shown below:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample2.aspx)]

<span data-ttu-id="09370-158">Vzhledem k tomu, že neexistují žádná mapování pro ObjectDataSource `Insert()` a `Delete()` metody, neexistují žádné `InsertParameters` nebo `DeleteParameters` oddíly.</span><span class="sxs-lookup"><span data-stu-id="09370-158">Since there are no mappings for the ObjectDataSource's `Insert()` and `Delete()` methods, there are no `InsertParameters` or `DeleteParameters` sections.</span></span> <span data-ttu-id="09370-159">Kromě toho od `Update()` metoda je namapovaný na `UpdateProduct` přetížení metody, která přijímá jenom tři vstupní parametry, `UpdateParameters` obsahuje jenom tři `Parameter` instance.</span><span class="sxs-lookup"><span data-stu-id="09370-159">Furthermore, since the `Update()` method is mapped to the `UpdateProduct` method overload that only accepts three input parameters, the `UpdateParameters` section has just three `Parameter` instances.</span></span>

<span data-ttu-id="09370-160">Všimněte si, že ObjectDataSource `OldValuesParameterFormatString` je nastavena na `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="09370-160">Note that the ObjectDataSource's `OldValuesParameterFormatString` property is set to `original_{0}`.</span></span> <span data-ttu-id="09370-161">Tato vlastnost je nastavena automaticky Visual Studio, při použití Průvodce konfigurace zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="09370-161">This property is set automatically by Visual Studio when using the Configure Data Source wizard.</span></span> <span data-ttu-id="09370-162">Ale vzhledem k tomu, že naše BLL metody neočekávané původní `ProductID` hodnota, která má být předán, odeberte toto přiřazení vlastnosti zcela z ObjectDataSource deklarativní syntaxe.</span><span class="sxs-lookup"><span data-stu-id="09370-162">However, since our BLL methods don't expect the original `ProductID` value to be passed in, remove this property assignment altogether from the ObjectDataSource's declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="09370-163">Pokud zrušíte jednoduše `OldValuesParameterFormatString` hodnotu vlastnosti z okna vlastností v zobrazení návrhu, vlastnost bude stále existovat v deklarativní syntaxi, ale bude nastavena pro prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="09370-163">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but will be set to an empty string.</span></span> <span data-ttu-id="09370-164">Buď odeberte vlastnost zcela od deklarativní syntaxi nebo, v okně Vlastnosti, nastavte hodnotu na výchozí, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="09370-164">Either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>


<span data-ttu-id="09370-165">Zatímco ObjectDataSource má jenom `UpdateParameters` pro název, ceny a ID produktu Visual Studio přidala BoundField nebo vlastnost CheckBoxField v GridView pro každé pole produktu.</span><span class="sxs-lookup"><span data-stu-id="09370-165">While the ObjectDataSource only has `UpdateParameters` for the product's name, price, and ID, Visual Studio has added a BoundField or CheckBoxField in the GridView for each of the product's fields.</span></span>


<span data-ttu-id="09370-166">[![GridView obsahuje BoundField nebo vlastnost CheckBoxField pro každé pole produktu](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="09370-166">[![The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image10.png)</span></span>

<span data-ttu-id="09370-167">**Obrázek 4**: GridView obsahuje BoundField nebo vlastnost CheckBoxField pro každé pole produktu ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="09370-167">**Figure 4**: The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image12.png))</span></span>


<span data-ttu-id="09370-168">Když koncový uživatel upravuje produktu a kliknutím na tlačítko jeho aktualizaci, zobrazí GridView těchto polí, které nebyly jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="09370-168">When the end user edits a product and clicks its Update button, the GridView enumerates those fields that were not read-only.</span></span> <span data-ttu-id="09370-169">Potom nastaví hodnotu odpovídající parametr v prvku ObjectDataSource `UpdateParameters` kolekce hodnotě zadané uživatelem.</span><span class="sxs-lookup"><span data-stu-id="09370-169">It then sets the value of the corresponding parameter in the ObjectDataSource's `UpdateParameters` collection to the value entered by the user.</span></span> <span data-ttu-id="09370-170">Pokud není k dispozici odpovídající parametr, přidá GridView jedna kolekce.</span><span class="sxs-lookup"><span data-stu-id="09370-170">If there is not a corresponding parameter, the GridView adds one to the collection.</span></span> <span data-ttu-id="09370-171">Proto pokud naše GridView obsahuje BoundFields a CheckBoxFields pro všechna pole produktu, ObjectDataSource dojdete k vyvolání `UpdateProduct` přetížení, které přijímá ve všech těchto parametrů, přestože, ObjectDataSource deklarativní určuje jenom tři vstupní parametry (viz obrázek 5).</span><span class="sxs-lookup"><span data-stu-id="09370-171">Therefore, if our GridView contains BoundFields and CheckBoxFields for all of the product's fields, the ObjectDataSource will end up invoking the `UpdateProduct` overload that takes in all of these parameters, despite the fact that the ObjectDataSource's declarative markup specifies only three input parameters (see Figure 5).</span></span> <span data-ttu-id="09370-172">Podobně, pokud je některou kombinaci hodnot jiných jen pro čtení produktu, které se pole v GridView, který neodpovídá vstupní parametry pro `UpdateProduct` přetížení, při pokusu o aktualizaci, bude vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="09370-172">Similarly, if there is some combination of non-read-only product fields in the GridView that doesn't correspond to the input parameters for a `UpdateProduct` overload, an exception will be raised when attempting to update.</span></span>


<span data-ttu-id="09370-173">[![Rutina GridView bude přidat parametry do kolekce UpdateParameters ObjectDataSource](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="09370-173">[![The GridView Will Add Parameters to the ObjectDataSource's UpdateParameters Collection](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image13.png)</span></span>

<span data-ttu-id="09370-174">**Obrázek 5**: The GridView bude přidání parametrů ke ObjectDataSource `UpdateParameters` kolekce ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="09370-174">**Figure 5**: The GridView Will Add Parameters to the ObjectDataSource's `UpdateParameters` Collection ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image15.png))</span></span>


<span data-ttu-id="09370-175">K zajištění, že ObjectDataSource vyvolá `UpdateProduct` přetížení při právě produktu název, ceny a ID, je potřeba omezit GridView na situaci, kdy upravitelné pole pro jenom na `ProductName` a `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="09370-175">To ensure that the ObjectDataSource invokes the `UpdateProduct` overload that takes in just the product's name, price, and ID, we need to restrict the GridView to having editable fields for just the `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="09370-176">Toho lze dosáhnout odebráním dalším BoundFields a CheckBoxFields, nastavením, ty další pole `ReadOnly` vlastnost `true`, nebo některé kombinaci obojího.</span><span class="sxs-lookup"><span data-stu-id="09370-176">This can be accomplished by removing the other BoundFields and CheckBoxFields, by setting those other fields' `ReadOnly` property to `true`, or by some combination of the two.</span></span> <span data-ttu-id="09370-177">V tomto kurzu budeme stačí odstranit všechna pole GridView s výjimkou `ProductName` a `UnitPrice` BoundFields, po které bude vypadat prvku GridView deklarativní značky:</span><span class="sxs-lookup"><span data-stu-id="09370-177">For this tutorial let's simply remove all GridView fields except the `ProductName` and `UnitPrice` BoundFields, after which the GridView's declarative markup will look like:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample3.aspx)]

<span data-ttu-id="09370-178">I když `UpdateProduct` přetížení očekává tři vstupní parametry, máme dvě BoundFields pouze v našem GridView.</span><span class="sxs-lookup"><span data-stu-id="09370-178">Even though the `UpdateProduct` overload expects three input parameters, we only have two BoundFields in our GridView.</span></span> <span data-ttu-id="09370-179">Důvodem je, že `productID` vstupní parametr je hodnotu primárního klíče a v předána hodnota `DataKeyNames` vlastnost pro upravená řádek.</span><span class="sxs-lookup"><span data-stu-id="09370-179">This is because the `productID` input parameter is a primary key value and passed in through the value of the `DataKeyNames` property for the edited row.</span></span>

<span data-ttu-id="09370-180">Naše GridView, spolu s `UpdateProduct` přetížení, umožňuje uživateli upravit pouze název a cena produktu beze ztráty v ostatních polích produktu.</span><span class="sxs-lookup"><span data-stu-id="09370-180">Our GridView, along with the `UpdateProduct` overload, allows a user to edit just the name and price of a product without losing any of the other product fields.</span></span>


<span data-ttu-id="09370-181">[![Rozhraní umožňuje úpravy právě produktu název a cena](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="09370-181">[![The Interface Allows Editing Just the Product's Name and Price](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image16.png)</span></span>

<span data-ttu-id="09370-182">**Obrázek 6**: umožňuje rozhraní úpravy právě produktu název a cena ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="09370-182">**Figure 6**: The Interface Allows Editing Just the Product's Name and Price ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="09370-183">Jak je popsáno v předchozí kurz, je životně důležitá, že GridView stav zobrazení s být povolené (výchozí nastavení).</span><span class="sxs-lookup"><span data-stu-id="09370-183">As discussed in the previous tutorial, it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="09370-184">Pokud jste nastavili GridView s `EnableViewState` vlastnost `false`, riskujete, že náhodně odstraněním nebo úpravou zaznamenává počet uživatelů.</span><span class="sxs-lookup"><span data-stu-id="09370-184">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="09370-185">V tématu [upozornění: souběžnosti problém s ASP.NET 2.0 GridViews nebo DetailsView/FormViews tento podpora úpravy nebo odstranění a jejichž stav zobrazení je zakázána](http://scottonwriting.net/sowblog/archive/2006/10/03/163215.aspx) Další informace.</span><span class="sxs-lookup"><span data-stu-id="09370-185">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/archive/2006/10/03/163215.aspx) for more information.</span></span>


## <a name="improving-theunitpriceformatting"></a><span data-ttu-id="09370-186">Vylepšení`UnitPrice`formátování</span><span class="sxs-lookup"><span data-stu-id="09370-186">Improving the`UnitPrice`Formatting</span></span>

<span data-ttu-id="09370-187">Při na GridView příklad na obrázku 6 funguje `UnitPrice` pole není naformátovaná vůbec, což vede k zobrazení ceny, které nemá žádné měny symboly a má čtyři desetinná místa.</span><span class="sxs-lookup"><span data-stu-id="09370-187">While the GridView example shown in Figure 6 works, the `UnitPrice` field is not formatted at all, resulting in a price display that lacks any currency symbols and has four decimal places.</span></span> <span data-ttu-id="09370-188">Použít pro upravovat řádky měny, jednoduše nastavit `UnitPrice` BoundField na `DataFormatString` vlastnost `{0:c}` a jeho `HtmlEncode` vlastnost `false`.</span><span class="sxs-lookup"><span data-stu-id="09370-188">To apply a currency formatting for the non-editable rows, simply set the `UnitPrice` BoundField's `DataFormatString` property to `{0:c}` and its `HtmlEncode` property to `false`.</span></span>


<span data-ttu-id="09370-189">[![Nastavte pole UnitPrice DataFormatString a vlastnosti HtmlEncode odpovídajícím způsobem](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="09370-189">[![Set the UnitPrice's DataFormatString and HtmlEncode Properties Accordingly](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image19.png)</span></span>

<span data-ttu-id="09370-190">**Obrázek 7**: nastavte `UnitPrice`na `DataFormatString` a `HtmlEncode` vlastnosti odpovídajícím způsobem ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="09370-190">**Figure 7**: Set the `UnitPrice`'s `DataFormatString` and `HtmlEncode` Properties Accordingly ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image21.png))</span></span>


<span data-ttu-id="09370-191">Díky této změně formátu upravovat řádky za cenu jako měnu; upravená řádek, ale stále zobrazuje hodnotu bez symbolu měny a s čtyři desetinná místa.</span><span class="sxs-lookup"><span data-stu-id="09370-191">With this change, the non-editable rows format the price as a currency; the edited row, however, still displays the value without the currency symbol and with four decimal places.</span></span>


<span data-ttu-id="09370-192">[![Nelze upravit bez řádky jsou nyní naformátovat jako hodnoty měny](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="09370-192">[![Non-Editable Rows are Now Formatted as Currency Values](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image22.png)</span></span>

<span data-ttu-id="09370-193">**Obrázek 8**: upravovat řádky jsou nyní formátovaný jako hodnoty měny ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="09370-193">**Figure 8**: Non-Editable Rows are Now Formatted as Currency Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image24.png))</span></span>


<span data-ttu-id="09370-194">Pokyny k formátování zadané v `DataFormatString` vlastnost lze použít k úpravě rozhraní nastavením BoundField `ApplyFormatInEditMode` vlastnost `true` (výchozí hodnota je `false`).</span><span class="sxs-lookup"><span data-stu-id="09370-194">The formatting instructions specified in the `DataFormatString` property can be applied to the editing interface by setting the BoundField's `ApplyFormatInEditMode` property to `true` (the default is `false`).</span></span> <span data-ttu-id="09370-195">Za chvíli tuto vlastnost nastavit na `true`.</span><span class="sxs-lookup"><span data-stu-id="09370-195">Take a moment to set this property to `true`.</span></span>


<span data-ttu-id="09370-196">[![Nastavte vlastnost ApplyFormatInEditMode UnitPrice BoundField na hodnotu true](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="09370-196">[![Set the UnitPrice BoundField's ApplyFormatInEditMode property to true](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image25.png)</span></span>

<span data-ttu-id="09370-197">**Obrázek 9**: nastavte `UnitPrice` na BoundField `ApplyFormatInEditMode` vlastnost `true` ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="09370-197">**Figure 9**: Set the `UnitPrice` BoundField's `ApplyFormatInEditMode` property to `true` ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image27.png))</span></span>


<span data-ttu-id="09370-198">Díky této změně hodnotu `UnitPrice` zobrazí v upravená řádek je formát měny.</span><span class="sxs-lookup"><span data-stu-id="09370-198">With this change, the value of the `UnitPrice` displayed in the edited row is also formatted as a currency.</span></span>


<span data-ttu-id="09370-199">[![Hodnota UnitPrice upravovaný řádek je nyní naformátovat jako měny](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="09370-199">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image28.png)</span></span>

<span data-ttu-id="09370-200">**Obrázek 10**: Upravit řádku `UnitPrice` hodnota je nyní formátu měny ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="09370-200">**Figure 10**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image30.png))</span></span>


<span data-ttu-id="09370-201">Však aktualizace produktu pomocí symbolu měny do textového pole, jako je $19.00 vyvolá `FormatException`.</span><span class="sxs-lookup"><span data-stu-id="09370-201">However, updating a product with the currency symbol in the textbox such as $19.00 throws a `FormatException`.</span></span> <span data-ttu-id="09370-202">Když se pokusí přiřadit hodnoty zadané uživatelem ObjectDataSource GridView `UpdateParameters` kolekce je možné převést `UnitPrice` řetězec "$19.00" do `decimal` vyžaduje parametr (viz obrázek 11).</span><span class="sxs-lookup"><span data-stu-id="09370-202">When the GridView attempts to assign the user-supplied values to the ObjectDataSource's `UpdateParameters` collection it is unable to convert the `UnitPrice` string "$19.00" into the `decimal` required by the parameter (see Figure 11).</span></span> <span data-ttu-id="09370-203">Chcete-li to opravit můžeme vytvořit obslužnou rutinu události pro prvku GridView `RowUpdating` událostí a mějte ho analyzovat uživatelem zadané `UnitPrice` jako měnu formátu `decimal`.</span><span class="sxs-lookup"><span data-stu-id="09370-203">To remedy this we can create an event handler for the GridView's `RowUpdating` event and have it parse the user-supplied `UnitPrice` as a currency-formatted `decimal`.</span></span>

<span data-ttu-id="09370-204">Prvku GridView `RowUpdating` událost přijme jako její druhý parametr objekt typu [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), což zahrnuje `NewValues` slovníku jako jeden z jeho vlastnosti, které obsahuje hodnoty připravené k zadané uživatelem přiřazené ObjectDataSource `UpdateParameters` kolekce.</span><span class="sxs-lookup"><span data-stu-id="09370-204">The GridView's `RowUpdating` event accepts as its second parameter an object of type [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), which includes a `NewValues` dictionary as one of its properties that holds the user-supplied values ready to be assigned to the ObjectDataSource's `UpdateParameters` collection.</span></span> <span data-ttu-id="09370-205">Jsme můžete přepsat existující `UnitPrice` hodnotu `NewValues` kolekce s desetinnou hodnotou analyzovat pomocí následující řádky kódu ve formátu měny `RowUpdating` obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="09370-205">We can overwrite the existing `UnitPrice` value in the `NewValues` collection with a decimal value parsed using the currency format with the following lines of code in the `RowUpdating` event handler:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample4.cs)]

<span data-ttu-id="09370-206">Pokud má zadaný uživatel `UnitPrice` hodnotu (například "$19.00"), se tato hodnota přepíše s desetinnou hodnotou vypočítávají podle [Decimal.Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), analýza hodnotu jako měny.</span><span class="sxs-lookup"><span data-stu-id="09370-206">If the user has supplied a `UnitPrice` value (such as "$19.00"), this value is overwritten with the decimal value computed by [Decimal.Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), parsing the value as a currency.</span></span> <span data-ttu-id="09370-207">To bude správně analyzovat desetinné v případě symboly měny, čárky, desetinných míst a tak dále a používá [výčet NumberStyles](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) v [System.Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="09370-207">This will correctly parse the decimal in the event of any currency symbols, commas, decimal points, and so on, and uses the [NumberStyles enumeration](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) in the [System.Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) namespace.</span></span>

<span data-ttu-id="09370-208">Obrázek 11 ukazuje potíže způsobené symboly měny v uživatelem zadané `UnitPrice`, společně s postupy prvku GridView `RowUpdating` obslužné rutiny události, můžete použít k správně analyzovat takové vstup.</span><span class="sxs-lookup"><span data-stu-id="09370-208">Figure 11 shows both the problem caused by currency symbols in the user-supplied `UnitPrice`, along with how the GridView's `RowUpdating` event handler can be utilized to correctly parse such input.</span></span>


<span data-ttu-id="09370-209">[![Hodnota UnitPrice upravovaný řádek je nyní naformátovat jako měny](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="09370-209">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image31.png)</span></span>

<span data-ttu-id="09370-210">**Obrázek 11**: Upravit řádku `UnitPrice` hodnota je nyní formátu měny ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="09370-210">**Figure 11**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image33.png))</span></span>


## <a name="step-2-prohibitingnull-unitprices"></a><span data-ttu-id="09370-211">Krok 2: zákaz`NULL UnitPrices`</span><span class="sxs-lookup"><span data-stu-id="09370-211">Step 2: Prohibiting`NULL UnitPrices`</span></span>

<span data-ttu-id="09370-212">Během konfigurace databáze umožňuje `NULL` hodnoty ve `Products` tabulky `UnitPrice` sloupce, jsme chtít zabránit uživatelům, kteří navštíví konkrétní stránku zadat `NULL` `UnitPrice` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="09370-212">While the database is configured to allow `NULL` values in the `Products` table's `UnitPrice` column, we may want to prevent users visiting this particular page from specifying a `NULL` `UnitPrice` value.</span></span> <span data-ttu-id="09370-213">To znamená pokud uživatel nezadá `UnitPrice` hodnota při úpravě řádek produktu, nikoli uložte výsledky do databáze chceme zobrazit zprávu informující uživatele, že pomocí této stránky, musí mít všechny produkty, upravená cena zadaná.</span><span class="sxs-lookup"><span data-stu-id="09370-213">That is, if a user fails to enter a `UnitPrice` value when editing a product row, rather than save the results to the database we want to display a message informing the user that, through this page, any edited products must have a price specified.</span></span>

<span data-ttu-id="09370-214">`GridViewUpdateEventArgs` Objekt předaný do prvku GridView `RowUpdating` obsahuje obslužné rutiny události `Cancel` vlastnost, pokud nastavena na `true`, ukončí proces aktualizace.</span><span class="sxs-lookup"><span data-stu-id="09370-214">The `GridViewUpdateEventArgs` object passed into the GridView's `RowUpdating` event handler contains a `Cancel` property that, if set to `true`, terminates the updating process.</span></span> <span data-ttu-id="09370-215">Umožňuje rozšířit `RowUpdating` obslužné rutiny události nastavit `e.Cancel` k `true` a zobrazí zprávu vysvětlením důvod, proč, pokud `UnitPrice` hodnotu `NewValues` kolekce je `null`.</span><span class="sxs-lookup"><span data-stu-id="09370-215">Let's extend the `RowUpdating` event handler to set `e.Cancel` to `true` and display a message explaining why if the `UnitPrice` value in the `NewValues` collection is `null`.</span></span>

<span data-ttu-id="09370-216">Začněte tím, že přidání ovládacího prvku popisek webovou stránku s názvem `MustProvideUnitPriceMessage`.</span><span class="sxs-lookup"><span data-stu-id="09370-216">Start by adding a Label Web control to the page named `MustProvideUnitPriceMessage`.</span></span> <span data-ttu-id="09370-217">Tento popisek – ovládací prvek se zobrazí, pokud uživatel k určení `UnitPrice` hodnota při aktualizaci produktu.</span><span class="sxs-lookup"><span data-stu-id="09370-217">This Label control will be displayed if the user fails to specify a `UnitPrice` value when updating a product.</span></span> <span data-ttu-id="09370-218">Nastavte jeho `Text` vlastnost "Je nutné zadat cenu pro produkt."</span><span class="sxs-lookup"><span data-stu-id="09370-218">Set the Label's `Text` property to "You must provide a price for the product."</span></span> <span data-ttu-id="09370-219">Vytvořili jste taky novou třídu CSS v `Styles.css` s názvem `Warning` s následující definice:</span><span class="sxs-lookup"><span data-stu-id="09370-219">I've also created a new CSS class in `Styles.css` named `Warning` with the following definition:</span></span>


[!code-css[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample5.css)]

<span data-ttu-id="09370-220">Nakonec nastavte jeho `CssClass` vlastnost `Warning`.</span><span class="sxs-lookup"><span data-stu-id="09370-220">Finally, set the Label's `CssClass` property to `Warning`.</span></span> <span data-ttu-id="09370-221">V tomto okamžiku návrháře by se zobrazit upozornění v red, tučné, kurzíva, velikost velmi velkými písmeny výše GridView, jak ukazuje obrázek 12.</span><span class="sxs-lookup"><span data-stu-id="09370-221">At this point the Designer should show the warning message in a red, bold, italic, extra large font size above the GridView, as shown in Figure 12.</span></span>


<span data-ttu-id="09370-222">[![Štítek se přidal výše GridView](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="09370-222">[![A Label Has Been Added Above the GridView](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image34.png)</span></span>

<span data-ttu-id="09370-223">**Obrázek 12**: A popisek má byla přidána výše GridView ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="09370-223">**Figure 12**: A Label Has Been Added Above the GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image36.png))</span></span>


<span data-ttu-id="09370-224">Ve výchozím nastavení, by být tento popisek skrytý, takže nastavit jeho `Visible` vlastnost `false` v `Page_Load` obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="09370-224">By default, this Label should be hidden, so set its `Visible` property to `false` in the `Page_Load` event handler:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample6.cs)]

<span data-ttu-id="09370-225">Pokud se uživatel pokusí o aktualizaci produktu bez zadání `UnitPrice`, chceme zrušit aktualizaci a zobrazit upozornění popisku.</span><span class="sxs-lookup"><span data-stu-id="09370-225">If the user attempts to update a product without specifying the `UnitPrice`, we want to cancel the update and display the warning label.</span></span> <span data-ttu-id="09370-226">Posílení prvku GridView `RowUpdating` obslužné rutiny události následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="09370-226">Augment the GridView's `RowUpdating` event handler as follows:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample7.cs)]

<span data-ttu-id="09370-227">Pokud uživatel se pokusí uložit bez zadání cenu produktu, aktualizace byla zrušena, a zobrazí se zpráva s užitečné.</span><span class="sxs-lookup"><span data-stu-id="09370-227">If a user attempts to save a product without specifying a price, the update is cancelled and a helpful message is displayed.</span></span> <span data-ttu-id="09370-228">Při databáze (a obchodní logiku) umožňuje `NULL` `UnitPrice` s, tato konkrétní stránka technologie ASP.NET není.</span><span class="sxs-lookup"><span data-stu-id="09370-228">While the database (and business logic) allows for `NULL` `UnitPrice` s, this particular ASP.NET page does not.</span></span>


<span data-ttu-id="09370-229">[![Uživatele nelze ponechat prázdný UnitPrice](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="09370-229">[![A User Cannot Leave UnitPrice Blank](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image37.png)</span></span>

<span data-ttu-id="09370-230">**Obrázek 13**: A nemůžete opustit uživatele `UnitPrice` prázdné ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="09370-230">**Figure 13**: A User Cannot Leave `UnitPrice` Blank ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image39.png))</span></span>


<span data-ttu-id="09370-231">Zatím jsme viděli, jak používat prvku GridView `RowUpdating` událostí prostřednictvím kódu programu změnit hodnoty parametru přiřazené ObjectDataSource `UpdateParameters` kolekce a jak zrušit aktualizaci zpracovat zcela.</span><span class="sxs-lookup"><span data-stu-id="09370-231">So far we have seen how to use the GridView's `RowUpdating` event to programmatically alter the parameter values assigned to the ObjectDataSource's `UpdateParameters` collection as well as how to cancel the updating process altogether.</span></span> <span data-ttu-id="09370-232">Tyto koncepty přenesou do ovládacích prvků DetailsView a FormView a platí také pro vkládání a odstraňování.</span><span class="sxs-lookup"><span data-stu-id="09370-232">These concepts carry over to the DetailsView and FormView controls and also apply to inserting and deleting.</span></span>

<span data-ttu-id="09370-233">Tyto úlohy lze také provést na úrovni ObjectDataSource prostřednictvím obslužné rutiny události pro jeho `Inserting`, `Updating`, a `Deleting` události.</span><span class="sxs-lookup"><span data-stu-id="09370-233">These tasks can also be done at the ObjectDataSource level through event handlers for its `Inserting`, `Updating`, and `Deleting` events.</span></span> <span data-ttu-id="09370-234">Tyto události fire před vyvoláním související metody podkladového objektu a zadejte poslední chance moci upravit kolekci vstupní parametry, nebo přímý operaci zrušte.</span><span class="sxs-lookup"><span data-stu-id="09370-234">These events fire before the associated method of the underlying object is invoked and provide a last-chance opportunity to modify the input parameters collection or cancel the operation outright.</span></span> <span data-ttu-id="09370-235">Obslužné rutiny události pro tyto tři události jsou předávány na objektu typu [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) má dvě vlastnosti, které vás zajímají:</span><span class="sxs-lookup"><span data-stu-id="09370-235">The event handlers for these three events are passed an object of type [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) that has two properties of interest:</span></span>

- <span data-ttu-id="09370-236">[Zrušit](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), která, pokud nastavena na `true`, zruší prováděnou operaci</span><span class="sxs-lookup"><span data-stu-id="09370-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), which, if set to `true`, cancels the operation being performed</span></span>
- <span data-ttu-id="09370-237">[Vstupní parametry](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), což je kolekce `InsertParameters`, `UpdateParameters`, nebo `DeleteParameters`, v závislosti na tom, zda obslužná rutina události pro `Inserting`, `Updating`, nebo `Deleting` událostí</span><span class="sxs-lookup"><span data-stu-id="09370-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), which is the collection of `InsertParameters`, `UpdateParameters`, or `DeleteParameters`, depending on whether the event handler is for the `Inserting`, `Updating`, or `Deleting` event</span></span>

<span data-ttu-id="09370-238">Pro ilustraci práce s hodnotami parametrů na úrovni ObjectDataSource, umožňuje zahrnout DetailsView naši stránku, který umožňuje uživatelům přidání nového produktu.</span><span class="sxs-lookup"><span data-stu-id="09370-238">To illustrate working with the parameter values at the ObjectDataSource level, let's include a DetailsView in our page that allows the users to add a new product.</span></span> <span data-ttu-id="09370-239">Tato DetailsView se použije k poskytnutí rozhraní pro rychle přidání nového produktu do databáze.</span><span class="sxs-lookup"><span data-stu-id="09370-239">This DetailsView will be used to provide an interface for quickly adding a new product to the database.</span></span> <span data-ttu-id="09370-240">Při přidání nového produktu umožňuje povolit uživatelům jenom zadat hodnoty pro zachovat konzistentní uživatelské rozhraní `ProductName` a `UnitPrice` pole.</span><span class="sxs-lookup"><span data-stu-id="09370-240">To keep a consistent user interface when adding a new product let's allow the user to only enter values for the `ProductName` and `UnitPrice` fields.</span></span> <span data-ttu-id="09370-241">Ve výchozím nastavení, je možnost tyto hodnoty, které nejsou dodány v ovládacím prvku DetailsView vkládání rozhraní `NULL` databáze hodnotu.</span><span class="sxs-lookup"><span data-stu-id="09370-241">By default, those values that aren't supplied in the DetailsView's inserting interface will be set to a `NULL` database value.</span></span> <span data-ttu-id="09370-242">Ale můžeme použít ObjectDataSource `Inserting` událost vložení různé výchozí hodnoty, jako jsme krátce zobrazí.</span><span class="sxs-lookup"><span data-stu-id="09370-242">However, we can use the ObjectDataSource's `Inserting` event to inject different default values, as we'll see shortly.</span></span>

## <a name="step-3-providing-an-interface-to-add-new-products"></a><span data-ttu-id="09370-243">Krok 3: Poskytuje rozhraní pro přidání nové produkty</span><span class="sxs-lookup"><span data-stu-id="09370-243">Step 3: Providing an Interface to Add New Products</span></span>

<span data-ttu-id="09370-244">Přetáhněte DetailsView z panelu nástrojů na návrháře výše GridView, vymažte jeho `Height` a `Width` vlastnosti a vazby, aby ObjectDataSource už je na stránce.</span><span class="sxs-lookup"><span data-stu-id="09370-244">Drag a DetailsView from the Toolbox onto the Designer above the GridView, clear out its `Height` and `Width` properties, and bind it to the ObjectDataSource already present on the page.</span></span> <span data-ttu-id="09370-245">Tím se přidá BoundField nebo vlastnost CheckBoxField pro každé pole produktu.</span><span class="sxs-lookup"><span data-stu-id="09370-245">This will add a BoundField or CheckBoxField for each of the product's fields.</span></span> <span data-ttu-id="09370-246">Vzhledem k tomu, že chceme, použijete tento DetailsView k přidání nových produktů, musíme zaškrtnutí políčka Povolit vložení ze inteligentní značky; neexistuje však žádný z těchto možností protože ObjectDataSource `Insert()` metoda není namapovaná na metodu v `ProductsBLL` – třída (odvolání jsme nastavit toto mapování (žádné), při konfiguraci zdroje dat viz obrázek 3).</span><span class="sxs-lookup"><span data-stu-id="09370-246">Since we want to use this DetailsView to add new products, we need to check the Enable Inserting option from the smart tag; however, there's no such option because the ObjectDataSource's `Insert()` method is not mapped to a method in the `ProductsBLL` class (recall that we set this mapping to (None) when configuring the data source see Figure 3).</span></span>

<span data-ttu-id="09370-247">Pokud chcete nakonfigurovat ObjectDataSource, vyberte odkaz Konfigurace zdroje dat z jeho inteligentních značek, spouští se průvodce.</span><span class="sxs-lookup"><span data-stu-id="09370-247">To configure the ObjectDataSource, select the Configure Data Source link from its smart tag, launching the wizard.</span></span> <span data-ttu-id="09370-248">Na první obrazovce umožňuje změnit základní objekt, který je vázána ObjectDataSource; nechte ji nastavit na `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="09370-248">The first screen allows you to change the underlying object the ObjectDataSource is bound to; leave it set to `ProductsBLL`.</span></span> <span data-ttu-id="09370-249">Na další obrazovce uvádí mapování metod ObjectDataSource podkladového objektu.</span><span class="sxs-lookup"><span data-stu-id="09370-249">The next screen lists the mappings from the ObjectDataSource's methods to the underlying object's.</span></span> <span data-ttu-id="09370-250">I když jsme výslovně uvedené, který `Insert()` a `Delete()` metody nelze mapovat na všechny metody, pokud přejdete do karty INSERT a DELETE uvidíte, že existuje mapování.</span><span class="sxs-lookup"><span data-stu-id="09370-250">Even though we explicitly indicated that the `Insert()` and `Delete()` methods should not be mapped to any methods, if you go to the INSERT and DELETE tabs you'll see that a mapping is there.</span></span> <span data-ttu-id="09370-251">Důvodem je, že `ProductsBLL`na `AddProduct` a `DeleteProduct` pomocí metody `DataObjectMethodAttribute` atribut k označení, že jsou výchozí metody pro `Insert()` a `Delete()`, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="09370-251">This is because the `ProductsBLL`'s `AddProduct` and `DeleteProduct` methods use the `DataObjectMethodAttribute` attribute to indicate that they are the default methods for `Insert()` and `Delete()`, respectively.</span></span> <span data-ttu-id="09370-252">Proto průvodce ObjectDataSource vybírá tyto pokaždé, když spustíte průvodce, pokud je některá hodnota, které explicitně určena.</span><span class="sxs-lookup"><span data-stu-id="09370-252">Hence, the ObjectDataSource wizard selects these each time you run the wizard unless there's some other value explicitly specified.</span></span>

<span data-ttu-id="09370-253">Ponechte `Insert()` metoda odkazující na `AddProduct` metoda, ale znovu nastavit kartě odstranění rozevíracího seznamu na (žádný).</span><span class="sxs-lookup"><span data-stu-id="09370-253">Leave the `Insert()` method pointing to the `AddProduct` method, but again set the DELETE tab's drop-down list to (None).</span></span>


<span data-ttu-id="09370-254">[![Nastavení na kartě Vložení rozevíracího seznamu metodu AddProduct](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="09370-254">[![Set the INSERT Tab's Drop-Down List to the AddProduct Method](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image40.png)</span></span>

<span data-ttu-id="09370-255">**Obrázek 14**: kartu vložení rozevíracího seznamu nastavte `AddProduct` – metoda ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="09370-255">**Figure 14**: Set the INSERT Tab's Drop-Down List to the `AddProduct` Method ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image42.png))</span></span>


<span data-ttu-id="09370-256">[![Nastavení na kartě odstranění rozevíracího seznamu (None)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="09370-256">[![Set the DELETE Tab's Drop-Down List to (None)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image43.png)</span></span>

<span data-ttu-id="09370-257">**Obrázek 15**: karta odstranit rozevíracím seznamu (None) nastavte ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="09370-257">**Figure 15**: Set the DELETE Tab's Drop-Down List to (None) ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image45.png))</span></span>


<span data-ttu-id="09370-258">Po provedení těchto změn, deklarativní syntaxe ObjectDataSource bude rozšířit, aby obsahovaly `InsertParameters` kolekce, jak je uvedeno níže:</span><span class="sxs-lookup"><span data-stu-id="09370-258">After making these changes, the ObjectDataSource's declarative syntax will be expanded to include an `InsertParameters` collection, as shown below:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample8.aspx)]

<span data-ttu-id="09370-259">Znovu spustit Průvodce přidány zpět `OldValuesParameterFormatString` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="09370-259">Rerunning the wizard added back the `OldValuesParameterFormatString` property.</span></span> <span data-ttu-id="09370-260">Za chvíli zrušte tuto vlastnost nastavit na výchozí hodnotu (`{0}`) nebo odeberte úplně ze deklarativní syntaxi.</span><span class="sxs-lookup"><span data-stu-id="09370-260">Take a moment to clear this property by setting it to the default value (`{0}`) or removing it altogether from the declarative syntax.</span></span>

<span data-ttu-id="09370-261">S ObjectDataSource poskytování vkládání inteligentních značek DetailsView nyní zahrnují políčka Povolit vložení; vrátíte do návrháře a zaškrtnete tuto možnost.</span><span class="sxs-lookup"><span data-stu-id="09370-261">With the ObjectDataSource providing inserting capabilities, the DetailsView's smart tag will now include the Enable Inserting checkbox; return to the Designer and check this option.</span></span> <span data-ttu-id="09370-262">V dalším kroku porovnat dolů DetailsView tak, že má jenom dvě BoundFields - `ProductName` a `UnitPrice` - a CommandField.</span><span class="sxs-lookup"><span data-stu-id="09370-262">Next, pare down the DetailsView so that it only has two BoundFields - `ProductName` and `UnitPrice` - and the CommandField.</span></span> <span data-ttu-id="09370-263">V tomto okamžiku DetailsView deklarativní syntaxe by měl vypadat jako:</span><span class="sxs-lookup"><span data-stu-id="09370-263">At this point the DetailsView's declarative syntax should look like:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample9.aspx)]

<span data-ttu-id="09370-264">16 obrázek znázorňuje tuto stránku při zobrazení v tomto okamžiku prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="09370-264">Figure 16 shows this page when viewed through a browser at this point.</span></span> <span data-ttu-id="09370-265">Jak vidíte, DetailsView obsahuje název a cena první produktu (Chai).</span><span class="sxs-lookup"><span data-stu-id="09370-265">As you can see, the DetailsView lists the name and price of the first product (Chai).</span></span> <span data-ttu-id="09370-266">Co chceme, je však vkládání rozhraní, které poskytuje prostředky pro uživatelům rychle přidání nového produktu do databáze.</span><span class="sxs-lookup"><span data-stu-id="09370-266">What we want, however, is an inserting interface that provides a means for the user to quickly add a new product to the database.</span></span>


<span data-ttu-id="09370-267">[![DetailsView je aktuálně v režimu jen pro čtení vykreslit.](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="09370-267">[![The DetailsView is Currently Rendered in Read-Only Mode](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image46.png)</span></span>

<span data-ttu-id="09370-268">**Obrázek 16**: DetailsView je aktuálně v režimu jen pro čtení vykreslit ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="09370-268">**Figure 16**: The DetailsView is Currently Rendered in Read-Only Mode ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image48.png))</span></span>


<span data-ttu-id="09370-269">Chcete-li zobrazit DetailsView v jeho vkládání režimu, je potřeba nastavit `DefaultMode` vlastnost `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="09370-269">In order to show the DetailsView in its inserting mode we need to set the `DefaultMode` property to `Inserting`.</span></span> <span data-ttu-id="09370-270">Tím se vykreslí DetailsView v režimu vkládání po první návštěvě a udržuje ho došlo po vložení nového záznamu.</span><span class="sxs-lookup"><span data-stu-id="09370-270">This renders the DetailsView in insert mode when first visited and keeps it there after inserting a new record.</span></span> <span data-ttu-id="09370-271">Jak ukazuje obrázek 17, takové DetailsView poskytuje rychlý rozhraní pro přidávání nového záznamu.</span><span class="sxs-lookup"><span data-stu-id="09370-271">As Figure 17 shows, such a DetailsView provides a quick interface for adding a new record.</span></span>


<span data-ttu-id="09370-272">[![DetailsView poskytuje rozhraní pro rychle přidání nového produktu](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="09370-272">[![The DetailsView Provides an Interface for Quickly Adding a New Product](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image49.png)</span></span>

<span data-ttu-id="09370-273">**Obrázek 17**: DetailsView poskytuje rozhraní pro rychle přidání nového produktu ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="09370-273">**Figure 17**: The DetailsView Provides an Interface for Quickly Adding a New Product ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image51.png))</span></span>


<span data-ttu-id="09370-274">Když uživatel zadá název produktu a ceny (například "Pokusná horních" a 1,99 jako obrázek 17) a na příkaz Insert, vyplývá zpětné volání a pak zahájí vkládání pracovního postupu, ukončené v novém záznamu produktu se přidává do databáze.</span><span class="sxs-lookup"><span data-stu-id="09370-274">When the user enters a product name and price (such as "Acme Water" and 1.99, as in Figure 17) and clicks Insert, a postback ensues and the inserting workflow commences, culminating in a new product record being added to the database.</span></span> <span data-ttu-id="09370-275">DetailsView udržuje jeho vkládání rozhraní a GridView je automaticky odrážejí svůj zdroj dat tak, aby zahrnovaly nového produktu, jak ukazuje obrázek 18.</span><span class="sxs-lookup"><span data-stu-id="09370-275">The DetailsView maintains its inserting interface and the GridView is automatically rebound to its data source in order to include the new product, as shown in Figure 18.</span></span>


![Produktu](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image52.png)

<span data-ttu-id="09370-277">**Obrázek 18**: produkt "Pokusná horních" se přidal do databáze</span><span class="sxs-lookup"><span data-stu-id="09370-277">**Figure 18**: The Product "Acme Water" Has Been Added to the Database</span></span>


<span data-ttu-id="09370-278">Zatímco rutina GridView v 18 obrázek, nezobrazí pole produktu postrádá z rozhraní DetailsView `CategoryID`, `SupplierID`, `QuantityPerUnit`a tak dále jsou přiřazeny `NULL` databáze hodnoty.</span><span class="sxs-lookup"><span data-stu-id="09370-278">While the GridView in Figure 18 doesn't show it, the product fields lacking from the DetailsView interface `CategoryID`, `SupplierID`, `QuantityPerUnit`, and so on are assigned `NULL` database values.</span></span> <span data-ttu-id="09370-279">Můžete to zjistit tak, že provedete následující kroky:</span><span class="sxs-lookup"><span data-stu-id="09370-279">You can see this by performing the following steps:</span></span>

1. <span data-ttu-id="09370-280">Přejděte do Průzkumníka serveru v sadě Visual Studio</span><span class="sxs-lookup"><span data-stu-id="09370-280">Go to the Server Explorer in Visual Studio</span></span>
2. <span data-ttu-id="09370-281">Rozšíření `NORTHWND.MDF` uzel databáze</span><span class="sxs-lookup"><span data-stu-id="09370-281">Expanding the `NORTHWND.MDF` database node</span></span>
3. <span data-ttu-id="09370-282">Klikněte pravým tlačítkem na `Products` uzlu tabulky databáze</span><span class="sxs-lookup"><span data-stu-id="09370-282">Right-click on the `Products` database table node</span></span>
4. <span data-ttu-id="09370-283">Vyberte zobrazení dat v tabulce</span><span class="sxs-lookup"><span data-stu-id="09370-283">Select Show Table Data</span></span>

<span data-ttu-id="09370-284">To se zobrazí všechny záznamy v `Products` tabulky.</span><span class="sxs-lookup"><span data-stu-id="09370-284">This will list all of the records in the `Products` table.</span></span> <span data-ttu-id="09370-285">Jak 19 obrázek ukazuje, všechny naše nového produktu sloupců než `ProductID`, `ProductName`, a `UnitPrice` mít `NULL` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="09370-285">As Figure 19 shows, all of our new product's columns other than `ProductID`, `ProductName`, and `UnitPrice` have `NULL` values.</span></span>


<span data-ttu-id="09370-286">[![Produktu pole není zadaný v ovládacím prvku DetailsView jsou přiřazené hodnoty NULL](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="09370-286">[![The Product Fields Not Provided in the DetailsView are Assigned NULL Values](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image53.png)</span></span>

<span data-ttu-id="09370-287">**Obrázek 19**: produktu pole není zadaný v ovládacím prvku DetailsView přiřazené `NULL` hodnoty ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="09370-287">**Figure 19**: The Product Fields Not Provided in the DetailsView are Assigned `NULL` Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image55.png))</span></span>


<span data-ttu-id="09370-288">Chceme poskytnout jiné než výchozí hodnotu `NULL` pro jeden nebo více z těchto hodnot sloupce, buď protože `NULL` není doporučené výchozí možnost nebo protože sám sloupce databáze nepovoluje `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="09370-288">We may want to provide a default value other than `NULL` for one or more of these column values, either because `NULL` isn't the best default option or because the database column itself doesn't allow `NULL` s.</span></span> <span data-ttu-id="09370-289">K tomu můžeme prostřednictvím kódu programu můžete nastavit hodnoty parametrů prvku DetailsView `InputParameters` kolekce.</span><span class="sxs-lookup"><span data-stu-id="09370-289">To accomplish this we can programmatically set the values of the parameters of the DetailsView's `InputParameters` collection.</span></span> <span data-ttu-id="09370-290">Toto přiřazení lze provést buď události obslužné rutiny DetailsView `ItemInserting` události nebo ObjectDataSource `Inserting` událostí.</span><span class="sxs-lookup"><span data-stu-id="09370-290">This assignment can be done either in the event handler for the DetailsView's `ItemInserting` event or the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="09370-291">Vzhledem k tomu, že jste již hledá pomocí před a po úroveň události na data webové řídit úroveň, podíváme se na události ObjectDataSource pomocí této doby.</span><span class="sxs-lookup"><span data-stu-id="09370-291">Since we've already looked at using the pre- and post-level events at the data Web control level, let's explore using the ObjectDataSource's events this time.</span></span>

## <a name="step-4-assigning-values-to-thecategoryidandsupplieridparameters"></a><span data-ttu-id="09370-292">Krok 4: Přiřazování hodnot k`CategoryID`a`SupplierID`parametry</span><span class="sxs-lookup"><span data-stu-id="09370-292">Step 4: Assigning Values to the`CategoryID`and`SupplierID`Parameters</span></span>

<span data-ttu-id="09370-293">V tomto kurzu budeme Představte si, že naše aplikace při přidání nového produktu prostřednictvím tohoto rozhraní se by se měla přiřadit `CategoryID` a `SupplierID` hodnotu 1.</span><span class="sxs-lookup"><span data-stu-id="09370-293">For this tutorial let's imagine that for our application when adding a new product through this interface it should be assigned a `CategoryID` and `SupplierID` value of 1.</span></span> <span data-ttu-id="09370-294">Jak už bylo zmíněno dříve, bude ObjectDataSource během procesu úpravy dat má pár událostí před a po úrovně tohoto ještě efektivněji.</span><span class="sxs-lookup"><span data-stu-id="09370-294">As mentioned earlier, the ObjectDataSource has a pair of pre- and post-level events that fire during the data modification process.</span></span> <span data-ttu-id="09370-295">Při jeho `Insert()` metoda je volána, nejprve vyvolá ObjectDataSource jeho `Inserting` událostí, pak zavolá metodu, jeho `Insert()` metoda byla mapována na a nakonec vyvolá `Inserted` událostí.</span><span class="sxs-lookup"><span data-stu-id="09370-295">When its `Insert()` method is invoked, the ObjectDataSource first raises its `Inserting` event, then calls the method that its `Insert()` method has been mapped to, and finally raises the `Inserted` event.</span></span> <span data-ttu-id="09370-296">`Inserting` Obslužné rutiny události nám poskytuje jeden poslední možnost k vylepšení vstupní parametry, nebo přímý operaci zrušte.</span><span class="sxs-lookup"><span data-stu-id="09370-296">The `Inserting` event handler affords us one last opportunity to tweak the input parameters or cancel the operation outright.</span></span>

> [!NOTE]
> <span data-ttu-id="09370-297">V reálné aplikaci byste pravděpodobně chtít buď umožňují uživateli zadat kategorii a dodavatele nebo by vydat tuto hodnotu pro ně na základě některé kritérií nebo obchodní logiky (nikoli slepě výběr ID 1).</span><span class="sxs-lookup"><span data-stu-id="09370-297">In a real-world application you would likely want to either let the user specify the category and supplier or would pick this value for them based on some criteria or business logic (rather than blindly selecting an ID of 1).</span></span> <span data-ttu-id="09370-298">Bez ohledu na to příklad ukazuje, jak se prostřednictvím kódu programu z předem úroveň události ObjectDataSource nastavit hodnotu vstupního parametru.</span><span class="sxs-lookup"><span data-stu-id="09370-298">Regardless, the example illustrates how to programmatically set the value of an input parameter from the ObjectDataSource's pre-level event.</span></span>


<span data-ttu-id="09370-299">Za chvíli k vytvoření obslužné rutiny události pro ObjectDataSource `Inserting` událostí.</span><span class="sxs-lookup"><span data-stu-id="09370-299">Take a moment to create an event handler for the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="09370-300">Všimněte si, že druhý vstupní parametr obslužné rutiny události je objekt typu `ObjectDataSourceMethodEventArgs`, jehož vlastnost, která má přístup ke kolekci parametrů (`InputParameters`) a vlastnost, která má-li zrušit operaci (`Cancel`).</span><span class="sxs-lookup"><span data-stu-id="09370-300">Notice that the event handler's second input parameter is an object of type `ObjectDataSourceMethodEventArgs`, which has a property to access the parameters collection (`InputParameters`) and a property to cancel the operation (`Cancel`).</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample10.cs)]

<span data-ttu-id="09370-301">V tomto okamžiku `InputParameters` vlastnost obsahuje ObjectDataSource `InsertParameters` kolekce s hodnotami z DetailsView přiřazenu.</span><span class="sxs-lookup"><span data-stu-id="09370-301">At this point, the `InputParameters` property contains the ObjectDataSource's `InsertParameters` collection with the values assigned from the DetailsView.</span></span> <span data-ttu-id="09370-302">Chcete-li změnit hodnotu některého z těchto parametrů, jednoduše použijte: `e.InputParameters["paramName"] = value`.</span><span class="sxs-lookup"><span data-stu-id="09370-302">To change the value of one of these parameters, simply use: `e.InputParameters["paramName"] = value`.</span></span> <span data-ttu-id="09370-303">Proto nastavit `CategoryID` a `SupplierID` upravit tak, aby hodnoty 1 `Inserting` obslužné rutiny události pro vypadat třeba takto:</span><span class="sxs-lookup"><span data-stu-id="09370-303">Therefore, to set the `CategoryID` and `SupplierID` to values of 1, adjust the `Inserting` event handler to look like the following:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample11.cs)]

<span data-ttu-id="09370-304">Tento čas při přidání nového produktu (například: MSN Soda), `CategoryID` a `SupplierID` sloupce nového produktu jsou nastaveny na hodnotu 1 (viz obrázek 20).</span><span class="sxs-lookup"><span data-stu-id="09370-304">This time when adding a new product (such as Acme Soda), the `CategoryID` and `SupplierID` columns of the new product are set to 1 (see Figure 20).</span></span>


<span data-ttu-id="09370-305">[![Teď máte nové produkty jejich CategoryID a ID dodavatele hodnoty nastavené na 1](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="09370-305">[![New Products Now Have Their CategoryID and SupplierID Values Set to 1](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image56.png)</span></span>

<span data-ttu-id="09370-306">**Obrázek 20**: nové produkty nyní mají jejich `CategoryID` a `SupplierID` hodnoty nastavena na hodnotu 1 ([Kliknutím zobrazit obrázek v plné velikosti](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="09370-306">**Figure 20**: New Products Now Have Their `CategoryID` and `SupplierID` Values Set to 1 ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image58.png))</span></span>


## <a name="summary"></a><span data-ttu-id="09370-307">Souhrn</span><span class="sxs-lookup"><span data-stu-id="09370-307">Summary</span></span>

<span data-ttu-id="09370-308">Ovládací prvek webu data i ObjectDataSource pokračujte během úprava, vkládání a odstraňování procesu, určitý počet událostí před a po úrovně.</span><span class="sxs-lookup"><span data-stu-id="09370-308">During the editing, inserting, and deleting process, both the data Web control and the ObjectDataSource proceed through a number of pre- and post-level events.</span></span> <span data-ttu-id="09370-309">V tomto kurzu jsme zkontrolován předem úroveň události a viděli, jak tyto slouží k přizpůsobení vstupní parametry nebo zrušit operace změny dat z ovládací prvek webu data a události na ObjectDataSource zcela i.</span><span class="sxs-lookup"><span data-stu-id="09370-309">In this tutorial we examined the pre-level events and saw how to use these to customize the input parameters or cancel the data modification operation altogether both from the data Web control and ObjectDataSource's events.</span></span> <span data-ttu-id="09370-310">V dalším kurzu podíváme vytváření a používání obslužných rutin událostí pro události po úrovně.</span><span class="sxs-lookup"><span data-stu-id="09370-310">In the next tutorial we'll look at creating and using event handlers for the post-level events.</span></span>

<span data-ttu-id="09370-311">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="09370-311">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="09370-312">O autorovi</span><span class="sxs-lookup"><span data-stu-id="09370-312">About the Author</span></span>

<span data-ttu-id="09370-313">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a zakladatele z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje s technologií Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="09370-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="09370-314">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="09370-314">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="09370-315">Jeho nejnovější seznam k [ *Edice nakladatelství Sams naučit sami technologii ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="09370-315">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="09370-316">Dosažitelný v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu, který najdete na [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="09370-316">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="09370-317">Zvláštní poděkování</span><span class="sxs-lookup"><span data-stu-id="09370-317">Special Thanks To</span></span>

<span data-ttu-id="09370-318">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="09370-318">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="09370-319">Vést kontroloři v tomto kurzu se Jackie Goor a Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="09370-319">Lead reviewers for this tutorial were Jackie Goor and Liz Shulok.</span></span> <span data-ttu-id="09370-320">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="09370-320">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="09370-321">Pokud ano, vyřaďte mi řádek v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="09370-321">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="09370-322">[Předchozí](an-overview-of-inserting-updating-and-deleting-data-cs.md)
[další](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)</span><span class="sxs-lookup"><span data-stu-id="09370-322">[Previous](an-overview-of-inserting-updating-and-deleting-data-cs.md)
[Next](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)</span></span>
