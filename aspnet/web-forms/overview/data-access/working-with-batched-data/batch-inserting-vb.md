---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-vb
title: Dávkové vložení (VB) | Microsoft Docs
author: rick-anderson
description: Naučte se vložit více záznamů databáze v rámci jedné operace. V uživatelské rozhraní vrstvě rozšiřujeme GridView umožňující uživateli zadat více n...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: 48e2a4ae-77ca-4208-a204-c38c690ffb59
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-vb
msc.type: authoredcontent
ms.openlocfilehash: a25c889784ccc6cee3ae01df59bd489b48114e74
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888725"
---
<a name="batch-inserting-vb"></a><span data-ttu-id="d6d54-104">Dávkové vložení (VB)</span><span class="sxs-lookup"><span data-stu-id="d6d54-104">Batch Inserting (VB)</span></span>
====================
<span data-ttu-id="d6d54-105">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d6d54-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d6d54-106">[Stáhněte si kód](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_VB.zip) nebo [stáhnout PDF](batch-inserting-vb/_static/datatutorial66vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d6d54-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_VB.zip) or [Download PDF](batch-inserting-vb/_static/datatutorial66vb1.pdf)</span></span>

> <span data-ttu-id="d6d54-107">Naučte se vložit více záznamů databáze v rámci jedné operace.</span><span class="sxs-lookup"><span data-stu-id="d6d54-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="d6d54-108">V uživatelské rozhraní vrstvě rozšiřujeme GridView umožňující uživateli zadat více nové záznamy.</span><span class="sxs-lookup"><span data-stu-id="d6d54-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="d6d54-109">V Data Access Layer jsme zabalit více operací vložení v rámci transakce zajistit, že všechny vložení úspěch nebo budou vráceny všechny vložení.</span><span class="sxs-lookup"><span data-stu-id="d6d54-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="d6d54-110">Úvod</span><span class="sxs-lookup"><span data-stu-id="d6d54-110">Introduction</span></span>

<span data-ttu-id="d6d54-111">V [aktualizace Batch](batch-updating-vb.md) kurzu jsme se podívali na přizpůsobení ovládacího prvku GridView k dispozici rozhraní, které byly upravovat více záznamů.</span><span class="sxs-lookup"><span data-stu-id="d6d54-111">In the [Batch Updating](batch-updating-vb.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="d6d54-112">Uživatel na stránce může Zkontrolujte řadu změny a pak klepnutím jednom tlačítko provádět dávková aktualizace.</span><span class="sxs-lookup"><span data-stu-id="d6d54-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="d6d54-113">V situacích, kde uživatelé běžně aktualizovat mnoho záznamů najednou, můžete uložit takového rozhraní obrovském množství kliknutí a přepínače kontextu klávesnice myši ve srovnání s výchozí za řádek úpravy funkce, které byly nejprve prozkoumali zpět v [ Přehled vložení, aktualizace a odstranění dat](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial.</span></span>

<span data-ttu-id="d6d54-114">Tento koncept můžete také použít při přidávání záznamů.</span><span class="sxs-lookup"><span data-stu-id="d6d54-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="d6d54-115">Představte si, které zde společnosti Northwind Traders běžně obdržíme dodávky od dodavatelů, které obsahují více produktů pro určité kategorie.</span><span class="sxs-lookup"><span data-stu-id="d6d54-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="d6d54-116">Jako příklad jsme může přijímat dodávky šesti různých kávy a kávy produkty z Tokio Traders.</span><span class="sxs-lookup"><span data-stu-id="d6d54-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="d6d54-117">Pokud uživatel zadá šesti produkty jeden v čase prostřednictvím ovládacího prvku DetailsView, budou muset zvolit řadu stejné hodnoty opakovaně: bude třeba vybrat stejné kategorii (nápoje) stejného dodavatele (Tokio Traders), stejné zastaveny (hodnota False) a stejnou jednotek na hodnota pořadí (0).</span><span class="sxs-lookup"><span data-stu-id="d6d54-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="d6d54-118">Tato položka opakující se data jenom není časově náročné, ale jsou náchylné na chyby.</span><span class="sxs-lookup"><span data-stu-id="d6d54-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="d6d54-119">S malým množstvím pracovní vytvoříme dávce vkládání rozhraní, které umožňuje uživatelům zvolit dodavatele a kategorie jednou, zadejte řadu názvy produktů a jednotkové ceny a pak klikněte na tlačítko pro přidání nové produkty do databáze (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="d6d54-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="d6d54-120">Po přidání každý produkt, jeho `ProductName` a `UnitPrice` datová pole jsou přiřazené hodnoty zadané v textových polích, při jeho `CategoryID` a `SupplierID` hodnoty přiřazené hodnoty z DropDownLists v horní fo formuláře.</span><span class="sxs-lookup"><span data-stu-id="d6d54-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="d6d54-121">`Discontinued` a `UnitsOnOrder` hodnoty jsou nastaveny na hodnoty pevně `False` a 0, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="d6d54-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `False` and 0, respectively.</span></span>


<span data-ttu-id="d6d54-122">[![Rozhraní vložení dávky](batch-inserting-vb/_static/image2.png)](batch-inserting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-122">[![The Batch Inserting Interface](batch-inserting-vb/_static/image2.png)](batch-inserting-vb/_static/image1.png)</span></span>

<span data-ttu-id="d6d54-123">**Obrázek 1**: Služba Batch vkládání rozhraní ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-vb/_static/image3.png))</span></span>


<span data-ttu-id="d6d54-124">V tomto kurzu vytvoříme stránky, který implementuje dávkové vložení rozhraní zobrazené na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="d6d54-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="d6d54-125">Jako s předchozí dva kurzy, jsme zalomen vložení v rámci rozsahu transakce zajistit nedělitelnost.</span><span class="sxs-lookup"><span data-stu-id="d6d54-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="d6d54-126">Umožňují s začít!</span><span class="sxs-lookup"><span data-stu-id="d6d54-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="d6d54-127">Krok 1: Vytvoření rozhraní zobrazení</span><span class="sxs-lookup"><span data-stu-id="d6d54-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="d6d54-128">V tomto kurzu bude skládat z jedné stránky, který je rozdělený do dvou oblastí: oblast zobrazení a vkládání oblast.</span><span class="sxs-lookup"><span data-stu-id="d6d54-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="d6d54-129">Zobrazení rozhraní, které vytvoříme v tomto kroku, zobrazí produkty v GridView a obsahuje tlačítko s názvem procesu dodávky produktu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="d6d54-130">Při kliknutí na toto tlačítko zobrazení rozhraní se nahradí vkládání rozhraní, což je znázorněno na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="d6d54-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="d6d54-131">Zobrazení rozhraní vrátí po přidání produkty z dodávky nebo klepnutí na tlačítka Storno.</span><span class="sxs-lookup"><span data-stu-id="d6d54-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="d6d54-132">Vytvoříme rozhraní vkládání v kroku 2.</span><span class="sxs-lookup"><span data-stu-id="d6d54-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="d6d54-133">Při vytvoření stránky, která má dvě rozhraní, pouze jeden z nich je viditelná najednou, každý rozhraní je umístěn obvykle v rámci [ovládací prvek panelu webu](http://www.w3schools.com/aspnet/control_panel.asp), který slouží jako kontejner pro další ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="d6d54-134">Naši stránku proto bude mít dva ovládací prvky Panel jeden pro každé rozhraní.</span><span class="sxs-lookup"><span data-stu-id="d6d54-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="d6d54-135">Začněte otevřením `BatchInsert.aspx` stránku `BatchData` složku a přetáhněte panelu z panelu nástrojů na návrháře (viz obrázek 2).</span><span class="sxs-lookup"><span data-stu-id="d6d54-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="d6d54-136">Nastavit panelu s `ID` vlastnost `DisplayInterface`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="d6d54-137">Při přidávání panelu do návrháře, jeho `Height` a `Width` vlastnosti jsou nastavené 50px a 125px, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="d6d54-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="d6d54-138">Zruší se tyto hodnoty vlastností v okně Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="d6d54-138">Clear out these property values from the Properties window.</span></span>


<span data-ttu-id="d6d54-139">[![Přetáhněte panelu z panelu nástrojů na návrháře](batch-inserting-vb/_static/image5.png)](batch-inserting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-vb/_static/image5.png)](batch-inserting-vb/_static/image4.png)</span></span>

<span data-ttu-id="d6d54-140">**Obrázek 2**: přetáhněte panelu z panelu nástrojů na návrháře ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-vb/_static/image6.png))</span></span>


<span data-ttu-id="d6d54-141">V dalším kroku přetáhněte ovládací prvek tlačítko a GridView do panelu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="d6d54-142">Nastavte na tlačítko s `ID` vlastnost `ProcessShipment` a jeho `Text` vlastnost do procesu dodávky produktu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="d6d54-143">Nastavit GridView s `ID` vlastnost `ProductsGrid` a z jeho inteligentních značek navázat jej na nové ObjectDataSource s názvem `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="d6d54-144">Konfigurace ObjectDataSource načítat data z `ProductsBLL` třídu s `GetProducts` metoda.</span><span class="sxs-lookup"><span data-stu-id="d6d54-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="d6d54-145">Vzhledem k tomu, že tato rutina GridView se používají pouze pro zobrazení dat, nastavte rozevírací seznamy v aktualizaci UPDATE, INSERT a odstranit karty na (žádný).</span><span class="sxs-lookup"><span data-stu-id="d6d54-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="d6d54-146">Kliknutím na tlačítko Dokončit ukončete průvodce Konfigurace zdroje dat.</span><span class="sxs-lookup"><span data-stu-id="d6d54-146">Click Finish to complete the Configure Data Source wizard.</span></span>


<span data-ttu-id="d6d54-147">[![Zobrazit Data vrácená z metody třídy ProductsBLL s GetProducts](batch-inserting-vb/_static/image8.png)](batch-inserting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-vb/_static/image8.png)](batch-inserting-vb/_static/image7.png)</span></span>

<span data-ttu-id="d6d54-148">**Obrázek 3**: Zobrazit Data vrácená z `ProductsBLL` třídu s `GetProducts` – metoda ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-vb/_static/image9.png))</span></span>


<span data-ttu-id="d6d54-149">[![Nastavte rozevírací seznamy v aktualizaci UPDATE, INSERT a odstranit karty na (žádný)](batch-inserting-vb/_static/image11.png)](batch-inserting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-vb/_static/image11.png)](batch-inserting-vb/_static/image10.png)</span></span>

<span data-ttu-id="d6d54-150">**Obrázek 4**: rozevíracího seznamu jsou uvedeny ve UPDATE, INSERT a odstranit karty na hodnotu (žádná) ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-vb/_static/image12.png))</span></span>


<span data-ttu-id="d6d54-151">Po dokončení Průvodce ObjectDataSource, Visual Studio přidá BoundFields a vlastnost CheckBoxField pro produkt datová pole.</span><span class="sxs-lookup"><span data-stu-id="d6d54-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="d6d54-152">Odeberte všechny ale na `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, a `Discontinued` pole.</span><span class="sxs-lookup"><span data-stu-id="d6d54-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="d6d54-153">Nebojte se provádět jakékoli estetické vlastní nastavení.</span><span class="sxs-lookup"><span data-stu-id="d6d54-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="d6d54-154">Rozhodli k formátování `UnitPrice` pole jako hodnotu měny přeuspořádány pole a přejmenovat několik polí `HeaderText` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="d6d54-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="d6d54-155">Rutina GridView stránkování a řazení podporu zaškrtnutím políček Povolit stránkování a Povolit řazení v GridView s inteligentním také nakonfigurujte.</span><span class="sxs-lookup"><span data-stu-id="d6d54-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="d6d54-156">Po přidání ovládacích prvků panelů, tlačítko, rutina GridView a ObjectDataSource a přizpůsobení pole s GridView, stránku s deklarativní by měl vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="d6d54-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](batch-inserting-vb/samples/sample1.aspx)]

<span data-ttu-id="d6d54-157">Všimněte si, že kód pro tlačítko a GridView zobrazí v rámci otevření a zavření `<asp:Panel>` značky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="d6d54-158">Vzhledem k tomu, že tyto ovládací prvky jsou v rámci `DisplayInterface` panelech jsme můžete skrýt je jednoduše nastavení panelu s `Visible` vlastnost `False`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `False`.</span></span> <span data-ttu-id="d6d54-159">Krok 3 zjistí prostřednictvím kódu programu změna panelu s `Visible` zobrazíte jedno rozhraní při dalších skrytí klikněte na vlastnost v reakci na tlačítko.</span><span class="sxs-lookup"><span data-stu-id="d6d54-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="d6d54-160">Chcete-li zobrazit naše průběh prostřednictvím prohlížeče chvíli trvat.</span><span class="sxs-lookup"><span data-stu-id="d6d54-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="d6d54-161">Jak je vidět na obrázku 5, měli byste vidět tlačítko procesu dodávky produktu nad GridView, obsahující seznam produktů deset najednou.</span><span class="sxs-lookup"><span data-stu-id="d6d54-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>


<span data-ttu-id="d6d54-162">[![GridView seznamy produktů a nabízí řazení a stránkování možnosti](batch-inserting-vb/_static/image14.png)](batch-inserting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-vb/_static/image14.png)](batch-inserting-vb/_static/image13.png)</span></span>

<span data-ttu-id="d6d54-163">**Obrázek 5**: GridView uvádí produktů a nabízí řazení a stránkování možnosti ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-vb/_static/image15.png))</span></span>


## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="d6d54-164">Krok 2: Vytvoření rozhraní vložení</span><span class="sxs-lookup"><span data-stu-id="d6d54-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="d6d54-165">Pomocí zobrazení rozhraní dokončení jsme re připravené k vytvoření rozhraní vkládání.</span><span class="sxs-lookup"><span data-stu-id="d6d54-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="d6d54-166">V tomto kurzu mohli s vytvořit vkládání rozhraní, které zobrazí výzvu pro jednu hodnotu dodavatele a kategorie a pak může uživatel zadat až pět názvy produktů a hodnoty cena jednotky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="d6d54-167">S tímto rozhraním uživatel může přidávat jedné do pěti nové produkty, které všechny sdílejí stejné kategorii a dodavatele, ale mají názvy produktů jedinečný a ceny.</span><span class="sxs-lookup"><span data-stu-id="d6d54-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="d6d54-168">Spuštění přetažením panelu z panelu nástrojů na návrháře jeho umístění pod existující `DisplayInterface` panelu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="d6d54-169">Nastavit `ID` vlastnost tohoto objektu nově přidaná panelu `InsertingInterface` a nastavit jeho `Visible` vlastnost `False`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `False`.</span></span> <span data-ttu-id="d6d54-170">Přidáme kód, který nastaví `InsertingInterface` Panel s `Visible` vlastnost `True` v kroku 3.</span><span class="sxs-lookup"><span data-stu-id="d6d54-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `True` in Step 3.</span></span> <span data-ttu-id="d6d54-171">Také vyčistit panelu s `Height` a `Width` hodnot vlastností.</span><span class="sxs-lookup"><span data-stu-id="d6d54-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="d6d54-172">Dále je potřeba vytvořit vkládání rozhraní, které se zobrazí zpět na obrázku 1.</span><span class="sxs-lookup"><span data-stu-id="d6d54-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="d6d54-173">Toto rozhraní se může vytvořit prostřednictvím řady různých způsobů HTML, ale budeme používat přímočará jeden: čtyři sloupce, sedm řádek tabulky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="d6d54-174">Při zadávání kódu pro kód HTML `<table>` elementy, chci raději použít zobrazení zdroje.</span><span class="sxs-lookup"><span data-stu-id="d6d54-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="d6d54-175">Když Visual Studio jsou nástroje pro přidání `<table>` prvků prostřednictvím návrháře návrháře zdá se, že všechny příliš ochotni vložit nevyžádaný pro `style` nastavení do kódu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="d6d54-176">Jakmile mám vytvořené `<table>` značek, I obvykle vrátíte do návrháře přidat ovládací prvky webového a nastavte jejich vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="d6d54-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="d6d54-177">Při vytváření tabulky pomocí předem určené sloupců a řádků nechci pomocí statické HTML místo [ovládací prvek webu tabulky](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) vzhledem k tomu, že všechny ovládací prvky webového umístit do ovládacího prvku Web tabulky lze přistupovat pouze pomocí `FindControl("controlID")` vzor.</span><span class="sxs-lookup"><span data-stu-id="d6d54-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="d6d54-178">, Ale používám ovládacích prvků tabulka pro dynamicky velikost tabulky (ty, jejichž řádky nebo sloupce jsou založené na některé databáze nebo definované uživatelem kritérií), od Web tabulky řízení konstruovat prostřednictvím kódu programu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>


<span data-ttu-id="d6d54-179">Zadejte následující kód v rámci `<asp:Panel>` značek `InsertingInterface` panelu:</span><span class="sxs-lookup"><span data-stu-id="d6d54-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>


[!code-html[Main](batch-inserting-vb/samples/sample2.html)]

<span data-ttu-id="d6d54-180">To `<table>` značek nezahrnuje všechny ovládací prvky webového ještě těch, které přidáme na okamžik.</span><span class="sxs-lookup"><span data-stu-id="d6d54-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="d6d54-181">Všimněte si, aby se každý `<tr>` element obsahuje konkrétní nastavení třídy CSS: `BatchInsertHeaderRow` pro řádek záhlaví, kde bude přejděte dodavatele a kategorie DropDownLists; `BatchInsertFooterRow` pro řádek zápatí stránky, kde přidat produkty z dodávky a zrušit tlačítka přejde; a střídavých `BatchInsertRow` a `BatchInsertAlternatingRow` hodnot řádků, které budou obsahovat produktu a jednotky cena TextBox – ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="d6d54-182">I jste vytvořili odpovídající tříd CSS ve `Styles.css` souboru umožnit vkládání rozhraní vzhled podobné GridView a DetailsView ovládací prvky jsme sunout používaných v celém tyto kurzy.</span><span class="sxs-lookup"><span data-stu-id="d6d54-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="d6d54-183">Níže jsou uvedeny tyto třídy CSS.</span><span class="sxs-lookup"><span data-stu-id="d6d54-183">These CSS classes are shown below.</span></span>


[!code-css[Main](batch-inserting-vb/samples/sample3.css)]

<span data-ttu-id="d6d54-184">Pomocí této značky zadané vrátíte do návrhového zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d6d54-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="d6d54-185">To `<table>` by měl zobrazit jako tabulku čtyři sloupce, řádku sedm v návrháři, jak ukazuje obrázek 6.</span><span class="sxs-lookup"><span data-stu-id="d6d54-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>


<span data-ttu-id="d6d54-186">[![Vkládání rozhraní se skládá čtyři sloupce, sedm řádek tabulky](batch-inserting-vb/_static/image17.png)](batch-inserting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-vb/_static/image17.png)](batch-inserting-vb/_static/image16.png)</span></span>

<span data-ttu-id="d6d54-187">**Obrázek 6**: tvoří vkládání rozhraní čtyři sloupce, sedm řádek tabulky ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-vb/_static/image18.png))</span></span>


<span data-ttu-id="d6d54-188">Jsme re nyní připraveni k přidávání ovládacích prvků webové rozhraní vkládání.</span><span class="sxs-lookup"><span data-stu-id="d6d54-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="d6d54-189">Přetáhněte dvě DropDownLists z panelu nástrojů na příslušné buněk v tabulce, jednu pro dodavatele a jeden pro kategorii.</span><span class="sxs-lookup"><span data-stu-id="d6d54-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="d6d54-190">Nastavte rozevírací seznam s dodavatele `ID` vlastnost `Suppliers` a navázat jej nové ObjectDataSource s názvem `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="d6d54-191">Konfigurace nového ObjectDataSource načíst data z `SuppliersBLL` třídu s `GetSuppliers` metoda a sadu aktualizace kartě s rozevíracím seznamu na (žádný).</span><span class="sxs-lookup"><span data-stu-id="d6d54-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="d6d54-192">Kliknutím na tlačítko Dokončit ukončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="d6d54-192">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="d6d54-193">[![Konfigurace ObjectDataSource lze pomocí této metody GetSuppliers SuppliersBLL třídu s](batch-inserting-vb/_static/image20.png)](batch-inserting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-vb/_static/image20.png)](batch-inserting-vb/_static/image19.png)</span></span>

<span data-ttu-id="d6d54-194">**Obrázek 7**: Konfigurace ObjectDataSource pro použití `SuppliersBLL` třídu s `GetSuppliers` – metoda ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-vb/_static/image21.png))</span></span>


<span data-ttu-id="d6d54-195">Mít `Suppliers` rozevírací seznam zobrazení `CompanyName` pole data a použití `SupplierID` data pole jako jeho `ListItem` s hodnoty.</span><span class="sxs-lookup"><span data-stu-id="d6d54-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>


<span data-ttu-id="d6d54-196">[![Pole dat NázevSpolečnosti zobrazovat a používat KódDodavatele jako hodnota](batch-inserting-vb/_static/image23.png)](batch-inserting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-vb/_static/image23.png)](batch-inserting-vb/_static/image22.png)</span></span>

<span data-ttu-id="d6d54-197">**Obrázek 8**: zobrazení `CompanyName` pole Data a použití `SupplierID` jako hodnotu ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-vb/_static/image24.png))</span></span>


<span data-ttu-id="d6d54-198">Název druhé rozevírací seznam `Categories` a navázat jej nové ObjectDataSource s názvem `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="d6d54-199">Konfigurace `CategoriesDataSource` ObjectDataSource používat `CategoriesBLL` třídu s `GetCategories` metoda; nastavte rozevírací seznam seznamů v aktualizaci a odstranění karty na (žádný) a klikněte na tlačítko Dokončit ukončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="d6d54-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="d6d54-200">Nakonec máte zobrazení rozevírací seznam `CategoryName` pole data a použití `CategoryID` jako hodnotu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="d6d54-201">Poté, co tyto dvě DropDownLists byly přidány a vázána na ObjectDataSources správně nakonfigurované, by mělo vypadat jako obrázek 9 obrazovky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>


<span data-ttu-id="d6d54-202">[![Řádek záhlaví teď obsahuje dodavatelé a DropDownLists kategorií](batch-inserting-vb/_static/image26.png)](batch-inserting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-vb/_static/image26.png)](batch-inserting-vb/_static/image25.png)</span></span>

<span data-ttu-id="d6d54-203">**Obrázek 9**: záhlaví řádků nyní obsahuje `Suppliers` a `Categories` DropDownLists ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-vb/_static/image27.png))</span></span>


<span data-ttu-id="d6d54-204">Nyní potřebujeme vytvořit textových polí shromažďovat název a ceny pro každý nový produkt.</span><span class="sxs-lookup"><span data-stu-id="d6d54-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="d6d54-205">Přetáhněte ovládací prvek textové pole z panelu nástrojů na návrháře pro každou z pěti produktu název a cena řádky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="d6d54-206">Nastavte `ID` vlastnosti textových polí na `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`a tak dále.</span><span class="sxs-lookup"><span data-stu-id="d6d54-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="d6d54-207">Přidat CompareValidator po každém z nich jednotkové ceny textových polí, nastavení `ControlToValidate` vlastnost na příslušné `ID`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="d6d54-208">Také nastavit `Operator` vlastnost `GreaterThanEqual`, `ValueToCompare` na hodnotu 0, a `Type` k `Currency`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="d6d54-209">Tato nastavení, požádejte CompareValidator pro zajištění cenu, pokud zadali, platná měna hodnotu, která je větší než nebo rovna hodnotě nula.</span><span class="sxs-lookup"><span data-stu-id="d6d54-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="d6d54-210">Nastavte `Text` vlastnost \*, a `ErrorMessage` ceny musí být větší než nebo rovna hodnotě nula.</span><span class="sxs-lookup"><span data-stu-id="d6d54-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="d6d54-211">Navíc prosím vynechejte symboly měny.</span><span class="sxs-lookup"><span data-stu-id="d6d54-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="d6d54-212">Vkládání rozhraní nezahrnuje všechny ovládací prvky RequiredFieldValidator, i když `ProductName` pole `Products` tabulky databáze nepovoluje `NULL` hodnoty.</span><span class="sxs-lookup"><span data-stu-id="d6d54-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="d6d54-213">Je to proto, že chceme, aby mohl uživatel zadat až pět produkty.</span><span class="sxs-lookup"><span data-stu-id="d6d54-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="d6d54-214">Například pokud uživatel byly zajistit cena název a jednotka produktu pro první tři řádky, ponechat prázdné, poslední dva řádky d právě přidáme tři nové produkty do systému.</span><span class="sxs-lookup"><span data-stu-id="d6d54-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="d6d54-215">Protože `ProductName` je požadováno, ale budeme muset kontrola prostřednictvím kódu programu, ujistěte se, že pokud jednotkové ceny je zadán, je zadána hodnota odpovídající název produktu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="d6d54-216">Tato kontrola v kroku 4 jsme budete řešení.</span><span class="sxs-lookup"><span data-stu-id="d6d54-216">We'll tackle this check in Step 4.</span></span>


<span data-ttu-id="d6d54-217">Při ověřování vstupu uživatele s, CompareValidator sestavy neplatná data, pokud hodnota obsahuje symbolu měny.</span><span class="sxs-lookup"><span data-stu-id="d6d54-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="d6d54-218">Přidáte $ před každou jednotkové ceny textová pole, která bude sloužit jako vizuální upozornění, která dá pokyn, uživatelům při zadávání cenu vynechejte symbolu měny.</span><span class="sxs-lookup"><span data-stu-id="d6d54-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="d6d54-219">Nakonec přidání ovládacího prvku ValidationSummary v rámci `InsertingInterface` panelu nastavení jeho `ShowMessageBox` vlastnost `True` a jeho `ShowSummary` vlastnost `False`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="d6d54-220">S tímto nastavením Pokud uživatel zadá hodnotu ceny neplatný jednotky, hvězdičku se zobrazí vedle problematické ovládacích prvcích TextBox a ValidationSummary zobrazí messagebox straně klienta, který zobrazuje chybovou zprávu, kterou jsme dříve zadaný.</span><span class="sxs-lookup"><span data-stu-id="d6d54-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="d6d54-221">V tomto okamžiku by mělo vypadat obrazovky jako obrázek 10.</span><span class="sxs-lookup"><span data-stu-id="d6d54-221">At this point, your screen should look similar to Figure 10.</span></span>


<span data-ttu-id="d6d54-222">[![Vkládání rozhraní nyní zahrnuje textových polí pro produkty názvy a ceny](batch-inserting-vb/_static/image29.png)](batch-inserting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-vb/_static/image29.png)](batch-inserting-vb/_static/image28.png)</span></span>

<span data-ttu-id="d6d54-223">**Obrázek 10**: vkládání rozhraní nyní zahrnuje textových polí pro názvy produktů a ceny ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-vb/_static/image30.png))</span></span>


<span data-ttu-id="d6d54-224">Další, je potřeba přidat produktů přidat z dodávky a Storno do řádku zápatí.</span><span class="sxs-lookup"><span data-stu-id="d6d54-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="d6d54-225">Tlačítko přetáhněte dva ovládací prvky z panelu nástrojů do zápatí rozhraní vkládání nastavení tlačítka `ID` vlastnosti, které chcete `AddProducts` a `CancelButton` a `Text` vlastnosti, které chcete přidat produkty z dodávky a zrušit, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="d6d54-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="d6d54-226">Kromě toho nastavit `CancelButton` ovládacího prvku s `CausesValidation` vlastnost `false`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="d6d54-227">Nakonec je potřeba přidat ovládací prvek webového popisek, který se zobrazí stavové zprávy pro tato dvě rozhraní.</span><span class="sxs-lookup"><span data-stu-id="d6d54-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="d6d54-228">Například pokud uživatel úspěšně přidá nové dodávky produktů, chceme vraťte se na rozhraní zobrazení a zobrazí potvrzovací zpráva.</span><span class="sxs-lookup"><span data-stu-id="d6d54-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="d6d54-229">Pokud však uživatel poskytuje cenu pro nového produktu, ale nechá vypnout název produktu, musíme zobrazí zprávu s upozorněním od `ProductName` pole je povinné.</span><span class="sxs-lookup"><span data-stu-id="d6d54-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="d6d54-230">Vzhledem k tomu, že je třeba tuto zprávu zobrazíte pro obě rozhraní, umístěte ho v horní části stránky mimo panely.</span><span class="sxs-lookup"><span data-stu-id="d6d54-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="d6d54-231">Přetáhněte ovládací prvek popisek webového z panelu nástrojů do horní části stránky v návrháři.</span><span class="sxs-lookup"><span data-stu-id="d6d54-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="d6d54-232">Nastavte `ID` vlastnost `StatusLabel`, zrušte na `Text` vlastnost a nastavte `Visible` a `EnableViewState` vlastnosti, které chcete `False`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `False`.</span></span> <span data-ttu-id="d6d54-233">Jak jsme mohli vidět v předchozích kurzy, nastavení `EnableViewState` vlastnost `False` umožňuje prostřednictvím kódu programu změnit hodnoty popisek s vlastností a nechat je automaticky vrátit zpět na výchozí hodnoty na následné zpětné volání.</span><span class="sxs-lookup"><span data-stu-id="d6d54-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `False` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="d6d54-234">Tato funkce zjednodušuje kód pro zobrazující zprávu o stavu v odpovědi na některé akce uživatele, který zmizí na následné zpětné volání.</span><span class="sxs-lookup"><span data-stu-id="d6d54-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="d6d54-235">Nakonec nastavte `StatusLabel` ovládacího prvku s `CssClass` vlastnost na upozornění, což je název třídy CSS definovaná v `Styles.css` který zobrazí text velký, kurzíva, tučné písmo, red písmeny.</span><span class="sxs-lookup"><span data-stu-id="d6d54-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="d6d54-236">Obrázek 11 ukazuje návrháři sady Visual Studio, po přidání a nakonfigurování popisku.</span><span class="sxs-lookup"><span data-stu-id="d6d54-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>


<span data-ttu-id="d6d54-237">[![Umístěte ovládací prvek StatusLabel výše dva ovládací prvky Panel](batch-inserting-vb/_static/image32.png)](batch-inserting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-vb/_static/image32.png)](batch-inserting-vb/_static/image31.png)</span></span>

<span data-ttu-id="d6d54-238">**Obrázek 11**: místní `StatusLabel` ovládací prvek nahoře dva ovládací prvky Panel ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-vb/_static/image33.png))</span></span>


## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="d6d54-239">Krok 3: Přepínání mezi zobrazení a vkládání rozhraní</span><span class="sxs-lookup"><span data-stu-id="d6d54-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="d6d54-240">V tuto chvíli jsme vyplnili kód pro naše zobrazení a vkládání rozhraní, ale nemůžeme re stále ponechaná na dvě úlohy:</span><span class="sxs-lookup"><span data-stu-id="d6d54-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="d6d54-241">Přepínání mezi zobrazení a vkládání rozhraní</span><span class="sxs-lookup"><span data-stu-id="d6d54-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="d6d54-242">Přidání produkty v dodávky do databáze</span><span class="sxs-lookup"><span data-stu-id="d6d54-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="d6d54-243">V současné době rozhraní zobrazení je viditelná ale rozhraní vkládání skryt.</span><span class="sxs-lookup"><span data-stu-id="d6d54-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="d6d54-244">Důvodem je, že `DisplayInterface` Panel s `Visible` je nastavena na `True` (výchozí hodnota), při `InsertingInterface` Panel s `Visible` je nastavena na `False`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `True` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `False`.</span></span> <span data-ttu-id="d6d54-245">Chcete-li přepnout mezi dvě rozhraní, potřebujeme jen k přepnutí každý ovládací prvek s `Visible` hodnotu vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="d6d54-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="d6d54-246">Chceme přesunout z rozhraní zobrazení rozhraní vkládání při kliknutí na tlačítko procesu dodávky produktu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="d6d54-247">Proto vytvořit obslužnou rutinu události pro toto tlačítko s `Click` událost, která obsahuje následující kód:</span><span class="sxs-lookup"><span data-stu-id="d6d54-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>


[!code-vb[Main](batch-inserting-vb/samples/sample4.vb)]

<span data-ttu-id="d6d54-248">Tento kód jednoduše skryje `DisplayInterface` panelu a ukazuje `InsertingInterface` panelu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="d6d54-249">V dalším kroku vytváření obslužných rutin událostí pro přidání produkty z dodávky a tlačítko Zrušit ovládacích prvků v rozhraní vkládání.</span><span class="sxs-lookup"><span data-stu-id="d6d54-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="d6d54-250">Pokud některý z těchto tlačítek po kliknutí na musíme vrátit se zpátky do rozhraní zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d6d54-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="d6d54-251">Vytvoření `Click` obslužné rutiny události pro obě tlačítko ovládací prvky tak, aby volání `ReturnToDisplayInterface`, metodu přidáme na okamžik.</span><span class="sxs-lookup"><span data-stu-id="d6d54-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="d6d54-252">Kromě skrytí `InsertingInterface` panely a zobrazení `DisplayInterface` panelech `ReturnToDisplayInterface` metoda musí vrátit ovládací prvky webového stavu předem úpravy.</span><span class="sxs-lookup"><span data-stu-id="d6d54-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="d6d54-253">To zahrnuje nastavení DropDownLists `SelectedIndex` vlastnosti 0 a vymazání `Text` vlastností ovládacích prvků textového pole.</span><span class="sxs-lookup"><span data-stu-id="d6d54-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="d6d54-254">Zvažte, co může dojít, pokud jsme dodán t vrátit ovládacích prvků do jejich předem úpravy stavu před vrácením rozhraní zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d6d54-254">Consider what might happen if we didn t return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="d6d54-255">Uživatel může klikněte na tlačítko procesu dodávky produktu, zadejte produkty z dodávky a pak klikněte na tlačítko Přidat produkty z dodávky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="d6d54-256">To by přidejte produkty a vrátí uživatele k zobrazení rozhraní.</span><span class="sxs-lookup"><span data-stu-id="d6d54-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="d6d54-257">V tomto okamžiku by uživatel chtít přidat jiné dodávky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="d6d54-258">Po kliknutí na tlačítko procesu dodávky produktu, které by mohly vrátit rozhraní vložení, ale rozevírací seznam výběry a textové pole hodnot by stále možné naplnit jejich předchozí hodnoty.</span><span class="sxs-lookup"><span data-stu-id="d6d54-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>


[!code-vb[Main](batch-inserting-vb/samples/sample5.vb)]

<span data-ttu-id="d6d54-259">Obě `Click` jednoduše volání obslužné rutiny událostí `ReturnToDisplayInterface` metoda, i když se vrátíme k produktům přidat z dodávky `Click` obslužné rutiny událostí v kroku 4 a přidejte kód pro uložení produkty.</span><span class="sxs-lookup"><span data-stu-id="d6d54-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="d6d54-260">`ReturnToDisplayInterface` Spustí vrácením `Suppliers` a `Categories` DropDownLists jejich první možnosti.</span><span class="sxs-lookup"><span data-stu-id="d6d54-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="d6d54-261">Dvě konstanty `firstControlID` a `lastControlID` označit počáteční a koncové hodnoty řízení indexu v názvu produktu název a jednotka cena textových polí v vkládání rozhraní a jsou použity v hranice `For` smyčky, která nastaví `Text`vlastností ovládacích prvků textového pole zpět na prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="d6d54-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `For` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="d6d54-262">Nakonec panelů `Visible` se obnoví tak, aby rozhraní vkládání skrytá a rozhraní zobrazení zobrazí.</span><span class="sxs-lookup"><span data-stu-id="d6d54-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="d6d54-263">Za chvíli k otestování této stránce v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="d6d54-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="d6d54-264">Při první návštěvě stránky zobrazení rozhraní vám ukáže, jak je vidět na obrázku 5.</span><span class="sxs-lookup"><span data-stu-id="d6d54-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="d6d54-265">Klikněte na tlačítko procesu dodávky produktu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="d6d54-266">Bude odeslat zpět na stránku a měli byste vidět vkládání rozhraní, jak ukazuje obrázek 12.</span><span class="sxs-lookup"><span data-stu-id="d6d54-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="d6d54-267">Buď přidejte produkty z tlačítka dodávky nebo instalaci zrušte kliknutím na tlačítko se vrátíte do rozhraní zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d6d54-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="d6d54-268">Při zobrazení rozhraní vkládání, za chvíli k otestování CompareValidators na do jednotkové ceny textových polí.</span><span class="sxs-lookup"><span data-stu-id="d6d54-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="d6d54-269">Měli byste vidět klienta messagebox upozornění, když kliknete na Přidat produkty z dodávky tlačítka s hodnoty měny neplatný nebo ceny hodnotu menší než nula.</span><span class="sxs-lookup"><span data-stu-id="d6d54-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>


<span data-ttu-id="d6d54-270">[![Rozhraní vložení se zobrazí po kliknutí na tlačítko dodávky produktu procesu](batch-inserting-vb/_static/image35.png)](batch-inserting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-vb/_static/image35.png)](batch-inserting-vb/_static/image34.png)</span></span>

<span data-ttu-id="d6d54-271">**Obrázek 12**: vkládání rozhraní se zobrazí po kliknutí na tlačítko dodávky produktu procesu ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-vb/_static/image36.png))</span></span>


## <a name="step-4-adding-the-products"></a><span data-ttu-id="d6d54-272">Krok 4: Přidání produkty</span><span class="sxs-lookup"><span data-stu-id="d6d54-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="d6d54-273">Všechny, které zůstává pro tento kurz je určen k uložení produkty do databáze v produktech přidat z dodávky tlačítko s `Click` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="d6d54-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="d6d54-274">Můžete to provést tak, že vytvoříte `ProductsDataTable` a přidání `ProductsRow` instance pro každý ze zadaných názvů produktu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="d6d54-275">Jednou tyto `ProductsRow` s byly přidány budeme volání `ProductsBLL` třídu s `UpdateWithTransaction` metoda předávání v `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="d6d54-276">Odvolat, který `UpdateWithTransaction` metoda, která byla vytvořená zpět v [zabalení změny databáze v rámci transakce](wrapping-database-modifications-within-a-transaction-vb.md) kurz, předává `ProductsDataTable` k `ProductsTableAdapter` s `UpdateWithTransaction` metoda.</span><span class="sxs-lookup"><span data-stu-id="d6d54-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter` s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="d6d54-277">Zde, je spuštění ADO.NET transakce a problémů TableAdatper `INSERT` příkaz k databázi pro každý přidat `ProductsRow` DataTable.</span><span class="sxs-lookup"><span data-stu-id="d6d54-277">From there, an ADO.NET transaction is started and the TableAdatper issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="d6d54-278">Za předpokladu, že všechny produkty, které jsou přidány bez chyby, že je transakce potvrzena, v opačném případě je vrácena zpět.</span><span class="sxs-lookup"><span data-stu-id="d6d54-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="d6d54-279">Kód pro přidání produkty z dodávky tlačítko s `Click` obslužné rutiny události musí také provést bit kontroly chyb.</span><span class="sxs-lookup"><span data-stu-id="d6d54-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="d6d54-280">Vzhledem k tomu, že neexistují žádné RequiredFieldValidators použít v rozhraní vkládání, může uživatel zadat při vynechání jeho název ceny pro produkt.</span><span class="sxs-lookup"><span data-stu-id="d6d54-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="d6d54-281">Vzhledem k tomu, že název produktu s je povinný, pokud takové podmínku, kterou se musíme upozornění uživatele a není pokračovat vložení.</span><span class="sxs-lookup"><span data-stu-id="d6d54-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="d6d54-282">Kompletní `Click` následuje kód obslužné rutiny událostí:</span><span class="sxs-lookup"><span data-stu-id="d6d54-282">The complete `Click` event handler code follows:</span></span>


[!code-vb[Main](batch-inserting-vb/samples/sample6.vb)]

<span data-ttu-id="d6d54-283">Obslužné rutiny události začne zajistit, aby `Page.IsValid` vlastnost vrací hodnotu `True`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `True`.</span></span> <span data-ttu-id="d6d54-284">Vrátí-li `False`, pak to znamená, jeden nebo více CompareValidators se hlásí neplatná data; v takovém případě jsme nechcete, aby k pokusu o vložení zadané produkty nebo jsme nakonec se výjimku při pokusu o přiřazení uživatele zadali jednotkové ceny hodnoty na `ProductsRow` s `UnitPrice` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="d6d54-284">If it returns `False`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="d6d54-285">Další, nové `ProductsDataTable` se vytvoří instance (`products`).</span><span class="sxs-lookup"><span data-stu-id="d6d54-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="d6d54-286">A `For` smyčky je použít k iteraci v rámci produktu název a jednotka cena textových polí a `Text` do místní proměnné jsou načteny vlastnosti `productName` a `unitPrice`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-286">A `For` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="d6d54-287">Pokud uživatel zadá hodnotu do jednotkové ceny ale ne pro odpovídající název produktu `StatusLabel` zobrazí zprávu, pokud jste zadali, ceny jednotku, kterou jste musí také obsahovat název produktu a obslužné rutiny události je byl ukončen.</span><span class="sxs-lookup"><span data-stu-id="d6d54-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="d6d54-288">Pokud byl zadaný název produktu, a nové `ProductsRow` instance je vytvořený pomocí `ProductsDataTable` s `NewProductsRow` metoda.</span><span class="sxs-lookup"><span data-stu-id="d6d54-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="d6d54-289">Tento nový `ProductsRow` instance s `ProductName` je nastavena na aktuální produkt název textového pole při `SupplierID` a `CategoryID` vlastnosti jsou přiřazeny k `SelectedValue` vlastnosti DropDownLists v hlavičce vkládání rozhraní s.</span><span class="sxs-lookup"><span data-stu-id="d6d54-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="d6d54-290">Když uživatel zadá hodnotu za cenu produktu s, nebude přiřazen k `ProductsRow` instance s `UnitPrice` vlastnost; jinak, je vlastnost nepřiřazené, vlevo, která bude mít za následek `NULL` hodnota `UnitPrice` v databázi.</span><span class="sxs-lookup"><span data-stu-id="d6d54-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="d6d54-291">Nakonec `Discontinued` a `UnitsOnOrder` vlastnosti přiřazené hodnoty pevně `False` a 0, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="d6d54-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `False` and 0, respectively.</span></span>

<span data-ttu-id="d6d54-292">Po přiřazení vlastnosti `ProductsRow` instance je přidán do `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="d6d54-293">Po dokončení `For` smyčky, jsme zkontrolujte, zda byly přidány všechny produkty.</span><span class="sxs-lookup"><span data-stu-id="d6d54-293">At the completion of the `For` loop, we check whether any products have been added.</span></span> <span data-ttu-id="d6d54-294">Uživatel může po všech klikli přidat produkty z dodávky před vstupem všechny názvy produktů nebo ceny.</span><span class="sxs-lookup"><span data-stu-id="d6d54-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="d6d54-295">Pokud je alespoň jeden produktu v `ProductsDataTable`, `ProductsBLL` třídu s `UpdateWithTransaction` metoda je volána.</span><span class="sxs-lookup"><span data-stu-id="d6d54-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="d6d54-296">Dále je odrážejí data do `ProductsGrid` GridView tak, aby nově přidané produkty se zobrazí v zobrazení rozhraní.</span><span class="sxs-lookup"><span data-stu-id="d6d54-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="d6d54-297">`StatusLabel` Se aktualizuje a zobrazí zprávu s potvrzením a `ReturnToDisplayInterface` je vyvolána, skrytí vkládání rozhraní a zobrazující rozhraní zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d6d54-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="d6d54-298">Pokud byla zadána žádná produktů, vkládání rozhraní zůstane zobrazené ale zprávy, které nebyly přidány žádné produkty.</span><span class="sxs-lookup"><span data-stu-id="d6d54-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="d6d54-299">Zadejte názvy produktů a jednotkové ceny v textových polí se zobrazí.</span><span class="sxs-lookup"><span data-stu-id="d6d54-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="d6d54-300">Obrázek s 13, 14 až 15 zobrazit vkládání a zobrazit rozhraní v akci.</span><span class="sxs-lookup"><span data-stu-id="d6d54-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="d6d54-301">Obrázek 13 uživatelem zadaná hodnota cena jednotky bez odpovídající názvu produktu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="d6d54-302">Obrázek 14 zobrazuje rozhraní zobrazení po tři nové produkty byly přidány úspěšně, a zobrazí dvě nově přidané produkty obrázek 15 GridView (třetí ten se na předchozí stránce).</span><span class="sxs-lookup"><span data-stu-id="d6d54-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>


<span data-ttu-id="d6d54-303">[![Název produktu je nutné při zadávání jednotkové ceny](batch-inserting-vb/_static/image38.png)](batch-inserting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-vb/_static/image38.png)](batch-inserting-vb/_static/image37.png)</span></span>

<span data-ttu-id="d6d54-304">**Obrázek 13**: název produktu A je potřeba při zadávání jednotkové ceny ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-vb/_static/image39.png))</span></span>


<span data-ttu-id="d6d54-305">[![Tři nové Veggies byly přidány pro dodavatele Mayumi s](batch-inserting-vb/_static/image41.png)](batch-inserting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-vb/_static/image41.png)](batch-inserting-vb/_static/image40.png)</span></span>

<span data-ttu-id="d6d54-306">**Obrázek 14**: tři nové Veggies byly přidány pro s Mayumi dodavatele ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-vb/_static/image42.png))</span></span>


<span data-ttu-id="d6d54-307">[![Nové produkty naleznete na poslední stránku GridView](batch-inserting-vb/_static/image44.png)](batch-inserting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="d6d54-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-vb/_static/image44.png)](batch-inserting-vb/_static/image43.png)</span></span>

<span data-ttu-id="d6d54-308">**Obrázek 15**: nové produktům najdete na poslední stránku GridView ([Kliknutím zobrazit obrázek v plné velikosti](batch-inserting-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="d6d54-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-vb/_static/image45.png))</span></span>


> [!NOTE]
> <span data-ttu-id="d6d54-309">Dávkové vložení logiky použili v tomto kurzu zabalí vložení v rámci oboru transakce.</span><span class="sxs-lookup"><span data-stu-id="d6d54-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="d6d54-310">Chcete-li to ověřit, záměrně zavést na úrovni databáze chybu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="d6d54-311">Například místo přiřazení nové `ProductsRow` instance s `CategoryID` vlastnost na vybranou hodnotu v `Categories` rozevírací seznam, přiřadit ho na hodnotu jako `i * 5`.</span><span class="sxs-lookup"><span data-stu-id="d6d54-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="d6d54-312">Zde `i` indexeru smyčky a má hodnoty v rozsahu od 1 do 5.</span><span class="sxs-lookup"><span data-stu-id="d6d54-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="d6d54-313">Proto při přidávání dvě nebo více produktů v dávce vložit první produktu budou mít platný `CategoryID` bude mít hodnotu (5), ale následné produkty `CategoryID` hodnoty, které neodpovídají až `CategoryID` hodnoty ve `Categories` tabulky.</span><span class="sxs-lookup"><span data-stu-id="d6d54-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="d6d54-314">Čistý efekt je, že při první `INSERT` bude úspěšné, následných ty se nezdaří s narušení omezení pro cizí klíč.</span><span class="sxs-lookup"><span data-stu-id="d6d54-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="d6d54-315">Vzhledem k tomu, že je dávkové vložení atomic, první `INSERT` bude vrácena zpět, vrácení začal databázi do stavu před dávky vložit procesu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>


## <a name="summary"></a><span data-ttu-id="d6d54-316">Souhrn</span><span class="sxs-lookup"><span data-stu-id="d6d54-316">Summary</span></span>

<span data-ttu-id="d6d54-317">Přes toto a předchozí dva kurzy jsme vytvořili rozhraní, které umožňují pro aktualizaci, odstranění, a vkládání balíků dat, které použít podpora transakcí jsme přidali do Data Access Layer v [zabalení změny databáze v rámci transakce](wrapping-database-modifications-within-a-transaction-vb.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="d6d54-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial.</span></span> <span data-ttu-id="d6d54-318">Pro určité scénáře, takové dávkové zpracování uživatelského rozhraní výrazně zlepšit efektivitu koncový uživatel vyjímání dolů na počet kliknutí, zpětná vystavení a kontext klávesnice myši přepínače, při zachování také integritu podkladová data.</span><span class="sxs-lookup"><span data-stu-id="d6d54-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="d6d54-319">V tomto kurzu dokončení naše pohled na práci s daty dávkové.</span><span class="sxs-lookup"><span data-stu-id="d6d54-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="d6d54-320">Jsou zde popsány další sadu kurzy celou řadu pokročilých scénářích Data Access Layer, včetně použití uložených procedur v TableAdapter s metodami, konfigurace nastavení připojení a příkaz úrovně v DAL, šifrování připojovací řetězce a další!</span><span class="sxs-lookup"><span data-stu-id="d6d54-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="d6d54-321">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="d6d54-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d6d54-322">O autorovi</span><span class="sxs-lookup"><span data-stu-id="d6d54-322">About the Author</span></span>

<span data-ttu-id="d6d54-323">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a zakladatele z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje s technologií Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="d6d54-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d6d54-324">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="d6d54-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d6d54-325">Jeho nejnovější seznam k [ *Edice nakladatelství Sams naučit sami technologii ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d6d54-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d6d54-326">Dosažitelný v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu, který najdete na [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d6d54-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d6d54-327">Zvláštní poděkování</span><span class="sxs-lookup"><span data-stu-id="d6d54-327">Special Thanks To</span></span>

<span data-ttu-id="d6d54-328">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="d6d54-328">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d6d54-329">Vést kontroloři pro účely tohoto kurzu byly Hilton Giesenow a S ren Jakub Lauritsen.</span><span class="sxs-lookup"><span data-stu-id="d6d54-329">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="d6d54-330">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="d6d54-330">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d6d54-331">Pokud ano, vyřaďte mi řádek v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d6d54-331">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="d6d54-332">Předchozí</span><span class="sxs-lookup"><span data-stu-id="d6d54-332">Previous</span></span>](batch-deleting-vb.md)
