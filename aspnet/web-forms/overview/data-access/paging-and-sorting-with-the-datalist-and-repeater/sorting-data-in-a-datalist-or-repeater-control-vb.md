---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
title: "Řazení dat v DataList nebo prvku Repeater (VB) | Microsoft Docs"
author: rick-anderson
description: "V tomto kurzu podíváme, jak se zahrnuje řazení podpora v DataList a opakovače, jakož i konstruování DataList nebo opakovače, jejichž data můžete..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/13/2006
ms.topic: article
ms.assetid: 97c13898-0741-45f9-b3fa-7540ab1679e6
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 0133a74454a7754f4f7087e2121c7387a1aef8a8
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2018
---
<a name="sorting-data-in-a-datalist-or-repeater-control-vb"></a><span data-ttu-id="b489d-103">Řazení dat v DataList nebo prvku Repeater (VB)</span><span class="sxs-lookup"><span data-stu-id="b489d-103">Sorting Data in a DataList or Repeater Control (VB)</span></span>
====================
<span data-ttu-id="b489d-104">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b489d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b489d-105">[Stáhněte si ukázkovou aplikaci](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe) nebo [stáhnout PDF](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b489d-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span></span>

> <span data-ttu-id="b489d-106">V tomto kurzu podíváme, jak se zahrnuje řazení podpora v DataList a opakovače, jakož i konstruování DataList nebo opakovače, jejichž data můžete stránkovaného fondu a seřazeny.</span><span class="sxs-lookup"><span data-stu-id="b489d-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>


## <a name="introduction"></a><span data-ttu-id="b489d-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="b489d-107">Introduction</span></span>

<span data-ttu-id="b489d-108">V [předchozí kurzu](paging-report-data-in-a-datalist-or-repeater-control-vb.md) jsme se zaměřili na tom, jak přidat podporu stránkování k DataList.</span><span class="sxs-lookup"><span data-stu-id="b489d-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="b489d-109">Jsme vytvořili novou metodu v `ProductsBLL` – třída (`GetProductsAsPagedDataSource`) vrácená `PagedDataSource` objektu.</span><span class="sxs-lookup"><span data-stu-id="b489d-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="b489d-110">Když je vázán k DataList nebo opakovače, by DataList nebo opakovače zobrazí právě k požadované stránce data.</span><span class="sxs-lookup"><span data-stu-id="b489d-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="b489d-111">Tento postup je podobný co se používá interně ovládacími prvky GridView DetailsView a FormView zajistit jejich integrované výchozí funkce stránkování.</span><span class="sxs-lookup"><span data-stu-id="b489d-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="b489d-112">Nabízí podporu stránkování, kromě GridView také zahrnuje předinstalované řazení podpory.</span><span class="sxs-lookup"><span data-stu-id="b489d-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="b489d-113">DataList ani opakovače poskytuje vestavěnou funkci řazení; řazení funkce však mohou být přidány s malou část kódu.</span><span class="sxs-lookup"><span data-stu-id="b489d-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="b489d-114">V tomto kurzu podíváme, jak se zahrnuje řazení podpora v DataList a opakovače, jakož i konstruování DataList nebo opakovače, jejichž data můžete stránkovaného fondu a seřazeny.</span><span class="sxs-lookup"><span data-stu-id="b489d-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="b489d-115">Zkontrolujte řazení</span><span class="sxs-lookup"><span data-stu-id="b489d-115">A Review of Sorting</span></span>

<span data-ttu-id="b489d-116">Jak jsme viděli v [stránkování a řazení dat sestavy](../paging-and-sorting/paging-and-sorting-report-data-vb.md) kurzu prvek GridView poskytuje předinstalované řazení podpory.</span><span class="sxs-lookup"><span data-stu-id="b489d-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="b489d-117">Každé pole GridView může mít přiřazený `SortExpression`, což naznačuje datové pole, podle kterého chcete řadit data.</span><span class="sxs-lookup"><span data-stu-id="b489d-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="b489d-118">Při GridView s `AllowSorting` je nastavena na `true`, každé pole GridView, který má `SortExpression` záhlaví se vykresluje jako LinkButton má hodnotu vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="b489d-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="b489d-119">Když uživatel klikne na konkrétní GridView pole s hlavičky, nastane zpětné volání a data jsou seřazená podle pole kliknutelnou s `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="b489d-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="b489d-120">Ovládací prvek GridView má `SortExpression` taky vlastnost, která ukládá `SortExpression` pole GridView data jsou seřazená podle.</span><span class="sxs-lookup"><span data-stu-id="b489d-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="b489d-121">Kromě toho `SortDirection` vlastnost určuje, zda data který se má seřadit ve vzestupném nebo sestupném pořadí (Pokud uživatel klikne na odkaz záhlaví pole s konkrétní GridView dvakrát za sebou, pořadí řazení je přepínat stav).</span><span class="sxs-lookup"><span data-stu-id="b489d-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="b489d-122">Když GridView je vázán k jeho řízení zdrojů dat, se předá jeho `SortExpression` a `SortDirection` vlastnosti, které chcete data zdroj ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="b489d-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="b489d-123">Ovládací prvek zdroj dat načte data a potom je seřadí podle zadaných `SortExpression` a `SortDirection` vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="b489d-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="b489d-124">Po řazení dat, vrátí ovládací prvek zdroje dat ji do GridView.</span><span class="sxs-lookup"><span data-stu-id="b489d-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="b489d-125">Tato funkce s ovládacími prvky DataList nebo opakovače replikovat, jsme musí:</span><span class="sxs-lookup"><span data-stu-id="b489d-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="b489d-126">Vytvoření řazení rozhraní</span><span class="sxs-lookup"><span data-stu-id="b489d-126">Create a sorting interface</span></span>
- <span data-ttu-id="b489d-127">Mějte na paměti, seřadit podle pole data a jestli se má seřadit ve vzestupném nebo sestupném pořadí</span><span class="sxs-lookup"><span data-stu-id="b489d-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="b489d-128">Vyzvat ObjectDataSource k řazení dat. podle konkrétní datové pole</span><span class="sxs-lookup"><span data-stu-id="b489d-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="b489d-129">Jsme budete řešení tyto tři úlohy v krocích 3 a 4.</span><span class="sxs-lookup"><span data-stu-id="b489d-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="b489d-130">Následující, podíváme, jak se zahrnuje stránkování i řazení podpory v DataList nebo opakovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="b489d-131">Krok 2: Zobrazení v prvku Repeater produkty</span><span class="sxs-lookup"><span data-stu-id="b489d-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="b489d-132">Před jsme starat o implementaci všechny funkce související s řazení, umožní s začněte tím, že seznam produktů v ovládacím prvku opakovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="b489d-133">Začněte otevřením `Sorting.aspx` stránku `PagingSortingDataListRepeater` složky.</span><span class="sxs-lookup"><span data-stu-id="b489d-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="b489d-134">Přidání ovládacího prvku opakovače na webovou stránku, nastavení jeho `ID` vlastnost `SortableProducts`.</span><span class="sxs-lookup"><span data-stu-id="b489d-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="b489d-135">Opakovače s inteligentním, vytvořte nový ObjectDataSource s názvem `ProductsDataSource` a nakonfigurovat ji k načtení dat z `ProductsBLL` třídu s `GetProducts()` metoda.</span><span class="sxs-lookup"><span data-stu-id="b489d-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="b489d-136">Vyberte možnost (žádné) možnost z rozevíracího seznamu na kartách INSERT, UPDATE a DELETE.</span><span class="sxs-lookup"><span data-stu-id="b489d-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="b489d-137">[![ObjectDataSource vytvořit a nakonfigurovat jej lze pomocí této metody GetProductsAsPagedDataSource()](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span></span>

<span data-ttu-id="b489d-138">**Obrázek 1**: ObjectDataSource vytvořit a nakonfigurovat jej pro použití `GetProductsAsPagedDataSource()` – metoda ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span></span>


<span data-ttu-id="b489d-139">[![Nastavte rozevíracím seznamu v aktualizaci UPDATE, INSERT a odstranit karty na (žádný)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span></span>

<span data-ttu-id="b489d-140">**Obrázek 2**: nastavte rozevíracím seznamu v aktualizaci UPDATE, INSERT a odstranit karty na (žádný) ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span></span>


<span data-ttu-id="b489d-141">Na rozdíl od s DataList, Visual Studio automaticky nevytvoří `ItemTemplate` po vazby ke zdroji dat ovládacího prvku opakovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="b489d-142">Kromě toho musí přidáme to `ItemTemplate` deklarativně jako inteligentní značky ovládacího prvku s opakovače chybí možnost Upravit šablony v DataList s nalezen.</span><span class="sxs-lookup"><span data-stu-id="b489d-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="b489d-143">Umožňují s používat stejné `ItemTemplate` z předchozí kurz, který zobrazí název produktu s, dodavatele a kategorie.</span><span class="sxs-lookup"><span data-stu-id="b489d-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="b489d-144">Po přidání `ItemTemplate`, opakovače a ObjectDataSource s deklarativní by měl vypadat podobně jako následující:</span><span class="sxs-lookup"><span data-stu-id="b489d-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample1.aspx)]

<span data-ttu-id="b489d-145">Obrázek 3 ukazuje tuto stránku při zobrazení prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="b489d-145">Figure 3 shows this page when viewed through a browser.</span></span>


<span data-ttu-id="b489d-146">[![Zobrazí se každý produkt s názvem, dodavatele a kategorii](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="b489d-147">**Obrázek 3**: každý produkt s názvem, dodavatele a kategorie se zobrazí ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span></span>


## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="b489d-148">Krok 3: Instruující ObjectDataSource k řazení dat.</span><span class="sxs-lookup"><span data-stu-id="b489d-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="b489d-149">Řazení dat, které zobrazuje v Opakovači, je potřeba informovat ObjectDataSource výrazu řazení, podle kterého má řazení proběhnout data.</span><span class="sxs-lookup"><span data-stu-id="b489d-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="b489d-150">Předtím, než ObjectDataSource načítá data, nejprve aktivuje její [ `Selecting` událostí](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), což dává příležitost, abychom mohli zadejte výraz řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="b489d-151">`Selecting` Obslužné rutiny události se předá objekt typu [ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), který má vlastnost s názvem [ `Arguments` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) typu [ `DataSourceSelectArguments` ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span><span class="sxs-lookup"><span data-stu-id="b489d-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="b489d-152">`DataSourceSelectArguments` Třída slouží k předávání žádostí souvisejících s daty z příjemce dat k řízení zdrojů dat a zahrnuje [ `SortExpression` vlastnost](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span><span class="sxs-lookup"><span data-stu-id="b489d-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="b489d-153">Chcete-li předat řazení informace ze stránky ASP.NET ObjectDataSource, vytvořit obslužnou rutinu události pro `Selecting` událostí a použijte následující kód:</span><span class="sxs-lookup"><span data-stu-id="b489d-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample2.vb)]

<span data-ttu-id="b489d-154">*SortExpression* hodnota by měla být přiřazená název datového pole seřadit podle data (například ProductName).</span><span class="sxs-lookup"><span data-stu-id="b489d-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="b489d-155">Neexistuje vlastnost související směr řazení, takže pokud chcete data seřaďte v sestupném pořadí, doplňovací řetězec DESC k *sortExpression* hodnotu (například ProductName DESC).</span><span class="sxs-lookup"><span data-stu-id="b489d-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="b489d-156">Pokračujte a zkuste několik různých hodnot pevně pro *sortExpression* a testovat výsledky v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="b489d-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="b489d-157">Jak ukazuje obrázek 4, při použití ProductName DESC jako *sortExpression*, produkty jsou seřazeny podle názvu jejich ve vzestupném abecedním pořadí.</span><span class="sxs-lookup"><span data-stu-id="b489d-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>


<span data-ttu-id="b489d-158">[![Produkty jsou seřazeny podle názvu jejich Reverse abecedně](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span></span>

<span data-ttu-id="b489d-159">**Obrázek 4**: The produkty jsou seřazeny podle názvu jejich v abecedním pořadí Reverse ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span></span>


## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="b489d-160">Krok 4: Vytvoření rozhraní řazení a zapamatování výrazů řazení a směr</span><span class="sxs-lookup"><span data-stu-id="b489d-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="b489d-161">Zapnutí podpory v GridView řazení převede text záhlaví každý řazení pole s LinkButton, po kliknutí na seřadí data odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="b489d-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="b489d-162">Řazení rozhraní má smysl pro GridView, kde jeho data přehledně rozložená ve sloupcích.</span><span class="sxs-lookup"><span data-stu-id="b489d-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="b489d-163">Pro ovládací prvky DataList a opakovače ale jiné řazení rozhraní je potřeba.</span><span class="sxs-lookup"><span data-stu-id="b489d-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="b489d-164">Společné rozhraní řazení seznam dat (na rozdíl od mřížky dat), je rozevíracího seznamu, který poskytuje pole, podle kterých se dají řadit data.</span><span class="sxs-lookup"><span data-stu-id="b489d-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="b489d-165">Umožní s implementovat takového rozhraní pro účely tohoto kurzu.</span><span class="sxs-lookup"><span data-stu-id="b489d-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="b489d-166">Přidat ovládací prvek rozevírací seznam webového výše `SortableProducts` opakovače a nastavte její `ID` vlastnost `SortBy`.</span><span class="sxs-lookup"><span data-stu-id="b489d-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="b489d-167">V okně vlastností klikněte na výpustky v `Items` vlastnost, aby si Editor kolekce ListItem.</span><span class="sxs-lookup"><span data-stu-id="b489d-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="b489d-168">Přidat `ListItem` s k řazení dat. tím `ProductName`, `CategoryName`, a `SupplierName` pole.</span><span class="sxs-lookup"><span data-stu-id="b489d-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="b489d-169">Také přidat `ListItem` seřadit produkty podle názvu jejich ve vzestupném abecedním pořadí.</span><span class="sxs-lookup"><span data-stu-id="b489d-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="b489d-170">`ListItem` `Text` Vlastnosti lze nastavit na jakoukoli hodnotu (například název), ale `Value` vlastnosti musí být nastavena na název datového pole (například ProductName).</span><span class="sxs-lookup"><span data-stu-id="b489d-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="b489d-171">Chcete-li seřadit výsledky v sestupném pořadí, připojte řetězec DESC název pole dat, jako je ProductName DESC.</span><span class="sxs-lookup"><span data-stu-id="b489d-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>


![Přidání položky ListItem pro každé pole řazení dat](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image13.png)

<span data-ttu-id="b489d-173">**Obrázek 5**: přidání `ListItem` pro každé pole řazení dat</span><span class="sxs-lookup"><span data-stu-id="b489d-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>


<span data-ttu-id="b489d-174">Nakonec přidejte ovládacího prvku tlačítko webové napravo rozevírací seznam.</span><span class="sxs-lookup"><span data-stu-id="b489d-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="b489d-175">Nastavte její `ID` k `RefreshRepeater` a jeho `Text` vlastnosti aktualizace.</span><span class="sxs-lookup"><span data-stu-id="b489d-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="b489d-176">Po vytvoření `ListItem` s a přidání tlačítko Aktualizovat rozevírací seznam a tlačítko deklarativní syntaxi s by měl vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="b489d-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample3.aspx)]

<span data-ttu-id="b489d-177">Pomocí řazení rozevírací seznam dokončení, musíme další aktualizace ObjectDataSource s `Selecting` obslužné rutiny události tak, aby používala vybraný `SortBy``ListItem` s `Value` vlastnost oproti výraz pevně řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample4.vb)]

<span data-ttu-id="b489d-178">V tomto okamžiku při první návštěvě stránce bude produkty původně seřazené podle `ProductName` pole dat, protože s `SortBy` `ListItem` vybrané ve výchozím nastavení (viz obrázek 6).</span><span class="sxs-lookup"><span data-stu-id="b489d-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="b489d-179">Vyberete různé řazení možnost například kategorie a kliknutím na tlačítko Aktualizovat způsobí zpětné volání a znovu seřadit data název kategorie, jak je vidět na obrázku 7.</span><span class="sxs-lookup"><span data-stu-id="b489d-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>


<span data-ttu-id="b489d-180">[![Tyto produkty jsou původně seřazené podle názvu](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span></span>

<span data-ttu-id="b489d-181">**Obrázek 6**: produkty jsou původně seřazené podle názvu jejich ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span></span>


<span data-ttu-id="b489d-182">[![Tyto produkty jsou nyní seřazené podle kategorie](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span></span>

<span data-ttu-id="b489d-183">**Obrázek 7**: produkty jsou nyní seřazené podle kategorie ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b489d-184">Kliknutím na tlačítko Aktualizovat způsobí, že data jako automaticky znovu seřazené protože stav opakovače s zobrazení je zakázané, a způsobuje opakovače se svázat svůj zdroj dat na každé zpětné volání.</span><span class="sxs-lookup"><span data-stu-id="b489d-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="b489d-185">Pokud jste již opakovače s zobrazení stav povoleno, změna toto řazení rozevíracího seznamu won t mít žádné dopad na pořadí řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won t have any affect on the sort order.</span></span> <span data-ttu-id="b489d-186">Chcete-li to opravit, vytvoření obslužné rutiny události pro tlačítko Aktualizovat s `Click` událostí a obnovení vazby opakovače svůj zdroj dat (voláním opakovače s `DataBind()` metoda).</span><span class="sxs-lookup"><span data-stu-id="b489d-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>


## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="b489d-187">Zapamatování výrazů řazení a směr</span><span class="sxs-lookup"><span data-stu-id="b489d-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="b489d-188">Při vytváření řazení DataList nebo opakovače na stránce, kde bez řazení související postback může dojít, je s imperativní že výrazů řazení a směr zapamatován napříč postback.</span><span class="sxs-lookup"><span data-stu-id="b489d-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="b489d-189">Představte si například, že v tomto kurzu zahrnout tlačítko Odstranit u každého produktu aktualizován opakovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="b489d-190">Když uživatel klikne na tlačítko Odstranit jsme d spouštět nějaký kód odstranit vybrané produktu a konkrétním data, která mají opakovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="b489d-191">Pokud nejsou podrobnosti řazení zachová pro zpětné volání, údaje zobrazené na obrazovce se vrátí do původního pořadí řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="b489d-192">V tomto kurzu rozevírací seznam implicitně ukládá řazení výraz a směr svůj stav zobrazení pro nás.</span><span class="sxs-lookup"><span data-stu-id="b489d-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="b489d-193">Pokud jsme používali různé řazení rozhraní, jeden s Řekněme, LinkButtons, které poskytuje různé možnosti řazení d musíme postará pamatovat pořadí řazení mezi postback.</span><span class="sxs-lookup"><span data-stu-id="b489d-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="b489d-194">To je možné dosáhnout uložením řazení parametry ve stavu zobrazení stránky s, včetně řazení parametr v řetězci dotazu nebo prostřednictvím některé jiné technika trvalost stavu.</span><span class="sxs-lookup"><span data-stu-id="b489d-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="b489d-195">Budoucí příklady v tomto kurzu prozkoumejte postup zachovat řazení podrobnosti ve stavu zobrazení stránky s.</span><span class="sxs-lookup"><span data-stu-id="b489d-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="b489d-196">Krok 5: Přidání řazení podporu pro DataList, který používá výchozí stránkování</span><span class="sxs-lookup"><span data-stu-id="b489d-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="b489d-197">V [předchozí kurzu](paging-report-data-in-a-datalist-or-repeater-control-vb.md) jsme se zaměřili na implementaci stránkování výchozí s DataList.</span><span class="sxs-lookup"><span data-stu-id="b489d-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="b489d-198">Umožní s tato předchozí příklad rozšířit pro zahrnují možnost řadit stránkové data.</span><span class="sxs-lookup"><span data-stu-id="b489d-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="b489d-199">Začněte otevřením `SortingWithDefaultPaging.aspx` a `Paging.aspx` stránky v `PagingSortingDataListRepeater` složky.</span><span class="sxs-lookup"><span data-stu-id="b489d-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="b489d-200">Z `Paging.aspx` klikněte na tlačítko zdroj pro zobrazení stránky s deklarativní.</span><span class="sxs-lookup"><span data-stu-id="b489d-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="b489d-201">Kopírovat vybraný text (viz obrázek 8) a vložte jej do deklarativní z `SortingWithDefaultPaging.aspx` mezi `<asp:Content>` značky.</span><span class="sxs-lookup"><span data-stu-id="b489d-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>


<span data-ttu-id="b489d-202">[![Deklarativní v replikaci &lt;asp: obsah&gt; značek z Paging.aspx SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span></span>

<span data-ttu-id="b489d-203">**Obrázek 8**: deklarativní v replikaci `<asp:Content>` značky z `Paging.aspx` k `SortingWithDefaultPaging.aspx` ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span></span>


<span data-ttu-id="b489d-204">Po zkopírování deklarativní, zkopírujte metody a vlastnosti ve `Paging.aspx` stránky třídu s kódem v pozadí k třídě kódu pro `SortingWithDefaultPaging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="b489d-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="b489d-205">V dalším kroku pozorně zobrazení `SortingWithDefaultPaging.aspx` stránku v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="b489d-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="b489d-206">By měl mít květy stejné funkce a vzhled jako `Paging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="b489d-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="b489d-207">Rozšíření ProductsBLL zahrnout výchozí stránkování a řazení – metoda</span><span class="sxs-lookup"><span data-stu-id="b489d-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="b489d-208">V předchozích kurzu jsme vytvořili `GetProductsAsPagedDataSource(pageIndex, pageSize)` metoda v `ProductsBLL` třídy, který vrátil `PagedDataSource` objektu.</span><span class="sxs-lookup"><span data-stu-id="b489d-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="b489d-209">To `PagedDataSource` objekt byl naplněný *všechny* produkty (prostřednictvím BLL s `GetProducts()` metoda), ale když vázaný DataList pouze záznamy odpovídající zadanému *index stránky* a *pageSize* byly zobrazeny vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="b489d-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="b489d-210">V tomto kurzu jsme přidali řazení podporu zadáním výrazů řazení z ObjectDataSource s `Selecting` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="b489d-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="b489d-211">Tento postup funguje i když ObjectDataSource se vrátí objekt, který lze seřadit, jako je třeba `ProductsDataTable` vrácené `GetProducts()` metoda.</span><span class="sxs-lookup"><span data-stu-id="b489d-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="b489d-212">Ale `PagedDataSource` objekt vrácený `GetProductsAsPagedDataSource` metoda nepodporuje řazení jeho vnitřní datové zdroje.</span><span class="sxs-lookup"><span data-stu-id="b489d-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="b489d-213">Místo toho je potřeba seřadit výsledky vrácené `GetProducts()` metoda *před* jsme ji umístit do `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="b489d-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="b489d-214">K tomu, vytvoření nové metody v `ProductsBLL` třídy `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span><span class="sxs-lookup"><span data-stu-id="b489d-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="b489d-215">Seřadit `ProductsDataTable` vrácený `GetProducts()` metoda, zadejte `Sort` vlastnost jeho výchozí `DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="b489d-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample5.vb)]

<span data-ttu-id="b489d-216">`GetProductsSortedAsPagedDataSource` Metoda se pouze mírně liší od `GetProductsAsPagedDataSource` metoda vytvořili v předchozí kurzu.</span><span class="sxs-lookup"><span data-stu-id="b489d-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="b489d-217">Konkrétně `GetProductsSortedAsPagedDataSource` přijímá další vstupní parametr `sortExpression` a přiřadí této hodnoty `Sort` vlastnost `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="b489d-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="b489d-218">Po zadání několika řádků kódu později, `PagedDataSource` objekt s zdroj dat je přiřazen `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="b489d-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="b489d-219">Volání metody GetProductsSortedAsPagedDataSource a určující hodnotu pro parametr SortExpression vstup</span><span class="sxs-lookup"><span data-stu-id="b489d-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="b489d-220">Pomocí `GetProductsSortedAsPagedDataSource` Metoda dokončení, dalším krokem je zadejte hodnotu tohoto parametru.</span><span class="sxs-lookup"><span data-stu-id="b489d-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="b489d-221">ObjectDataSource v `SortingWithDefaultPaging.aspx` je nyní nakonfigurován, aby volání `GetProductsAsPagedDataSource` metoda a předává dva vstupní parametry prostřednictvím jeho dva `QueryStringParameters`, které jsou určené v `SelectParameters` kolekce.</span><span class="sxs-lookup"><span data-stu-id="b489d-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="b489d-222">Tyto dva `QueryStringParameters` označuje, že zdroj `GetProductsAsPagedDataSource` metoda s *index stránky* a *pageSize* parametry pocházejí z pole řetězce dotazu `pageIndex` a `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="b489d-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="b489d-223">Aktualizace ObjectDataSource s `SelectMethod` vlastnosti, které se vyvolá nové `GetProductsSortedAsPagedDataSource` metoda.</span><span class="sxs-lookup"><span data-stu-id="b489d-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="b489d-224">Pak přidejte nový `QueryStringParameter` tak, aby *sortExpression* vstupní parametr přistupuje z pole řetězce dotazu `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="b489d-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="b489d-225">Nastavte `QueryStringParameter` s `DefaultValue` k ProductName.</span><span class="sxs-lookup"><span data-stu-id="b489d-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="b489d-226">Po provedení těchto změn ObjectDataSource s deklarativní by měl vypadat podobně jako:</span><span class="sxs-lookup"><span data-stu-id="b489d-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample6.aspx)]

<span data-ttu-id="b489d-227">V tomto okamžiku `SortingWithDefaultPaging.aspx` stránka bude abecedně seřaďte své výsledky podle názvu produktu (viz obrázek 9).</span><span class="sxs-lookup"><span data-stu-id="b489d-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="b489d-228">Důvodem je, že ve výchozím nastavení, je předaná hodnota ProductName jako `GetProductsSortedAsPagedDataSource` metoda s *sortExpression* parametr.</span><span class="sxs-lookup"><span data-stu-id="b489d-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>


<span data-ttu-id="b489d-229">[![Ve výchozím nastavení jsou výsledky seřazené podle ProductName](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span></span>

<span data-ttu-id="b489d-230">**Obrázek 9**: ve výchozím výsledky jsou seřazené podle `ProductName` ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))</span></span>


<span data-ttu-id="b489d-231">Pokud ručně přidáte `sortExpression` pole řetězce dotazu, jako `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` výsledky budou seřazeny podle zadaného `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="b489d-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="b489d-232">Ale to `sortExpression` parametr není zahrnutý v řetězci dotazu při přesunu dat na jinou stránku.</span><span class="sxs-lookup"><span data-stu-id="b489d-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="b489d-233">Kliknutím na další nebo poslední stránku ve skutečnosti tlačítka trvá nám zpět do `Paging.aspx`!</span><span class="sxs-lookup"><span data-stu-id="b489d-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="b489d-234">Kromě toho že s aktuálně žádné řazení rozhraní.</span><span class="sxs-lookup"><span data-stu-id="b489d-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="b489d-235">Jediným způsobem, uživatel může změnit pořadí řazení stránkové dat je přímo manipulace s řetězci dotazu.</span><span class="sxs-lookup"><span data-stu-id="b489d-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="b489d-236">Vytváření rozhraní řazení</span><span class="sxs-lookup"><span data-stu-id="b489d-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="b489d-237">Je potřeba nejdřív aktualizovat `RedirectUser` metodu pro odeslání uživatelům `SortingWithDefaultPaging.aspx` (místo `Paging.aspx`) a zahrnout `sortExpression` hodnota v řetězci dotazu.</span><span class="sxs-lookup"><span data-stu-id="b489d-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="b489d-238">Také jsme měli přidat jen pro čtení, úrovni stránky s názvem `SortExpression` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="b489d-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="b489d-239">Tato vlastnost, podobně jako `PageIndex` a `PageSize` vlastnosti vytvořili v předchozí kurzu, vrátí hodnotu `sortExpression` pole řetězce dotazu, pokud existuje a výchozí hodnota (ProductName) jinak.</span><span class="sxs-lookup"><span data-stu-id="b489d-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="b489d-240">Aktuálně `RedirectUser` metoda přijímá pouze jeden vstupní parametr index stránky pro zobrazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="b489d-241">Může však nastat situace, když chcete přesměrovat uživatele na konkrétní stránku dat pomocí výraz řazení, než jaké s zadaný v řetězci dotazu.</span><span class="sxs-lookup"><span data-stu-id="b489d-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="b489d-242">Za chvíli vytvoříme rozhraní řazení pro tuto stránku, která bude zahrnovat řadu ovládací prvky webového tlačítko pro řazení dat podle zadaného sloupce.</span><span class="sxs-lookup"><span data-stu-id="b489d-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="b489d-243">Po kliknutí těchto tlačítek na, chceme přesměruje uživatele předávání v hodnota výrazu odpovídající řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="b489d-244">Aby bylo možné tuto funkci, vytvářet dvě verze `RedirectUser` metoda.</span><span class="sxs-lookup"><span data-stu-id="b489d-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="b489d-245">První z nich by měl přijmout právě index stránky, pokud chcete zobrazit, zatímco druhý přijímá stránky indexu a řazení výraz.</span><span class="sxs-lookup"><span data-stu-id="b489d-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample7.vb)]

<span data-ttu-id="b489d-246">V prvním příkladu v tomto kurzu jsme vytvořili řazení rozhraní pomocí rozevírací seznam.</span><span class="sxs-lookup"><span data-stu-id="b489d-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="b489d-247">V tomto příkladu umožňují s použít tři ovládací prvky webového tlačítko umístěna nad DataList, jednu pro řazení podle `ProductName`, jeden pro `CategoryName`a jeden pro `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="b489d-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="b489d-248">Přidejte tři tlačítko webové ovládací prvky, nastavení jejich `ID` a `Text` vlastnosti odpovídajícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="b489d-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample8.aspx)]

<span data-ttu-id="b489d-249">Dále vytvořte `Click` obslužné rutiny události pro každý.</span><span class="sxs-lookup"><span data-stu-id="b489d-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="b489d-250">Obslužné rutiny událostí by měly volat `RedirectUser` metoda, vrácení uživatele na první stránku pomocí výrazu odpovídající řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample9.vb)]

<span data-ttu-id="b489d-251">Při první návštěvě stránky, data jsou seřazená podle abecedy podle názvu produktu (odkazuje zpět na obrázku 9).</span><span class="sxs-lookup"><span data-stu-id="b489d-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="b489d-252">Klikněte na tlačítko Další přechodu na druhé stránce dat a klikněte na tlačítko řazení podle kategorie tlačítko.</span><span class="sxs-lookup"><span data-stu-id="b489d-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="b489d-253">To nám vrátí na první stránku dat, seřazené podle názvu kategorie (viz obrázek 10).</span><span class="sxs-lookup"><span data-stu-id="b489d-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="b489d-254">Podobně klepnutím na řazení podle dodavatele tlačítko seřadí data od první stránky dat dodavatelem.</span><span class="sxs-lookup"><span data-stu-id="b489d-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="b489d-255">Volba řazení je zapamatován jako data je prostřednictvím stránkovaného fondu.</span><span class="sxs-lookup"><span data-stu-id="b489d-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="b489d-256">Obrázek 11 zobrazuje stránku po řazení podle kategorie a pak přechodu na stránku třináctou data.</span><span class="sxs-lookup"><span data-stu-id="b489d-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>


<span data-ttu-id="b489d-257">[![Produkty jsou seřazené podle kategorie](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span></span>

<span data-ttu-id="b489d-258">**Obrázek 10**: produkty jsou seřazené podle kategorie ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span></span>


<span data-ttu-id="b489d-259">[![Výraz řazení je zapamatovaných při stránkování prostřednictvím dat](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span></span>

<span data-ttu-id="b489d-260">**Obrázek 11**: výraz řazení je zapamatovaných při stránkování prostřednictvím dat ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span></span>


## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="b489d-261">Krok 6: Vlastní stránkování prostřednictvím záznamy v prvku Repeater</span><span class="sxs-lookup"><span data-stu-id="b489d-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="b489d-262">Příklad DataList zkontrolován v kroku 5 stránky prostřednictvím svá data pomocí techniky stránkování neefektivní výchozí.</span><span class="sxs-lookup"><span data-stu-id="b489d-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="b489d-263">Při procházení dostatečně velké objemy dat, je nutné použít vlastní stránkování.</span><span class="sxs-lookup"><span data-stu-id="b489d-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="b489d-264">Zpět v [efektivně stránkování prostřednictvím velké objemy dat](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) a [řazení dat vlastní stránkovaného](../paging-and-sorting/sorting-custom-paged-data-vb.md) kurzy, jsme se zaměřili na rozdíly mezi výchozími a vlastní stránkování a vytvořený metody v BLL pro Použití vlastní stránkování a řazení vlastní stránkové data.</span><span class="sxs-lookup"><span data-stu-id="b489d-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-vb.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="b489d-265">Konkrétně v těchto dvou předchozí kurzy, jsme přidali následující tři metody, které `ProductsBLL` třídy:</span><span class="sxs-lookup"><span data-stu-id="b489d-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="b489d-266">`GetProductsPaged(startRowIndex, maximumRows)`Vrátí podmnožinu záznamy začínající na konkrétní *startRowIndex* a nejvýše *maximumRows*.</span><span class="sxs-lookup"><span data-stu-id="b489d-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="b489d-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)`Vrátí podmnožinu konkrétní záznamů seřazené podle zadaného *sortExpression* vstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="b489d-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="b489d-268">`TotalNumberOfProducts()`poskytuje celkový počet záznamů v `Products` databázové tabulky.</span><span class="sxs-lookup"><span data-stu-id="b489d-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="b489d-269">Tyto metody slouží k efektivní stránky a řazení prostřednictvím dat pomocí ovládacího prvku DataList nebo opakovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="b489d-270">Pro znázornění je umožnit s začněte tím, že vytvoření ovládacího prvku opakovače s vlastní podporu stránkování; potom přidáme možnosti řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="b489d-271">Otevřete `SortingWithCustomPaging.aspx` stránku `PagingSortingDataListRepeater` složky a přidat prvku Repeater na stránku nastavení jeho `ID` vlastnost, která má `Products`.</span><span class="sxs-lookup"><span data-stu-id="b489d-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="b489d-272">Inteligentní značky opakovače s, vytvořte nový ObjectDataSource s názvem `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="b489d-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="b489d-273">Nakonfigurovat, aby vyberte data z `ProductsBLL` třídu s `GetProductsPaged` metoda.</span><span class="sxs-lookup"><span data-stu-id="b489d-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>


<span data-ttu-id="b489d-274">[![Konfigurace ObjectDataSource lze pomocí této metody GetProductsPaged ProductsBLL třídu s](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span></span>

<span data-ttu-id="b489d-275">**Obrázek 12**: Konfigurace ObjectDataSource pro použití `ProductsBLL` třídu s `GetProductsPaged` – metoda ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span></span>


<span data-ttu-id="b489d-276">Nastavte rozevírací seznamy v aktualizaci UPDATE, INSERT a odstraňte karty na (žádný) a pak klikněte na tlačítko Další.</span><span class="sxs-lookup"><span data-stu-id="b489d-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="b489d-277">Průvodce konfigurace zdroje dat vyzve k zadání zdroje `GetProductsPaged` metoda s *startRowIndex* a *maximumRows* vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="b489d-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="b489d-278">Ve skutečnosti se ignorují tyto vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="b489d-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="b489d-279">Místo toho *startRowIndex* a *maximumRows* hodnoty budou předány v prostřednictvím `Arguments` vlastnost ObjectDataSource s `Selecting` obslužné rutiny události, stejně jako jsme zadali *sortExpression* v této ukázce první kurz s.</span><span class="sxs-lookup"><span data-stu-id="b489d-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="b489d-280">Proto nechejte zdrojový parametr rozevíracích seznamů v Průvodci nastavte na žádný.</span><span class="sxs-lookup"><span data-stu-id="b489d-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>


<span data-ttu-id="b489d-281">[![Zadaná sada parametrů zdroje nechte na hodnotu None](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span></span>

<span data-ttu-id="b489d-282">**Obrázek 13**: ponechte zdroje parametr nastaven na hodnotu None ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b489d-283">Proveďte *není* nastavit ObjectDataSource s `EnablePaging` vlastnost `true`.</span><span class="sxs-lookup"><span data-stu-id="b489d-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="b489d-284">To způsobí, že ObjectDataSource automaticky zahrnout vlastní *startRowIndex* a *maximumRows* parametry, které `SelectMethod` s existující seznam parametrů.</span><span class="sxs-lookup"><span data-stu-id="b489d-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="b489d-285">`EnablePaging` Vlastnost je užitečná, když vlastní vazby stránkovaného data do ovládacího prvku GridView, DetailsView nebo FormView, protože tyto ovládací prvky očekávat určité chování z ObjectDataSource této s k dispozici pouze v případě `EnablePaging` vlastnost je `true`.</span><span class="sxs-lookup"><span data-stu-id="b489d-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="b489d-286">Vzhledem k tomu, že máme ručně přidat podporu stránkování pro DataList a opakovače, ponechte tuto vlastnost nastavit na `false` (výchozí), protože jsme budete cukrárna potřebných funkcí přímo v naší stránce s ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b489d-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>


<span data-ttu-id="b489d-287">Nakonec zadejte opakovače s `ItemTemplate` tak, aby produkt s název, kategorie a dodavatele.</span><span class="sxs-lookup"><span data-stu-id="b489d-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="b489d-288">Po provedení těchto změn opakovače a ObjectDataSource deklarativní syntaxi s by měl vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="b489d-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample10.aspx)]

<span data-ttu-id="b489d-289">Za chvíli navštívit stránku prostřednictvím prohlížeče a Všimněte si, že jsou vráceny žádné záznamy.</span><span class="sxs-lookup"><span data-stu-id="b489d-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="b489d-290">Důvodem je, že jsme jste zatím k určení *startRowIndex* a *maximumRows* hodnoty parametrů; proto hodnoty 0 jsou předávány v obou.</span><span class="sxs-lookup"><span data-stu-id="b489d-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="b489d-291">Chcete-li tyto hodnoty zadat vytvořit obslužnou rutinu události pro ObjectDataSource s `Selecting` událostí a nastavte tyto parametry hodnoty prostřednictvím kódu programu pevně hodnoty 0 a 5, v uvedeném pořadí:</span><span class="sxs-lookup"><span data-stu-id="b489d-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample11.vb)]

<span data-ttu-id="b489d-292">Díky této změně stránky, při zobrazení prostřednictvím prohlížeče, zobrazuje prvních pět produkty.</span><span class="sxs-lookup"><span data-stu-id="b489d-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>


<span data-ttu-id="b489d-293">[![Zobrazení první pět záznamů](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span></span>

<span data-ttu-id="b489d-294">**Obrázek 14**: zobrazení první pět záznamů ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b489d-295">Produkty uvedené v obrázku 14 dojít, který se má seřadit podle názvu produktu, protože `GetProductsPaged` uložené procedury, která provádí efektivní vlastního dotazu stránkování řadí výsledky podle `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="b489d-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>


<span data-ttu-id="b489d-296">Aby bylo možné povolit uživateli krok prostřednictvím stránky, je potřeba sledovat počáteční index řádku a maximální počet řádků a mějte na paměti tyto hodnoty mezi postback.</span><span class="sxs-lookup"><span data-stu-id="b489d-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="b489d-297">V příkladu stránkování výchozí jsme použili pole řetězce dotazu se zachovat tyto hodnoty; v této ukázce umožní zachovat tyto informace ve stavu zobrazení stránky s s.</span><span class="sxs-lookup"><span data-stu-id="b489d-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="b489d-298">Vytvořte následující dvě vlastnosti:</span><span class="sxs-lookup"><span data-stu-id="b489d-298">Create the following two properties:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample12.vb)]

<span data-ttu-id="b489d-299">Potom aktualizujte kód obslužné rutiny události zvolíte tak, aby používala `StartRowIndex` a `MaximumRows` vlastnosti místo pevně hodnoty 0 a 5:</span><span class="sxs-lookup"><span data-stu-id="b489d-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample13.vb)]

<span data-ttu-id="b489d-300">V tomto okamžiku Naše stránka stále zobrazuje pouze prvních pět záznamů.</span><span class="sxs-lookup"><span data-stu-id="b489d-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="b489d-301">Nicméně s těmito vlastnostmi na místě, jsme re připravené k vytvoření naše rozhraní stránkování.</span><span class="sxs-lookup"><span data-stu-id="b489d-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="b489d-302">Přidání rozhraní stránkování</span><span class="sxs-lookup"><span data-stu-id="b489d-302">Adding the Paging Interface</span></span>

<span data-ttu-id="b489d-303">V příkladu stránkování výchozí štítek webové zobrazení ovládací prvek, který zobrazí jaké stránky dat včetně a celkový počet stránek existují použít umožňují s pomocí stejné první, předchozí a další, poslední stránkování rozhraní.</span><span class="sxs-lookup"><span data-stu-id="b489d-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="b489d-304">Přidejte čtyři ovládací prvky webového tlačítko a popisek pod opakovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-304">Add the four Button Web controls and Label below the Repeater.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample14.aspx)]

<span data-ttu-id="b489d-305">Dále vytvořte `Click` obslužných rutin událostí pro čtyři tlačítka.</span><span class="sxs-lookup"><span data-stu-id="b489d-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="b489d-306">Po kliknutí z těchto tlačítek na, musíme aktualizovat `StartRowIndex` a rebind data, která mají opakovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="b489d-307">Kód pro první, předchozí a další tlačítka je dostatečně jednoduchá, ale pro poslední tlačítko jak jsme je zjistit počáteční index řádků na poslední stránku dat?</span><span class="sxs-lookup"><span data-stu-id="b489d-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="b489d-308">K výpočtu tento index, jakož i schopnost určit, že zda by měla být povolená tlačítka Další a poslední potřebujeme vědět, celkový počet záznamů jsou stránkování prostřednictvím.</span><span class="sxs-lookup"><span data-stu-id="b489d-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="b489d-309">Jsme můžete určit voláním `ProductsBLL` třídu s `TotalNumberOfProducts()` metoda.</span><span class="sxs-lookup"><span data-stu-id="b489d-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="b489d-310">Umožňují s vytvoření vlastnosti jen pro čtení, úrovně stránky s názvem `TotalRowCount` , vrátí výsledky `TotalNumberOfProducts()` metoda:</span><span class="sxs-lookup"><span data-stu-id="b489d-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample15.vb)]

<span data-ttu-id="b489d-311">S touto vlastností jsme můžete teď určit poslední stránku s počáteční index řádku.</span><span class="sxs-lookup"><span data-stu-id="b489d-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="b489d-312">Konkrétně se s výsledkem celé číslo z `TotalRowCount` minus 1 dělený `MaximumRows`, násobenou `MaximumRows`.</span><span class="sxs-lookup"><span data-stu-id="b489d-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="b489d-313">Jsme teď může zapisovat `Click` obslužných rutin událostí pro čtyři tlačítka rozhraní stránkování:</span><span class="sxs-lookup"><span data-stu-id="b489d-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample16.vb)]

<span data-ttu-id="b489d-314">Nakonec musíme zakázat tlačítka první a předchozí v rozhraní stránkování, při zobrazení na první stránku dat a tlačítka Další a poslední při zobrazení poslední stránky.</span><span class="sxs-lookup"><span data-stu-id="b489d-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="b489d-315">K tomu, přidejte následující kód do ObjectDataSource s `Selecting` obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="b489d-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample17.vb)]

<span data-ttu-id="b489d-316">Po přidání těchto `Click` obslužné rutiny událostí a kód k povolení nebo zakázání prvky rozhraní stránkování podle aktuální index řádku počáteční testovací stránce v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="b489d-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="b489d-317">Jako znázorňuje obrázek 15, pokud nejprve na stránce první, a bude předchozí tlačítka jsou zakázány.</span><span class="sxs-lookup"><span data-stu-id="b489d-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="b489d-318">Kliknutím na tlačítko Další zobrazuje stránku druhý dat, když kliknete na poslední zobrazí poslední stránce (viz následující obrázky 16 a 17).</span><span class="sxs-lookup"><span data-stu-id="b489d-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="b489d-319">Při zobrazení na poslední stránku dat jsou zakázány na další a poslední tlačítka.</span><span class="sxs-lookup"><span data-stu-id="b489d-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>


<span data-ttu-id="b489d-320">[![Poslední tlačítka předchozí a nejsou při zobrazení první stránka produkty](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span></span>

<span data-ttu-id="b489d-321">**Obrázek 15**: poslední tlačítka a Previous nejsou při zobrazení první stránka produkty ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span></span>


<span data-ttu-id="b489d-322">[![Druhá stránka produkty jsou Dispalyed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-322">[![The Second Page of Products are Dispalyed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span></span>

<span data-ttu-id="b489d-323">**Obrázek 16**: druhé stránce produkty jsou Dispalyed ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-323">**Figure 16**: The Second Page of Products are Dispalyed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span></span>


<span data-ttu-id="b489d-324">[![Kliknutím na poslední zobrazí na poslední stránku dat](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span></span>

<span data-ttu-id="b489d-325">**Obrázek 17**: Kliknutím na poslední zobrazí poslední stránku Data ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span></span>


## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="b489d-326">Krok 7: Včetně řazení podporu pro vlastní opakovače stránkovaného fondu</span><span class="sxs-lookup"><span data-stu-id="b489d-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="b489d-327">Teď, když byl implementován vlastní stránkování, znovu připravení zahrnují řazení podporujeme.</span><span class="sxs-lookup"><span data-stu-id="b489d-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="b489d-328">`ProductsBLL` Třídu s `GetProductsPagedAndSorted` metoda má stejné *startRowIndex* a *maximumRows* vstupní parametry jako `GetProductsPaged`, ale umožňuje další  *sortExpression* vstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="b489d-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="b489d-329">Použít `GetProductsPagedAndSorted` metoda z `SortingWithCustomPaging.aspx`, je potřeba provést následující kroky:</span><span class="sxs-lookup"><span data-stu-id="b489d-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="b489d-330">Změnit ObjectDataSource s `SelectMethod` vlastnost z `GetProductsPaged` k `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="b489d-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="b489d-331">Přidat *sortExpression* `Parameter` objekt, který chcete ObjectDataSource s `SelectParameters` kolekce.</span><span class="sxs-lookup"><span data-stu-id="b489d-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="b489d-332">Vytvoření privátního, úrovně stránky `SortExpression` vlastnost, která je uchována jeho hodnota napříč postback prostřednictvím stav zobrazení stránky s.</span><span class="sxs-lookup"><span data-stu-id="b489d-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="b489d-333">Aktualizace ObjectDataSource s `Selecting` obslužné rutiny události přiřadit ObjectDataSource s *sortExpression* parametr hodnota úrovně stránky `SortExpression` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="b489d-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="b489d-334">Vytvořte rozhraní řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-334">Create the sorting interface.</span></span>

<span data-ttu-id="b489d-335">Začněte tím, že aktualizace ObjectDataSource s `SelectMethod` vlastnost a přidávání *sortExpression* `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="b489d-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="b489d-336">Ujistěte se, že *sortExpression* `Parameter` s `Type` je nastavena na `String`.</span><span class="sxs-lookup"><span data-stu-id="b489d-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="b489d-337">Po dokončení těchto úloh první dva, ObjectDataSource s deklarativní by měl vypadat následovně:</span><span class="sxs-lookup"><span data-stu-id="b489d-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample18.aspx)]

<span data-ttu-id="b489d-338">Dále je třeba úrovně stránky `SortExpression` vlastnost, jehož hodnota je serializováno stavu zobrazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="b489d-339">Pokud byla nastavena žádná hodnota výraz řazení, použijte jako výchozí ProductName:</span><span class="sxs-lookup"><span data-stu-id="b489d-339">If no sort expression value has been set, use ProductName as the default:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample19.vb)]

<span data-ttu-id="b489d-340">Předtím, než ObjectDataSource vyvolá `GetProductsPagedAndSorted` metoda je potřeba nastavit *sortExpression* `Parameter` na hodnotu `SortExpression` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="b489d-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="b489d-341">V `Selecting` obslužné rutiny události, přidejte následující řádek kódu:</span><span class="sxs-lookup"><span data-stu-id="b489d-341">In the `Selecting` event handler, add the following line of code:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample20.vb)]

<span data-ttu-id="b489d-342">Zbývá k implementaci rozhraní řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="b489d-343">Jako jsme to udělali v posledním příkladu, umožní s mít rozhraní řazení implementovaná pomocí tří ovládací prvky webového tlačítko, které umožňují uživatelům řazení výsledků podle názvu produktu, kategorie nebo dodavatele.</span><span class="sxs-lookup"><span data-stu-id="b489d-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample21.aspx)]

<span data-ttu-id="b489d-344">Vytvoření `Click` obslužné rutiny události pro tyto tři ovládací prvky tlačítek.</span><span class="sxs-lookup"><span data-stu-id="b489d-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="b489d-345">Události obslužnou rutinu, resetovat `StartRowIndex` na hodnotu 0, nastavte `SortExpression` na odpovídající hodnotu a obnovení vazby dat opakovače:</span><span class="sxs-lookup"><span data-stu-id="b489d-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample22.vb)]

<span data-ttu-id="b489d-346">Že všechny existuje s je k němu!</span><span class="sxs-lookup"><span data-stu-id="b489d-346">That s all there is to it!</span></span> <span data-ttu-id="b489d-347">Když došlo k několika kroků získat vlastní řazení a stránkování implementována, kroky měla velmi podobné těm, které jsou potřebné pro výchozí stránkování.</span><span class="sxs-lookup"><span data-stu-id="b489d-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="b489d-348">Obrázek 18 ukazuje produkty při prohlížení na poslední stránku dat při seřazené podle kategorie.</span><span class="sxs-lookup"><span data-stu-id="b489d-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>


<span data-ttu-id="b489d-349">[![Zobrazí se poslední Data stránky, Sorted podle kategorií,](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="b489d-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span></span>

<span data-ttu-id="b489d-350">**Obrázek 18**: poslední stránku dat, Sorted podle kategorií, se zobrazí ([Kliknutím zobrazit obrázek v plné velikosti](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="b489d-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b489d-351">V předchozích příkladech, při řazení podle dodavatele, které dodavatel byl použit jako výraz řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="b489d-352">Ale pro vlastní implementaci stránkování, potřebujeme používat NázevSpolečnosti.</span><span class="sxs-lookup"><span data-stu-id="b489d-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="b489d-353">Důvodem je, že uložené procedury, která je zodpovědná za implementaci vlastní stránkování `GetProductsPagedAndSorted` předá výraz řazení do `ROW_NUMBER()` – klíčové slovo, `ROW_NUMBER()` – klíčové slovo vyžaduje místo aliasu, raději skutečný název sloupce.</span><span class="sxs-lookup"><span data-stu-id="b489d-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="b489d-354">Proto musí používáme `CompanyName` (název sloupce v `Suppliers` tabulky) namísto aby alias použitý v `SELECT` dotazu (`SupplierName`) pro výraz řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>


## <a name="summary"></a><span data-ttu-id="b489d-355">Souhrn</span><span class="sxs-lookup"><span data-stu-id="b489d-355">Summary</span></span>

<span data-ttu-id="b489d-356">Ani DataList ani opakovače nabízí integrovanou podporu řazení, ale pomocí bit kódu a vlastní řazení rozhraní, je možné přidat tyto funkce.</span><span class="sxs-lookup"><span data-stu-id="b489d-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="b489d-357">Při implementaci řazení, ale není stránkování, výrazů řazení lze zadat prostřednictvím `DataSourceSelectArguments` objekt předaný do ObjectDataSource s `Select` metoda.</span><span class="sxs-lookup"><span data-stu-id="b489d-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="b489d-358">To `DataSourceSelectArguments` objekt s `SortExpression` vlastnost může být přiřazena aplikace ObjectDataSource s `Selecting` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="b489d-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="b489d-359">Pro přidání možností řazení do DataList nebo opakovače, který již poskytuje podporu stránkování, je nejjednodušší způsob přizpůsobení vrstvu obchodní logiky obsahovat metodu, která přijímá výraz řazení.</span><span class="sxs-lookup"><span data-stu-id="b489d-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="b489d-360">Tyto informace lze předat pak ve prostřednictvím parametru v ObjectDataSource s `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="b489d-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="b489d-361">V tomto kurzu dokončení součást stránkování a řazení s ovládacími prvky DataList a opakovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="b489d-362">Naše další a finální kurzu bude zkontrolujte postup přidání tlačítka na DataList a opakovače s šablony chcete-li provést některé funkce vlastní, zahájená uživatelem na základě položky.</span><span class="sxs-lookup"><span data-stu-id="b489d-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="b489d-363">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="b489d-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b489d-364">O autorovi</span><span class="sxs-lookup"><span data-stu-id="b489d-364">About the Author</span></span>

<span data-ttu-id="b489d-365">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a zakladatele z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje s technologií Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="b489d-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b489d-366">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="b489d-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b489d-367">Jeho nejnovější seznam k [ *Edice nakladatelství Sams naučit sami technologii ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b489d-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b489d-368">Dosažitelný v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu, který najdete na [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b489d-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b489d-369">Zvláštní poděkování</span><span class="sxs-lookup"><span data-stu-id="b489d-369">Special Thanks To</span></span>

<span data-ttu-id="b489d-370">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="b489d-370">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b489d-371">Vést kontrolorem pro tento kurz byl David Suru.</span><span class="sxs-lookup"><span data-stu-id="b489d-371">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="b489d-372">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="b489d-372">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b489d-373">Pokud ano, vyřaďte mi řádek v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b489d-373">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="b489d-374">Předchozí</span><span class="sxs-lookup"><span data-stu-id="b489d-374">Previous</span></span>](paging-report-data-in-a-datalist-or-repeater-control-vb.md)
