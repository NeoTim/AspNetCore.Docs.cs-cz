---
uid: web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
title: "Vytvoření zabezpečeného aplikace webových formulářů ASP.NET s registrací uživatele, e-mailem potvrzení a heslo resetovat (C#) | Microsoft Docs"
author: Erikre
description: "V tomto kurzu se dozvíte, jak vytvářet aplikace webových formulářů ASP.NET pomocí registrace uživatele, potvrzení e-mailu a resetování hesla pomocí ASP.NET Identity člena..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/02/2014
ms.topic: article
ms.assetid: 0a8d6044-5fab-4213-82d6-5618d5601358
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
msc.type: authoredcontent
ms.openlocfilehash: ed39295ed1bcaa924336a1faf52049e291abeadb
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2018
---
<a name="create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset-c"></a><span data-ttu-id="e51f3-103">Vytvoření zabezpečeného aplikace webových formulářů ASP.NET s registrací uživatele, e-mailem potvrzení a heslo resetovat (C#)</span><span class="sxs-lookup"><span data-stu-id="e51f3-103">Create a secure ASP.NET Web Forms app with user registration, email confirmation and password reset (C#)</span></span>
====================
<span data-ttu-id="e51f3-104">Podle [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="e51f3-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

> <span data-ttu-id="e51f3-105">V tomto kurzu se dozvíte, jak vytvářet aplikace webových formulářů ASP.NET pomocí registrace uživatele, potvrzení e-mailu a resetování hesla pomocí systému členství ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="e51f3-105">This tutorial shows you how to build an ASP.NET Web Forms app with user registration, email confirmation and password reset using the ASP.NET Identity membership system.</span></span> <span data-ttu-id="e51f3-106">V tomto kurzu bylo založeno na Rick Anderson [kurz MVC](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md).</span><span class="sxs-lookup"><span data-stu-id="e51f3-106">This tutorial was based on Rick Anderson's [MVC tutorial](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md).</span></span>


## <a name="introduction"></a><span data-ttu-id="e51f3-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="e51f3-107">Introduction</span></span>

<span data-ttu-id="e51f3-108">Tento kurz vás provede kroky potřebné k vytváření aplikací webových formulářů ASP.NET pomocí sady Visual Studio a technologie ASP.NET 4.5 pro vytvoření zabezpečeného aplikace webových formulářů s registrací uživatele, e-mailem potvrzení a heslo resetovat.</span><span class="sxs-lookup"><span data-stu-id="e51f3-108">This tutorial guides you through the steps required to create an ASP.NET Web Forms application using Visual Studio and ASP.NET 4.5 to create a secure Web Forms app with user registration, email confirmation and password reset.</span></span>

### <a name="tutorial-tasks-and-information"></a><span data-ttu-id="e51f3-109">Kurz úkoly a informace:</span><span class="sxs-lookup"><span data-stu-id="e51f3-109">Tutorial Tasks and Information:</span></span>

- [<span data-ttu-id="e51f3-110">Vytvořit rozhraní ASP.NET Web Forms aplikace</span><span class="sxs-lookup"><span data-stu-id="e51f3-110">Create an ASP.NET Web Forms app</span></span>](#createWebForms)
- [<span data-ttu-id="e51f3-111">Propojte sendgrid vám umožňuje</span><span class="sxs-lookup"><span data-stu-id="e51f3-111">Hook Up SendGrid</span></span>](#SG)
- [<span data-ttu-id="e51f3-112">Požadovat potvrzení e-mailu před přihlášení</span><span class="sxs-lookup"><span data-stu-id="e51f3-112">Require Email Confirmation Before Log In</span></span>](#require)
- [<span data-ttu-id="e51f3-113">Obnovení hesla a resetování</span><span class="sxs-lookup"><span data-stu-id="e51f3-113">Password Recovery and Reset</span></span>](#reset)
- [<span data-ttu-id="e51f3-114">Odkaz pro potvrzení znovu odeslat e-mailu</span><span class="sxs-lookup"><span data-stu-id="e51f3-114">Resend Email Confirmation Link</span></span>](#rsend)
- [<span data-ttu-id="e51f3-115">Řešení potíží s aplikací</span><span class="sxs-lookup"><span data-stu-id="e51f3-115">Troubleshooting the App</span></span>](#dbg)
- [<span data-ttu-id="e51f3-116">Další zdroje informací</span><span class="sxs-lookup"><span data-stu-id="e51f3-116">Additional Resources</span></span>](#addRes)

<a id="createWebForms"></a>
## <a name="create-an-aspnet-web-forms-app"></a><span data-ttu-id="e51f3-117">Vytvoření aplikace ASP.NET – webové formuláře</span><span class="sxs-lookup"><span data-stu-id="e51f3-117">Create an ASP.NET Web Forms App</span></span>

<span data-ttu-id="e51f3-118">Začněte tím, že instalace a spuštění [Visual Studio Express 2013 pro Web](https://go.microsoft.com/fwlink/?LinkId=299058) nebo [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span><span class="sxs-lookup"><span data-stu-id="e51f3-118">Start by installing and running [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span></span> <span data-ttu-id="e51f3-119">Nainstalujte [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) nebo vyšší také.</span><span class="sxs-lookup"><span data-stu-id="e51f3-119">Install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher as well.</span></span>

> [!NOTE]
> <span data-ttu-id="e51f3-120">Upozornění: Je nutné nainstalovat [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) nebo vyšší k dokončení tohoto kurzu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-120">Warning: You must install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher to complete this tutorial.</span></span>


1. <span data-ttu-id="e51f3-121">Vytvoření nového projektu (**soubor**  - &gt; **nový projekt**) a vyberte **webové aplikace ASP.NET** šablony a nejnovější rozhraní .NET Framework verze z **nový projekt** dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="e51f3-121">Create a new project (**File** -&gt; **New Project**) and select the **ASP.NET Web Application** template and the latest .NET Framework version from the **New Project** dialog box.</span></span>
2. <span data-ttu-id="e51f3-122">Z **nový projekt ASP.NET** dialogové okno, vyberte **webových formulářů** šablony.</span><span class="sxs-lookup"><span data-stu-id="e51f3-122">From the **New ASP.NET Project** dialog box, select the **Web Forms** template.</span></span> <span data-ttu-id="e51f3-123">Ponechte výchozí ověřování jako **jednotlivé uživatelské účty**.</span><span class="sxs-lookup"><span data-stu-id="e51f3-123">Leave the default authentication as **Individual User Accounts**.</span></span> <span data-ttu-id="e51f3-124">Pokud chcete hostovat aplikaci v Azure, nechte **hostitel v cloudu** políčko zaškrtnuto.</span><span class="sxs-lookup"><span data-stu-id="e51f3-124">If you'd like to host the app in Azure, leave the **Host in the cloud** check box checked.</span></span>   
 <span data-ttu-id="e51f3-125">Potom klikněte na **OK** k vytvoření nového projektu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-125">Then, click **OK** to create the new project.</span></span>  
    <span data-ttu-id="e51f3-126">![Dialogové okno Nový projekt ASP.NET](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e51f3-126">![New ASP.NET Project dialog box](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span></span>
3. <span data-ttu-id="e51f3-127">Povolte Secure Sockets Layer (SSL) pro projekt.</span><span class="sxs-lookup"><span data-stu-id="e51f3-127">Enable Secure Sockets Layer (SSL) for the project.</span></span> <span data-ttu-id="e51f3-128">Postupujte podle kroků v k dispozici **povolit šifrování SSL pro projekt** části [Začínáme s webovými formuláři kurz řadou](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms).</span><span class="sxs-lookup"><span data-stu-id="e51f3-128">Follow the steps available in the **Enable SSL for the Project** section of the [Getting Started with Web Forms tutorial series](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms).</span></span>
4. <span data-ttu-id="e51f3-129">Spuštění aplikace, klikněte na tlačítko **zaregistrovat** propojit a registraci nového uživatele.</span><span class="sxs-lookup"><span data-stu-id="e51f3-129">Run the app, click the **Register** link and register a new user.</span></span> <span data-ttu-id="e51f3-130">V tomto okamžiku je pouze ověření na e-mailu na základě [[EmailAddress]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) atribut pro zajištění ve správném formátu e-mailovou adresu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-130">At this point, the only validation on the email is based on the [[EmailAddress]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) attribute to ensure the email address is well-formed.</span></span> <span data-ttu-id="e51f3-131">Slouží k úpravě kódu k přidání potvrzení e-mailu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-131">You will modify the code to add email confirmation.</span></span> <span data-ttu-id="e51f3-132">Zavřete okno prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="e51f3-132">Close the browser window.</span></span>
5. <span data-ttu-id="e51f3-133">V **Průzkumníka serveru** sady Visual Studio (**zobrazení**  - &gt; **Průzkumníka serveru**), přejděte na **Connections\ dat DefaultConnection\Tables\AspNetUsers**, klikněte pravým tlačítkem a vyberte **otevřete definici tabulky**.</span><span class="sxs-lookup"><span data-stu-id="e51f3-133">In **Server Explorer** of Visual Studio (**View** -&gt; **Server Explorer**), navigate to **Data Connections\DefaultConnection\Tables\AspNetUsers**, right click and select **Open table definition**.</span></span> 

    <span data-ttu-id="e51f3-134">Na následujícím obrázku `AspNetUsers` schématu tabulky:</span><span class="sxs-lookup"><span data-stu-id="e51f3-134">The following image shows the `AspNetUsers` table schema:</span></span>

    ![Schéma tabulky AspNetUsers](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image2.png)
6. <span data-ttu-id="e51f3-136">V **Průzkumníka serveru**, klikněte pravým tlačítkem na **AspNetUsers** tabulky a vyberte **zobrazit Data tabulky**.</span><span class="sxs-lookup"><span data-stu-id="e51f3-136">In **Server Explorer**, right-click on the **AspNetUsers** table and select **Show Table Data**.</span></span>  
  
    ![Data tabulky AspNetUsers](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image3.png)  
 <span data-ttu-id="e51f3-138">V tomto okamžiku není potvrzena e-mailu pro uživatele registrovaná.</span><span class="sxs-lookup"><span data-stu-id="e51f3-138">At this point the email for the registered user has not been confirmed.</span></span>
7. <span data-ttu-id="e51f3-139">Klikněte na řádek a vyberte možnost odstranit pro odstranění uživatele.</span><span class="sxs-lookup"><span data-stu-id="e51f3-139">Click on the row and select delete to delete the user.</span></span> <span data-ttu-id="e51f3-140">Budete znovu přidat tuto e-mailu v dalším kroku a odeslat zprávu potvrzení e-mailovou adresu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-140">You'll add this email again in the next step and send a confirmation message to the email address.</span></span>

## <a name="email-confirmation"></a><span data-ttu-id="e51f3-141">Potvrzení e-mailu</span><span class="sxs-lookup"><span data-stu-id="e51f3-141">Email Confirmation</span></span>

<span data-ttu-id="e51f3-142">Je osvědčeným postupem potvrďte e-mailu během registrace nového uživatele ověřit, že nejsou zosobnění někdo jiný (to znamená, že nebyly zaregistrována někoho jiného e-mailu).</span><span class="sxs-lookup"><span data-stu-id="e51f3-142">It's a best practice to confirm the email during the registration of a new user to verify they are not impersonating someone else (that is, they haven't registered with someone else's email).</span></span> <span data-ttu-id="e51f3-143">Předpokládejme, že jste měli diskusní fórum, chcete zabránit `"bob@cpandl.com"` registraci jako `"joe@contoso.com"`.</span><span class="sxs-lookup"><span data-stu-id="e51f3-143">Suppose you had a discussion forum, you would want to prevent `"bob@cpandl.com"` from registering as `"joe@contoso.com"`.</span></span> <span data-ttu-id="e51f3-144">Bez potvrzení e-mailu `"joe@contoso.com"` může získat nežádoucí e-mailu z vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="e51f3-144">Without email confirmation, `"joe@contoso.com"` could get unwanted email from your app.</span></span> <span data-ttu-id="e51f3-145">Předpokládejme, že Bob, ať už náhodně registrován jako `"bib@cpandl.com"` a, kdyby zaznamenali mu nebude moci používat obnovení hesla, protože aplikace nemá správnou e-mailovou.</span><span class="sxs-lookup"><span data-stu-id="e51f3-145">Suppose Bob accidently registered as `"bib@cpandl.com"` and hadn't noticed it, he wouldn't be able to use password recovery because the app doesn't have his correct email.</span></span> <span data-ttu-id="e51f3-146">Potvrzení e-mailu poskytuje jen omezenou ochranu z robotů a neposkytuje ochranu proti určené odesílatelům nevyžádané pošty.</span><span class="sxs-lookup"><span data-stu-id="e51f3-146">Email confirmation provides only limited protection from bots and doesn't provide protection from determined spammers.</span></span>

<span data-ttu-id="e51f3-147">Obvykle budete chtít zabránit noví uživatelé předtím, než byl potvrzen e-mail, textovou zprávu SMS nebo jiný mechanismus publikování všechna data na váš web.</span><span class="sxs-lookup"><span data-stu-id="e51f3-147">You generally want to prevent new users from posting any data to your website before they have been confirmed by either email, an SMS text message or another mechanism.</span></span> <span data-ttu-id="e51f3-148">V následujících částech se budeme povolí potvrzení e-mailu a upravit kód nově zaregistrovaný uživatelům zabránit protokolování, dokud bylo potvrzeno e-mailu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-148">In the sections below, we will enable email confirmation and modify the code to prevent newly registered users from logging in until their email has been confirmed.</span></span> <span data-ttu-id="e51f3-149">V tomto kurzu budete používat e-mailovou službu sendgrid vám umožňuje.</span><span class="sxs-lookup"><span data-stu-id="e51f3-149">You'll use the email service SendGrid in this tutorial.</span></span>

<a id="SG"></a>
## <a name="hook-up-sendgrid"></a><span data-ttu-id="e51f3-150">Propojte sendgrid vám umožňuje</span><span class="sxs-lookup"><span data-stu-id="e51f3-150">Hook up SendGrid</span></span>

<span data-ttu-id="e51f3-151">I když tento kurz ukazuje jenom postup přidání e-mailové oznámení prostřednictvím [sendgrid vám umožňuje](http://sendgrid.com/), můžete odeslat e-mailu pomocí protokolu SMTP a další mechanismy (viz [další prostředky](#addRes)).</span><span class="sxs-lookup"><span data-stu-id="e51f3-151">Although this tutorial only shows how to add email notification through [SendGrid](http://sendgrid.com/), you can send email using SMTP and other mechanisms (see [additional resources](#addRes)).</span></span>

1. <span data-ttu-id="e51f3-152">V sadě Visual Studio, otevřete **Konzola správce balíčků** (**nástroje**  - &gt; **Manager balíček NuGet**  - &gt; **Konzola správce balíčků**) a zadejte následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="e51f3-152">In Visual Studio, open the **Package Manager Console** (**Tools** -&gt; **NuGet Package Manger** -&gt; **Package Manager Console**), and enter the following command:</span></span>  
    `Install-Package SendGrid`
2. <span data-ttu-id="e51f3-153">Přejděte na [stránku pro přihlášení sendgrid vám umožňuje Azure](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) a ZDARMA zaregistrovat účet sendgrid vám umožňuje.</span><span class="sxs-lookup"><span data-stu-id="e51f3-153">Go to the [Azure SendGrid sign-up page](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) and register for free SendGrid account.</span></span> <span data-ttu-id="e51f3-154">Můžete také zaregistrovat bezplatný účet sendgrid vám umožňuje přímo na [sendgrid vám umožňuje na webu](http://www.sendgrid.com).</span><span class="sxs-lookup"><span data-stu-id="e51f3-154">You can also sign-up for a free SendGrid account directly on [SendGrid's site](http://www.sendgrid.com).</span></span>
3. <span data-ttu-id="e51f3-155">Z **Průzkumníku řešení** otevřete *IdentityConfig.cs* v soubor *aplikace\_spustit* složky a přidejte následující kód zvýrazněných v žlutý k `EmailService` třída ke konfiguraci **sendgrid vám umožňuje**:</span><span class="sxs-lookup"><span data-stu-id="e51f3-155">From **Solution Explorer** open the *IdentityConfig.cs* file in the *App\_Start* folder and add the following code highlighted in yellow to the `EmailService` class to configure **SendGrid**:</span></span>

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample1.cs?highlight=3,5,8-37)]
4. <span data-ttu-id="e51f3-156">Také, přidejte následující `using` příkazy na začátek *IdentityConfig.cs* souboru:</span><span class="sxs-lookup"><span data-stu-id="e51f3-156">Also, add the following `using` statements to the beginning of the *IdentityConfig.cs* file:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample2.cs?highlight=1-4)]
5. <span data-ttu-id="e51f3-157">Pro zjednodušení této ukázku, budete ukládat hodnoty účet služby e-mailu v `appSettings` části *web.config* souboru.</span><span class="sxs-lookup"><span data-stu-id="e51f3-157">To keep this sample simple, you'll store the email service account values in the `appSettings` section of the *web.config* file.</span></span> <span data-ttu-id="e51f3-158">Přidejte následující kód XML zvýrazněných v žlutý k *web.config* soubor v kořenovém adresáři projektu:</span><span class="sxs-lookup"><span data-stu-id="e51f3-158">Add the following XML highlighted in yellow to the *web.config* file at the root of your project:</span></span>

    [!code-xml[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample3.xml?highlight=2-5)]

    > [!WARNING]
    > <span data-ttu-id="e51f3-159">Zabezpečení – nikdy úložiště citlivá data ve zdrojovém kódu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-159">Security - Never store sensitive data in your source code.</span></span> <span data-ttu-id="e51f3-160">V tomto příkladu účet a přihlašovací údaje uložené v **appSetting** části *Web.config* souboru.</span><span class="sxs-lookup"><span data-stu-id="e51f3-160">In this example, the account and credentials are stored in the **appSetting** section of the *Web.config* file.</span></span> <span data-ttu-id="e51f3-161">V Azure, můžete bezpečně uložit tyto hodnoty na  **[konfigurace](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)**  na portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="e51f3-161">On Azure, you can securely store these values on the **[Configure](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)** tab in the Azure portal.</span></span> <span data-ttu-id="e51f3-162">Související informace najdete v tématu Rick Anderson s názvem [osvědčené postupy pro nasazování hesel a dalších citlivých dat do ASP.NET a do Azure](https://go.microsoft.com/fwlink/?LinkId=513141).</span><span class="sxs-lookup"><span data-stu-id="e51f3-162">For related information see Rick Anderson's topic titled [Best practices for deploying passwords and other sensitive data to ASP.NET and Azure](https://go.microsoft.com/fwlink/?LinkId=513141).</span></span>
6. <span data-ttu-id="e51f3-163">Přidejte hodnoty e-mailové služby, aby odrážela, že hodnoty sendgrid vám umožňuje ověřování (uživatelské jméno a heslo), aby bylo možné úspěšné odeslání e-mailu z vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="e51f3-163">Add the email service values to reflect your SendGrid authentication values (User Name and Password) so that you can successful send email from your app.</span></span> <span data-ttu-id="e51f3-164">Nezapomeňte použít název účtu sendgrid vám umožňuje spíše než e-mailovou adresu, které jste zadali sendgrid vám umožňuje.</span><span class="sxs-lookup"><span data-stu-id="e51f3-164">Be sure to use your SendGrid account name rather than the email address you provided SendGrid.</span></span>

### <a name="enable-email-confirmation"></a><span data-ttu-id="e51f3-165">Povolit potvrzení e-mailu</span><span class="sxs-lookup"><span data-stu-id="e51f3-165">Enable Email Confirmation</span></span>

 <span data-ttu-id="e51f3-166">Pokud chcete povolit potvrzení e-mailu, změníte kód registrace pomocí následujících kroků.</span><span class="sxs-lookup"><span data-stu-id="e51f3-166">To enable email confirmation, you'll modify the registration code using the following steps.</span></span>  
 

1. <span data-ttu-id="e51f3-167">V *účet* složku, otevřete *Register.aspx.cs* kódu a aktualizovat `CreateUser_Click` způsob povolení následující zvýrazněný změny:</span><span class="sxs-lookup"><span data-stu-id="e51f3-167">In the *Account* folder, open the *Register.aspx.cs* code-behind and update the `CreateUser_Click` method to enable the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample4.cs?highlight=9-11)]
2. <span data-ttu-id="e51f3-168">V **Průzkumníku řešení**, klikněte pravým tlačítkem na *Default.aspx* a vyberte **nastavit jako úvodní stránku**.</span><span class="sxs-lookup"><span data-stu-id="e51f3-168">In **Solution Explorer**, right-click *Default.aspx* and select **Set As Start Page**.</span></span>
3. <span data-ttu-id="e51f3-169">Spusťte aplikaci stisknutím **F5.**</span><span class="sxs-lookup"><span data-stu-id="e51f3-169">Run the app by pressing **F5.**</span></span> <span data-ttu-id="e51f3-170">Po zobrazení stránky, klikněte na tlačítko **zaregistrovat** odkaz na stránce registrace.</span><span class="sxs-lookup"><span data-stu-id="e51f3-170">After the page is displayed, click the **Register** link to display the Register page.</span></span>
4. <span data-ttu-id="e51f3-171">Zadejte váš e-mail a heslo a potom klikněte **zaregistrovat** tlačítko Odeslat e-mailové zprávy prostřednictvím sendgrid vám umožňuje.</span><span class="sxs-lookup"><span data-stu-id="e51f3-171">Enter your email and password, then click the **Register** button to send an email message via SendGrid.</span></span>  
 <span data-ttu-id="e51f3-172">Aktuální stav projektu a kód vám umožní uživatelům přihlášení po jejich dokončení registrace, i když se nepotvrdily svého účtu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-172">The current state of your project and code will allow the user to log in once they complete the registration form, even though they haven't confirmed their account.</span></span>
5. <span data-ttu-id="e51f3-173">Zkontrolujte e-mailový účet a klikněte na odkaz k potvrzení e-mailu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-173">Check your email account and click on the link to confirm your email.</span></span>  
 <span data-ttu-id="e51f3-174">Po odeslání formuláře registrace budete přihlášeni.</span><span class="sxs-lookup"><span data-stu-id="e51f3-174">Once you submit the registration form, you will be logged in.</span></span>  
    ![Ukázkový web - přihlášení](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image4.png)

<a id="require"></a>
## <a name="require-email-confirmation-before-log-in"></a><span data-ttu-id="e51f3-176">Požadovat potvrzení e-mailu před přihlášení</span><span class="sxs-lookup"><span data-stu-id="e51f3-176">Require Email Confirmation Before Log In</span></span>

<span data-ttu-id="e51f3-177">I když se ujistíte, e-mailový účet, v tomto okamžiku nebude muset klikněte na odkaz obsažený v e-mailu ověření být plně přihlášeného.</span><span class="sxs-lookup"><span data-stu-id="e51f3-177">Although you have confirmed the email account, at this point you would not need to click on the link contained in the verification email to be fully signed-in.</span></span> <span data-ttu-id="e51f3-178">V následující části upravíte kód nutnosti nové uživatele tak, aby měl potvrzen e-mailu, než se přihlásí (ověřený).</span><span class="sxs-lookup"><span data-stu-id="e51f3-178">In the following section, you will modify the code requiring new users to have a confirmed email before they are logged in (authenticated).</span></span>

1. <span data-ttu-id="e51f3-179">V **Průzkumníku řešení** sady Visual Studio, aktualizovat `CreateUser_Click` událost v *Register.aspx.cs* obsažené v kódu *účty* složku s následující zvýrazněný změny:</span><span class="sxs-lookup"><span data-stu-id="e51f3-179">In **Solution Explorer** of Visual Studio, update the `CreateUser_Click` event in the *Register.aspx.cs* code-behind contained in the *Accounts* folder with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample5.cs?highlight=13-14,17-21)]
2. <span data-ttu-id="e51f3-180">Aktualizace `LogIn` metoda v *Login.aspx.cs* kódu s následující zvýrazněný změny:</span><span class="sxs-lookup"><span data-stu-id="e51f3-180">Update the `LogIn` method in the *Login.aspx.cs* code-behind with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample6.cs?highlight=9-19,45-46)]

### <a name="run-the-application"></a><span data-ttu-id="e51f3-181">Spuštění aplikace</span><span class="sxs-lookup"><span data-stu-id="e51f3-181">Run the Application</span></span>

 <span data-ttu-id="e51f3-182">Teď, když jste implementovali kód zkontrolujte, zda byl potvrzen e-mailovou adresu uživatele, můžete zkontrolovat funkčnost na obou **zaregistrovat** a **přihlášení** stránky.</span><span class="sxs-lookup"><span data-stu-id="e51f3-182">Now that you have implemented the code to check whether a user's email address has been confirmed, you can check the functionality on both the **Register** and **Login** pages.</span></span> 

1. <span data-ttu-id="e51f3-183">Odstranit všechny účty v **AspNetUsers** tabulku, která obsahují e-mailový alias, který chcete otestovat.</span><span class="sxs-lookup"><span data-stu-id="e51f3-183">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
2. <span data-ttu-id="e51f3-184">Spuštění aplikace (**F5**) a ověřte nelze zaregistrovat jako uživatel, dokud se ujistíte, e-mailovou adresu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-184">Run the app (**F5**) and verify you cannot register as a user until you have confirmed your email address.</span></span>
3. <span data-ttu-id="e51f3-185">Před potvrzením váš nový účet prostřednictvím e-mailu, který byl právě zaslali, pokuste se přihlásit pomocí nového účtu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-185">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
 <span data-ttu-id="e51f3-186">Dozvíte se, že nebudete moci přihlásit a, musíte mít potvrzené e-mailový účet.</span><span class="sxs-lookup"><span data-stu-id="e51f3-186">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span>
4. <span data-ttu-id="e51f3-187">Jakmile potvrdíte, e-mailovou adresu, přihlaste se k aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e51f3-187">Once you confirm your email address, log in to the app.</span></span>

<a id="reset"></a>
## <a name="password-recovery-and-reset"></a><span data-ttu-id="e51f3-188">Obnovení hesla a resetování</span><span class="sxs-lookup"><span data-stu-id="e51f3-188">Password Recovery and Reset</span></span>

1. <span data-ttu-id="e51f3-189">V sadě Visual Studio, odeberte komentář znaky z `Forgot` metoda v *Forgot.aspx.cs* obsažené v kódu *účtu* složky tak, že metoda zobrazí jako následuje:</span><span class="sxs-lookup"><span data-stu-id="e51f3-189">In Visual Studio, remove the comment characters from the `Forgot` method in the *Forgot.aspx.cs* code-behind contained in the *Account* folder, so that the method appears as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample7.cs?highlight=16-18)]
2. <span data-ttu-id="e51f3-190">Otevřete *Login.aspx* stránky.</span><span class="sxs-lookup"><span data-stu-id="e51f3-190">Open the *Login.aspx* page.</span></span> <span data-ttu-id="e51f3-191">Nahraďte kód u konce **loginForm** části jak je znázorněno níže:</span><span class="sxs-lookup"><span data-stu-id="e51f3-191">Replace the markup near the end of the **loginForm** section as highlighted below:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample8.aspx?highlight=52-53)]
3. <span data-ttu-id="e51f3-192">Otevřete *Login.aspx.cs* kódu a zrušte komentář u následujícího řádku kódu zvýrazněných v žlutý z `Page_Load` obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="e51f3-192">Open the *Login.aspx.cs* code-behind and uncomment the following line of code highlighted in yellow from the `Page_Load` event handler:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample9.cs?highlight=5)]
4. <span data-ttu-id="e51f3-193">Spusťte aplikaci stisknutím **F5.**</span><span class="sxs-lookup"><span data-stu-id="e51f3-193">Run the app by pressing **F5.**</span></span> <span data-ttu-id="e51f3-194">Po zobrazení stránky, klikněte na tlačítko **přihlásit** odkaz.</span><span class="sxs-lookup"><span data-stu-id="e51f3-194">After the page is displayed, click the **Log in** link.</span></span>
5. <span data-ttu-id="e51f3-195">Klikněte na tlačítko **zapomněli jste heslo?** odkaz na zobrazení **zapomněli jste heslo** stránky.</span><span class="sxs-lookup"><span data-stu-id="e51f3-195">Click the **Forgot your password?** link to display the **Forgot Password** page.</span></span>
6. <span data-ttu-id="e51f3-196">Zadejte e-mailovou adresu a klikněte na **odeslání** tlačítko Odeslat e-mail na vaši adresu, která vám umožní vytvořit nové heslo.</span><span class="sxs-lookup"><span data-stu-id="e51f3-196">Enter your email address and click the **Submit** button to send an email to your address which will allow you to reset your password.</span></span>   
 <span data-ttu-id="e51f3-197">Zkontrolujte e-mailový účet a klikněte na odkaz zobrazíte **resetovat heslo** stránky.</span><span class="sxs-lookup"><span data-stu-id="e51f3-197">Check your email account and click on the link to display the **Reset Password** page.</span></span>
7. <span data-ttu-id="e51f3-198">Na **resetovat heslo** zadejte vaše e-mailu, heslo a potvrzení hesla.</span><span class="sxs-lookup"><span data-stu-id="e51f3-198">On the **Reset Password** page, enter your email, password, and confirmed password.</span></span> <span data-ttu-id="e51f3-199">Potom stiskněte **resetovat** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="e51f3-199">Then, press the **Reset** button.</span></span>  
 <span data-ttu-id="e51f3-200">Pokud jste úspěšně resetovali heslo, **změnit heslo** se zobrazí stránka.</span><span class="sxs-lookup"><span data-stu-id="e51f3-200">When you successfully reset your password, the **Password Changed** page will be displayed.</span></span> <span data-ttu-id="e51f3-201">Nyní můžete přihlásit pomocí nového hesla.</span><span class="sxs-lookup"><span data-stu-id="e51f3-201">Now you can log in with your new password.</span></span>

<a id="rsend"></a>
## <a name="resend-email-confirmation-link"></a><span data-ttu-id="e51f3-202">Odkaz pro potvrzení znovu odeslat e-mailu</span><span class="sxs-lookup"><span data-stu-id="e51f3-202">Resend Email Confirmation Link</span></span>

<span data-ttu-id="e51f3-203">Jakmile uživatel vytvoří nový místní účet, jsou e-mailem potvrzení propojení, které musí předtím, než se nemohou přihlásit</span><span class="sxs-lookup"><span data-stu-id="e51f3-203">Once a user creates a new local account, they are emailed a confirmation link they are required to use before they can log on.</span></span> <span data-ttu-id="e51f3-204">Pokud uživatel, ať už náhodně odstraní e-mail s potvrzením nebo e-mailu nikdy dorazí, potřebují odkaz potvrzení odeslat znovu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-204">If the user accidently deletes the confirmation email, or the email never arrives, they will need the confirmation link sent again.</span></span> <span data-ttu-id="e51f3-205">Následující změny kódu ukazují, jak povolit tuto funkci.</span><span class="sxs-lookup"><span data-stu-id="e51f3-205">The following code changes show how to enable this.</span></span>

1. <span data-ttu-id="e51f3-206">V sadě Visual Studio, otevřete **Login.aspx.cs** kódu a přidejte následující obslužné rutiny události po `LogIn` obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="e51f3-206">In Visual Studio, open the **Login.aspx.cs** code-behind and add the following event handler after the `LogIn` event handler:</span></span>   

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample10.cs)]
2. <span data-ttu-id="e51f3-207">Změnit `LogIn` obslužné rutiny událostí v *Login.aspx.cs* kódu tak, že změníte kód zvýrazněných v žlutý následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="e51f3-207">Modify the `LogIn` event handler in the *Login.aspx.cs* code-behind by changing the code highlighted in yellow as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample11.cs?highlight=15-17)]
3. <span data-ttu-id="e51f3-208">Aktualizace *Login.aspx* tak, že přidáte kód zvýrazněných v žlutý následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="e51f3-208">Update the *Login.aspx* page by adding the code highlighted in yellow as follows:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample12.aspx?highlight=45-46)]
4. <span data-ttu-id="e51f3-209">Odstranit všechny účty v **AspNetUsers** tabulku, která obsahují e-mailový alias, který chcete otestovat.</span><span class="sxs-lookup"><span data-stu-id="e51f3-209">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
5. <span data-ttu-id="e51f3-210">Spuštění aplikace (**F5**) a zaregistrujte e-mailovou adresu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-210">Run the app (**F5**) and register your email address.</span></span>
6. <span data-ttu-id="e51f3-211">Před potvrzením váš nový účet prostřednictvím e-mailu, který byl právě zaslali, pokuste se přihlásit pomocí nového účtu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-211">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
 <span data-ttu-id="e51f3-212">Dozvíte se, že nebudete moci přihlásit a, musíte mít potvrzené e-mailový účet.</span><span class="sxs-lookup"><span data-stu-id="e51f3-212">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span> <span data-ttu-id="e51f3-213">Kromě toho můžete potvrzovací zpráva nyní znovu odeslat ke svému účtu e-mailu.</span><span class="sxs-lookup"><span data-stu-id="e51f3-213">In addition, you can now resend a confirmation message to your email account.</span></span>
7. <span data-ttu-id="e51f3-214">Zadejte e-mailovou adresu a heslo, stiskněte **znovu odeslat potvrzení** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="e51f3-214">Enter your email address and password, then press the **Resend confirmation** button.</span></span>
8. <span data-ttu-id="e51f3-215">Jakmile potvrdíte, e-mailovou adresu, na základě nově odeslaných e-mailové zprávy, přihlaste se k aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e51f3-215">Once you confirm your email address based on the newly sent email message, log in to the app.</span></span>

<a id="dbg"></a>
## <a name="troubleshooting-the-app"></a><span data-ttu-id="e51f3-216">Řešení potíží s aplikací</span><span class="sxs-lookup"><span data-stu-id="e51f3-216">Troubleshooting the App</span></span>

<span data-ttu-id="e51f3-217">Pokud jste neobdrželi e-mail, který obsahuje odkaz na ověřit vaše přihlašovací údaje:</span><span class="sxs-lookup"><span data-stu-id="e51f3-217">If you don't receive an email containing the link to verify your credentials:</span></span>

- <span data-ttu-id="e51f3-218">Zkontrolujte složku Nevyžádaná pošta nebo nevyžádané pošty.</span><span class="sxs-lookup"><span data-stu-id="e51f3-218">Check your junk or spam folder.</span></span>
- <span data-ttu-id="e51f3-219">Přihlaste se k účtu sendgrid vám umožňuje a klikněte na [odkaz e-mailu aktivity](https://sendgrid.com/logs/index).</span><span class="sxs-lookup"><span data-stu-id="e51f3-219">Log into your SendGrid account and click on the [Email Activity link](https://sendgrid.com/logs/index).</span></span>
- <span data-ttu-id="e51f3-220">Být jistý, použít název účtu uživatele sendgrid vám umožňuje jako *Web.config* hodnotu namísto e-mailovou adresu účtu sendgrid vám umožňuje.</span><span class="sxs-lookup"><span data-stu-id="e51f3-220">Be certain you used your SendGrid user account name as a *Web.config* value rather than your SendGrid account email address.</span></span>

<a id="addRes"></a>
## <a name="additional-resources"></a><span data-ttu-id="e51f3-221">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="e51f3-221">Additional Resources</span></span>

- [<span data-ttu-id="e51f3-222">Odkazy na identitě ASP.NET Identity doporučené prostředky</span><span class="sxs-lookup"><span data-stu-id="e51f3-222">Links to ASP.NET Identity Recommended Resources</span></span>](../../../identity/overview/getting-started/aspnet-identity-recommended-resources.md)
- [<span data-ttu-id="e51f3-223">Potvrzení účtu a heslo pro obnovení s ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="e51f3-223">Account Confirmation and Password Recovery with ASP.NET Identity</span></span>](../../../identity/overview/features-api/account-confirmation-and-password-recovery-with-aspnet-identity.md)
- [<span data-ttu-id="e51f3-224">Kurz řady webových formulářů ASP.NET – přidání poskytovatele OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="e51f3-224">ASP.NET Web Forms tutorial series - Add an OAuth 2.0 Provider</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#OAuthWebForms)
- [<span data-ttu-id="e51f3-225">Nasazení aplikace zabezpečení rozhraní ASP.NET Web Forms členství, OAuth a databáze SQL Azure App Service</span><span class="sxs-lookup"><span data-stu-id="e51f3-225">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to Azure App Service</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)
- [<span data-ttu-id="e51f3-226">ASP.NET řady kurz webové formuláře – povolit šifrování SSL pro projekt</span><span class="sxs-lookup"><span data-stu-id="e51f3-226">ASP.NET Web Forms tutorial series - Enable SSL for the Project</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms)
