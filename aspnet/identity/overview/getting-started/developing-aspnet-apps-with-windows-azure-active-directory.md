---
uid: identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory
title: Vývoj aplikací ASP.NET se službou Azure Active Directory | Microsoft Docs
author: Rick-Anderson
description: Nástroje Microsoft ASP.NET tools pro službu Azure Active Directory zjednodušuje kvůli povolení ověřování pro webové aplikace hostované v Azure. Můžete použít Azure Authenti...
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/14/2014
ms.topic: article
ms.assetid: 457d7eaf-ee76-4ceb-9082-c7c1721435ad
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory
msc.type: authoredcontent
ms.openlocfilehash: 44bf29e099583bf9d49f2715d3ff4f748728ad8b
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/06/2018
---
<a name="developing-aspnet-apps-with-azure-active-directory"></a><span data-ttu-id="821bd-104">Vývoj aplikací ASP.NET se službou Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="821bd-104">Developing ASP.NET Apps with Azure Active Directory</span></span>
====================
<span data-ttu-id="821bd-105">podle [Rick Anderson](https://github.com/Rick-Anderson)</span><span class="sxs-lookup"><span data-stu-id="821bd-105">by [Rick Anderson](https://github.com/Rick-Anderson)</span></span>

> <span data-ttu-id="821bd-106">Nástroje Microsoft ASP.NET pro Azure Active Directory usnadňuje povolení ověřování pro webové aplikace hostované na [Azure](https://www.windowsazure.com/home/features/web-sites/).</span><span class="sxs-lookup"><span data-stu-id="821bd-106">Microsoft ASP.NET tools for Azure Active Directory makes it simple to enable authentication for web applications hosted on [Azure](https://www.windowsazure.com/home/features/web-sites/).</span></span> <span data-ttu-id="821bd-107">Ověřování Azure můžete použít k ověření uživatele služeb Office 365 z vaší organizace, podnikové účty synchronizované z vaší místní službou Active Directory nebo uživatelé vytvoření ve vlastní domény Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="821bd-107">You can use Azure Authentication to authenticate Office 365 users from your organization, corporate accounts synced from your on-premise Active Directory or users created in your own custom Azure Active Directory domain.</span></span> <span data-ttu-id="821bd-108">Povolení ověřování systému Windows Azure nakonfiguruje aplikace k ověření uživatelů pomocí jedné [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) klienta.</span><span class="sxs-lookup"><span data-stu-id="821bd-108">Enabling Windows Azure Authentication configures your application to authenticate users using a single [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) tenant.</span></span>
> 
>  <span data-ttu-id="821bd-109">V tomto kurzu napsal Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="821bd-109">This tutorial was written by Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span></span>


<span data-ttu-id="821bd-110">Tento kurz vám ukáže, jak vytvořit aplikaci ASP.NET, který je nakonfigurován pro přihlašování pomocí [Azure Active Directory](https://msdn.microsoft.com/library/azure/mt168838.aspx) (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="821bd-110">This tutorial will show you how to create an ASP.NET application that is configured for sign-on with [Azure Active Directory](https://msdn.microsoft.com/library/azure/mt168838.aspx) (Azure AD).</span></span> <span data-ttu-id="821bd-111">Také se naučíte, jak zavolat rozhraní Graph API k načtení informací o aktuálně přihlášeného uživatele a jak nasadit aplikaci do Azure.</span><span class="sxs-lookup"><span data-stu-id="821bd-111">You will also learn how to call the Graph API to get information about the currently signed-in user and how to deploy the application to Azure.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="821bd-112">Požadavky</span><span class="sxs-lookup"><span data-stu-id="821bd-112">Prerequisites</span></span>

1. <span data-ttu-id="821bd-113">[Visual Studio Express 2013 pro Web](https://www.microsoft.com/visualstudio/eng/2013-downloads#d-2013-express) nebo [Visual Studio 2013](https://www.microsoft.com/visualstudio/eng/2013-downloads).</span><span class="sxs-lookup"><span data-stu-id="821bd-113">[Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/eng/2013-downloads#d-2013-express) or [Visual Studio 2013](https://www.microsoft.com/visualstudio/eng/2013-downloads).</span></span>
2. <span data-ttu-id="821bd-114">[Visual Studio 2013 Update 4](https://www.microsoft.com/download/details.aspx?id=44921) -je požadována aktualizace 3 nebo vyšší.</span><span class="sxs-lookup"><span data-stu-id="821bd-114">[Visual Studio 2013 Update 4](https://www.microsoft.com/download/details.aspx?id=44921) - Update 3 or higher is required.</span></span>
3. <span data-ttu-id="821bd-115">Účet Azure.</span><span class="sxs-lookup"><span data-stu-id="821bd-115">An Azure account.</span></span> <span data-ttu-id="821bd-116">[Kliknutím sem](https://azure.microsoft.com/pricing/free-trial/) bezplatnou zkušební verzi, pokud již nemáte účet.</span><span class="sxs-lookup"><span data-stu-id="821bd-116">[Click here](https://azure.microsoft.com/pricing/free-trial/) for a free trial if you do not already have an account.</span></span>

## <a name="add-a-global-administrator-to-your-active-directory"></a><span data-ttu-id="821bd-117">Přidejte globální správce do služby Active Directory</span><span class="sxs-lookup"><span data-stu-id="821bd-117">Add a Global Administrator to your Active Directory</span></span>

1. <span data-ttu-id="821bd-118">Přihlaste se k [portál pro správu Azure](https://manage.windowsazure.com/).</span><span class="sxs-lookup"><span data-stu-id="821bd-118">Sign in to the [Azure Management Portal](https://manage.windowsazure.com/).</span></span>
2. <span data-ttu-id="821bd-119">Obsahuje všechny účty Azure **výchozí adresář** – klikněte na něj a pak klikněte na tlačítko **uživatelé** v horní části stránky (viz následující obrázek).</span><span class="sxs-lookup"><span data-stu-id="821bd-119">All Azure accounts contain a **Default Directory** -- click on it, then click the **Users** tab at the top of the page (see image below).</span></span>
3. <span data-ttu-id="821bd-120">Klikněte na tlačítko Přidat uživatele.</span><span class="sxs-lookup"><span data-stu-id="821bd-120">Click Add User.</span></span>  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image1.png)
4. <span data-ttu-id="821bd-121">Vytvoření nového uživatele pomocí **globálního správce** role.</span><span class="sxs-lookup"><span data-stu-id="821bd-121">Create a new user with the **Global Administrator** role.</span></span> <span data-ttu-id="821bd-122">Klikněte na tlačítko **uživatelé** z hlavní nabídky a klikněte **přidat uživatele** tlačítka na panelu příkazů.</span><span class="sxs-lookup"><span data-stu-id="821bd-122">Click **Users** from the top menu, and then click the **Add User** button on the command bar.</span></span>
5. <span data-ttu-id="821bd-123">V **přidat uživatele** dialogové okno, zadejte název pro nového uživatele a pak klikněte na šipku vpravo.</span><span class="sxs-lookup"><span data-stu-id="821bd-123">In the **Add User** dialog, enter a name for the new user and then click the right arrow.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image2.png)
6. <span data-ttu-id="821bd-124">Zadejte uživatelské jméno a nastavte roli **globálního správce**.</span><span class="sxs-lookup"><span data-stu-id="821bd-124">Enter the user name and set the role to **Global Administrator**.</span></span> <span data-ttu-id="821bd-125">Globální správci potřebují alternativní e-mailovou adresu pro účely obnovení hesla.</span><span class="sxs-lookup"><span data-stu-id="821bd-125">Global administrators require an alternate email address for password recovery purposes.</span></span> <span data-ttu-id="821bd-126">Jakmile budete hotovi, klikněte na šipku vpravo.</span><span class="sxs-lookup"><span data-stu-id="821bd-126">After you're finished, click the right arrow.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image3.png)
7. <span data-ttu-id="821bd-127">Na další stránce dialogového okna, klikněte na tlačítko **vytvořit**.</span><span class="sxs-lookup"><span data-stu-id="821bd-127">On the next page of the dialog, click **Create**.</span></span> <span data-ttu-id="821bd-128">Dočasné heslo se vytvoří pro nového uživatele a zobrazí v dialogovém okně.</span><span class="sxs-lookup"><span data-stu-id="821bd-128">A temporary password will be created for the new user and displayed in the dialog.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image4.png)  
  
   <span data-ttu-id="821bd-129">Uložit heslo budou muset změnit heslo po prvním přihlášení.</span><span class="sxs-lookup"><span data-stu-id="821bd-129">Save the password, you will be required to change the password after the first log in.</span></span> <span data-ttu-id="821bd-130">Následující obrázek ukazuje nový účet správce.</span><span class="sxs-lookup"><span data-stu-id="821bd-130">The following image shows the new admin account.</span></span> <span data-ttu-id="821bd-131">Azure Active Directory musíte použít k přihlášení do aplikace, není k účtu Microsoft, které jsou také uvedené na této stránce.</span><span class="sxs-lookup"><span data-stu-id="821bd-131">You must use the Azure Active Directory to log into your app, not the Microsoft account also shown on this page.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image5.png)

## <a name="create-an-aspnet-application"></a><span data-ttu-id="821bd-132">Vytvoření aplikace ASP.NET</span><span class="sxs-lookup"><span data-stu-id="821bd-132">Create an ASP.NET Application</span></span>

<span data-ttu-id="821bd-133">Následující postup použijte [Visual Studio Express 2013 pro Web](https://www.microsoft.com/download/details.aspx?id=40747)a vyžaduje [Visual Studio 2013 Update 3](https://www.microsoft.com/download/details.aspx?id=43721).</span><span class="sxs-lookup"><span data-stu-id="821bd-133">The following steps use [Visual Studio Express 2013 for Web](https://www.microsoft.com/download/details.aspx?id=40747), and requires [Visual Studio 2013 Update 3](https://www.microsoft.com/download/details.aspx?id=43721).</span></span>

1. <span data-ttu-id="821bd-134">V sadě Visual Studio, klikněte na tlačítko **soubor** a potom **nový projekt**.</span><span class="sxs-lookup"><span data-stu-id="821bd-134">In Visual Studio, click **File** and then **New Project**.</span></span> <span data-ttu-id="821bd-135">Na **nový projekt** dialogové okno, vyberte v levé nabídce projektu Visual C# webovou a klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="821bd-135">On the **New Project** dialog, select the Visual C# Web project from the left menu and click **OK**.</span></span> <span data-ttu-id="821bd-136">Můžete také zrušte zaškrtnutí políčka **přidat službu Application Insights do projektu** Pokud nechcete, aby funkce pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="821bd-136">You may also want to uncheck the **Add Application Insights to Project** if you don't want the functionality for your application.</span></span>
2. <span data-ttu-id="821bd-137">V **nový projekt ASP.NET** dialogovém okně, vyberte **MVC**a potom klikněte na **změna ověřování**.</span><span class="sxs-lookup"><span data-stu-id="821bd-137">In the **New ASP.NET Project** dialog, select **MVC**, and then click **Change Authentication**.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image6.png)
3. <span data-ttu-id="821bd-138">Na **změna ověřování** dialogovém okně, vyberte **účty organizace**.</span><span class="sxs-lookup"><span data-stu-id="821bd-138">On the **Change Authentication** dialog, select **Organizational Accounts**.</span></span> <span data-ttu-id="821bd-139">Tyto možnosti lze automaticky registrace vaší aplikace s Azure AD a také automaticky konfigurace aplikace pro integraci se službou Azure AD.</span><span class="sxs-lookup"><span data-stu-id="821bd-139">These options can be used to automatically register your application with Azure AD as well as automatically configure your application to integrate with Azure AD.</span></span> <span data-ttu-id="821bd-140">Nemusíte používat **změna ověřování** dialogovém okně můžete zaregistrovat a nakonfigurovat aplikaci, ale je mnohem jednodušší.</span><span class="sxs-lookup"><span data-stu-id="821bd-140">You don't have to use the **Change Authentication** dialog to register and configure your application, but it makes it much easier.</span></span> <span data-ttu-id="821bd-141">Pokud například používáte sadu Visual Studio 2012, můžete pořád spustit ručně zaregistrovat aplikaci v portálu pro správu Azure a aktualizaci konfigurace pro integraci s Azure AD.</span><span class="sxs-lookup"><span data-stu-id="821bd-141">If you are using Visual Studio 2012 for example, you can still manually register the application in the Azure Management Portal and update its configuration to integrate with Azure AD.</span></span>  
   <span data-ttu-id="821bd-142">V rozevíracích nabídek vyberte **cloudu – jednotný** a **jednotné přihlašování, čtení dat adresáře**.</span><span class="sxs-lookup"><span data-stu-id="821bd-142">In the drop-down menus, select **Cloud - Single Organization** and **Single Sign On, Read directory data**.</span></span> <span data-ttu-id="821bd-143">Zadejte doménu pro váš adresář Azure AD, například (v obrázcích níže) *aricka0yahoo.onmicrosoft.com*a potom klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="821bd-143">Enter the domain for your Azure AD directory, for example (in the images below) *aricka0yahoo.onmicrosoft.com*, and then click **OK**.</span></span> <span data-ttu-id="821bd-144">Název domény můžete získat z karty domén pro výchozí adresář na portálu azure (viz další image dolů).</span><span class="sxs-lookup"><span data-stu-id="821bd-144">You can get the domain name from the Domains tab for the Default Directory on the azure portal (see the next image down).</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image7.png)  
  
   <span data-ttu-id="821bd-145">Následující obrázek zobrazuje název domény z portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="821bd-145">The following image shows the domain name from the Azure portal.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image8.png)  

    > [!NOTE]
    > <span data-ttu-id="821bd-146">Volitelně můžete nakonfigurovat identifikátor ID URI aplikace, které se zaregistruje ve službě Azure AD kliknutím **další možnosti**.</span><span class="sxs-lookup"><span data-stu-id="821bd-146">You can optionally configure the Application ID URI that will be registered in Azure AD by clicking **More Options**.</span></span> <span data-ttu-id="821bd-147">Identifikátor ID URI aplikace je jedinečný identifikátor pro aplikaci, která je registrovaná v Azure AD a používá je aplikace identifikovat při komunikaci se službou Azure AD.</span><span class="sxs-lookup"><span data-stu-id="821bd-147">The App ID URI is the unique identifier for an application, which is registered in Azure AD and used by the application to identify itself when communicating with Azure AD.</span></span> <span data-ttu-id="821bd-148">Další informace o identifikátor ID URI aplikace a další vlastnosti registrovaných aplikací najdete v tématu [v tomto tématu](https://msdn.microsoft.com/library/azure/dn499820.aspx#BKMK_Registering).</span><span class="sxs-lookup"><span data-stu-id="821bd-148">For more information about the App ID URI and other properties of registered applications, see [this topic](https://msdn.microsoft.com/library/azure/dn499820.aspx#BKMK_Registering).</span></span> <span data-ttu-id="821bd-149">Kliknutím na zaškrtávací políčko níže pole identifikátor ID URI aplikace také můžete přepsat existující registraci ve službě Azure AD, který používá stejný identifikátor ID URI aplikace.</span><span class="sxs-lookup"><span data-stu-id="821bd-149">By clicking the checkbox below the App ID URI field, you can also choose to overwrite an existing registration in Azure AD that uses the same App ID URI.</span></span>
4. <span data-ttu-id="821bd-150">Po kliknutí na **OK**, zobrazí se dialogové okno přihlášení a budete se muset přihlásit pomocí účtu globálního správce (není účet Microsoft spojené s vaším předplatným).</span><span class="sxs-lookup"><span data-stu-id="821bd-150">After clicking **OK**, a sign-in dialog will appear, and you'll need to sign in using a Global Administrator account (not the Microsoft account associated with your subscription).</span></span> <span data-ttu-id="821bd-151">Pokud jste dříve vytvořili nový účet správce, bude nutné změnit heslo a potom znovu přihlásit pomocí nového hesla.</span><span class="sxs-lookup"><span data-stu-id="821bd-151">If you created a new Administrator account earlier, you'll be required to change the password and then sign in again using the new password.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image9.png)
5. <span data-ttu-id="821bd-152">Poté, co jste úspěšně ověřen, **nový projekt ASP.NET** dialogové okno se zobrazí zvoleného ověřování (**organizační** ) a zaregistrována (adresáři,kdebudounováaplikace*aricka0yahoo.onmicrosoft.com* na obrázku níže).</span><span class="sxs-lookup"><span data-stu-id="821bd-152">After you've successfully authenticated, the **New ASP.NET Project** dialog will show your authentication choice (**Organizational** ) and the directory where the new application will be registered (*aricka0yahoo.onmicrosoft.com* in the image below).</span></span> <span data-ttu-id="821bd-153">Pod tyto informace, zaškrtněte políčko s názvem bez přípony **hostitel v cloudu**.</span><span class="sxs-lookup"><span data-stu-id="821bd-153">Below this information, select the checkbox labeled **Host in the cloud**.</span></span> <span data-ttu-id="821bd-154">Pokud je toto políčko zaškrtnuto, projektu, se zřídí jako webové aplikace Azure a budou povolené pro snadné publikování později.</span><span class="sxs-lookup"><span data-stu-id="821bd-154">If this checkbox is selected, the project will be provisioned as an Azure web app and will be enabled for easy publishing later.</span></span> <span data-ttu-id="821bd-155">Click **OK**.</span><span class="sxs-lookup"><span data-stu-id="821bd-155">Click **OK**.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image10.png)
6. <span data-ttu-id="821bd-156">**Webu Azure konfigurovat** zobrazí se dialogové okno, použití název lokality automaticky generovaný a oblast.</span><span class="sxs-lookup"><span data-stu-id="821bd-156">The **Configure Azure Website** dialog will appear, using an auto-generated site name and region.</span></span> <span data-ttu-id="821bd-157">Všimněte si také účet, který jste aktuálně přihlášeni v dialogovém okně.</span><span class="sxs-lookup"><span data-stu-id="821bd-157">Also note the account you're currently signed into in the dialog.</span></span> <span data-ttu-id="821bd-158">Chcete-li zajistit, že tento účet je ten, který je připojen vašeho předplatného Azure, obvykle účet Microsoft.</span><span class="sxs-lookup"><span data-stu-id="821bd-158">You want to make sure that this account is the one that your Azure subscription is attached to, typically a Microsoft account.</span></span>

    > [!NOTE]
    > <span data-ttu-id="821bd-159">Tento projekt vyžaduje databázi.</span><span class="sxs-lookup"><span data-stu-id="821bd-159">This project requires a database.</span></span> <span data-ttu-id="821bd-160">Musíte vybrat jednu ze stávajících databází nebo vytvořte novou.</span><span class="sxs-lookup"><span data-stu-id="821bd-160">You need to select one of your existing databases, or create a new one.</span></span> <span data-ttu-id="821bd-161">Databáze není nutná, protože projekt již používá soubor místní databázi k ukládání malé množství dat konfigurace ověřování.</span><span class="sxs-lookup"><span data-stu-id="821bd-161">A database is required because the project already uses a local database file to store a small amount of authentication configuration data.</span></span> <span data-ttu-id="821bd-162">Při nasazení aplikace na web Azure, tato databáze není zabalené s nasazením, proto musíte vybrat jednu, která je přístupná v cloudu.</span><span class="sxs-lookup"><span data-stu-id="821bd-162">When you deploy the application to an Azure Website, this database isn't packaged with the deployment, so you need to choose one that's accessible in the cloud.</span></span> <span data-ttu-id="821bd-163">Click **OK**.</span><span class="sxs-lookup"><span data-stu-id="821bd-163">Click **OK**.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image11.png)
7. <span data-ttu-id="821bd-164">Vytvoří projekt, a možnosti ověřování a možnosti webové aplikace, budou automaticky nakonfigurováni projektu.</span><span class="sxs-lookup"><span data-stu-id="821bd-164">The project will be created, and your authentication options and web app options will be automatically configured with the project.</span></span> <span data-ttu-id="821bd-165">Po dokončení tohoto procesu spusťte projekt lokálně stisknutím **^ F5**.</span><span class="sxs-lookup"><span data-stu-id="821bd-165">Once this process has completed, run the project locally by pressing **^F5**.</span></span> <span data-ttu-id="821bd-166">Bude nutné se přihlásit pomocí účtu organizace.</span><span class="sxs-lookup"><span data-stu-id="821bd-166">You will be required to sign in using your organizational account.</span></span> <span data-ttu-id="821bd-167">Zadejte uživatelské jméno a heslo pro účet, který jste dříve vytvořili a klikněte na **přihlášení**.</span><span class="sxs-lookup"><span data-stu-id="821bd-167">Provide the username and password for the account you created earlier and click **Sign in**.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image12.png)
8. <span data-ttu-id="821bd-168">Po úspěšném přihlášení se zobrazí webu ASP.NET, že jste ověřována zobrazení uživatelského jména v pravém horním rohu stránky.</span><span class="sxs-lookup"><span data-stu-id="821bd-168">After successful sign in, the ASP.NET site will show that you've authenticated by displaying the username in the top right corner of the page.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image13.png)  
  
   <span data-ttu-id="821bd-169">Pokud dojde k chybě:</span><span class="sxs-lookup"><span data-stu-id="821bd-169">If you get the error:</span></span>  
   <span data-ttu-id="821bd-170">Hodnota nemůže být null nebo prázdný.</span><span class="sxs-lookup"><span data-stu-id="821bd-170">Value cannot be null or empty.</span></span> <span data-ttu-id="821bd-171">Název parametru: linkText</span><span class="sxs-lookup"><span data-stu-id="821bd-171">Parameter name: linkText</span></span>   
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image14.png)  
  
   <span data-ttu-id="821bd-172">najdete v článku [ladění](#dbg) části na konci tohoto kurzu.</span><span class="sxs-lookup"><span data-stu-id="821bd-172">see the [debug](#dbg) section at the end of the tutorial.</span></span>

## <a name="basics-of-the-graph-api"></a><span data-ttu-id="821bd-173">Základní informace o Graph API</span><span class="sxs-lookup"><span data-stu-id="821bd-173">Basics of the Graph API</span></span>

<span data-ttu-id="821bd-174">[Rozhraní Graph API](https://msdn.microsoft.com/library/azure/hh974476.aspx) je programovací rozhraní používá k provádění CRUD a další operace na objektech v adresáři služby Azure AD.</span><span class="sxs-lookup"><span data-stu-id="821bd-174">[The Graph API](https://msdn.microsoft.com/library/azure/hh974476.aspx) is the programmatic interface used to perform CRUD and other operations on objects in your Azure AD directory.</span></span> <span data-ttu-id="821bd-175">Pokud vyberete možnost účtu organizace pro ověřování při vytváření nového projektu v sadě Visual Studio 2013, vaše aplikace už nakonfigurovaná k volání rozhraní Graph API.</span><span class="sxs-lookup"><span data-stu-id="821bd-175">If you select an Organizational Account option for authentication when creating a new project in Visual Studio 2013, your application will already be configured to call the Graph API.</span></span> <span data-ttu-id="821bd-176">Tato část stručně ukazuje, jak funguje rozhraní Graph API.</span><span class="sxs-lookup"><span data-stu-id="821bd-176">This section briefly shows you how the Graph API works.</span></span>

1. <span data-ttu-id="821bd-177">V běžící aplikaci, klikněte na název přihlášeného uživatele v horní pravé části stránky.</span><span class="sxs-lookup"><span data-stu-id="821bd-177">In your running application, click on the name of the signed-in user at the top right of the page.</span></span> <span data-ttu-id="821bd-178">Tím přejdete na stránku profilu uživatele, který je akce na řadiči Domů.</span><span class="sxs-lookup"><span data-stu-id="821bd-178">This will take you to the User Profile page, which is an action on the Home Controller.</span></span> <span data-ttu-id="821bd-179">Můžete si všimnout, že tabulka obsahuje informace o uživateli o účet správce, že jste vytvořili dříve.</span><span class="sxs-lookup"><span data-stu-id="821bd-179">You'll notice that the table contains user information about the administrator account you created earlier.</span></span> <span data-ttu-id="821bd-180">Tyto informace jsou uloženy ve vašem adresáři a rozhraní Graph API je volána pro načtení těchto informací při načtení stránky.</span><span class="sxs-lookup"><span data-stu-id="821bd-180">This information is stored in your directory, and the Graph API is called to retrieve this information when the page loads.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image15.png)
2. <span data-ttu-id="821bd-181">Přejděte zpět do Visual Studio a rozbalte **řadiče** složku a potom otevřete **HomeController.cs** souboru.</span><span class="sxs-lookup"><span data-stu-id="821bd-181">Go back to Visual Studio and expand the **Controllers** folder and then open the **HomeController.cs** file.</span></span> <span data-ttu-id="821bd-182">Zobrazí se **UserProfile()** akci, která obsahuje kód pro načtení tokenu a poté zavolat rozhraní Graph API.</span><span class="sxs-lookup"><span data-stu-id="821bd-182">You'll see a **UserProfile()** action that contains code to retrieve a token and then call the Graph API.</span></span> <span data-ttu-id="821bd-183">Tento kód je duplikována níže:</span><span class="sxs-lookup"><span data-stu-id="821bd-183">This code is duplicated below:</span></span> 

    [!code-csharp[Main](developing-aspnet-apps-with-windows-azure-active-directory/samples/sample1.cs?highlight=22)]

    <span data-ttu-id="821bd-184">K volání rozhraní Graph API, musíte nejdřív načíst token.</span><span class="sxs-lookup"><span data-stu-id="821bd-184">To call the Graph API, you first need to retrieve a token.</span></span> <span data-ttu-id="821bd-185">Pokud je token načteny, je nutno přidat jeho řetězcová hodnota v hlavičce autorizace pro všechny následné požadavky na rozhraní Graph API.</span><span class="sxs-lookup"><span data-stu-id="821bd-185">When the token is retrieved, its string value must be appended in the Authorization header for all subsequent requests to the Graph API.</span></span> <span data-ttu-id="821bd-186">Většinu kódu výše zpracovává podrobnosti o ověřování pro službu Azure AD se získat token, pomocí tokenu pro volání pro rozhraní Graph API a pak transformace odpovědi tak, aby může být uvedené v zobrazení.</span><span class="sxs-lookup"><span data-stu-id="821bd-186">Most of the code above handles the details of authenticating to Azure AD to get a token, using the token to make a call to the Graph API, and then transforming the response so that it can be presented in the View.</span></span>

    <span data-ttu-id="821bd-187">Následující zvýrazněný řádek je nejdůležitější část diskusi: `UserProfile profile = JsonConvert.DeserializeObject<UserProfile>(responseString);`.</span><span class="sxs-lookup"><span data-stu-id="821bd-187">The most relevant portion for discussion is the following highlighted line: `UserProfile profile = JsonConvert.DeserializeObject<UserProfile>(responseString);`.</span></span> <span data-ttu-id="821bd-188">Tento řádek představuje jméno uživatele, který má byla v odpovědi JSON deserializovat a je uvedené v zobrazení.</span><span class="sxs-lookup"><span data-stu-id="821bd-188">This line represents the name of the user, which has been deserialized from the JSON response and is presented in the View.</span></span>

    <span data-ttu-id="821bd-189">Můžete volat rozhraní Graph API pomocí položky HttpClient a zpracování nezpracovaných dat sami, ale snadnější je použití [grafu klientské knihovny, která je k dispozici prostřednictvím balíčku NuGet](http://www.nuget.org/packages/Microsoft.Azure.ActiveDirectory.GraphClient/).</span><span class="sxs-lookup"><span data-stu-id="821bd-189">You can call the Graph API using HttpClient and handle the raw data yourself, but an easier way is to use the [Graph Client Library which is available via NuGet](http://www.nuget.org/packages/Microsoft.Azure.ActiveDirectory.GraphClient/).</span></span> <span data-ttu-id="821bd-190">Klientská knihovna zpracuje nezpracovaná požadavků HTTP a transformaci vrácená data pro vás a výrazně usnadňuje práci s rozhraní Graph API v prostředí .NET.</span><span class="sxs-lookup"><span data-stu-id="821bd-190">The Client Library handles the raw HTTP requests and the transformation of the returned data for you, and makes it much easier to work with the Graph API in a .NET environment.</span></span> <span data-ttu-id="821bd-191">Zobrazit související ukázky kódu rozhraní Graph API na [Githubu.](https://github.com/AzureADSamples)</span><span class="sxs-lookup"><span data-stu-id="821bd-191">See the related Graph API code samples on [GitHub.](https://github.com/AzureADSamples)</span></span>

## <a name="deploy-the-application-to-azure"></a><span data-ttu-id="821bd-192">Nasaďte aplikaci do Azure</span><span class="sxs-lookup"><span data-stu-id="821bd-192">Deploy the Application to Azure</span></span>

<span data-ttu-id="821bd-193">Následující kroky ukazují postup nasazení aplikace do Azure.</span><span class="sxs-lookup"><span data-stu-id="821bd-193">The following steps will show you how to deploy the application to Azure.</span></span> <span data-ttu-id="821bd-194">V dřívějších krocích nový projekt připojený s webovou aplikaci v Azure, takže je připravena k publikování v několika krocích.</span><span class="sxs-lookup"><span data-stu-id="821bd-194">In the earlier steps, you connected your new project with a web app on Azure, so it's ready to be published in just a few steps.</span></span>

1. <span data-ttu-id="821bd-195">V sadě Visual Studio, klikněte pravým tlačítkem na projekt a vyberte **publikovat**.</span><span class="sxs-lookup"><span data-stu-id="821bd-195">In Visual Studio, right-click on the project and select **Publish**.</span></span> <span data-ttu-id="821bd-196">**Publikovat Web** zobrazí se dialogové okno s každé nastavení již nakonfigurována.</span><span class="sxs-lookup"><span data-stu-id="821bd-196">The **Publish Web** dialog will appear with each setting already configured.</span></span> <span data-ttu-id="821bd-197">Klikněte na **Další** tlačítko přejdete k **nastavení** stránky.</span><span class="sxs-lookup"><span data-stu-id="821bd-197">Click on the **Next** button to go to the **Settings** page.</span></span> <span data-ttu-id="821bd-198">Můžete být vyzváni k ověření; Zajistěte, aby že ověření pomocí účtu předplatného Azure (obvykle účet Microsoft) a ne organizační účet, který jste vytvořili dříve.</span><span class="sxs-lookup"><span data-stu-id="821bd-198">You may be prompted to authenticate; make sure you authenticate using your Azure subscription account (typically a Microsoft account) and not the organizational account you created earlier.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image16.png)
2. <span data-ttu-id="821bd-199">Zkontrolujte **povolit ověřování organizace** možnost.</span><span class="sxs-lookup"><span data-stu-id="821bd-199">Check the **Enable Organizational Authentication** option.</span></span> <span data-ttu-id="821bd-200">V **domény** pole, zadejte doménu pro váš adresář.</span><span class="sxs-lookup"><span data-stu-id="821bd-200">In the **Domain** field, enter the domain for your directory.</span></span> <span data-ttu-id="821bd-201">Z **úroveň přístupu** rozevíracího seznamu, vyberte **jednotné přihlašování, čtení dat adresáře**.</span><span class="sxs-lookup"><span data-stu-id="821bd-201">From the **Access Level** drop-down, select **Single Sign On, Read directory data**.</span></span> <span data-ttu-id="821bd-202">Můžete si všimnout, že je v již zadána předchozí databáze, které jste použili **databáze** části.</span><span class="sxs-lookup"><span data-stu-id="821bd-202">You'll notice that the previous database you used is already populated in the **Databases** section.</span></span> <span data-ttu-id="821bd-203">Klikněte na tlačítko **publikování**.</span><span class="sxs-lookup"><span data-stu-id="821bd-203">Click **Publish**.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image17.png)
3. <span data-ttu-id="821bd-204">Visual Studio zahájíte nasazení webu a potom zobrazí se nové okno prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="821bd-204">Visual Studio will begin deploying your website, and then a new browser window will appear.</span></span> <span data-ttu-id="821bd-205">Zobrazí se výzva k ověření do vašeho adresáře ještě jednou.</span><span class="sxs-lookup"><span data-stu-id="821bd-205">You may be prompted to authenticate to your directory once again.</span></span> <span data-ttu-id="821bd-206">Jakmile jste ověření budete přesměrováni na přehled nově publikovaných webu v Azure.</span><span class="sxs-lookup"><span data-stu-id="821bd-206">Once you've authenticated, you'll be redirected to your newly published website on Azure.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image18.png)

<a id="dbg"></a>
## <a name="debugging-the-app"></a><span data-ttu-id="821bd-207">Ladění aplikace</span><span class="sxs-lookup"><span data-stu-id="821bd-207">Debugging the app</span></span>

<span data-ttu-id="821bd-208">Pokud dojde k následující chybě:</span><span class="sxs-lookup"><span data-stu-id="821bd-208">If you get the following error:</span></span>   
 <span data-ttu-id="821bd-209">Hodnota nemůže být null nebo prázdný.</span><span class="sxs-lookup"><span data-stu-id="821bd-209">Value cannot be null or empty.</span></span> <span data-ttu-id="821bd-210">Název parametru: linkText</span><span class="sxs-lookup"><span data-stu-id="821bd-210">Parameter name: linkText</span></span>   
   
![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image19.png)  
  

<span data-ttu-id="821bd-211">Nahraďte kód v *Views\Shared\\_LoginPartial.cshtml* soubor s následující:</span><span class="sxs-lookup"><span data-stu-id="821bd-211">Replace the code in the *Views\Shared\\_LoginPartial.cshtml* file with the following:</span></span>

[!code-cshtml[Main](developing-aspnet-apps-with-windows-azure-active-directory/samples/sample2.cshtml?highlight=1-8,15-16)]

<span data-ttu-id="821bd-212">Po spuštění aplikace, pokud má přihlášený uživatel zobrazuje "Null uživatel", odhlásit se a přihlaste zpět pomocí účtu služby Active Directory, kterou jste vytvořili dříve.</span><span class="sxs-lookup"><span data-stu-id="821bd-212">After running the app, if the logged in user shows "Null User", sign out, and sign back in with the Active Directory account you created earlier.</span></span>

<span data-ttu-id="821bd-213">Vynikající kurz a postupujte podle je Rick Rainey [podrobné informace: weby Azure a organizační ověřování pomocí služby Azure AD](http://rickrainey.com/2014/08/19/deep-dive-azure-websites-and-organizational-authentication-using-azure-ad/).</span><span class="sxs-lookup"><span data-stu-id="821bd-213">An excellent tutorial to follow is Rick Rainey's [Deep Dive: Azure Websites and Organizational Authentication using Azure AD](http://rickrainey.com/2014/08/19/deep-dive-azure-websites-and-organizational-authentication-using-azure-ad/).</span></span>

## <a name="more-information"></a><span data-ttu-id="821bd-214">Další informace</span><span class="sxs-lookup"><span data-stu-id="821bd-214">More Information</span></span>

- [<span data-ttu-id="821bd-215">Podrobné informace: Weby Azure a organizační ověřování pomocí služby Azure AD</span><span class="sxs-lookup"><span data-stu-id="821bd-215">Deep Dive: Azure Websites and Organizational Authentication using Azure AD</span></span>](http://rickrainey.com/2014/08/19/deep-dive-azure-websites-and-organizational-authentication-using-azure-ad/)
- [<span data-ttu-id="821bd-216">Přehled rozhraní API služby Azure AD Graph</span><span class="sxs-lookup"><span data-stu-id="821bd-216">Azure AD Graph API Overview</span></span>](https://msdn.microsoft.com/library/azure/hh974476.aspx)
- [<span data-ttu-id="821bd-217">Scénáře ověřování ve službě Azure AD</span><span class="sxs-lookup"><span data-stu-id="821bd-217">Authentication Scenarios in Azure AD</span></span>](https://msdn.microsoft.com/library/azure/dn499820.aspx)
- [<span data-ttu-id="821bd-218">Ukázky kódu Azure AD na Githubu</span><span class="sxs-lookup"><span data-stu-id="821bd-218">Azure AD Code Samples on GitHub</span></span>](https://github.com/AzureADSamples)
