---
uid: mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
title: "Iterace #5 – testů jednotek vytvořit (C#) | Microsoft Docs"
author: microsoft
description: "V páté iteraci jsme snadněji naše aplikace spravovat a upravovat přidáním testování částí. Jsme model třídy modelu našich dat a vytvářet testy částí pro o..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2009
ms.topic: article
ms.assetid: 28ad8f80-b8a5-444e-b478-8b15a846060c
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
msc.type: authoredcontent
ms.openlocfilehash: f9b2d05ec8756d68f6bd2f387c85faf03abd167e
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/10/2017
---
<a name="iteration-5--create-unit-tests-c"></a><span data-ttu-id="d5257-104">Iterace #5 – vytvoření testování částí (C#)</span><span class="sxs-lookup"><span data-stu-id="d5257-104">Iteration #5 – Create unit tests (C#)</span></span>
====================
<span data-ttu-id="d5257-105">podle [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="d5257-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="d5257-106">Stáhněte si kód</span><span class="sxs-lookup"><span data-stu-id="d5257-106">Download Code</span></span>](iteration-5-create-unit-tests-cs/_static/contactmanager_5_cs1.zip)

> <span data-ttu-id="d5257-107">V páté iteraci jsme snadněji naše aplikace spravovat a upravovat přidáním testování částí.</span><span class="sxs-lookup"><span data-stu-id="d5257-107">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="d5257-108">Jsme model třídy modelu našich dat a vytvářet testy částí pro naše řadiče a logiku ověření.</span><span class="sxs-lookup"><span data-stu-id="d5257-108">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>


## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="d5257-109">Vytvoření aplikace ASP.NET MVC správy kontaktů (C#)</span><span class="sxs-lookup"><span data-stu-id="d5257-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="d5257-110">Z této série kurzů využijeme celou aplikaci obraťte se na správu od začátku ukončíte.</span><span class="sxs-lookup"><span data-stu-id="d5257-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="d5257-111">Obraťte se na správce aplikace umožňuje ukládat kontaktní údaje - názvy, telefonní čísla a e-mailové adresy – seznam osob.</span><span class="sxs-lookup"><span data-stu-id="d5257-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="d5257-112">Přes několikrát jsme sestavení aplikace.</span><span class="sxs-lookup"><span data-stu-id="d5257-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="d5257-113">S každé iteraci jsme postupně zlepšení aplikace.</span><span class="sxs-lookup"><span data-stu-id="d5257-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="d5257-114">Cílem tohoto více iterace přístupu je vám umožní pochopit důvod pro každé změně.</span><span class="sxs-lookup"><span data-stu-id="d5257-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="d5257-115">Iterace #1 – Vytvoření aplikace.</span><span class="sxs-lookup"><span data-stu-id="d5257-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="d5257-116">V první iteraci vytvoříme obraťte se na správce v nejjednodušší způsob, jak to možné.</span><span class="sxs-lookup"><span data-stu-id="d5257-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="d5257-117">Nemůžeme přidat podporu pro základní databázových operací: vytvořit, číst, aktualizovat a odstranit (CRUD).</span><span class="sxs-lookup"><span data-stu-id="d5257-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="d5257-118">Iterace #2 – zpřístupnění aplikace vypadat dobrý.</span><span class="sxs-lookup"><span data-stu-id="d5257-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="d5257-119">V této iteraci můžeme vylepšit vzhled aplikace Úprava výchozí stránky předlohy zobrazení ASP.NET MVC a stylů CSS.</span><span class="sxs-lookup"><span data-stu-id="d5257-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="d5257-120">Iterace #3 – přidání ověřování formuláře.</span><span class="sxs-lookup"><span data-stu-id="d5257-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="d5257-121">V třetím iteraci přidáme ověření základní formulář.</span><span class="sxs-lookup"><span data-stu-id="d5257-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="d5257-122">Jsme zabránit neoprávněným osobám v odeslání formuláře bez dokončení vyžadovaná pole formuláře.</span><span class="sxs-lookup"><span data-stu-id="d5257-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="d5257-123">Můžeme také ověřit e-mailových adres a telefonních čísel.</span><span class="sxs-lookup"><span data-stu-id="d5257-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="d5257-124">Iterace #4 - li aplikaci volně vázány.</span><span class="sxs-lookup"><span data-stu-id="d5257-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="d5257-125">V této třetí iteraci jsme využít výhod několik softwaru vzory návrhu na bylo snazší spravovat a upravovat aplikace obraťte se na správce.</span><span class="sxs-lookup"><span data-stu-id="d5257-125">In this third iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="d5257-126">Například můžeme Refaktorovat naše aplikace pro použití vzoru úložiště a vzoru vkládání závislostí.</span><span class="sxs-lookup"><span data-stu-id="d5257-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="d5257-127">Iterace #5 – vytvoření testování částí.</span><span class="sxs-lookup"><span data-stu-id="d5257-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="d5257-128">V páté iteraci jsme snadněji naše aplikace spravovat a upravovat přidáním testování částí.</span><span class="sxs-lookup"><span data-stu-id="d5257-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="d5257-129">Jsme model třídy modelu našich dat a vytvářet testy částí pro naše řadiče a logiku ověření.</span><span class="sxs-lookup"><span data-stu-id="d5257-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="d5257-130">Iterace #6 - použití vývoje řízeného testováním.</span><span class="sxs-lookup"><span data-stu-id="d5257-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="d5257-131">V této šesté iteraci přidáme nové funkce pro naši aplikaci tak, že nejprve zápis testů částí a psaní kódu pro testování částí.</span><span class="sxs-lookup"><span data-stu-id="d5257-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="d5257-132">V této iteraci přidáme kontaktní skupiny.</span><span class="sxs-lookup"><span data-stu-id="d5257-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="d5257-133">Iterace #7 – přidání funkci Ajax.</span><span class="sxs-lookup"><span data-stu-id="d5257-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="d5257-134">V sedmého iteraci jsme přidáním podpory pro Ajax zvýšit rychlost reakce a výkon aplikace.</span><span class="sxs-lookup"><span data-stu-id="d5257-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>


## <a name="this-iteration"></a><span data-ttu-id="d5257-135">Tato iterace</span><span class="sxs-lookup"><span data-stu-id="d5257-135">This Iteration</span></span>

<span data-ttu-id="d5257-136">V předchozí iteraci aplikace, obraťte se na správce jsme rozdělili aplikaci se víc volně vázány.</span><span class="sxs-lookup"><span data-stu-id="d5257-136">In the previous iteration of the Contact Manager application, we refactored the application to be more loosely coupled.</span></span> <span data-ttu-id="d5257-137">Jsme oddělené aplikaci do různých řadič, služby a vrstvy úložiště.</span><span class="sxs-lookup"><span data-stu-id="d5257-137">We separated the application into distinct controller, service, and repository layers.</span></span> <span data-ttu-id="d5257-138">Jednotlivé úrovně komunikuje s vrstvy pod ním prostřednictvím rozhraní.</span><span class="sxs-lookup"><span data-stu-id="d5257-138">Each layer interacts with the layer beneath it through interfaces.</span></span>

<span data-ttu-id="d5257-139">Jsme rozdělili aplikace, abyste mohli snadněji spravovat a upravovat aplikace.</span><span class="sxs-lookup"><span data-stu-id="d5257-139">We refactored the application to make the application easier to maintain and modify.</span></span> <span data-ttu-id="d5257-140">Například pokud je potřeba použít novou technologií přístupu data, můžete nám jednoduše změnit vrstvy úložiště bez zásahu do řadiče nebo vrstva služby.</span><span class="sxs-lookup"><span data-stu-id="d5257-140">For example, if we need to use a new data access technology, we can simply change the repository layer without touching the controller or service layer.</span></span> <span data-ttu-id="d5257-141">Tím, že správce kontaktujte volně vázány, jsme sunout provedené aplikace odolnější vůči změnit.</span><span class="sxs-lookup"><span data-stu-id="d5257-141">By making the Contact Manager loosely coupled, we ve made the application more resilient to change.</span></span>

<span data-ttu-id="d5257-142">Ale co se stane, když je potřeba přidat novou funkci obraťte se na správce aplikace?</span><span class="sxs-lookup"><span data-stu-id="d5257-142">But, what happens when we need to add a new feature to the Contact Manager application?</span></span> <span data-ttu-id="d5257-143">Nebo, co se stane, když jsme oprava chyby?</span><span class="sxs-lookup"><span data-stu-id="d5257-143">Or, what happens when we fix a bug?</span></span> <span data-ttu-id="d5257-144">Sad, ale i Principy pravdivosti psaní kódu je, že vždy, když touch kódu vytvoříte nebezpečí nové chyby.</span><span class="sxs-lookup"><span data-stu-id="d5257-144">A sad, but well proven, truth of writing code is that whenever you touch code you create the risk of introducing new bugs.</span></span>

<span data-ttu-id="d5257-145">Například jemné jeden den, Správce může zobrazit dotaz můžete přidat nové funkce, obraťte se na správce.</span><span class="sxs-lookup"><span data-stu-id="d5257-145">For example, one fine day, your manager might ask you to add a new feature to the Contact Manager.</span></span> <span data-ttu-id="d5257-146">Jana chce můžete přidat podporu pro skupiny kontaktu.</span><span class="sxs-lookup"><span data-stu-id="d5257-146">She wants you to add support for Contact Groups.</span></span> <span data-ttu-id="d5257-147">Jana chce vám umožňuje uživatelům uspořádání jejich kontakty do skupin jako je například přátel, obchodních a tak dále.</span><span class="sxs-lookup"><span data-stu-id="d5257-147">She wants you to enable users to organize their contacts into groups such as Friends, Business, and so on.</span></span>

<span data-ttu-id="d5257-148">Chcete-li implementovat tuto novou funkci, budete muset upravit všechny tři vrstvy aplikace, obraťte se na správce.</span><span class="sxs-lookup"><span data-stu-id="d5257-148">In order to implement this new feature, you'll need to modify all three layers of the Contact Manager application.</span></span> <span data-ttu-id="d5257-149">Budete muset přidat další nové funkce v řadičích, vrstvě služby a úložiště.</span><span class="sxs-lookup"><span data-stu-id="d5257-149">You'll need to add new functionality to the controllers, the service layer, and the repository.</span></span> <span data-ttu-id="d5257-150">Jakmile začnete měnit kód, riskujete přerušení funkce, který odpracoval před.</span><span class="sxs-lookup"><span data-stu-id="d5257-150">As soon as you start modifying code, you risk breaking functionality that worked before.</span></span>

<span data-ttu-id="d5257-151">Refaktoring naše aplikace na samostatné vrstvy, jako jsme to udělali v předchozí iteraci byl dobré.</span><span class="sxs-lookup"><span data-stu-id="d5257-151">Refactoring our application into separate layers, as we did in the previous iteration, was a good thing.</span></span> <span data-ttu-id="d5257-152">Bylo dobré, protože umožňuje nám dělat změny na celý vrstvy bez zásahu zbývající aplikace.</span><span class="sxs-lookup"><span data-stu-id="d5257-152">It was a good thing because it enables us to make changes to entire layers without touching the rest of the application.</span></span> <span data-ttu-id="d5257-153">Ale pokud budete chtít snadněji spravovat a upravovat kód v rámci vrstvy, budete muset vytvářet testy částí pro kód.</span><span class="sxs-lookup"><span data-stu-id="d5257-153">However, if you want to make the code within a layer easier to maintain and modify, you need to create unit tests for the code.</span></span>

<span data-ttu-id="d5257-154">Můžete použít jinou jednotku testu jednotlivá jednotka kódu.</span><span class="sxs-lookup"><span data-stu-id="d5257-154">You use a unit test to test an individual unit of code.</span></span> <span data-ttu-id="d5257-155">Tyto jednotky kódu jsou menší než vrstvy celou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="d5257-155">These units of code are smaller than entire application layers.</span></span> <span data-ttu-id="d5257-156">Testování částí se obvykle používají k ověření, jestli konkrétní metoda ve vašem kódu chová očekávaným způsobem.</span><span class="sxs-lookup"><span data-stu-id="d5257-156">Typically, you use a unit test to verify whether a particular method in your code behaves in the way that you expect.</span></span> <span data-ttu-id="d5257-157">Například by vytvořit testů jednotek pro metodu CreateContact() vystavené ContactManagerService třídy.</span><span class="sxs-lookup"><span data-stu-id="d5257-157">For example, you would create a unit test for the CreateContact() method exposed by the ContactManagerService class.</span></span>

<span data-ttu-id="d5257-158">Testování částí pro pracovní aplikace, která je jenom jako bezpečnostní opatření.</span><span class="sxs-lookup"><span data-stu-id="d5257-158">The unit tests for an application work just like a safety net.</span></span> <span data-ttu-id="d5257-159">Vždy, když upravíte kódu v aplikaci, můžete spustit sadu testů jednotek pro zkontrolujte, zda úpravy dělí stávající funkce.</span><span class="sxs-lookup"><span data-stu-id="d5257-159">Whenever you modify code in an application, you can run a set of unit tests to check whether the modification breaks existing functionality.</span></span> <span data-ttu-id="d5257-160">Testování částí byl váš kód bezpečné upravit.</span><span class="sxs-lookup"><span data-stu-id="d5257-160">Unit tests make your code safe to modify.</span></span> <span data-ttu-id="d5257-161">Testování částí zajistěte všechny kódu v aplikaci odolnější vůči změnit.</span><span class="sxs-lookup"><span data-stu-id="d5257-161">Unit tests make all of the code in your application more resilient to change.</span></span>

<span data-ttu-id="d5257-162">V této iteraci přidáme testování částí pro naši aplikaci obraťte se na správce.</span><span class="sxs-lookup"><span data-stu-id="d5257-162">In this iteration, we add unit tests to our Contact Manager application.</span></span> <span data-ttu-id="d5257-163">Tímto způsobem v další iterace jsme můžete přidat skupiny obraťte se na naše aplikace bez obav o pozastavení stávající funkce.</span><span class="sxs-lookup"><span data-stu-id="d5257-163">That way, in the next iteration, we can add Contact Groups to our application without worrying about breaking existing functionality.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d5257-164">Existují různé platformy včetně NUnit, xUnit.net a MbUnit testování částí.</span><span class="sxs-lookup"><span data-stu-id="d5257-164">There are a variety of unit testing frameworks including NUnit, xUnit.net, and MbUnit.</span></span> <span data-ttu-id="d5257-165">V tomto kurzu používáme jednotky testování framework zahrnutá v sadě Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d5257-165">In this tutorial, we use the unit testing framework included with Visual Studio.</span></span> <span data-ttu-id="d5257-166">Však můžete stejným způsobem použít jednu z těchto alternativní architektury.</span><span class="sxs-lookup"><span data-stu-id="d5257-166">However, you could just as easily use one of these alternative frameworks.</span></span>


## <a name="what-gets-tested"></a><span data-ttu-id="d5257-167">Získá testů, které</span><span class="sxs-lookup"><span data-stu-id="d5257-167">What Gets Tested</span></span>

<span data-ttu-id="d5257-168">V ideálním veškerý kód by být pokryté komponentami testování částí.</span><span class="sxs-lookup"><span data-stu-id="d5257-168">In the perfect world, all of your code would be covered by unit tests.</span></span> <span data-ttu-id="d5257-169">V ideálním můžete být ideální bezpečnostní opatření.</span><span class="sxs-lookup"><span data-stu-id="d5257-169">In the perfect world, you would have the perfect safety net.</span></span> <span data-ttu-id="d5257-170">Bude moci upravit každý řádek kódu v aplikaci a okamžitě vědět, spuštěním testů jednotek, zda změna překročila stávající funkce.</span><span class="sxs-lookup"><span data-stu-id="d5257-170">You would be able to modify any line of code in your application and know instantly, by executing your unit tests, whether the change broke existing functionality.</span></span>

<span data-ttu-id="d5257-171">Ale jsme nejsou zobrazeny t za provozu v ideálním.</span><span class="sxs-lookup"><span data-stu-id="d5257-171">However, we don t live in a perfect world.</span></span> <span data-ttu-id="d5257-172">V praxi, když zápis testů částí které soustředit se jenom na zápis testů pro obchodní logiky (například logiku ověření).</span><span class="sxs-lookup"><span data-stu-id="d5257-172">In practice, when writing unit tests, you concentrate on writing tests for your business logic (for example, validation logic).</span></span> <span data-ttu-id="d5257-173">Konkrétně můžete *nepodporují* zápis testů částí data přístup logiky nebo logika zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d5257-173">In particular, you *do not* write unit tests for your data access logic or your view logic.</span></span>

<span data-ttu-id="d5257-174">Chcete-li být užitečné, třeba testy jednotek spustit velmi rychle.</span><span class="sxs-lookup"><span data-stu-id="d5257-174">To be useful, unit tests must execute very quickly.</span></span> <span data-ttu-id="d5257-175">Snadno můžete shromažďujete stovky (nebo dokonce tisíce) testování částí pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="d5257-175">You easily can accumulate hundreds (or even thousands) of unit tests for an application.</span></span> <span data-ttu-id="d5257-176">Pokud testy jednotek trvat dlouhou dobu spuštění budete vyhnout, jejich spuštění.</span><span class="sxs-lookup"><span data-stu-id="d5257-176">If the unit tests take a long time to run then you'll avoid executing them.</span></span> <span data-ttu-id="d5257-177">Jinými slovy dlouhotrvající testů jednotek jsou nepoužitelná pro účely kódování den.</span><span class="sxs-lookup"><span data-stu-id="d5257-177">In other words, long running unit tests are useless for day to day coding purposes.</span></span>

<span data-ttu-id="d5257-178">Z tohoto důvodu je obvykle Nezapisovat testy částí pro kód, který komunikuje s databází.</span><span class="sxs-lookup"><span data-stu-id="d5257-178">For this reason, you typically do not write unit tests for code that interacts with a database.</span></span> <span data-ttu-id="d5257-179">Spuštěným stovky testování částí pro online databáze může být příliš pomalé.</span><span class="sxs-lookup"><span data-stu-id="d5257-179">Running hundreds of unit tests against a live database would be too slow.</span></span> <span data-ttu-id="d5257-180">Místo toho model databáze a napsat kód, který komunikuje s databází imitované (probereme, že mocking databázi níže).</span><span class="sxs-lookup"><span data-stu-id="d5257-180">Instead, you mock your database and write code that interacts with the mock database (we discuss mocking a database below).</span></span>

<span data-ttu-id="d5257-181">Podobné z jiného důvodu je obvykle Nezapisovat testování částí pro zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d5257-181">For a similar reason, you typically do not write unit tests for views.</span></span> <span data-ttu-id="d5257-182">Chcete-li otestovat zobrazení, musí začne pracovat webovém serveru.</span><span class="sxs-lookup"><span data-stu-id="d5257-182">In order to test a view, you must spin up a web server.</span></span> <span data-ttu-id="d5257-183">Protože roztočený webový server je relativně pomalé proces, není doporučeno vytvářet testy částí pro zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d5257-183">Because spinning up a web server is a relatively slow process, creating unit tests for your views is not recommended.</span></span>

<span data-ttu-id="d5257-184">Pokud zobrazení obsahuje složitý logiku měli zvážit, přesun logiku do pomocné metody.</span><span class="sxs-lookup"><span data-stu-id="d5257-184">If your view contains complicated logic then you should consider moving the logic into Helper methods.</span></span> <span data-ttu-id="d5257-185">Můžete napsat testy částí pro pomocné metody, které se provedou bez roztočený webový server.</span><span class="sxs-lookup"><span data-stu-id="d5257-185">You can write unit tests for Helper methods that execute without spinning up a web server.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d5257-186">Při psaní testů pro logiku data přístup, nebo zobrazení logiku není vhodné při zápis testů částí při sestavování funkční nebo integrace testů může být velmi cenné tyto testy.</span><span class="sxs-lookup"><span data-stu-id="d5257-186">While writing tests for data access logic or view logic is not a good idea when writing unit tests, these tests can be very valuable when building functional or integration tests.</span></span>


> [!NOTE] 
> 
> <span data-ttu-id="d5257-187">ASP.NET MVC je modul zobrazení webových formulářů.</span><span class="sxs-lookup"><span data-stu-id="d5257-187">ASP.NET MVC is the Web Forms View Engine.</span></span> <span data-ttu-id="d5257-188">Zatímco modul Web Forms zobrazení je závislé na webovém serveru, nemusí být další moduly zobrazení.</span><span class="sxs-lookup"><span data-stu-id="d5257-188">While the Web Forms View Engine is dependent on a web server, other view engines might not be.</span></span>


## <a name="using-a-mock-object-framework"></a><span data-ttu-id="d5257-189">Pomocí rozhraní Mock objektu</span><span class="sxs-lookup"><span data-stu-id="d5257-189">Using a Mock Object Framework</span></span>

<span data-ttu-id="d5257-190">Při vytváření testů jednotek, musíte téměř vždy využít architekturu model objektu.</span><span class="sxs-lookup"><span data-stu-id="d5257-190">When building unit tests, you almost always need to take advantage of a Mock Object framework.</span></span> <span data-ttu-id="d5257-191">Model objektu rozhraní umožňuje vytvářet mocks a zástupných procedur pro třídy v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="d5257-191">A Mock Object framework enables you to create mocks and stubs for the classes in your application.</span></span>

<span data-ttu-id="d5257-192">Například můžete použít model objektu rozhraní k vygenerování verzi mock vaší třídy úložiště.</span><span class="sxs-lookup"><span data-stu-id="d5257-192">For example, you can use a Mock Object framework to generate a mock version of your repository class.</span></span> <span data-ttu-id="d5257-193">Tímto způsobem třídu imitované úložiště můžete použít místo třídu skutečné úložiště v testů jednotek.</span><span class="sxs-lookup"><span data-stu-id="d5257-193">That way, you can use the mock repository class instead of the real repository class in your unit tests.</span></span> <span data-ttu-id="d5257-194">Pomocí mock úložiště umožňuje vyhnout se provádění kódu databáze při provádění testů jednotek.</span><span class="sxs-lookup"><span data-stu-id="d5257-194">Using the mock repository enables you to avoid executing database code when executing a unit test.</span></span>

<span data-ttu-id="d5257-195">Visual Studio nezahrnuje framework model objektu.</span><span class="sxs-lookup"><span data-stu-id="d5257-195">Visual Studio does not include a Mock Object framework.</span></span> <span data-ttu-id="d5257-196">Existuje však několik architektury model objektu komerční s otevřeným zdrojem k dispozici pro rozhraní .NET framework:</span><span class="sxs-lookup"><span data-stu-id="d5257-196">However, there are several commercial and open source Mock Object frameworks available for the .NET framework:</span></span>

1. <span data-ttu-id="d5257-197">Moq – toto rozhraní je k dispozici v rámci licence BSD s otevřeným zdrojem.</span><span class="sxs-lookup"><span data-stu-id="d5257-197">Moq - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="d5257-198">Můžete si stáhnout Moq z [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span><span class="sxs-lookup"><span data-stu-id="d5257-198">You can download Moq from [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span></span>
2. <span data-ttu-id="d5257-199">Rhino Mocks – toto rozhraní je k dispozici v části s otevřeným zdrojem BSD licencí.</span><span class="sxs-lookup"><span data-stu-id="d5257-199">Rhino Mocks - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="d5257-200">Můžete si stáhnout Rhino Mocks z [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span><span class="sxs-lookup"><span data-stu-id="d5257-200">You can download Rhino Mocks from [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span></span>
3. <span data-ttu-id="d5257-201">Typemock Odpojovač - Toto je komerční framework.</span><span class="sxs-lookup"><span data-stu-id="d5257-201">Typemock Isolator - This is a commercial framework.</span></span> <span data-ttu-id="d5257-202">Můžete si stáhnout zkušební verzi z [http://www.typemock.com/](http://www.typemock.com/).</span><span class="sxs-lookup"><span data-stu-id="d5257-202">You can download a trial version from [http://www.typemock.com/](http://www.typemock.com/).</span></span>

<span data-ttu-id="d5257-203">V tomto kurzu rozhodli používat Moq.</span><span class="sxs-lookup"><span data-stu-id="d5257-203">In this tutorial, I decided to use Moq.</span></span> <span data-ttu-id="d5257-204">Ale můžete stejným způsobem použít Rhino Mocks nebo Typemock Odpojovač vytvořit model objektů aplikace obraťte se na správce.</span><span class="sxs-lookup"><span data-stu-id="d5257-204">However, you could just as easily use Rhino Mocks or Typemock Isolator to create the Mock objects for the Contact Manager application.</span></span>

<span data-ttu-id="d5257-205">Než budete moct použít Moq, je třeba provést následující kroky:</span><span class="sxs-lookup"><span data-stu-id="d5257-205">Before you can use Moq, you need to complete the following steps:</span></span>

1. <span data-ttu-id="d5257-206">.</span><span class="sxs-lookup"><span data-stu-id="d5257-206">.</span></span>
2. <span data-ttu-id="d5257-207">Předtím, než jste rozbalte stahování, ujistěte se, klikněte pravým tlačítkem na soubor a klikněte na tlačítko s názvem bez přípony **Odblokovat** (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="d5257-207">Before you unzip the download, make sure that you right-click the file and click the button labeled **Unblock** (see Figure 1).</span></span>
3. <span data-ttu-id="d5257-208">Rozbalte stahování.</span><span class="sxs-lookup"><span data-stu-id="d5257-208">Unzip the download.</span></span>
4. <span data-ttu-id="d5257-209">Přidat odkaz na sestavení Moq pravým tlačítkem na složku odkazů v projektu ContactManager.Tests a výběrem **přidat odkaz na**.</span><span class="sxs-lookup"><span data-stu-id="d5257-209">Add a reference to the Moq assembly by right-clicking the References folder in the ContactManager.Tests project and selecting **Add Reference**.</span></span> <span data-ttu-id="d5257-210">Na kartě Procházet přejděte do složky, kde jste rozbalené Moq a vyberte Moq.dll sestavení.</span><span class="sxs-lookup"><span data-stu-id="d5257-210">Under the Browse tab, browse to the folder where you unzipped Moq and select the Moq.dll assembly.</span></span> <span data-ttu-id="d5257-211">Klikněte **OK** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="d5257-211">Click the **OK** button.</span></span>
5. <span data-ttu-id="d5257-212">Po dokončení těchto kroků složce odkazy by měl vypadat jako na obrázku 2.</span><span class="sxs-lookup"><span data-stu-id="d5257-212">After you complete these steps, your References folder should look like Figure 2.</span></span>


<span data-ttu-id="d5257-213">[![Odblokování Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d5257-213">[![Unblocking Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span></span>

<span data-ttu-id="d5257-214">**Obrázek 01**: odblokování Moq ([Kliknutím zobrazit obrázek v plné velikosti](iteration-5-create-unit-tests-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="d5257-214">**Figure 01**: Unblocking Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image2.png))</span></span>


<span data-ttu-id="d5257-215">[![Po přidání Moq odkazy](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d5257-215">[![References after adding Moq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span></span>

<span data-ttu-id="d5257-216">**Obrázek 02**: odkazy po přidání Moq ([Kliknutím zobrazit obrázek v plné velikosti](iteration-5-create-unit-tests-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d5257-216">**Figure 02**: References after adding Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image4.png))</span></span>


## <a name="creating-unit-tests-for-the-service-layer"></a><span data-ttu-id="d5257-217">Testování částí pro vrstvu služby</span><span class="sxs-lookup"><span data-stu-id="d5257-217">Creating Unit Tests for the Service Layer</span></span>

<span data-ttu-id="d5257-218">Umožní s začněte vytvořením sadu testů jednotek pro vrstvu služby s aplikací naše obraťte se na správce.</span><span class="sxs-lookup"><span data-stu-id="d5257-218">Let s start by creating a set of unit tests for our Contact Manager application s service layer.</span></span> <span data-ttu-id="d5257-219">Chcete-li ověřit ověřovací logiku použijeme tyto testy.</span><span class="sxs-lookup"><span data-stu-id="d5257-219">We'll use these tests to verify our validation logic.</span></span>

<span data-ttu-id="d5257-220">Vytvořte novou složku s názvem modely v ContactManager.Tests projektu.</span><span class="sxs-lookup"><span data-stu-id="d5257-220">Create a new folder named Models in the ContactManager.Tests project.</span></span> <span data-ttu-id="d5257-221">V dalším kroku klikněte pravým tlačítkem na složku modely a vyberte **přidat, nový Test**.</span><span class="sxs-lookup"><span data-stu-id="d5257-221">Next, right-click the Models folder and select **Add, New Test**.</span></span> <span data-ttu-id="d5257-222">**Přidat nový Test** otevře se dialogové okno znázorněný na obrázku 3.</span><span class="sxs-lookup"><span data-stu-id="d5257-222">The **Add New Test** dialog shown in Figure 3 appears.</span></span> <span data-ttu-id="d5257-223">Vyberte **jednotkové testování** šablony a pojmenujte nový test ContactManagerServiceTest.cs.</span><span class="sxs-lookup"><span data-stu-id="d5257-223">Select the **Unit Test** template and name your new test ContactManagerServiceTest.cs.</span></span> <span data-ttu-id="d5257-224">Klikněte **OK** tlačítko přidáte nový test pro projekt Test.</span><span class="sxs-lookup"><span data-stu-id="d5257-224">Click the **OK** button to add your new test to your Test Project.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d5257-225">Obecně platí budete chtít struktura složek testovacího projektu tak, aby odpovídaly struktura složek projektu ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="d5257-225">In general, you want the folder structure of your Test Project to match the folder structure of your ASP.NET MVC project.</span></span> <span data-ttu-id="d5257-226">Například řadič testy umístit do složky řadiče, model testů ve složce modely a tak dále.</span><span class="sxs-lookup"><span data-stu-id="d5257-226">For example, you place controller tests in a Controllers folder, model tests in a Models folder, and so on.</span></span>


<span data-ttu-id="d5257-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d5257-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span></span>

<span data-ttu-id="d5257-228">**Obrázek 03**: Models\ContactManagerServiceTest.cs ([Kliknutím zobrazit obrázek v plné velikosti](iteration-5-create-unit-tests-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d5257-228">**Figure 03**: Models\ContactManagerServiceTest.cs([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image6.png))</span></span>


<span data-ttu-id="d5257-229">Na začátku chceme test CreateContact() metody vystavené ContactManagerService třídy.</span><span class="sxs-lookup"><span data-stu-id="d5257-229">Initially, we want to test the CreateContact() method exposed by the ContactManagerService class.</span></span> <span data-ttu-id="d5257-230">Vytvoříme následujících pět testů:</span><span class="sxs-lookup"><span data-stu-id="d5257-230">We'll create the following five tests:</span></span>

- <span data-ttu-id="d5257-231">CreateContact() - testy této CreateContact() vrátí hodnotu true, pokud je platný kontakt předaný metodě.</span><span class="sxs-lookup"><span data-stu-id="d5257-231">CreateContact() - Tests that CreateContact() returns the value true when a valid Contact is passed to the method.</span></span>
- <span data-ttu-id="d5257-232">CreateContactRequiredFirstName() - testy, zda je přidána chybová zpráva do stavu modelu, když kontakt s chybějící křestní jméno je předaný metodě CreateContact().</span><span class="sxs-lookup"><span data-stu-id="d5257-232">CreateContactRequiredFirstName() - Tests that an error message is added to model state when a Contact with a missing first name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d5257-233">CreateContactRequredLastName() - testy, zda je přidána chybová zpráva do stavu modelu, když kontakt s chybějící příjmení je předaný metodě CreateContact().</span><span class="sxs-lookup"><span data-stu-id="d5257-233">CreateContactRequredLastName() - Tests that an error message is added to model state when a Contact with a missing last name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d5257-234">CreateContactInvalidPhone() - testy, zda je přidána chybová zpráva do stavu modelu, když kontakt s neplatným telefonním číslem je předaný metodě CreateContact().</span><span class="sxs-lookup"><span data-stu-id="d5257-234">CreateContactInvalidPhone() - Tests that an error message is added to model state when a Contact with an invalid phone number is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d5257-235">CreateContactInvalidEmail() - testy, zda je přidána chybová zpráva do stavu modelu, když kontakt s neplatnou e-mailovou adresou je předaný metodě CreateContact()...</span><span class="sxs-lookup"><span data-stu-id="d5257-235">CreateContactInvalidEmail() - Tests that an error message is added to model state when a Contact with an invalid email address is passed to the CreateContact() method..</span></span>

<span data-ttu-id="d5257-236">První test ověřuje, že a obraťte se na platný nevygeneruje chybu ověření.</span><span class="sxs-lookup"><span data-stu-id="d5257-236">The first test verifies that a valid Contact does not generate a validation error.</span></span> <span data-ttu-id="d5257-237">Zbývající testy zkontrolujte jednotlivých pravidel ověřování.</span><span class="sxs-lookup"><span data-stu-id="d5257-237">The remaining tests check each of the validation rules.</span></span>

<span data-ttu-id="d5257-238">Kód pro tyto testy je obsažený v výpis 1.</span><span class="sxs-lookup"><span data-stu-id="d5257-238">The code for these tests is contained in Listing 1.</span></span>

<span data-ttu-id="d5257-239">**Výpis 1 - Models\ContactManagerServiceTest.cs**</span><span class="sxs-lookup"><span data-stu-id="d5257-239">**Listing 1 - Models\ContactManagerServiceTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample1.cs)]


<span data-ttu-id="d5257-240">Protože třída kontaktu jsme se používá v výpis 1, je potřeba přidat odkaz na rozhraní Entity Framework Microsoft do našich testovacího projektu.</span><span class="sxs-lookup"><span data-stu-id="d5257-240">Because we use the Contact class in Listing 1, we need to add a reference to the Microsoft Entity Framework to our Test project.</span></span> <span data-ttu-id="d5257-241">Přidáte odkaz na sestavení System.Data.Entity.</span><span class="sxs-lookup"><span data-stu-id="d5257-241">Add a reference to the System.Data.Entity assembly.</span></span>


<span data-ttu-id="d5257-242">Výpis 1 obsahuje metodu s názvem inicializaci(), který je upraven pomocí atributu [TestInitialize].</span><span class="sxs-lookup"><span data-stu-id="d5257-242">Listing 1 contains a method named Initialize() that is decorated with the [TestInitialize] attribute.</span></span> <span data-ttu-id="d5257-243">Tato metoda je volána automaticky, než se spustí všechny testy jednotek (nazývá se 5krát bezprostředně před všechny testy jednotek).</span><span class="sxs-lookup"><span data-stu-id="d5257-243">This method is called automatically before each of the unit tests is run (it is called 5 times right before each of the unit tests).</span></span> <span data-ttu-id="d5257-244">Metoda inicializaci() vytvoří imitované úložiště s následující řádek kódu:</span><span class="sxs-lookup"><span data-stu-id="d5257-244">The Initialize() method creates a mock repository with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample2.cs)]

<span data-ttu-id="d5257-245">Tento řádek kódu používá ke generování imitované úložiště z rozhraní IContactManagerRepository Moq framework.</span><span class="sxs-lookup"><span data-stu-id="d5257-245">This line of code uses the Moq framework to generate a mock repository from the IContactManagerRepository interface.</span></span> <span data-ttu-id="d5257-246">Imitované úložiště se používá namísto skutečné EntityContactManagerRepository předejdete přístup k databázi, když se spustí každý testování částí.</span><span class="sxs-lookup"><span data-stu-id="d5257-246">The mock repository is used instead of the actual EntityContactManagerRepository to avoid accessing the database when each unit test is run.</span></span> <span data-ttu-id="d5257-247">Implementuje metodu rozhraní IContactManagerRepository imitované úložiště, ale t Tento metody ve skutečnosti provádět žádné kroky.</span><span class="sxs-lookup"><span data-stu-id="d5257-247">The mock repository implements the methods of the IContactManagerRepository interface, but the methods don t actually do anything.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d5257-248">Pokud používáte Moq framework, je rozdíl mezi \_mockRepository a \_mockRepository.Object.</span><span class="sxs-lookup"><span data-stu-id="d5257-248">When using the Moq framework, there is a distinction between \_mockRepository and \_mockRepository.Object.</span></span> <span data-ttu-id="d5257-249">Bývalé odkazuje model&lt;IContactManagerRepository&gt; třídu, která obsahuje metody pro určení, jak se bude chovat imitované úložiště.</span><span class="sxs-lookup"><span data-stu-id="d5257-249">The former refers to the Mock&lt;IContactManagerRepository&gt; class that contains methods for specifying how the mock repository will behave.</span></span> <span data-ttu-id="d5257-250">K tomu odkazuje na skutečnou imitované úložiště, který implementuje rozhraní IContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="d5257-250">The latter refers to the actual mock repository that implements the IContactManagerRepository interface.</span></span>


<span data-ttu-id="d5257-251">Imitované úložiště se používá v metodě inicializaci() při vytváření instance třídy ContactManagerService.</span><span class="sxs-lookup"><span data-stu-id="d5257-251">The mock repository is used in the Initialize() method when creating an instance of the ContactManagerService class.</span></span> <span data-ttu-id="d5257-252">Všechny testy jednotlivých jednotek použít tuto instanci třídy ContactManagerService.</span><span class="sxs-lookup"><span data-stu-id="d5257-252">All of the individual unit tests use this instance of the ContactManagerService class.</span></span>

<span data-ttu-id="d5257-253">Výpis 1 obsahuje pět metody, které odpovídají jednotlivým testování částí.</span><span class="sxs-lookup"><span data-stu-id="d5257-253">Listing 1 contains five methods that correspond to each of the unit tests.</span></span> <span data-ttu-id="d5257-254">Každá z těchto metod opatřen atributem [TestMethod].</span><span class="sxs-lookup"><span data-stu-id="d5257-254">Each of these methods is decorated with the [TestMethod] attribute.</span></span> <span data-ttu-id="d5257-255">Při spuštění testování částí, se nazývá libovolné metody, která má tento atribut.</span><span class="sxs-lookup"><span data-stu-id="d5257-255">When you run the unit tests, any method that has this attribute is called.</span></span> <span data-ttu-id="d5257-256">Jinými slovy libovolné metody, která opatřen atributem [TestMethod] je testování částí.</span><span class="sxs-lookup"><span data-stu-id="d5257-256">In other words, any method that is decorated with the [TestMethod] attribute is a unit test.</span></span>

<span data-ttu-id="d5257-257">První testování částí s názvem CreateContact(), ověřuje, že volání CreateContact() vrátí hodnotu true, pokud je platnou instanci třídy, obraťte se na předaný metodě.</span><span class="sxs-lookup"><span data-stu-id="d5257-257">The first unit test, named CreateContact(), verifies that calling CreateContact() returns the value true when a valid instance of the Contact class is passed to the method.</span></span> <span data-ttu-id="d5257-258">Test vytvoří instanci třídy kontaktu, volá metodu CreateContact() a ověřuje, že CreateContact() vrátí hodnotu true.</span><span class="sxs-lookup"><span data-stu-id="d5257-258">The test creates an instance of the Contact class, calls the CreateContact() method, and verifies that CreateContact() returns the value true.</span></span>

<span data-ttu-id="d5257-259">Zbývající testy ověřte, zda při volání metody CreateContact() neplatný kontaktují potom metoda vrátí hodnotu false a stav modelu, který je přidána chybová zpráva ověření očekávané.</span><span class="sxs-lookup"><span data-stu-id="d5257-259">The remaining tests verify that when the CreateContact() method is called with an invalid Contact then the method returns false and the expected validation error message is added to model state.</span></span> <span data-ttu-id="d5257-260">Například CreateContactRequiredFirstName() test vytvoří instanci třídy, obraťte se s prázdný řetězec pro vlastnost jeho FirstName.</span><span class="sxs-lookup"><span data-stu-id="d5257-260">For example, the CreateContactRequiredFirstName() test creates an instance of the Contact class with an empty string for its FirstName property.</span></span> <span data-ttu-id="d5257-261">V dalším kroku CreateContact() metoda volána s neplatnou kontakt.</span><span class="sxs-lookup"><span data-stu-id="d5257-261">Next, the CreateContact() method is called with the invalid Contact.</span></span> <span data-ttu-id="d5257-262">Nakonec test ověřuje, že CreateContact() vrací hodnotu false a že stav modelu, který obsahuje chybovou zprávu ověření očekávané "jméno je povinné."</span><span class="sxs-lookup"><span data-stu-id="d5257-262">Finally, the test verifies that CreateContact() returns false and that model state contains the expected validation error message "First name is required."</span></span>

<span data-ttu-id="d5257-263">Testování částí v výpis 1 můžete spustit výběrem možnosti nabídky **Test, spustit všechny testy v řešení (CTRL + R, A)**.</span><span class="sxs-lookup"><span data-stu-id="d5257-263">You can run the unit tests in Listing 1 by selecting the menu option **Test, Run, All Tests in Solution (CTRL+R, A)**.</span></span> <span data-ttu-id="d5257-264">Výsledky testů se zobrazí v okně výsledků testu (viz obrázek 4).</span><span class="sxs-lookup"><span data-stu-id="d5257-264">The results of the tests are displayed in the Test Results window (see Figure 4).</span></span>


<span data-ttu-id="d5257-265">[![Výsledky testu](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d5257-265">[![Test Results](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span></span>

<span data-ttu-id="d5257-266">**Obrázek 04**: výsledky testu ([Kliknutím zobrazit obrázek v plné velikosti](iteration-5-create-unit-tests-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d5257-266">**Figure 04**: Test Results ([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image8.png))</span></span>


## <a name="creating-unit-tests-for-controllers"></a><span data-ttu-id="d5257-267">Testování částí pro řadiče</span><span class="sxs-lookup"><span data-stu-id="d5257-267">Creating Unit Tests for Controllers</span></span>

<span data-ttu-id="d5257-268">Aplikace ASP.NETMVC řízení toku interakce s uživatelem.</span><span class="sxs-lookup"><span data-stu-id="d5257-268">ASP.NETMVC application control the flow of user interaction.</span></span> <span data-ttu-id="d5257-269">Při testování řadič, budete chtít otestovat, zda řadičem vrací pravé akce výsledek a zobrazení data.</span><span class="sxs-lookup"><span data-stu-id="d5257-269">When testing a controller, you want to test whether the controller returns the right action result and view data.</span></span> <span data-ttu-id="d5257-270">Můžete také chtít otestovat, zda řadič komunikuje s třídy modelu způsobem očekává.</span><span class="sxs-lookup"><span data-stu-id="d5257-270">You also might want to test whether a controller interacts with model classes in the manner expected.</span></span>

<span data-ttu-id="d5257-271">Například výpis 2 obsahuje dvě testování částí pro kontaktujte řadič Create() metoda.</span><span class="sxs-lookup"><span data-stu-id="d5257-271">For example, Listing 2 contains two unit tests for the Contact controller Create() method.</span></span> <span data-ttu-id="d5257-272">První testování částí ověřuje, že když a obraťte se na platný předána metodě Create() pak metodu Create() přesměruje na Index akci.</span><span class="sxs-lookup"><span data-stu-id="d5257-272">The first unit test verifies that when a valid Contact is passed to the Create() method then the Create() method redirects to the Index action.</span></span> <span data-ttu-id="d5257-273">Jinými slovy když uplyne a obraťte se na platný, Metoda Create() by měl vrátit RedirectToRouteResult, která představuje akci Index.</span><span class="sxs-lookup"><span data-stu-id="d5257-273">In other words, when passed a valid Contact, the Create() method should return a RedirectToRouteResult that represents the Index action.</span></span>

<span data-ttu-id="d5257-274">Jsme nejsou zobrazeny chcete t testování vrstvě služby ContactManager, když se testují vrstvě řadiče.</span><span class="sxs-lookup"><span data-stu-id="d5257-274">We don t want to test the ContactManager service layer when we are testing the controller layer.</span></span> <span data-ttu-id="d5257-275">Proto jsme model vrstvy služby s následující kód v metodě inicializovat:</span><span class="sxs-lookup"><span data-stu-id="d5257-275">Therefore, we mock the service layer with the following code in the Initialize method:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample3.cs)]

<span data-ttu-id="d5257-276">V testu jednotek CreateValidContact() můžeme model chování volání vrstvě služby CreateContact() metoda s následující řádek kódu:</span><span class="sxs-lookup"><span data-stu-id="d5257-276">In the CreateValidContact() unit test, we mock the behavior of calling the service layer CreateContact() method with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample4.cs)]

<span data-ttu-id="d5257-277">Tento řádek kódu způsobí, že služba imitované ContactManager vrátí hodnotu true v případě jeho CreateContact() metoda je volána.</span><span class="sxs-lookup"><span data-stu-id="d5257-277">This line of code causes the mock ContactManager service to return the value true when its CreateContact() method is called.</span></span> <span data-ttu-id="d5257-278">Ve vrstvě služby mocking, abychom mohli otestovat chování kontroleru bez nutnosti spouštět všechny kód ve vrstvě služby.</span><span class="sxs-lookup"><span data-stu-id="d5257-278">By mocking the service layer, we can test the behavior of our controller without needing to execute any code in the service layer.</span></span>

<span data-ttu-id="d5257-279">Druhý testování částí ověřuje, že akce Create() vrátí zobrazení pro vytváření, pokud je neplatný kontaktujte předaný metodě.</span><span class="sxs-lookup"><span data-stu-id="d5257-279">The second unit test verifies that the Create() action returns the Create view when an invalid contact is passed to the method.</span></span> <span data-ttu-id="d5257-280">Jsme způsobit vrstvě služby CreateContact() metoda vrátí hodnotu false s následující řádek kódu:</span><span class="sxs-lookup"><span data-stu-id="d5257-280">We cause the service layer CreateContact() method to return the value false with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample5.cs)]

<span data-ttu-id="d5257-281">Pokud Metoda Create() chová jako Očekáváme, měla by při vrstvě služby vrátí hodnotu false vrátit zobrazení pro vytváření.</span><span class="sxs-lookup"><span data-stu-id="d5257-281">If the Create() method behaves as we expect then it should return the Create view when the service layer returns the value false.</span></span> <span data-ttu-id="d5257-282">Tímto způsobem řadičem můžete zobrazit chybové zprávy ověření v zobrazení pro vytváření a uživatel má možnost opravit tento neplatné obraťte se na vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="d5257-282">That way, the controller can display the validation error messages in the Create view and the user has a chance to correct that invalid Contact properties.</span></span>


<span data-ttu-id="d5257-283">Pokud máte v plánu vytvářet testy částí pro řadičů budete muset vrátit zobrazení explicitní názvy z vaší akce kontroleru.</span><span class="sxs-lookup"><span data-stu-id="d5257-283">If you plan to build unit tests for your controllers then you need to return explicit view names from your controller actions.</span></span> <span data-ttu-id="d5257-284">Například nevrátí zobrazení takto:</span><span class="sxs-lookup"><span data-stu-id="d5257-284">For example, do not return a view like this:</span></span>

<span data-ttu-id="d5257-285">Vrátí View();</span><span class="sxs-lookup"><span data-stu-id="d5257-285">return View();</span></span>

<span data-ttu-id="d5257-286">Místo toho vrátíte zobrazení takto:</span><span class="sxs-lookup"><span data-stu-id="d5257-286">Instead, return the view like this:</span></span>

<span data-ttu-id="d5257-287">Vrátí View("Create");</span><span class="sxs-lookup"><span data-stu-id="d5257-287">return View("Create");</span></span>

<span data-ttu-id="d5257-288">Pokud si nejste explicitní při vrácení zobrazení ViewResult.ViewName vlastnost vrací prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="d5257-288">If you are not explicit when returning a view then the ViewResult.ViewName property returns an empty string.</span></span>


<span data-ttu-id="d5257-289">**Výpis 2 - Controllers\ContactControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="d5257-289">**Listing 2 - Controllers\ContactControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample6.cs)]

## <a name="summary"></a><span data-ttu-id="d5257-290">Souhrn</span><span class="sxs-lookup"><span data-stu-id="d5257-290">Summary</span></span>

<span data-ttu-id="d5257-291">V této iteraci jsme vytvořili testování částí pro naši aplikaci obraťte se na správce.</span><span class="sxs-lookup"><span data-stu-id="d5257-291">In this iteration, we created unit tests for our Contact Manager application.</span></span> <span data-ttu-id="d5257-292">Tyto testy jednotek jsme můžete spustit kdykoli ověřit, že naše aplikace stále chová způsobem, který se očekává.</span><span class="sxs-lookup"><span data-stu-id="d5257-292">We can run these unit tests at any time to verify that our application still behaves in the manner that we expect.</span></span> <span data-ttu-id="d5257-293">Testování částí fungují jako bezpečnostní opatření pro naši aplikaci to nám bezpečně upravit aplikaci v budoucnu.</span><span class="sxs-lookup"><span data-stu-id="d5257-293">The unit tests act as a safety net for our application enabling us to safely modify our application in the future.</span></span>

<span data-ttu-id="d5257-294">Jsme vytvořili dvě sady testů jednotek.</span><span class="sxs-lookup"><span data-stu-id="d5257-294">We created two sets of unit tests.</span></span> <span data-ttu-id="d5257-295">Nejdřív jsme testovali ověřovací logiku vytvořením testování částí pro naše vrstvu služby.</span><span class="sxs-lookup"><span data-stu-id="d5257-295">First, we tested our validation logic by creating unit tests for our service layer.</span></span> <span data-ttu-id="d5257-296">V dalším kroku jsme testovali logiku řízení toku vytvořením testování částí pro naše řadiče vrstvu.</span><span class="sxs-lookup"><span data-stu-id="d5257-296">Next, we tested our flow control logic by creating unit tests for our controller layer.</span></span> <span data-ttu-id="d5257-297">Při testování naše vrstvy služby, jsme izolované naše testy pro naše vrstvu služby z našich vrstvy úložiště mocking naše vrstvy úložiště.</span><span class="sxs-lookup"><span data-stu-id="d5257-297">When testing our service layer, we isolated our tests for our service layer from our repository layer by mocking our repository layer.</span></span> <span data-ttu-id="d5257-298">Při testování vrstvě řadiče, jsme izolované naše testy pro naše vrstvu řadič mocking vrstvě služby.</span><span class="sxs-lookup"><span data-stu-id="d5257-298">When testing the controller layer, we isolated our tests for our controller layer by mocking the service layer.</span></span>

<span data-ttu-id="d5257-299">V další iterace jsme upravit aplikaci obraťte se na správce, tak, aby podporoval skupiny kontaktu.</span><span class="sxs-lookup"><span data-stu-id="d5257-299">In the next iteration, we modify the Contact Manager application so that it supports Contact Groups.</span></span> <span data-ttu-id="d5257-300">Tato nová funkce přidáme do aplikace pomocí procesu návrhu softwaru s názvem testy řízený vývoj.</span><span class="sxs-lookup"><span data-stu-id="d5257-300">We'll add this new functionality to our application using a software design process called test-driven development.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="d5257-301">[Předchozí](iteration-4-make-the-application-loosely-coupled-cs.md)
[další](iteration-6-use-test-driven-development-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d5257-301">[Previous](iteration-4-make-the-application-loosely-coupled-cs.md)
[Next](iteration-6-use-test-driven-development-cs.md)</span></span>
