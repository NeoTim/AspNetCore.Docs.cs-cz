---
uid: mvc/overview/getting-started/database-first-development/setting-up-database
title: 'Kurz: Začínáme s EF Database First pomocí MVC 5'
description: Tento kurz ukazuje, jak začít s existující databáze a rychle vytvořit webovou aplikaci, která umožňuje uživatelům interakci s daty.
author: Rick-Anderson
ms.author: riande
ms.date: 01/28/2019
ms.topic: tutorial
ms.assetid: 095abad4-3bfe-4f06-b092-ae6a735b7e49
msc.legacyurl: /mvc/overview/getting-started/database-first-development/setting-up-database
msc.type: authoredcontent
ms.openlocfilehash: dfc6c7a7083524a1e7049fdc879fe679f951084d
ms.sourcegitcommit: ed76cc752966c604a795fbc56d5a71d16ded0b58
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 02/02/2019
ms.locfileid: "55667736"
---
# <a name="tutorial-get-started-with-ef-database-first-using-mvc-5"></a><span data-ttu-id="a4ac2-103">Kurz: Začínáme s EF Database First pomocí MVC 5</span><span class="sxs-lookup"><span data-stu-id="a4ac2-103">Tutorial: Get started with EF Database First using MVC 5</span></span>

<span data-ttu-id="a4ac2-104">Pomocí generování uživatelského rozhraní ASP.NET, MVC a Entity Framework, můžete vytvořit webovou aplikaci, která poskytuje rozhraní pro existující databázi.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-104">Using MVC, Entity Framework, and ASP.NET Scaffolding, you can create a web application that provides an interface to an existing database.</span></span> <span data-ttu-id="a4ac2-105">V této sérii kurzů se dozvíte, jak automaticky vygenerovat kód, který umožňuje uživatelům zobrazit, upravit, vytvořit a odstranit data, která se nachází v databázové tabulce.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-105">This tutorial series shows you how to automatically generate code that enables users to display, edit, create, and delete data that resides in a database table.</span></span> <span data-ttu-id="a4ac2-106">Generovaný kód odpovídá sloupců v tabulce databáze.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-106">The generated code corresponds to the columns in the database table.</span></span> <span data-ttu-id="a4ac2-107">V poslední části série, se dozvíte, jak přidat anotacemi dat do datového modelu k určení požadavků na ověření a zobrazení formátování.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-107">In the last part of the series, you learn how add data annotations to the data model to specify validation requirements and display formatting.</span></span> <span data-ttu-id="a4ac2-108">Jakmile budete hotovi, můžete přechodu na Azure článku se dozvíte, jak nasadit aplikaci .NET a SQL database do služby Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-108">When you're done, you can advance to an Azure article to learn how to deploy a .NET app and SQL database to Azure App Service.</span></span>

<span data-ttu-id="a4ac2-109">Tento kurz ukazuje, jak začít s existující databáze a rychle vytvořit webovou aplikaci, která umožňuje uživatelům interakci s daty.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-109">This tutorial shows how to start with an existing database and quickly create a web application that enables users to interact with the data.</span></span> <span data-ttu-id="a4ac2-110">Používá Entity Framework 6 a MVC 5 k vytvoření webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-110">It uses the Entity Framework 6 and MVC 5 to build the web application.</span></span> <span data-ttu-id="a4ac2-111">Funkce technologie ASP.NET generování uživatelského rozhraní umožňuje automaticky vygenerovat kód pro zobrazení, aktualizaci, vytvoření a odstranění dat.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-111">The ASP.NET Scaffolding feature enables you to automatically generate code for displaying, updating, creating and deleting data.</span></span> <span data-ttu-id="a4ac2-112">Pomocí nástroje pro publikování v sadě Visual Studio, můžete snadno nasadit lokalitu a databázi do Azure.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-112">Using the publishing tools within Visual Studio, you can easily deploy the site and database to Azure.</span></span>

<span data-ttu-id="a4ac2-113">Tato části této série se zaměřuje na vytvoření databáze a vyplnění daty.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-113">This part of the series focuses on creating a database and populating it with data.</span></span>

<span data-ttu-id="a4ac2-114">Tato série byl zapsán s příspěvky z Petr Dykstra a Rick Anderson.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-114">This series was written with contributions from Tom Dykstra and Rick Anderson.</span></span> <span data-ttu-id="a4ac2-115">Byl vylepšen závislosti na zpětnou vazbu od uživatelů v části komentáře.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-115">It was improved based on feedback from users in the comments section.</span></span>

<span data-ttu-id="a4ac2-116">V tomto kurzu se naučíte:</span><span class="sxs-lookup"><span data-stu-id="a4ac2-116">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="a4ac2-117">Nastavení databáze</span><span class="sxs-lookup"><span data-stu-id="a4ac2-117">Set up the database</span></span>

## <a name="prerequisites"></a><span data-ttu-id="a4ac2-118">Požadavky</span><span class="sxs-lookup"><span data-stu-id="a4ac2-118">Prerequisites</span></span>

* [<span data-ttu-id="a4ac2-119">Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="a4ac2-119">Visual Studio 2017</span></span>](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017)

## <a name="introduction"></a><span data-ttu-id="a4ac2-120">Úvod</span><span class="sxs-lookup"><span data-stu-id="a4ac2-120">Introduction</span></span>

<span data-ttu-id="a4ac2-121">Tento kurz se zabývá situace, kdy databázi máte a chcete pro generování kódu pro webovou aplikaci na základě polí dané databáze.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-121">This tutorial addresses the situation where you have a database and want to generate code for a web application based on the fields of that database.</span></span> <span data-ttu-id="a4ac2-122">Tento přístup se nazývá Database First vývoje.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-122">This approach is called Database First development.</span></span> <span data-ttu-id="a4ac2-123">Pokud již nemáte existující databázi, můžete použít přístupu říká vývoje Code First, který zahrnuje definování datových tříd a generování databáze z vlastnosti třídy.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-123">If you do not already have an existing database, you can instead use an approach called Code First development which involves defining data classes and generating the database from the class properties.</span></span>

## <a name="set-up-the-database"></a><span data-ttu-id="a4ac2-124">Nastavení databáze</span><span class="sxs-lookup"><span data-stu-id="a4ac2-124">Set up the database</span></span>

<span data-ttu-id="a4ac2-125">Aby napodobovaly prostředí, které máte existující databázi, nejprve vytvořit databázi s předem vyplněný daty a potom vytvořit webové aplikace, která se připojuje k databázi.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-125">To mimic the environment of having an existing database, you will first create a database with some pre-filled data, and then create your web application that connects to the database.</span></span>

<span data-ttu-id="a4ac2-126">V tomto kurzu byla vyvinutá pomocí LocalDB.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-126">This tutorial was developed using LocalDB.</span></span> <span data-ttu-id="a4ac2-127">Můžete použít existující databázový server namísto LocalDB, ale v závislosti na vaší verzi sady Visual Studio a typ databáze, všechny datové nástroje v sadě Visual Studio nemusí být podporován.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-127">You can use an existing database server instead of LocalDB, but depending on your version of Visual Studio and your type of database, all of the data tools in Visual Studio might not be supported.</span></span> <span data-ttu-id="a4ac2-128">Pokud nástroje nejsou k dispozici pro vaši databázi, budete muset provést některé kroky specifické pro databázi v sadě management suite pro vaši databázi.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-128">If the tools are not available for your database, you may need to perform some of the database-specific steps within the management suite for your database.</span></span>

<span data-ttu-id="a4ac2-129">Pokud máte potíže s databází nástroje ve vaší verzi sady Visual Studio, ujistěte se, že máte nainstalovanou nejnovější verzi nástroje databáze.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-129">If you have a problem with the database tools in your version of Visual Studio, make sure you have installed the latest version of the database tools.</span></span> <span data-ttu-id="a4ac2-130">Informace o aktualizaci nebo instalaci databáze nástroje najdete v tématu [Microsoft SQL Server Data Tools](https://msdn.microsoft.com/data/hh297027).</span><span class="sxs-lookup"><span data-stu-id="a4ac2-130">For information about updating or installing the database tools, see [Microsoft SQL Server Data Tools](https://msdn.microsoft.com/data/hh297027).</span></span>

<span data-ttu-id="a4ac2-131">Spusťte sadu Visual Studio a vytvořte **databázový projekt SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-131">Launch Visual Studio and create a **SQL Server Database Project**.</span></span> <span data-ttu-id="a4ac2-132">Pojmenujte projekt **ContosoUniversityData**.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-132">Name the project **ContosoUniversityData**.</span></span>

![Vytvoření projektu databáze](setting-up-database/_static/image1.png)

<span data-ttu-id="a4ac2-134">Nyní máte projekt prázdnou databázi.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-134">You now have an empty database project.</span></span> <span data-ttu-id="a4ac2-135">Pokud chcete mít jistotu, že tato databáze můžete nasadit do Azure, nastavíte Azure SQL Database jako cílovou platformu pro projekt.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-135">To make sure that you can deploy this database to Azure, you'll set Azure SQL Database as the target platform for the project.</span></span> <span data-ttu-id="a4ac2-136">Nastavení cílové platformě není nasazena ve skutečnosti databázi. pouze znamená, že databázový projekt bude ověřte, zda je návrh databáze kompatibilní s cílovou platformu.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-136">Setting the target platform does not actually deploy the database; it only means that the database project will verify that the database design is compatible with the target platform.</span></span> <span data-ttu-id="a4ac2-137">Chcete-li nastavení cílové platformy, otevřete **vlastnosti** pro projekt a vyberte **Microsoft Azure SQL Database** pro cílovou platformu.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-137">To set the target platform, open the **Properties** for the project and select **Microsoft Azure SQL Database** for the target platform.</span></span>

<span data-ttu-id="a4ac2-138">Můžete vytvořit tabulky pro tento kurz potřeba přidáním skripty SQL, které určují tabulky.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-138">You can create the tables needed for this tutorial by adding SQL scripts that define the tables.</span></span> <span data-ttu-id="a4ac2-139">Klikněte pravým tlačítkem na projekt a přidat novou položku.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-139">Right-click your project and add a new item.</span></span> <span data-ttu-id="a4ac2-140">Vyberte **tabulek a zobrazení** > **tabulky** a pojmenujte ho *Student*.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-140">Select **Tables and Views** > **Table** and name it *Student*.</span></span>

<span data-ttu-id="a4ac2-141">V tabulce souboru nahraďte následující kód k vytvoření tabulky pomocí příkazu T-SQL.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-141">In the table file, replace the T-SQL command with the following code to create the table.</span></span>

[!code-sql[Main](setting-up-database/samples/sample1.sql)]

<span data-ttu-id="a4ac2-142">Všimněte si, že v okně návrhu se automaticky synchronizuje s kódem.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-142">Notice that the design window automatically synchronizes with the code.</span></span> <span data-ttu-id="a4ac2-143">Můžete pracovat s kódem nebo Návrhář.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-143">You can work with either the code or designer.</span></span>

![Zobrazit kód a návrh](setting-up-database/_static/image5.png)

<span data-ttu-id="a4ac2-145">Přidejte další tabulku.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-145">Add another table.</span></span> <span data-ttu-id="a4ac2-146">Tentokrát pojmenujte ji kurzu a pomocí následujícího příkazu T-SQL.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-146">This time name it Course and use the following T-SQL command.</span></span>

[!code-sql[Main](setting-up-database/samples/sample2.sql)]

<span data-ttu-id="a4ac2-147">A ještě jednou vytvořte tabulku s názvem registrace opakujte.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-147">And, repeat one more time to create a table named Enrollment.</span></span>

[!code-sql[Main](setting-up-database/samples/sample3.sql)]

<span data-ttu-id="a4ac2-148">Můžete naplnit databázi daty pomocí skriptu, který se spouští po nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-148">You can populate your database with data through a script that is run after the database is deployed.</span></span> <span data-ttu-id="a4ac2-149">Skript po nasazení přidáte do projektu.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-149">Add a Post-Deployment Script to the project.</span></span> <span data-ttu-id="a4ac2-150">Klikněte pravým tlačítkem na projekt a přidat novou položku.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-150">Right-click your project and add a new item.</span></span> <span data-ttu-id="a4ac2-151">Vyberte **uživatelské skripty** > **skript po nasazení**.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-151">Select **User Scripts** > **Post-Deployment Script**.</span></span> <span data-ttu-id="a4ac2-152">Můžete použít výchozí název.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-152">You can use the default name.</span></span>

<span data-ttu-id="a4ac2-153">Přidejte následující kód T-SQL do skriptu po nasazení.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-153">Add the following T-SQL code to the post-deployment script.</span></span> <span data-ttu-id="a4ac2-154">Tento skript jednoduše přidá data do databáze, pokud není nalezen žádný odpovídající záznam.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-154">This script simply adds data to the database when no matching record is found.</span></span> <span data-ttu-id="a4ac2-155">Nelze přepsat nebo odstranit všechna data, která jste zadali do databáze.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-155">It does not overwrite or delete any data you may have entered into the database.</span></span>

[!code-sql[Main](setting-up-database/samples/sample4.sql)]

<span data-ttu-id="a4ac2-156">Je důležité si uvědomit, že je skript po nasazení spustit pokaždé, když se nasadit projekt databáze.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-156">It is important to note that the post-deployment script is run every time you deploy your database project.</span></span> <span data-ttu-id="a4ac2-157">Proto budete muset pečlivě zvažte své požadavky na při zápisu tohoto skriptu.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-157">Therefore, you need to carefully consider your requirements when writing this script.</span></span> <span data-ttu-id="a4ac2-158">V některých případech můžete chtít začít ze známé sady dat pokaždé, když je projekt nasazen.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-158">In some cases, you may wish to start over from a known set of data every time the project is deployed.</span></span> <span data-ttu-id="a4ac2-159">V ostatních případech nemusíte chtít upravit existující data žádným způsobem.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-159">In other cases, you may not want to alter the existing data in any way.</span></span> <span data-ttu-id="a4ac2-160">Na základě vašich požadavků, můžete rozhodnout, zda je nutné skript po nasazení nebo co je potřeba zahrnout do skriptu.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-160">Based on your requirements, you can decide whether you need a post-deployment script or what you need to include in the script.</span></span> <span data-ttu-id="a4ac2-161">Další informace o naplnění databáze pomocí skriptu po nasazení najdete v tématu [včetně dat v databázový projekt SQL Server](https://blogs.msdn.com/b/ssdt/archive/2012/02/02/including-data-in-an-sql-server-database-project.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4ac2-161">For more information about populating your database with a post-deployment script, see [Including Data in a SQL Server Database Project](https://blogs.msdn.com/b/ssdt/archive/2012/02/02/including-data-in-an-sql-server-database-project.aspx).</span></span>

<span data-ttu-id="a4ac2-162">Teď máte 4 soubory skriptu SQL, ale žádné skutečné tabulky.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-162">You now have 4 SQL script files but no actual tables.</span></span> <span data-ttu-id="a4ac2-163">Jste připraveni nasadit projekt databáze na instanci localdb.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-163">You are ready to deploy your database project to localdb.</span></span> <span data-ttu-id="a4ac2-164">V sadě Visual Studio klikněte na tlačítko Start (nebo F5) k vytvoření a nasazení projektu databáze.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-164">In Visual Studio, click the Start button (or F5) to build and deploy your database project.</span></span> <span data-ttu-id="a4ac2-165">Zkontrolujte, **výstup** kartu k ověření, že sestavení a nasazení bylo úspěšné.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-165">Check the **Output** tab to verify that the build and deployment succeeded.</span></span>

<span data-ttu-id="a4ac2-166">Chcete-li zobrazit, že se vytvořil novou databázi, otevřete **Průzkumník objektů systému SQL Server** a vyhledejte název projektu na serveru správná místní databáze (v tomto případě **(localdb) \ProjectsV13**).</span><span class="sxs-lookup"><span data-stu-id="a4ac2-166">To see that the new database has been created, open **SQL Server Object Explorer** and look for the name of the project in the correct local database server (in this case **(localdb)\ProjectsV13**).</span></span>

<span data-ttu-id="a4ac2-167">Zobrazit tabulky jsou naplněný daty, klikněte pravým tlačítkem na tabulku a vyberte **Data zobrazení**.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-167">To see that the tables are populated with data, right-click a table, and select **View Data**.</span></span>

![Zobrazit data tabulky](setting-up-database/_static/image9.png)

<span data-ttu-id="a4ac2-169">Zobrazí se upravovat zobrazení dat tabulky.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-169">An editable view of the table data is displayed.</span></span> <span data-ttu-id="a4ac2-170">Pokud vyberete třeba **tabulky** > **dbo.course** > **Data zobrazení**, viz tabulku s tři sloupce (**kurzu**, **Title**, a **kredity**) a čtyři řádky.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-170">For example, if you select **Tables** > **dbo.course** > **View Data**, you see a table with three columns (**Course**, **Title**, and **Credits**) and four rows.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="a4ac2-171">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="a4ac2-171">Additional resources</span></span>

<span data-ttu-id="a4ac2-172">Úvodní příklad vývoje Code First najdete v tématu [Začínáme s ASP.NET MVC 5](../introduction/getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="a4ac2-172">For an introductory example of Code First development, see [Getting Started with ASP.NET MVC 5](../introduction/getting-started.md).</span></span> <span data-ttu-id="a4ac2-173">Složitější příklad naleznete v tématu [vytváření datového modelu Entity Framework pro aplikaci ASP.NET MVC 4](../getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="a4ac2-173">For a more advanced example, see [Creating an Entity Framework Data Model for an ASP.NET MVC 4 App](../getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>

<span data-ttu-id="a4ac2-174">Informace o výběru přístupem Entity Framework najdete v tématu [vývojové přístupy s Entity Framework](https://msdn.microsoft.com/library/ms178359.aspx#dbfmfcf).</span><span class="sxs-lookup"><span data-stu-id="a4ac2-174">For guidance on selecting which Entity Framework approach to use, see [Entity Framework Development Approaches](https://msdn.microsoft.com/library/ms178359.aspx#dbfmfcf).</span></span>

## <a name="next-steps"></a><span data-ttu-id="a4ac2-175">Další kroky</span><span class="sxs-lookup"><span data-stu-id="a4ac2-175">Next steps</span></span>

<span data-ttu-id="a4ac2-176">V tomto kurzu se naučíte:</span><span class="sxs-lookup"><span data-stu-id="a4ac2-176">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="a4ac2-177">Nastavení databáze</span><span class="sxs-lookup"><span data-stu-id="a4ac2-177">Set up the database</span></span>

<span data-ttu-id="a4ac2-178">Přejděte k dalšímu kurzu, kde se naučíte, jak vytvořit webové aplikace a datových modelů.</span><span class="sxs-lookup"><span data-stu-id="a4ac2-178">Advance to the next tutorial to learn how to create the web application and data models.</span></span>
> [!div class="nextstepaction"]
> [<span data-ttu-id="a4ac2-179">Vytvoření webové aplikace a datových modelů</span><span class="sxs-lookup"><span data-stu-id="a4ac2-179">Create the web application and data models</span></span>](creating-the-web-application.md)
