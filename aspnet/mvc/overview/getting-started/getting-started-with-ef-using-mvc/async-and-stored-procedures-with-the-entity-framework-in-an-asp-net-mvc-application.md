---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application
title: "Async a uložené procedury s rozhraní Entity Framework v aplikaci ASP.NET MVC | Microsoft Docs"
author: tdykstra
description: "Contoso univerzity ukázkovou webovou aplikaci demonstruje postup vytvoření aplikace ASP.NET MVC 5 s použitím Entity Framework 6 Code First a Visual Studio..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/07/2014
ms.topic: article
ms.assetid: 27d110fc-d1b7-4628-a763-26f1e6087549
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: 7412b32ac29179dfa319544781d4c7165c58196b
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2018
---
<a name="async-and-stored-procedures-with-the-entity-framework-in-an-aspnet-mvc-application"></a><span data-ttu-id="46650-103">Async a uložené procedury s rozhraní Entity Framework v aplikaci ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="46650-103">Async and Stored Procedures with the Entity Framework in an ASP.NET MVC Application</span></span>
====================
<span data-ttu-id="46650-104">podle [tní Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="46650-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="46650-105">[Stáhněte si dokončený projekt](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) nebo [stáhnout PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span><span class="sxs-lookup"><span data-stu-id="46650-105">[Download Completed Project](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) or [Download PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span></span>

> <span data-ttu-id="46650-106">Contoso univerzity ukázkovou webovou aplikaci demonstruje postup vytvoření aplikace ASP.NET MVC 5 s použitím Entity Framework 6 Code First a Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="46650-106">The Contoso University sample web application demonstrates how to create ASP.NET MVC 5 applications using the Entity Framework 6 Code First and Visual Studio 2013.</span></span> <span data-ttu-id="46650-107">Informace o kurzu řady najdete v tématu [z prvního kurzu řady](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="46650-107">For information about the tutorial series, see [the first tutorial in the series](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>


<span data-ttu-id="46650-108">V dřívějších kurzech jste zjistili, jak číst a aktualizovat data pomocí synchronní programovací model.</span><span class="sxs-lookup"><span data-stu-id="46650-108">In earlier tutorials you learned how to read and update data using the synchronous programming model.</span></span> <span data-ttu-id="46650-109">V tomto kurzu uvidíte, jak implementovat asynchronní programovací model.</span><span class="sxs-lookup"><span data-stu-id="46650-109">In this tutorial you see how to implement the asynchronous programming model.</span></span> <span data-ttu-id="46650-110">Asynchronní kódu může pomoci aplikace poskytují lepší výkon, protože umožňuje lepší využití prostředků serveru.</span><span class="sxs-lookup"><span data-stu-id="46650-110">Asynchronous code can help an application perform better because it makes better use of server resources.</span></span>

<span data-ttu-id="46650-111">V tomto kurzu dozvíte se taky, jak pomocí uložené procedury pro vložení, aktualizace a odstranění operace s entitou.</span><span class="sxs-lookup"><span data-stu-id="46650-111">In this tutorial you'll also see how to use stored procedures for insert, update, and delete operations on an entity.</span></span>

<span data-ttu-id="46650-112">Nakonec budete znovu nasaďte aplikaci do Azure společně s všechny změny databáze, které jste implementovali od poprvé, které jste nasadili.</span><span class="sxs-lookup"><span data-stu-id="46650-112">Finally, you'll redeploy the application to Azure, along with all of the database changes that you've implemented since the first time you deployed.</span></span>

<span data-ttu-id="46650-113">Následující ilustrace znázorňuje některé stránek, které budete pracovat.</span><span class="sxs-lookup"><span data-stu-id="46650-113">The following illustrations show some of the pages that you'll work with.</span></span>

![Stránka oddělení](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image1.png)

![Vytvořit oddělení](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image2.png)

## <a name="why-bother-with-asynchronous-code"></a><span data-ttu-id="46650-116">Proč zabývat asynchronní kódu</span><span class="sxs-lookup"><span data-stu-id="46650-116">Why bother with asynchronous code</span></span>

<span data-ttu-id="46650-117">Webový server má omezený počet vláken, které jsou k dispozici, a v situacích, vysokého zatížení všech dostupných vláken může být používán.</span><span class="sxs-lookup"><span data-stu-id="46650-117">A web server has a limited number of threads available, and in high load situations all of the available threads might be in use.</span></span> <span data-ttu-id="46650-118">Pokud k tomu dojde, server nemůže zpracovat nové žádosti o, dokud se uvolní vláken.</span><span class="sxs-lookup"><span data-stu-id="46650-118">When that happens, the server can't process new requests until the threads are freed up.</span></span> <span data-ttu-id="46650-119">Synchronní kód může být vázáno mnoho vláken při jejich nejsou to skutečně veškerou práci, protože se čeká vstupně-výstupních operací na dokončení.</span><span class="sxs-lookup"><span data-stu-id="46650-119">With synchronous code, many threads may be tied up while they aren't actually doing any work because they're waiting for I/O to complete.</span></span> <span data-ttu-id="46650-120">Asynchronní kód když proces čeká na vstupně-výstupních operací na dokončení, je jeho přístup z více vláken uvolněno pro server, aby používal pro zpracování dalších požadavků.</span><span class="sxs-lookup"><span data-stu-id="46650-120">With asynchronous code, when a process is waiting for I/O to complete, its thread is freed up for the server to use for processing other requests.</span></span> <span data-ttu-id="46650-121">V důsledku toho asynchronní kódu umožňuje prostředky serveru více efektivně používat, a server je povolena a zvládli větší provoz bez zpoždění.</span><span class="sxs-lookup"><span data-stu-id="46650-121">As a result, asynchronous code enables server resources to be use more efficiently, and the server is enabled to handle more traffic without delays.</span></span>

<span data-ttu-id="46650-122">V dřívějších verzích rozhraní .NET, byl složitý, psaní a testování asynchronní kódu chyby náchylné k chybám a ladění složité.</span><span class="sxs-lookup"><span data-stu-id="46650-122">In earlier versions of .NET, writing and testing asynchronous code was complex, error prone, and hard to debug.</span></span> <span data-ttu-id="46650-123">V rozhraní .NET 4.5 je mnohem jednodušší, pokud nemáte důvod nikoli k musí obecně napsat asynchronní kód psaní, testování a ladění kódu asynchronní.</span><span class="sxs-lookup"><span data-stu-id="46650-123">In .NET 4.5, writing, testing, and debugging asynchronous code is so much easier that you should generally write asynchronous code unless you have a reason not to.</span></span> <span data-ttu-id="46650-124">Asynchronní kód zavést malé množství režijní náklady na, ale pro situace nízkým provozem, stiskněte klávesu výkonu je nepatrné při pro intenzivní provoz situace, je výrazně potenciální zvýšení výkonu.</span><span class="sxs-lookup"><span data-stu-id="46650-124">Asynchronous code does introduce a small amount of overhead, but for low traffic situations the performance hit is negligible, while for high traffic situations, the potential performance improvement is substantial.</span></span>

<span data-ttu-id="46650-125">Další informace o asynchronní programování najdete v tématu [použití rozhraní .NET 4.5 asynchronní podpora k zabránění blokování volání](../../../../aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/web-development-best-practices.md#async).</span><span class="sxs-lookup"><span data-stu-id="46650-125">For more information about asynchronous programming, see [Use .NET 4.5's async support to avoid blocking calls](../../../../aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/web-development-best-practices.md#async).</span></span>

## <a name="create-the-department-controller"></a><span data-ttu-id="46650-126">Vytvoření řadiče oddělení</span><span class="sxs-lookup"><span data-stu-id="46650-126">Create the Department controller</span></span>

<span data-ttu-id="46650-127">Vytvořit řadič oddělení vyberte stejně jako jste to udělali starších řadičů, ale s výjimkou **použití asynchronní kontroler** akce zaškrtávací políčko.</span><span class="sxs-lookup"><span data-stu-id="46650-127">Create a Department controller the same way you did the earlier controllers, except this time select the **Use async controller** actions check box.</span></span>

![Oddělení řadiče vygenerované uživatelské rozhraní](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image3.png)

<span data-ttu-id="46650-129">Následující označuje zobrazit, co byla přidána do synchronní kód `Index` metoda aby asynchronní:</span><span class="sxs-lookup"><span data-stu-id="46650-129">The following highlights show what was added to the synchronous code for the `Index` method to make it asynchronous:</span></span>

[!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample1.cs?highlight=1,4)]

<span data-ttu-id="46650-130">Chcete-li povolit dotaz databáze Entity Framework pro asynchronní byly použity čtyři změny:</span><span class="sxs-lookup"><span data-stu-id="46650-130">Four changes were applied to enable the Entity Framework database query to execute asynchronously:</span></span>

- <span data-ttu-id="46650-131">Metoda je označena `async` – klíčové slovo, které sděluje kompilátoru generování zpětných volání pro části těla metody a automaticky vytvářet `Task<ActionResult>` objekt, který je vrácen.</span><span class="sxs-lookup"><span data-stu-id="46650-131">The method is marked with the `async` keyword, which tells the compiler to generate callbacks for parts of the method body and to automatically create the `Task<ActionResult>` object that is returned.</span></span>
- <span data-ttu-id="46650-132">Návratový typ byl změněn z `ActionResult` k `Task<ActionResult>`.</span><span class="sxs-lookup"><span data-stu-id="46650-132">The return type was changed from `ActionResult` to `Task<ActionResult>`.</span></span> <span data-ttu-id="46650-133">`Task<T>` Typ reprezentuje probíhající práce s tím výsledkem typu `T`.</span><span class="sxs-lookup"><span data-stu-id="46650-133">The `Task<T>` type represents ongoing work with a result of type `T`.</span></span>
- <span data-ttu-id="46650-134">`await` – Klíčové slovo, které bylo použito pro volání webové služby.</span><span class="sxs-lookup"><span data-stu-id="46650-134">The `await` keyword was applied to the web service call.</span></span> <span data-ttu-id="46650-135">Když kompilátor uvidí toto klíčové slovo, na pozadí se rozdělí metodu na dvě části.</span><span class="sxs-lookup"><span data-stu-id="46650-135">When the compiler sees this keyword, behind the scenes it splits the method into two parts.</span></span> <span data-ttu-id="46650-136">První část končí operace, které se spustí asynchronně.</span><span class="sxs-lookup"><span data-stu-id="46650-136">The first part ends with the operation that is started asynchronously.</span></span> <span data-ttu-id="46650-137">Druhá část je uvést do metody zpětného volání, která je volána po dokončení operace.</span><span class="sxs-lookup"><span data-stu-id="46650-137">The second part is put into a callback method that is called when the operation completes.</span></span>
- <span data-ttu-id="46650-138">Asynchronní verzi `ToList` byla volána metoda rozšíření.</span><span class="sxs-lookup"><span data-stu-id="46650-138">The asynchronous version of the `ToList` extension method was called.</span></span>

<span data-ttu-id="46650-139">Proč je `departments.ToList` příkaz změnil, ale ne `departments = db.Departments` příkaz?</span><span class="sxs-lookup"><span data-stu-id="46650-139">Why is the `departments.ToList` statement modified but not the `departments = db.Departments` statement?</span></span> <span data-ttu-id="46650-140">Důvodem je, že pouze příkazy, které způsobily dotazy nebo příkazy k odeslání do databáze se spustí asynchronně.</span><span class="sxs-lookup"><span data-stu-id="46650-140">The reason is that only statements that cause queries or commands to be sent to the database are executed asynchronously.</span></span> <span data-ttu-id="46650-141">`departments = db.Departments` Příkaz nastaví dotazu, ale dokud není spustit dotaz `ToList` metoda je volána.</span><span class="sxs-lookup"><span data-stu-id="46650-141">The `departments = db.Departments` statement sets up a query but the query is not executed until the `ToList` method is called.</span></span> <span data-ttu-id="46650-142">Proto pouze `ToList` metoda se spustí asynchronně.</span><span class="sxs-lookup"><span data-stu-id="46650-142">Therefore, only the `ToList` method is executed asynchronously.</span></span>

<span data-ttu-id="46650-143">V `Details` metoda a `HttpGet` `Edit` a `Delete` metody, `Find` metoda je ten, který způsobí, že dotaz k odeslání do databáze, tak, aby se metoda, která se provede asynchronně:</span><span class="sxs-lookup"><span data-stu-id="46650-143">In the `Details` method and the `HttpGet` `Edit` and `Delete` methods, the `Find` method is the one that causes a query to be sent to the database, so that's the method that gets executed asynchronously:</span></span>

[!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample2.cs?highlight=7)]

<span data-ttu-id="46650-144">V `Create`, `HttpPost Edit`, a `DeleteConfirmed` metody, je `SaveChanges` volání metody, které způsobí, že příkaz, který má být proveden, není příkazy, jako `db.Departments.Add(department)` který pouze způsobit entity v paměti, která má být změněn.</span><span class="sxs-lookup"><span data-stu-id="46650-144">In the `Create`, `HttpPost Edit`, and `DeleteConfirmed` methods, it is the `SaveChanges` method call that causes a command to be executed, not statements such as `db.Departments.Add(department)` which only cause entities in memory to be modified.</span></span>

[!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample3.cs?highlight=6)]

<span data-ttu-id="46650-145">Otevřete *Views\Department\Index.cshtml*a kód šablony nahraďte následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="46650-145">Open *Views\Department\Index.cshtml*, and replace the template code with the following code:</span></span>

[!code-cshtml[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample4.cshtml?highlight=3,5,20-22,36-38)]

<span data-ttu-id="46650-146">Tento kód změny názvu od indexu oddělení, přesune jméno správce napravo a poskytuje úplný název tohoto správce.</span><span class="sxs-lookup"><span data-stu-id="46650-146">This code changes the title from Index to Departments, moves the Administrator name to the right, and provides the full name of the administrator.</span></span>

<span data-ttu-id="46650-147">V části Vytvoření odstranit, podrobnosti a upravit zobrazení, změňte popisek pro `InstructorID` pole na "Správce" stejně jako jste změnili pole název oddělení "Oddělení" v zobrazení průběhu.</span><span class="sxs-lookup"><span data-stu-id="46650-147">In the Create, Delete, Details, and Edit views, change the caption for the `InstructorID` field to "Administrator" the same way you changed the department name field to "Department" in the Course views.</span></span>

<span data-ttu-id="46650-148">Vytvořit a upravit zobrazení použít následující kód:</span><span class="sxs-lookup"><span data-stu-id="46650-148">In the Create and Edit views use the following code:</span></span>

[!code-cshtml[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample5.cshtml)]

<span data-ttu-id="46650-149">V zobrazení Podrobnosti a odstranění použijte následující kód:</span><span class="sxs-lookup"><span data-stu-id="46650-149">In the Delete and Details views use the following code:</span></span>

[!code-cshtml[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample6.cshtml)]

<span data-ttu-id="46650-150">Spusťte aplikaci a klikněte na **oddělení** kartě.</span><span class="sxs-lookup"><span data-stu-id="46650-150">Run the application, and click the **Departments** tab.</span></span>

![Stránka oddělení](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image4.png)

<span data-ttu-id="46650-152">Všechno funguje stejně jako ostatní řadiče, ale v tomto kontroleru všechny dotazy SQL jsou asynchronně.</span><span class="sxs-lookup"><span data-stu-id="46650-152">Everything works the same as in the other controllers, but in this controller all of the SQL queries are executing asynchronously.</span></span>

<span data-ttu-id="46650-153">Některé věci znát při použití asynchronní programování s platformou Entity Framework:</span><span class="sxs-lookup"><span data-stu-id="46650-153">Some things to be aware of when you are using asynchronous programming with the Entity Framework:</span></span>

- <span data-ttu-id="46650-154">Kód asynchronní není bezpečné pro přístup z více vláken.</span><span class="sxs-lookup"><span data-stu-id="46650-154">The async code is not thread safe.</span></span> <span data-ttu-id="46650-155">Jinými slovy jinými slovy, nejsou pokusí provést více operací paralelně pomocí ke stejné instanci kontextu.</span><span class="sxs-lookup"><span data-stu-id="46650-155">In other words, in other words, don't try to do multiple operations in parallel using the same context instance.</span></span>
- <span data-ttu-id="46650-156">Pokud chcete využít výhod výkonu asynchronní kódu, ujistěte se, že všechny knihovny balíčky, které používáte (například konkrétní stránkování), také použít asynchronní, pokud volají žádné metody rozhraní Entity Framework, které způsobí dotazy k odeslání do databáze.</span><span class="sxs-lookup"><span data-stu-id="46650-156">If you want to take advantage of the performance benefits of async code, make sure that any library packages that you're using (such as for paging), also use async if they call any Entity Framework methods that cause queries to be sent to the database.</span></span>

## <a name="use-stored-procedures-for-inserting-updating-and-deleting"></a><span data-ttu-id="46650-157">Pomocí uložených procedur pro vložení, aktualizaci a odstraňování</span><span class="sxs-lookup"><span data-stu-id="46650-157">Use stored procedures for inserting, updating, and deleting</span></span>

<span data-ttu-id="46650-158">Někteří vývojáři a DBAs přednost pomocí uložených procedur pro přístup k databázi.</span><span class="sxs-lookup"><span data-stu-id="46650-158">Some developers and DBAs prefer to use stored procedures for database access.</span></span> <span data-ttu-id="46650-159">V dřívějších verzích rozhraní Entity Framework můžete načíst data pomocí uložené procedury pomocí [provádění nezpracovaná dotazu SQL](advanced-entity-framework-scenarios-for-an-mvc-web-application.md), ale nemůže pokyn EF používat uložené procedury pro operace aktualizace.</span><span class="sxs-lookup"><span data-stu-id="46650-159">In earlier versions of Entity Framework you can retrieve data using a stored procedure by [executing a raw SQL query](advanced-entity-framework-scenarios-for-an-mvc-web-application.md), but you can't instruct EF to use stored procedures for update operations.</span></span> <span data-ttu-id="46650-160">V EF 6 se snadno konfiguruje Code First pomocí uložených procedur.</span><span class="sxs-lookup"><span data-stu-id="46650-160">In EF 6 it's easy to configure Code First to use stored procedures.</span></span>

1. <span data-ttu-id="46650-161">V *DAL\SchoolContext.cs*, přidejte zvýrazněný kód, který `OnModelCreating` metoda.</span><span class="sxs-lookup"><span data-stu-id="46650-161">In *DAL\SchoolContext.cs*, add the highlighted code to the `OnModelCreating` method.</span></span>

    [!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample7.cs?highlight=9)]

    <span data-ttu-id="46650-162">Tento kód dá pokyn Entity Framework, použijte uložené postupy pro vložení, aktualizace a odstranění operací na `Department` entity.</span><span class="sxs-lookup"><span data-stu-id="46650-162">This code instructs Entity Framework to use stored procedures for insert, update, and delete operations on the `Department` entity.</span></span>
2. <span data-ttu-id="46650-163">V konzole pro správu balíčku zadejte následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="46650-163">In Package Manage Console, enter the following command:</span></span>

    `add-migration DepartmentSP`

    <span data-ttu-id="46650-164">Otevřete *migrace\&lt; časové razítko&gt;\_DepartmentSP.cs* zobrazíte kód `Up` metodu, která vytvoří Insert, Update a Delete uložené procedury:</span><span class="sxs-lookup"><span data-stu-id="46650-164">Open *Migrations\&lt;timestamp&gt;\_DepartmentSP.cs* to see the code in the `Up` method that creates Insert, Update, and Delete stored procedures:</span></span>

    [!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample8.cs?highlight=3-4,26-27,42-43)]
- <span data-ttu-id="46650-165">V konzole pro správu balíčku zadejte následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="46650-165">In Package Manage Console, enter the following command:</span></span>

    `update-database`
- <span data-ttu-id="46650-166">Spuštění aplikace v režimu ladění, klikněte **oddělení** a pak klikněte **vytvořit nový**.</span><span class="sxs-lookup"><span data-stu-id="46650-166">Run the application in debug mode, click the **Departments** tab, and then click **Create New**.</span></span>
- <span data-ttu-id="46650-167">Zadejte data pro nové oddělení a pak klikněte na tlačítko **vytvořit**.</span><span class="sxs-lookup"><span data-stu-id="46650-167">Enter data for a new department, and then click **Create**.</span></span>

    ![Vytvořit oddělení](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image5.png)
- <span data-ttu-id="46650-169">V sadě Visual Studio, podívejte se na protokoly v **výstup** okna, zobrazí se, že uložené procedury použila vložit nový řádek oddělení.</span><span class="sxs-lookup"><span data-stu-id="46650-169">In Visual Studio, look at the logs in the **Output** window to see that a stored procedure was used to insert the new Department row.</span></span>

    ![Vložení SP oddělení](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image6.png)

<span data-ttu-id="46650-171">Kód nejprve vytvoří výchozí uložené procedury názvy.</span><span class="sxs-lookup"><span data-stu-id="46650-171">Code First creates default stored procedure names.</span></span> <span data-ttu-id="46650-172">Pokud používáte existující databázi, může být nutné přizpůsobit názvy uložené procedury, chcete-li použít uložené procedury již definována v databázi.</span><span class="sxs-lookup"><span data-stu-id="46650-172">If you are using an existing database, you might need to customize the stored procedure names in order to use stored procedures already defined in the database.</span></span> <span data-ttu-id="46650-173">Informace o tom, jak to udělat najdete v tématu [Entity Framework Code první vložení, aktualizaci nebo odstranění uložených procedur](https://msdn.microsoft.com/data/dn468673).</span><span class="sxs-lookup"><span data-stu-id="46650-173">For information about how to do that, see [Entity Framework Code First Insert/Update/Delete Stored Procedures](https://msdn.microsoft.com/data/dn468673).</span></span>

<span data-ttu-id="46650-174">Pokud chcete přizpůsobit, co generované uložené procedury proveďte, můžete upravit automaticky generovaný kód pro byla migrace `Up` metodu, která vytvoří uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="46650-174">If you want to customize what generated stored procedures do, you can edit the scaffolded code for the migrations `Up` method that creates the stored procedure.</span></span> <span data-ttu-id="46650-175">Tímto způsobem vaše změny se projeví kdykoli, migrace se spustí a použijí se na vaši produkční databázi když migrace spustí automaticky v produkčním prostředí po nasazení.</span><span class="sxs-lookup"><span data-stu-id="46650-175">That way your changes are reflected whenever that migration is run and will be applied to your production database when migrations runs automatically in production after deployment.</span></span>

<span data-ttu-id="46650-176">Pokud chcete změnit existující uložené procedury, která byla vytvořena v předchozí migrace, můžete použít příkaz Add-Migration generování prázdné migrace a pak ručně napsat kód, který volá [AlterStoredProcedure](https://msdn.microsoft.com/library/system.data.entity.migrations.dbmigration.alterstoredprocedure.aspx) – metoda .</span><span class="sxs-lookup"><span data-stu-id="46650-176">If you want to change an existing stored procedure that was created in a previous migration, you can use the Add-Migration command to generate a blank migration, and then manually write code that calls the [AlterStoredProcedure](https://msdn.microsoft.com/library/system.data.entity.migrations.dbmigration.alterstoredprocedure.aspx) method.</span></span>

## <a name="deploy-to-azure"></a><span data-ttu-id="46650-177">Nasazení do Azure</span><span class="sxs-lookup"><span data-stu-id="46650-177">Deploy to Azure</span></span>

<span data-ttu-id="46650-178">V této části vyžaduje, abyste dokončili nepovinný **nasazení aplikace do Azure** tématu [nasazení a migrace](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application.md) kurzu této série.</span><span class="sxs-lookup"><span data-stu-id="46650-178">This section requires you to have completed the optional **Deploying the app to Azure** section in the [Migrations and Deployment](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application.md) tutorial of this series.</span></span> <span data-ttu-id="46650-179">Pokud jste měli chyby migrace, které můžete vyřešit odstraněním databázi ve vašem místním projektu, tuto část přeskočte.</span><span class="sxs-lookup"><span data-stu-id="46650-179">If you had migrations errors that you resolved by deleting the database in your local project, skip this section.</span></span>

1. <span data-ttu-id="46650-180">V sadě Visual Studio, klikněte pravým tlačítkem na projekt v **Průzkumníku řešení** a vyberte **publikovat** v místní nabídce.</span><span class="sxs-lookup"><span data-stu-id="46650-180">In Visual Studio, right-click the project in **Solution Explorer** and select **Publish** from the context menu.</span></span>
2. <span data-ttu-id="46650-181">Klikněte na tlačítko **publikování**.</span><span class="sxs-lookup"><span data-stu-id="46650-181">Click **Publish**.</span></span>

    <span data-ttu-id="46650-182">Visual Studio nasadí aplikaci do Azure a aplikace otevře výchozí prohlížeč, běží v Azure.</span><span class="sxs-lookup"><span data-stu-id="46650-182">Visual Studio deploys the application to Azure, and the application opens in your default browser, running in Azure.</span></span>
3. <span data-ttu-id="46650-183">Testování aplikace k ověření pracuje.</span><span class="sxs-lookup"><span data-stu-id="46650-183">Test the application to verify it's working.</span></span>

    <span data-ttu-id="46650-184">Při prvním spuštění stránky, který přistupuje k databázi, rozhraní Entity Framework spustí všechny byla migrace `Up` metody, které jsou nezbytné k přivedení aktuální pomocí aktuálního modelu dat databáze.</span><span class="sxs-lookup"><span data-stu-id="46650-184">The first time you run a page that accesses the database, the Entity Framework runs all of the migrations `Up` methods required to bring the database up to date with the current data model.</span></span> <span data-ttu-id="46650-185">Teď můžete použít všechny webových stránek, které jste přidali od posledního, které jste nasadili, včetně oddělení stránek, které jste přidali v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="46650-185">You can now use all of the web pages that you added since the last time you deployed, including the Department pages that you added in this tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="46650-186">Souhrn</span><span class="sxs-lookup"><span data-stu-id="46650-186">Summary</span></span>

<span data-ttu-id="46650-187">V tomto kurzu jste viděli, jak ke zlepšení efektivity serveru podle psaní kódu, který se spustí asynchronně a jak pomocí uložených procedur pro vložení, aktualizace a operace odstranění.</span><span class="sxs-lookup"><span data-stu-id="46650-187">In this tutorial you saw how to improve server efficiency by writing code that executes asynchronously, and how to use stored procedures for insert, update, and delete operations.</span></span> <span data-ttu-id="46650-188">V dalším kurzu se zobrazí, jak zabránit ztrátě dat při pokusu o několik uživatelů k úpravě stejné záznamu ve stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="46650-188">In the next tutorial, you'll see how to prevent data loss when multiple users try to edit the same record at the same time.</span></span>

<span data-ttu-id="46650-189">Odkazy na další zdroje Entity Framework najdete v [přístup k datům ASP.NET - doporučené prostředky](../../../../whitepapers/aspnet-data-access-content-map.md).</span><span class="sxs-lookup"><span data-stu-id="46650-189">Links to other Entity Framework resources can be found in the [ASP.NET Data Access - Recommended Resources](../../../../whitepapers/aspnet-data-access-content-map.md).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="46650-190">[Předchozí](updating-related-data-with-the-entity-framework-in-an-asp-net-mvc-application.md)
[další](handling-concurrency-with-the-entity-framework-in-an-asp-net-mvc-application.md)</span><span class="sxs-lookup"><span data-stu-id="46650-190">[Previous](updating-related-data-with-the-entity-framework-in-an-asp-net-mvc-application.md)
[Next](handling-concurrency-with-the-entity-framework-in-an-asp-net-mvc-application.md)</span></span>
