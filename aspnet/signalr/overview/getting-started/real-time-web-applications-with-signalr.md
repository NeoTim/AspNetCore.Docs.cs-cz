---
uid: signalr/overview/getting-started/real-time-web-applications-with-signalr
title: 'Rukou na testovacího prostředí: V reálném čase webových aplikací pomocí nástroje SignalR | Microsoft Docs'
author: rick-anderson
description: V reálném čase webových aplikací funkci možnost nabízet obsah připojeným klientům, jako dochází v reálném čase serverové. Pro vývojáře využívající technologii ASP.NET, ASP...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/16/2014
ms.topic: article
ms.assetid: ba07958c-42e1-4da0-81db-ba6925ed6db0
ms.technology: dotnet-signalr
ms.prod: .net-framework
msc.legacyurl: /signalr/overview/getting-started/real-time-web-applications-with-signalr
msc.type: authoredcontent
ms.openlocfilehash: 5a2bc120ded18ad2302fd6c5cde65a5323e86ca8
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/06/2018
---
<a name="hands-on-lab-real-time-web-applications-with-signalr"></a><span data-ttu-id="3ea86-104">Rukou na testovacího prostředí: V reálném čase webových aplikací pomocí nástroje SignalR</span><span class="sxs-lookup"><span data-stu-id="3ea86-104">Hands On Lab: Real-Time Web Applications with SignalR</span></span>
====================
<span data-ttu-id="3ea86-105">Podle [webové táborech Team](https://twitter.com/webcamps)</span><span class="sxs-lookup"><span data-stu-id="3ea86-105">by [Web Camps Team](https://twitter.com/webcamps)</span></span>

[<span data-ttu-id="3ea86-106">Stažení webové táborech cvičení Kit</span><span class="sxs-lookup"><span data-stu-id="3ea86-106">Download Web Camps Training Kit</span></span>](http://aka.ms/webcamps-training-kit)

> <span data-ttu-id="3ea86-107">V reálném čase webových aplikací funkci možnost nabízet obsah připojeným klientům, jako dochází v reálném čase serverové.</span><span class="sxs-lookup"><span data-stu-id="3ea86-107">Real-time Web applications feature the ability to push server-side content to the connected clients as it happens, in real-time.</span></span> <span data-ttu-id="3ea86-108">Pro vývojáře využívající technologii ASP.NET **funkce SignalR technologie ASP.NET** je knihovnu, kterou chcete přidat funkce webu v reálném čase do svých aplikací.</span><span class="sxs-lookup"><span data-stu-id="3ea86-108">For ASP.NET developers, **ASP.NET SignalR** is a library to add real-time web functionality to their applications.</span></span> <span data-ttu-id="3ea86-109">Provádí se několik přenosy, automaticky výběr nejlépe k dispozici přenos daného klienta a serveru nejlépe k dispozici přenos.</span><span class="sxs-lookup"><span data-stu-id="3ea86-109">It takes advantage of several transports, automatically selecting the best available transport given the client and server's best available transport.</span></span> <span data-ttu-id="3ea86-110">Provádí se **WebSocket**, rozhraní API jazyka HTML5, které umožňuje obousměrnou komunikaci mezi prohlížečem a serverem.</span><span class="sxs-lookup"><span data-stu-id="3ea86-110">It takes advantage of **WebSocket**, an HTML5 API that enables bi-directional communication between the browser and server.</span></span>
> 
> <span data-ttu-id="3ea86-111">**SignalR** také poskytuje jednoduché, vysoké úrovně rozhraní API pro provádění serveru do klienta protokolu RPC (volají funkce JavaScript v prohlížečích vaši klienti z kódu .NET na straně serveru) v aplikaci ASP.NET, jakož i přidání užitečné háky pro správu připojení například připojení/odpojení události, seskupování připojení a autorizaci.</span><span class="sxs-lookup"><span data-stu-id="3ea86-111">**SignalR** also provides a simple, high-level API for doing server to client RPC (call JavaScript functions in your clients' browsers from server-side .NET code) in your ASP.NET application, as well as adding useful hooks for connection management, such as connect/disconnect events, grouping connections, and authorization.</span></span>
> 
> <span data-ttu-id="3ea86-112">**SignalR** je abstrakci přes některé přenosů, které jsou požadovány pro práci v reálném čase mezi klientem a serverem.</span><span class="sxs-lookup"><span data-stu-id="3ea86-112">**SignalR** is an abstraction over some of the transports that are required to do real-time work between client and server.</span></span> <span data-ttu-id="3ea86-113">A **SignalR** připojení spustí HTTP a pak je převést **WebSocket** připojení, pokud je k dispozici.</span><span class="sxs-lookup"><span data-stu-id="3ea86-113">A **SignalR** connection starts as HTTP, and is then promoted to a **WebSocket** connection if available.</span></span> <span data-ttu-id="3ea86-114">**Protokol WebSocket** je ideální přenos pro **SignalR**, protože umožňuje využívat s maximální efektivitou paměti serveru, má nejnižší latenci a má nejvíce základní funkce (jako je plně duplexní komunikace mezi klientem a Server), ale má také nejpřísnější požadavky: **WebSocket** vyžaduje, aby používat server **systému Windows Server 2012** nebo **Windows 8**, společně s **Rozhraní .NET framework 4.5**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-114">**WebSocket** is the ideal transport for **SignalR**, since it makes the most efficient use of server memory, has the lowest latency, and has the most underlying features (such as full duplex communication between client and server), but it also has the most stringent requirements: **WebSocket** requires the server to be using **Windows Server 2012** or **Windows 8**, along with **.NET Framework 4.5**.</span></span> <span data-ttu-id="3ea86-115">Pokud tyto požadavky nejsou splněny, **SignalR** se pokusí použít jiné přenosy, abyste svá připojení (jako je *Ajax dlouhé dotazování*).</span><span class="sxs-lookup"><span data-stu-id="3ea86-115">If these requirements are not met, **SignalR** will attempt to use other transports to make its connections (like *Ajax long polling*).</span></span>
> 
> <span data-ttu-id="3ea86-116">**SignalR** rozhraní API obsahuje dva modely pro komunikaci mezi klienty a servery: **trvalé připojení** a **Hubs**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-116">The **SignalR** API contains two models for communicating between clients and servers: **Persistent Connections** and **Hubs**.</span></span> <span data-ttu-id="3ea86-117">A **připojení** představuje jednoduchý koncový bod pro odesílání jednoho příjemce, seskupené nebo zpráv všesměrového vysílání.</span><span class="sxs-lookup"><span data-stu-id="3ea86-117">A **Connection** represents a simple endpoint for sending single-recipient, grouped, or broadcast messages.</span></span> <span data-ttu-id="3ea86-118">A **rozbočovače** více vysoké úrovně kanál založena na rozhraní API připojení, která umožňuje klientovi i serveru volat metody na sobě navzájem přímo.</span><span class="sxs-lookup"><span data-stu-id="3ea86-118">A **Hub** is a more high-level pipeline built upon the Connection API that allows your client and server to call methods on each other directly.</span></span>
> 
> ![Architektura SignalR](real-time-web-applications-with-signalr/_static/image1.png)
> 
> <span data-ttu-id="3ea86-120">Všechny ukázky kódu a fragmenty kódu jsou součástí webové táborech školení sady, k dispozici na [ http://aka.ms/webcamps-training-kit ](http://aka.ms/webcamps-training-kit).</span><span class="sxs-lookup"><span data-stu-id="3ea86-120">All sample code and snippets are included in the Web Camps Training Kit, available at [http://aka.ms/webcamps-training-kit](http://aka.ms/webcamps-training-kit).</span></span>


<a id="Overview"></a>
## <a name="overview"></a><span data-ttu-id="3ea86-121">Přehled</span><span class="sxs-lookup"><span data-stu-id="3ea86-121">Overview</span></span>

<a id="Objectives"></a>
### <a name="objectives"></a><span data-ttu-id="3ea86-122">Cíle</span><span class="sxs-lookup"><span data-stu-id="3ea86-122">Objectives</span></span>

<span data-ttu-id="3ea86-123">V tomto testovacím prostředí praktických se dozvíte, jak:</span><span class="sxs-lookup"><span data-stu-id="3ea86-123">In this hands-on lab, you will learn how to:</span></span>

- <span data-ttu-id="3ea86-124">Odesílání oznámení ze serveru do klienta pomocí funkce SignalR.</span><span class="sxs-lookup"><span data-stu-id="3ea86-124">Send notifications from server to client using SignalR.</span></span>
- <span data-ttu-id="3ea86-125">Škálování SignalR aplikace pomocí **systému SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-125">Scale Out your SignalR application using **SQL Server**.</span></span>

<a id="Prerequisites"></a>
### <a name="prerequisites"></a><span data-ttu-id="3ea86-126">Požadavky</span><span class="sxs-lookup"><span data-stu-id="3ea86-126">Prerequisites</span></span>

<span data-ttu-id="3ea86-127">Pro dokončení této praktické cvičení je vyžadován následující text:</span><span class="sxs-lookup"><span data-stu-id="3ea86-127">The following is required to complete this hands-on lab:</span></span>

- <span data-ttu-id="3ea86-128">[Visual Studio Express 2013 pro Web](https://www.microsoft.com/visualstudio/) nebo vyšší</span><span class="sxs-lookup"><span data-stu-id="3ea86-128">[Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/) or greater</span></span>

<a id="Setup"></a>
### <a name="setup"></a><span data-ttu-id="3ea86-129">Instalace</span><span class="sxs-lookup"><span data-stu-id="3ea86-129">Setup</span></span>

<span data-ttu-id="3ea86-130">Aby bylo možné spustit praktická cvičení v tomto testovacím prostředí praktické, musíte nejdřív nastavit svoje prostředí.</span><span class="sxs-lookup"><span data-stu-id="3ea86-130">In order to run the exercises in this hands-on lab, you will need to set up your environment first.</span></span>

1. <span data-ttu-id="3ea86-131">Otevřete okno Průzkumníka Windows a přejděte do tohoto prostředí **zdroj** složky.</span><span class="sxs-lookup"><span data-stu-id="3ea86-131">Open a Windows Explorer window and browse to the lab's **Source** folder.</span></span>
2. <span data-ttu-id="3ea86-132">Klikněte pravým tlačítkem na **Setup.cmd** a vyberte **spustit jako správce** ke spuštění procesu instalace, který bude konfiguraci prostředí a instalaci sady Visual Studio fragmenty kódu pro toto testovací prostředí.</span><span class="sxs-lookup"><span data-stu-id="3ea86-132">Right-click **Setup.cmd** and select **Run as administrator** to launch the setup process that will configure your environment and install the Visual Studio code snippets for this lab.</span></span>
3. <span data-ttu-id="3ea86-133">Pokud se zobrazí dialogové okno Řízení uživatelských účtů, zkontrolujte akce, která bude pokračovat.</span><span class="sxs-lookup"><span data-stu-id="3ea86-133">If the User Account Control dialog box is shown, confirm the action to proceed.</span></span>

> [!NOTE]
> <span data-ttu-id="3ea86-134">Zkontrolujte, zda že jste zkontrolovali všechny závislosti pro toto testovací prostředí před spuštěním instalačního programu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-134">Make sure you have checked all the dependencies for this lab before running the setup.</span></span>


<a id="CodeSnippets"></a>
### <a name="using-the-code-snippets"></a><span data-ttu-id="3ea86-135">Používání fragmentů kódu</span><span class="sxs-lookup"><span data-stu-id="3ea86-135">Using the Code Snippets</span></span>

<span data-ttu-id="3ea86-136">V dokumentu testovacího prostředí budete vyzváni k vložení bloky kódu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-136">Throughout the lab document, you will be instructed to insert code blocks.</span></span> <span data-ttu-id="3ea86-137">Pro usnadnění vaší práce většina tento kód je k dispozici jako Visual Studio fragmenty kódu, kterým můžete přistupovat z v rámci Visual Studio 2013, abyste nemuseli přidat ručně.</span><span class="sxs-lookup"><span data-stu-id="3ea86-137">For your convenience, most of this code is provided as Visual Studio Code Snippets, which you can access from within Visual Studio 2013 to avoid having to add it manually.</span></span>

> [!NOTE]
> <span data-ttu-id="3ea86-138">Každý úkol je přiložena počáteční řešení umístěný v **začít** složky cvičení, která umožňuje postupujte podle jednotlivých cvičení nezávisle na ostatních.</span><span class="sxs-lookup"><span data-stu-id="3ea86-138">Each exercise is accompanied by a starting solution located in the **Begin** folder of the exercise that allows you to follow each exercise independently of the others.</span></span> <span data-ttu-id="3ea86-139">Upozorňujeme, že fragmenty kódu, které jsou přidány během cvičení chybí z nich spuštění řešení a nemusí fungovat, dokud nedokončíte výkonu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-139">Please be aware that the code snippets that are added during an exercise are missing from these starting solutions and may not work until you have completed the exercise.</span></span> <span data-ttu-id="3ea86-140">Uvnitř zdrojový kód pro cvičení, je také k dispozici **End** složku obsahující řešení sady Visual Studio s kódem, který je výsledkem kroků v odpovídající cvičení.</span><span class="sxs-lookup"><span data-stu-id="3ea86-140">Inside the source code for an exercise, you will also find an **End** folder containing a Visual Studio solution with the code that results from completing the steps in the corresponding exercise.</span></span> <span data-ttu-id="3ea86-141">Tato řešení můžete použít jako vodítko, pokud potřebujete další pomoc při práci prostřednictvím této praktické cvičení.</span><span class="sxs-lookup"><span data-stu-id="3ea86-141">You can use these solutions as guidance if you need additional help as you work through this hands-on lab.</span></span>


* * *

<a id="Exercises"></a>
## <a name="exercises"></a><span data-ttu-id="3ea86-142">Cvičení</span><span class="sxs-lookup"><span data-stu-id="3ea86-142">Exercises</span></span>

<span data-ttu-id="3ea86-143">Toto praktické cvičení zahrnuje následující cvičení:</span><span class="sxs-lookup"><span data-stu-id="3ea86-143">This hands-on lab includes the following exercises:</span></span>

1. [<span data-ttu-id="3ea86-144">Práce s Data v reálném čase pomocí funkce SignalR</span><span class="sxs-lookup"><span data-stu-id="3ea86-144">Working with Real-Time Data Using SignalR</span></span>](#Exercise1)
2. [<span data-ttu-id="3ea86-145">Škálování pomocí SQL serveru</span><span class="sxs-lookup"><span data-stu-id="3ea86-145">Scaling Out Using SQL Server</span></span>](#Exercise2)

<span data-ttu-id="3ea86-146">Odhadovaný čas dokončení tohoto testovacího prostředí: **60 minut**</span><span class="sxs-lookup"><span data-stu-id="3ea86-146">Estimated time to complete this lab: **60 minutes**</span></span>

> [!NOTE]
> <span data-ttu-id="3ea86-147">Při prvním spuštění sady Visual Studio, musíte vybrat jednu z předdefinovaných nastavení kolekce.</span><span class="sxs-lookup"><span data-stu-id="3ea86-147">When you first start Visual Studio, you must select one of the predefined settings collections.</span></span> <span data-ttu-id="3ea86-148">Každé předdefinované kolekce je navržené tak, aby odpovídala konkrétním vývoj styl a určuje rozložení oken, editor chování, IntelliSense – fragmenty kódu a možnosti dialogového okna.</span><span class="sxs-lookup"><span data-stu-id="3ea86-148">Each predefined collection is designed to match a particular development style and determines window layouts, editor behavior, IntelliSense code snippets, and dialog box options.</span></span> <span data-ttu-id="3ea86-149">Postupy v tomto testovacím prostředí popisovat akce, které jsou nutné k dokončení daného úkolu v sadě Visual Studio, při použití **obecné nastavení vývoj** kolekce.</span><span class="sxs-lookup"><span data-stu-id="3ea86-149">The procedures in this lab describe the actions necessary to accomplish a given task in Visual Studio when using the **General Development Settings** collection.</span></span> <span data-ttu-id="3ea86-150">Pokud si zvolíte jiné nastavení kolekce pro vývojové prostředí, může být rozdíly v krocích, které byste měli vzít v úvahu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-150">If you choose a different settings collection for your development environment, there may be differences in the steps that you should take into account.</span></span>


<a id="Exercise1"></a>
### <a name="exercise-1-working-with-real-time-data-using-signalr"></a><span data-ttu-id="3ea86-151">Cvičení 1: Práce s Data v reálném čase pomocí funkce SignalR</span><span class="sxs-lookup"><span data-stu-id="3ea86-151">Exercise 1: Working with Real-Time Data Using SignalR</span></span>

<span data-ttu-id="3ea86-152">Při chat se často používá jako příklad, můžete provést celek mnoho další s v reálném čase funkce webu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-152">While chat is often used as an example, you can do a whole lot more with real-time Web functionality.</span></span> <span data-ttu-id="3ea86-153">Vždy, když uživatel aktualizuje na webové stránce zobrazíte nová data nebo implementuje stránky Ajax dlouhé dotazování načte nová data, můžete použít funkci SignalR.</span><span class="sxs-lookup"><span data-stu-id="3ea86-153">Any time a user refreshes a web page to see new data or the page implements Ajax long polling to retrieve new data, you can use SignalR.</span></span>

<span data-ttu-id="3ea86-154">Podporuje SignalR **serveru nabízených** nebo **všesměrové vysílání** funkce; zpracovává správu připojení automaticky.</span><span class="sxs-lookup"><span data-stu-id="3ea86-154">SignalR supports **server push** or **broadcasting** functionality; it handles connection management automatically.</span></span> <span data-ttu-id="3ea86-155">V classic připojení protokolu HTTP pro komunikaci klienta se serverem bude připojení znovu navázáno pro každý požadavek, ale funkce SignalR poskytuje trvalé připojení mezi klientem a serverem.</span><span class="sxs-lookup"><span data-stu-id="3ea86-155">In classic HTTP connections for client-server communication, connection is re-established for each request, but SignalR provides persistent connection between the client and server.</span></span> <span data-ttu-id="3ea86-156">V systému SignalR, který volá kód serveru kód klienta v prohlížeči pomocí vzdáleného volání procedur (RPC) místo modelu požadavků a odpovědí víme ještě dnes.</span><span class="sxs-lookup"><span data-stu-id="3ea86-156">In SignalR the server code calls out to a client code in the browser using Remote Procedure Calls (RPC), rather than the request-response model we know today.</span></span>

<span data-ttu-id="3ea86-157">V tomto cvičení budete konfigurovat **Geek kvízu** aplikace pro používání SignalR zobrazení řídicího panelu statistiky o aktualizované metriky, aniž by bylo nutné aktualizovat celou stránku.</span><span class="sxs-lookup"><span data-stu-id="3ea86-157">In this exercise, you will configure the **Geek Quiz** application to use SignalR to display the Statistics dashboard with the updated metrics without the need to refresh the entire page.</span></span>

<a id="Ex1Task1"></a>
#### <a name="task-1--exploring-the-geek-quiz-statistics-page"></a><span data-ttu-id="3ea86-158">Úloha 1 – prohlížení stránky Geek kvízu s časovým limitem statistiky</span><span class="sxs-lookup"><span data-stu-id="3ea86-158">Task 1 – Exploring the Geek Quiz Statistics Page</span></span>

<span data-ttu-id="3ea86-159">V této úloze budete absolvovat aplikace a ověřte, jak je zobrazen stránce Statistika a jak můžete vylepšit způsobem jsou informace se aktualizuje.</span><span class="sxs-lookup"><span data-stu-id="3ea86-159">In this task, you will go through the application and verify how the statistics page is shown and how you can improve the way the information is updated.</span></span>

1. <span data-ttu-id="3ea86-160">Otevřete **Visual Studio Express 2013 pro Web** a otevřete **GeekQuiz.sln** řešení umístěný v **Source\Ex1 WorkingWithRealTimeData\Begin** složky.</span><span class="sxs-lookup"><span data-stu-id="3ea86-160">Open **Visual Studio Express 2013 for Web** and open the **GeekQuiz.sln** solution located in the **Source\Ex1-WorkingWithRealTimeData\Begin** folder.</span></span>
2. <span data-ttu-id="3ea86-161">Stiskněte klávesu **F5** ke spuštění řešení.</span><span class="sxs-lookup"><span data-stu-id="3ea86-161">Press **F5** to run the solution.</span></span> <span data-ttu-id="3ea86-162">**Přihlásit** stránka by se měla objevit v prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="3ea86-162">The **Log in** page should appear in the browser.</span></span>

    <span data-ttu-id="3ea86-163">![Spuštění řešení](real-time-web-applications-with-signalr/_static/image2.png "systémem řešení")</span><span class="sxs-lookup"><span data-stu-id="3ea86-163">![Running the solution](real-time-web-applications-with-signalr/_static/image2.png "Running the solution")</span></span>

    <span data-ttu-id="3ea86-164">*Spuštění řešení*</span><span class="sxs-lookup"><span data-stu-id="3ea86-164">*Running the solution*</span></span>
3. <span data-ttu-id="3ea86-165">Klikněte na tlačítko **zaregistrovat** v pravém horním rohu stránky vytvořte nového uživatele v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3ea86-165">Click **Register** in the upper-right corner of the page to create a new user in the application.</span></span>

    <span data-ttu-id="3ea86-166">![Zaregistrovat odkaz](real-time-web-applications-with-signalr/_static/image3.png "odkaz registrace")</span><span class="sxs-lookup"><span data-stu-id="3ea86-166">![Register link](real-time-web-applications-with-signalr/_static/image3.png "Register link")</span></span>

    <span data-ttu-id="3ea86-167">*Zaregistrovat odkaz*</span><span class="sxs-lookup"><span data-stu-id="3ea86-167">*Register link*</span></span>
4. <span data-ttu-id="3ea86-168">V **zaregistrovat** stránky, zadejte **uživatelské jméno** a **heslo**a potom klikněte na **zaregistrovat**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-168">In the **Register** page, enter a **User name** and **Password**, and then click **Register**.</span></span>

    <span data-ttu-id="3ea86-169">![Registrace uživatele](real-time-web-applications-with-signalr/_static/image4.png "registrace uživatele")</span><span class="sxs-lookup"><span data-stu-id="3ea86-169">![Registering a user](real-time-web-applications-with-signalr/_static/image4.png "Registering a user")</span></span>

    <span data-ttu-id="3ea86-170">*Registrace uživatele*</span><span class="sxs-lookup"><span data-stu-id="3ea86-170">*Registering a user*</span></span>
5. <span data-ttu-id="3ea86-171">Aplikace zaregistruje nový účet a uživatel je ověřen a přesměrován zpět na domovskou stránku zobrazující první otázku kvízu s časovým limitem.</span><span class="sxs-lookup"><span data-stu-id="3ea86-171">The application registers the new account and the user is authenticated and redirected back to the home page showing the first quiz question.</span></span>
6. <span data-ttu-id="3ea86-172">Otevřete **statistiky** stránky v novém okně a umístí **Domů** stránky a **statistiky** stránky vedle sebe.</span><span class="sxs-lookup"><span data-stu-id="3ea86-172">Open the **Statistics** page in a new window and put the **Home** page and **Statistics** page side-by-side.</span></span>

    <span data-ttu-id="3ea86-173">![Souběžně sdílená windows](real-time-web-applications-with-signalr/_static/image5.png "souběžně straně windows")</span><span class="sxs-lookup"><span data-stu-id="3ea86-173">![Side-by-side windows](real-time-web-applications-with-signalr/_static/image5.png "Side by side windows")</span></span>

    <span data-ttu-id="3ea86-174">*Windows vedle sebe*</span><span class="sxs-lookup"><span data-stu-id="3ea86-174">*Side-by-side windows*</span></span>
7. <span data-ttu-id="3ea86-175">V **Domů** stránky, odpovězte na otázku kliknutím na jednu z možností.</span><span class="sxs-lookup"><span data-stu-id="3ea86-175">In the **Home** page, answer the question by clicking one of the options.</span></span>

    <span data-ttu-id="3ea86-176">![Odpovědi na dotaz](real-time-web-applications-with-signalr/_static/image6.png "odpovědi na dotaz")</span><span class="sxs-lookup"><span data-stu-id="3ea86-176">![Answering a question](real-time-web-applications-with-signalr/_static/image6.png "Answering a question")</span></span>

    <span data-ttu-id="3ea86-177">*Odpovědi na dotaz*</span><span class="sxs-lookup"><span data-stu-id="3ea86-177">*Answering a question*</span></span>
8. <span data-ttu-id="3ea86-178">Po kliknutí na tlačítko požadovaného, by se zobrazit odpověď.</span><span class="sxs-lookup"><span data-stu-id="3ea86-178">After clicking one of the buttons, the answer should appear.</span></span>

    <span data-ttu-id="3ea86-179">![Otázka zodpovězena správné](real-time-web-applications-with-signalr/_static/image7.png "otázku odpověděli správný")</span><span class="sxs-lookup"><span data-stu-id="3ea86-179">![Question answered correct](real-time-web-applications-with-signalr/_static/image7.png "Question answered correct")</span></span>

    <span data-ttu-id="3ea86-180">*Otázka správně zodpovězena*</span><span class="sxs-lookup"><span data-stu-id="3ea86-180">*Question answered correctly*</span></span>
9. <span data-ttu-id="3ea86-181">Všimněte si, že informací uvedených na stránce Statistika je zastaralé.</span><span class="sxs-lookup"><span data-stu-id="3ea86-181">Notice that the information provided in the Statistics page is outdated.</span></span> <span data-ttu-id="3ea86-182">Chcete-li zobrazit aktualizované výsledky aktualizujte stránku.</span><span class="sxs-lookup"><span data-stu-id="3ea86-182">Refresh the page in order to see the updated results.</span></span>

    <span data-ttu-id="3ea86-183">![Stránka statistiky](real-time-web-applications-with-signalr/_static/image8.png "statistiky stránky")</span><span class="sxs-lookup"><span data-stu-id="3ea86-183">![Statistics page](real-time-web-applications-with-signalr/_static/image8.png "Statistics page")</span></span>

    <span data-ttu-id="3ea86-184">*Stránka statistiky*</span><span class="sxs-lookup"><span data-stu-id="3ea86-184">*Statistics page*</span></span>
10. <span data-ttu-id="3ea86-185">Přejděte zpět na Visual Studio a zastavte ladění.</span><span class="sxs-lookup"><span data-stu-id="3ea86-185">Go back to Visual Studio and stop debugging.</span></span>

<a id="Ex1Task2"></a>
#### <a name="task-2--adding-signalr-to-geek-quiz-to-show-online-charts"></a><span data-ttu-id="3ea86-186">Úloha 2 – přidání SignalR na Geek kvízu s časovým limitem zobrazíte Online grafy</span><span class="sxs-lookup"><span data-stu-id="3ea86-186">Task 2 – Adding SignalR to Geek Quiz to Show Online Charts</span></span>

<span data-ttu-id="3ea86-187">V této úloze bude do řešení přidat SignalR a odesílání aktualizací na klienty automaticky při novou odpověď pro odeslání na server.</span><span class="sxs-lookup"><span data-stu-id="3ea86-187">In this task, you will add SignalR to the solution and send updates to the clients automatically when a new answer is sent to the server.</span></span>

1. <span data-ttu-id="3ea86-188">Z **nástroje** nabídky v sadě Visual Studio, vyberte **Správce balíčků knihoven**a potom klikněte na **Konzola správce balíčků**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-188">From the **Tools** menu in Visual Studio, select **Library Package Manager**, and then click **Package Manager Console**.</span></span>
2. <span data-ttu-id="3ea86-189">V **Konzola správce balíčků** okno, spusťte následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="3ea86-189">In the **Package Manager Console** window, execute the following command:</span></span>

    [!code-powershell[Main](real-time-web-applications-with-signalr/samples/sample1.ps1)]

    <span data-ttu-id="3ea86-190">![Instalace balíčku SignalR](real-time-web-applications-with-signalr/_static/image9.png "instalace balíčku SignalR")</span><span class="sxs-lookup"><span data-stu-id="3ea86-190">![SignalR package installation](real-time-web-applications-with-signalr/_static/image9.png "SignalR package installation")</span></span>

    <span data-ttu-id="3ea86-191">*Instalace balíčku SignalR*</span><span class="sxs-lookup"><span data-stu-id="3ea86-191">*SignalR package installation*</span></span>

   > [!NOTE]
   > <span data-ttu-id="3ea86-192">Při instalaci **SignalR** NuGet balíčky verze bodu 2.0.2 z úplně nová aplikace MVC 5, budete muset ručně aktualizovat **OWIN** balíčky verzi 2.0.1 (nebo vyšší) před instalací SignalR.</span><span class="sxs-lookup"><span data-stu-id="3ea86-192">When installing **SignalR** NuGet packages version 2.0.2 from a brand new MVC 5 application, you will need to manually update **OWIN** packages to version 2.0.1 (or higher) before installing SignalR.</span></span> <span data-ttu-id="3ea86-193">K tomuto účelu můžete spustit následující skript v **Konzola správce balíčků**:</span><span class="sxs-lookup"><span data-stu-id="3ea86-193">To do this, you can execute the following script in the **Package Manager Console**:</span></span>
   > 
   > [!code-powershell[Main](real-time-web-applications-with-signalr/samples/sample2.ps1)]
   > 
   > <span data-ttu-id="3ea86-194">V budoucích vydání systému SignalR bude OWIN závislosti automaticky aktualizován.</span><span class="sxs-lookup"><span data-stu-id="3ea86-194">In a future release of SignalR, OWIN dependencies will be automatically updated.</span></span>
3. <span data-ttu-id="3ea86-195">V **Průzkumníku řešení**, rozbalte **skripty** složky a Všimněte si, které funkce SignalR *js* soubory byly přidány k řešení.</span><span class="sxs-lookup"><span data-stu-id="3ea86-195">In **Solution Explorer**, expand the **Scripts** folder and notice that the SignalR *js* files were added to the solution.</span></span>

    <span data-ttu-id="3ea86-196">![Odkazuje na SignalR JavaScript](real-time-web-applications-with-signalr/_static/image10.png "odkazuje SignalR JavaScript")</span><span class="sxs-lookup"><span data-stu-id="3ea86-196">![SignalR JavaScript references](real-time-web-applications-with-signalr/_static/image10.png "SignalR JavaScript references")</span></span>

    <span data-ttu-id="3ea86-197">*Odkazy na SignalR JavaScript*</span><span class="sxs-lookup"><span data-stu-id="3ea86-197">*SignalR JavaScript references*</span></span>
4. <span data-ttu-id="3ea86-198">V **Průzkumníku řešení**, klikněte pravým tlačítkem myši **GeekQuiz** projekt, vyberte **přidat** | **novou složku**a pojmenujte ji  **Centra**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-198">In **Solution Explorer**, right-click the **GeekQuiz** project, select **Add** | **New Folder**, and name it **Hubs**.</span></span>
5. <span data-ttu-id="3ea86-199">Klikněte pravým tlačítkem myši **Hubs** složky a vyberte **přidat | Nová položka**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-199">Right-click the **Hubs** folder and select **Add | New Item**.</span></span>

    <span data-ttu-id="3ea86-200">![Přidat novou položku](real-time-web-applications-with-signalr/_static/image11.png "přidat novou položku")</span><span class="sxs-lookup"><span data-stu-id="3ea86-200">![Add new item](real-time-web-applications-with-signalr/_static/image11.png "Add new item")</span></span>

    <span data-ttu-id="3ea86-201">*Přidat novou položku*</span><span class="sxs-lookup"><span data-stu-id="3ea86-201">*Add new item*</span></span>
6. <span data-ttu-id="3ea86-202">V **přidat novou položku** dialogové okno, vyberte **Visual C# | Web | SignalR** uzlu v levém podokně, vyberte **třídy rozbočovače SignalR (v2)** z podokna center název souboru **StatisticsHub.cs** a klikněte na tlačítko **přidat**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-202">In the **Add New Item** dialog box, select the **Visual C# | Web | SignalR** node in the left pane, select **SignalR Hub Class (v2)** from the center pane, name the file **StatisticsHub.cs** and click **Add**.</span></span>

    <span data-ttu-id="3ea86-203">![Přidat položku dialogové okno Nový](real-time-web-applications-with-signalr/_static/image12.png "přidat novou položku dialogové okno")</span><span class="sxs-lookup"><span data-stu-id="3ea86-203">![Add new item dialog box](real-time-web-applications-with-signalr/_static/image12.png "Add new item dialog box")</span></span>

    <span data-ttu-id="3ea86-204">*Přidat novou položku – dialogové okno*</span><span class="sxs-lookup"><span data-stu-id="3ea86-204">*Add new item dialog box*</span></span>
7. <span data-ttu-id="3ea86-205">Nahraďte kód v **StatisticsHub** třídy následujícím kódem.</span><span class="sxs-lookup"><span data-stu-id="3ea86-205">Replace the code in the **StatisticsHub** class with the following code.</span></span>

    <span data-ttu-id="3ea86-206">(Code fragment kódu - *RealTimeSignalR - Ex1 - StatisticsHubClass*)</span><span class="sxs-lookup"><span data-stu-id="3ea86-206">(Code Snippet - *RealTimeSignalR - Ex1 - StatisticsHubClass*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample3.cs)]
8. <span data-ttu-id="3ea86-207">Otevřete **Startup.cs** a přidejte následující řádek na konci **konfigurace** metoda.</span><span class="sxs-lookup"><span data-stu-id="3ea86-207">Open **Startup.cs** and add the following line at the end of the **Configuration** method.</span></span>

    <span data-ttu-id="3ea86-208">(Code fragment kódu - *RealTimeSignalR - Ex1 - MapSignalR*)</span><span class="sxs-lookup"><span data-stu-id="3ea86-208">(Code Snippet - *RealTimeSignalR - Ex1 - MapSignalR*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample4.cs)]
9. <span data-ttu-id="3ea86-209">Otevřete **StatisticsService.cs** stránky uvnitř **služby** složky a přidejte následující direktivy using.</span><span class="sxs-lookup"><span data-stu-id="3ea86-209">Open the **StatisticsService.cs** page inside the **Services** folder and add the following using directives.</span></span>

    <span data-ttu-id="3ea86-210">(Code fragment kódu - *RealTimeSignalR - Ex1 - UsingDirectives*)</span><span class="sxs-lookup"><span data-stu-id="3ea86-210">(Code Snippet - *RealTimeSignalR - Ex1 - UsingDirectives*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample5.cs)]
10. <span data-ttu-id="3ea86-211">Oznámit připojené klienty aktualizací, je třeba nejprve načíst **kontextu** objekt pro aktuální připojení.</span><span class="sxs-lookup"><span data-stu-id="3ea86-211">To notify connected clients of updates, you first retrieve a **Context** object for the current connection.</span></span> <span data-ttu-id="3ea86-212">**Rozbočovače** objektu obsahuje metody pro odesílání zpráv do jednoho klienta nebo všesměrového vysílání pro všechny připojené klienty.</span><span class="sxs-lookup"><span data-stu-id="3ea86-212">The **Hub** object contains methods to send messages to a single client or broadcast to all connected clients.</span></span> <span data-ttu-id="3ea86-213">Přidejte následující metodu do **StatisticsService** třída k vysílání dat statistiky.</span><span class="sxs-lookup"><span data-stu-id="3ea86-213">Add the following method to the **StatisticsService** class to broadcast the statistics data.</span></span>

    <span data-ttu-id="3ea86-214">(Code fragment kódu - *RealTimeSignalR - Ex1 - NotifyUpdatesMethod*)</span><span class="sxs-lookup"><span data-stu-id="3ea86-214">(Code Snippet - *RealTimeSignalR - Ex1 - NotifyUpdatesMethod*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample6.cs)]

    > [!NOTE]
    > <span data-ttu-id="3ea86-215">Ve výše uvedeném kódu, používáte název libovolný metoda k volání funkce na straně klienta (tj.: *updateStatistics*).</span><span class="sxs-lookup"><span data-stu-id="3ea86-215">In the code above, you are using an arbitrary method name to call a function on the client (i.e.: *updateStatistics*).</span></span> <span data-ttu-id="3ea86-216">Název metody, který zadáte interpretována jako dynamický objekt, což znamená, že není žádná IntelliSense nebo kompilace přijme se.</span><span class="sxs-lookup"><span data-stu-id="3ea86-216">The method name that you specify is interpreted as a dynamic object, which means there is no IntelliSense or compile-time validation for it.</span></span> <span data-ttu-id="3ea86-217">Vyhodnotí výraz v době běhu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-217">The expression is evaluated at run time.</span></span> <span data-ttu-id="3ea86-218">Při volání metody, které spouští, odešle SignalR název metody a hodnoty parametru klientovi.</span><span class="sxs-lookup"><span data-stu-id="3ea86-218">When the method call executes, SignalR sends the method name and the parameter values to the client.</span></span> <span data-ttu-id="3ea86-219">Pokud má klient metodu, která odpovídá názvu, že metoda je volána a hodnoty parametrů jsou předat do ní.</span><span class="sxs-lookup"><span data-stu-id="3ea86-219">If the client has a method that matches the name, that method is called and the parameter values are passed to it.</span></span> <span data-ttu-id="3ea86-220">Pokud žádná odpovídající metoda nenajde na straně klienta, je vyvolána žádná chyba.</span><span class="sxs-lookup"><span data-stu-id="3ea86-220">If no matching method is found on the client, no error is raised.</span></span> <span data-ttu-id="3ea86-221">Další informace najdete v části [ASP.NET SignalR centra API průvodce](../guide-to-the-api/hubs-api-guide-server.md).</span><span class="sxs-lookup"><span data-stu-id="3ea86-221">For more information, refer to [ASP.NET SignalR Hubs API Guide](../guide-to-the-api/hubs-api-guide-server.md).</span></span>
11. <span data-ttu-id="3ea86-222">Otevřete **TriviaController.cs** stránky uvnitř **řadiče** složky a přidejte následující direktivy using.</span><span class="sxs-lookup"><span data-stu-id="3ea86-222">Open the **TriviaController.cs** page inside the **Controllers** folder and add the following using directives.</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample7.cs)]
12. <span data-ttu-id="3ea86-223">Přidejte následující zvýrazněný kód, který **Post** metody akce.</span><span class="sxs-lookup"><span data-stu-id="3ea86-223">Add the following highlighted code to the **Post** action method.</span></span>

    <span data-ttu-id="3ea86-224">(Code fragment kódu - *RealTimeSignalR - Ex1 - NotifyUpdatesCall*)</span><span class="sxs-lookup"><span data-stu-id="3ea86-224">(Code Snippet - *RealTimeSignalR - Ex1 - NotifyUpdatesCall*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample8.cs)]
13. <span data-ttu-id="3ea86-225">Otevřete **Statistics.cshtml** stránky uvnitř **zobrazení | Domů** složky.</span><span class="sxs-lookup"><span data-stu-id="3ea86-225">Open the **Statistics.cshtml** page inside the **Views | Home** folder.</span></span> <span data-ttu-id="3ea86-226">Vyhledejte **skripty** a přidejte následující reference skriptu na začátku části.</span><span class="sxs-lookup"><span data-stu-id="3ea86-226">Locate the **Scripts** section and add the following script references at the beginning of the section.</span></span>

    <span data-ttu-id="3ea86-227">(Code fragment kódu - *RealTimeSignalR - Ex1 - SignalRScriptReferences*)</span><span class="sxs-lookup"><span data-stu-id="3ea86-227">(Code Snippet - *RealTimeSignalR - Ex1 - SignalRScriptReferences*)</span></span>

    [!code-cshtml[Main](real-time-web-applications-with-signalr/samples/sample9.cshtml)]

    > [!NOTE]
    > <span data-ttu-id="3ea86-228">Když přidáte do projektu sady Visual Studio SignalR a další skript knihovny, může správce balíčků nainstalujte verzi souboru skriptu SignalR, která je novější než verze uvedené v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-228">When you add SignalR and other script libraries to your Visual Studio project, the Package Manager might install a version of the SignalR script file that is more recent than the version shown in this topic.</span></span> <span data-ttu-id="3ea86-229">Ujistěte se, že odkaz na skript v kódu odpovídá verzi knihovny skriptu nainstalovaná ve vašem projektu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-229">Make sure that the script reference in your code matches the version of the script library installed in your project.</span></span>
14. <span data-ttu-id="3ea86-230">Přidejte následující zvýrazněný kód k připojení klienta k rozbočovači SignalR a aktualizaci statistiky dat při přijetí nové zprávy z rozbočovače.</span><span class="sxs-lookup"><span data-stu-id="3ea86-230">Add the following highlighted code to connect the client to the SignalR hub and update the statistics data when a new message is received from the hub.</span></span>

    <span data-ttu-id="3ea86-231">(Code fragment kódu - *RealTimeSignalR - Ex1 - SignalRClientCode*)</span><span class="sxs-lookup"><span data-stu-id="3ea86-231">(Code Snippet - *RealTimeSignalR - Ex1 - SignalRClientCode*)</span></span>

    [!code-cshtml[Main](real-time-web-applications-with-signalr/samples/sample10.cshtml)]

    <span data-ttu-id="3ea86-232">V tomto kódu jsou vytváření proxy server rozbočovače a registraci obslužné rutiny události pro naslouchání zpráv odeslaných serverem.</span><span class="sxs-lookup"><span data-stu-id="3ea86-232">In this code, you are creating a Hub Proxy and registering an event handler to listen for messages sent by the server.</span></span> <span data-ttu-id="3ea86-233">V takovém případě můžete přijímat zprávy odeslané přes *updateStatistics* metoda.</span><span class="sxs-lookup"><span data-stu-id="3ea86-233">In this case, you listen for messages sent through the *updateStatistics* method.</span></span>

<a id="Ex1Task3"></a>
#### <a name="task-3--running-the-solution"></a><span data-ttu-id="3ea86-234">Úloha 3 – spuštění řešení</span><span class="sxs-lookup"><span data-stu-id="3ea86-234">Task 3 – Running the Solution</span></span>

<span data-ttu-id="3ea86-235">V této úloze budete spouštět řešení a ověřte, že zobrazení statistiky aktualizován automaticky pomocí SignalR po odpovědi na novou otázku.</span><span class="sxs-lookup"><span data-stu-id="3ea86-235">In this task, you will run the solution to verify that the statistics view is updated automatically using SignalR after answering a new question.</span></span>

1. <span data-ttu-id="3ea86-236">Stiskněte klávesu **F5** ke spuštění řešení.</span><span class="sxs-lookup"><span data-stu-id="3ea86-236">Press **F5** to run the solution.</span></span>

    > [!NOTE]
    > <span data-ttu-id="3ea86-237">Pokud už nejste přihlášení k aplikaci, přihlaste se pomocí uživatele, kterého jste vytvořili v úloze 1.</span><span class="sxs-lookup"><span data-stu-id="3ea86-237">If not already logged in to the application, log in with the user you created in Task 1.</span></span>
2. <span data-ttu-id="3ea86-238">Otevřete **statistiky** stránky v novém okně a umístí **Domů** stránky a **statistiky** stránky vedle sebe, jako jste to udělali v úloze 1.</span><span class="sxs-lookup"><span data-stu-id="3ea86-238">Open the **Statistics** page in a new window and put the **Home** page and **Statistics** page side-by-side as you did in Task 1.</span></span>
3. <span data-ttu-id="3ea86-239">V **Domů** stránky, odpovězte na otázku kliknutím na jednu z možností.</span><span class="sxs-lookup"><span data-stu-id="3ea86-239">In the **Home** page, answer the question by clicking one of the options.</span></span>

    <span data-ttu-id="3ea86-240">![Odpovědi na jinou otázku](real-time-web-applications-with-signalr/_static/image13.png "odpovědi na jinou otázku")</span><span class="sxs-lookup"><span data-stu-id="3ea86-240">![Answering another question](real-time-web-applications-with-signalr/_static/image13.png "Answering another question")</span></span>

    <span data-ttu-id="3ea86-241">*Odpovědi na jinou otázku*</span><span class="sxs-lookup"><span data-stu-id="3ea86-241">*Answering another question*</span></span>
4. <span data-ttu-id="3ea86-242">Po kliknutí na tlačítko požadovaného, by se zobrazit odpověď.</span><span class="sxs-lookup"><span data-stu-id="3ea86-242">After clicking one of the buttons, the answer should appear.</span></span> <span data-ttu-id="3ea86-243">Všimněte si, že statistické informace na stránce se aktualizuje automaticky po odpovědi na otázky se aktualizované informace, aniž by bylo nutné aktualizovat celou stránku.</span><span class="sxs-lookup"><span data-stu-id="3ea86-243">Notice that the Statistics information on the page is updated automatically after answering the question with the updated information without the need to refresh the entire page.</span></span>

    <span data-ttu-id="3ea86-244">![Stránka statistiky aktualizují po provedení odpovědí](real-time-web-applications-with-signalr/_static/image14.png "stránka statistiky aktualizují po provedení odpovědí")</span><span class="sxs-lookup"><span data-stu-id="3ea86-244">![Statistics page refreshed after answer](real-time-web-applications-with-signalr/_static/image14.png "Statistics page refreshed after answer")</span></span>

    <span data-ttu-id="3ea86-245">*Stránka statistiky aktualizovat po odpovědí*</span><span class="sxs-lookup"><span data-stu-id="3ea86-245">*Statistics page refreshed after answer*</span></span>

<a id="Exercise2"></a>
### <a name="exercise-2-scaling-out-using-sql-server"></a><span data-ttu-id="3ea86-246">Cvičení 2: Škálování pomocí SQL serveru</span><span class="sxs-lookup"><span data-stu-id="3ea86-246">Exercise 2: Scaling Out Using SQL Server</span></span>

<span data-ttu-id="3ea86-247">Při příjmu webové aplikace, je obecně možné mezi *vertikálním navýšení kapacity* a *horizontální navýšení kapacity* možnosti.</span><span class="sxs-lookup"><span data-stu-id="3ea86-247">When scaling a web application, you can generally choose between *scaling up* and *scaling out* options.</span></span> <span data-ttu-id="3ea86-248">*Vertikální navýšení kapacity* znamená větší server pomocí více prostředků (procesoru, paměti RAM atd.) při *škálovat* znamená přidávat další servery pro zpracování zátěže.</span><span class="sxs-lookup"><span data-stu-id="3ea86-248">*Scale up* means using a larger server, with more resources (CPU, RAM, etc.) while *scale out* means adding more servers to handle the load.</span></span> <span data-ttu-id="3ea86-249">Problém s k tomu je, že klienti mohou získat směrované na různých serverech.</span><span class="sxs-lookup"><span data-stu-id="3ea86-249">The problem with the latter is that the clients can get routed to different servers.</span></span> <span data-ttu-id="3ea86-250">Klient, který je připojený k jednomu serveru nebude příjem zpráv odeslaných z jiného serveru.</span><span class="sxs-lookup"><span data-stu-id="3ea86-250">A client that is connected to one server will not receive messages sent from another server.</span></span>

<span data-ttu-id="3ea86-251">Tyto problémy můžete vyřešit pomocí komponenty s názvem *propojovacího rozhraní*, k předávání zpráv mezi servery.</span><span class="sxs-lookup"><span data-stu-id="3ea86-251">You can solve these issues by using a component called *backplane*, to forward messages between servers.</span></span> <span data-ttu-id="3ea86-252">S propojovacího rozhraní povoleno každá instance aplikace odesílá zprávy do propojovacího rozhraní a předává je propojovacího rozhraní dalších instancí aplikace.</span><span class="sxs-lookup"><span data-stu-id="3ea86-252">With a backplane enabled, each application instance sends messages to the backplane, and the backplane forwards them to the other application instances.</span></span>

<span data-ttu-id="3ea86-253">Aktuálně existují tři typy backplanes pro SignalR:</span><span class="sxs-lookup"><span data-stu-id="3ea86-253">There are currently three types of backplanes for SignalR:</span></span>

- <span data-ttu-id="3ea86-254">**Windows Azure Service Bus**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-254">**Windows Azure Service Bus**.</span></span> <span data-ttu-id="3ea86-255">Service Bus je zasílání zpráv infrastrukturu, která umožňuje součásti odesílat volně párované zprávy.</span><span class="sxs-lookup"><span data-stu-id="3ea86-255">Service Bus is a messaging infrastructure that allows components to send loosely coupled messages.</span></span>
- <span data-ttu-id="3ea86-256">**SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-256">**SQL Server**.</span></span> <span data-ttu-id="3ea86-257">Propojovací rozhraní systému SQL Server zapíše zprávy do tabulky SQL.</span><span class="sxs-lookup"><span data-stu-id="3ea86-257">The SQL Server backplane writes messages to SQL tables.</span></span> <span data-ttu-id="3ea86-258">Propojovacího rozhraní používá službu Service Broker pro efektivní zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="3ea86-258">The backplane uses Service Broker for efficient messaging.</span></span> <span data-ttu-id="3ea86-259">Ale spolupracuje také pokud Service Broker není povolena.</span><span class="sxs-lookup"><span data-stu-id="3ea86-259">However, it also works if Service Broker is not enabled.</span></span>
- <span data-ttu-id="3ea86-260">**Redis**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-260">**Redis**.</span></span> <span data-ttu-id="3ea86-261">Redis je úložišti klíč hodnota v paměti.</span><span class="sxs-lookup"><span data-stu-id="3ea86-261">Redis is an in-memory key-value store.</span></span> <span data-ttu-id="3ea86-262">Redis podporuje vzor publikovat/odebírat ("pub nebo sub") pro odesílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="3ea86-262">Redis supports a publish/subscribe ("pub/sub") pattern for sending messages.</span></span>

<span data-ttu-id="3ea86-263">Každá zpráva se budou odesílat prostřednictvím sběrnice zpráv.</span><span class="sxs-lookup"><span data-stu-id="3ea86-263">Every message is sent through a message bus.</span></span> <span data-ttu-id="3ea86-264">Implementuje sběrnice zpráv [IMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.messaging.imessagebus(v=vs.100).aspx) rozhraní, která poskytuje abstrakci se publikování a přihlášení k odběru.</span><span class="sxs-lookup"><span data-stu-id="3ea86-264">A message bus implements the [IMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.messaging.imessagebus(v=vs.100).aspx) interface, which provides a publish/subscribe abstraction.</span></span> <span data-ttu-id="3ea86-265">Backplanes fungovat tak, že nahradíte výchozí **IMessageBus** se sběrnicí určené pro tento propojovacího rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3ea86-265">The backplanes work by replacing the default **IMessageBus** with a bus designed for that backplane.</span></span>

<span data-ttu-id="3ea86-266">Každá instance serveru se připojí k propojovacího rozhraní přes sběrnici.</span><span class="sxs-lookup"><span data-stu-id="3ea86-266">Each server instance connects to the backplane through the bus.</span></span> <span data-ttu-id="3ea86-267">Pokud je odeslána zpráva, přejdete do propojovacího rozhraní a propojovacího rozhraní odešle ji do každého serveru.</span><span class="sxs-lookup"><span data-stu-id="3ea86-267">When a message is sent, it goes to the backplane, and the backplane sends it to every server.</span></span> <span data-ttu-id="3ea86-268">Když server přijme zprávu o z propojovacího rozhraní, ukládá zprávy v místní mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="3ea86-268">When a server receives a message from the backplane, it stores the message in its local cache.</span></span> <span data-ttu-id="3ea86-269">Server pak přináší zprávy pro klienty z místní mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="3ea86-269">The server then delivers messages to clients from its local cache.</span></span>

<span data-ttu-id="3ea86-270">Další informace o propojovacího rozhraní SignalR fungování, přečtěte si to [článku](../performance/scaleout-in-signalr.md).</span><span class="sxs-lookup"><span data-stu-id="3ea86-270">For more information about how the SignalR backplane works, read this [article](../performance/scaleout-in-signalr.md).</span></span>

> [!NOTE]
> <span data-ttu-id="3ea86-271">Je několik scénářů, kde propojovací rozhraní se může stát úzkým místem.</span><span class="sxs-lookup"><span data-stu-id="3ea86-271">There are some scenarios where a backplane can become a bottleneck.</span></span> <span data-ttu-id="3ea86-272">Zde jsou některé typické scénáře SignalR:</span><span class="sxs-lookup"><span data-stu-id="3ea86-272">Here are some typical SignalR scenarios:</span></span>
> 
> - <span data-ttu-id="3ea86-273">[Všesměrové vysílání server](tutorial-server-broadcast-with-signalr.md) (například běžícími): Backplanes fungovat i pro tento scénář, protože serveru ovládá rychlost, jakou jsou odesílány zprávy.</span><span class="sxs-lookup"><span data-stu-id="3ea86-273">[Server broadcast](tutorial-server-broadcast-with-signalr.md) (e.g., stock ticker): Backplanes work well for this scenario, because the server controls the rate at which messages are sent.</span></span>
> - <span data-ttu-id="3ea86-274">[Klient klient](tutorial-getting-started-with-signalr.md) (například chat): V tomto scénáři můžou propojovacího rozhraní problémové místo, pokud počet zpráv škáluje s počtem klientů; to znamená, pokud počet zpráv zvětšování úměrně Další klienti se připojují.</span><span class="sxs-lookup"><span data-stu-id="3ea86-274">[Client-to-client](tutorial-getting-started-with-signalr.md) (e.g., chat): In this scenario, the backplane might be a bottleneck if the number of messages scales with the number of clients; that is, if the rate of messages grows proportionally as more clients join.</span></span>
> - <span data-ttu-id="3ea86-275">[Vysoká frekvence v reálném čase](tutorial-high-frequency-realtime-with-signalr.md) (např. v reálném čase hry): propojovací rozhraní se nedoporučuje pro tento scénář.</span><span class="sxs-lookup"><span data-stu-id="3ea86-275">[High-frequency realtime](tutorial-high-frequency-realtime-with-signalr.md) (e.g., real-time games): A backplane is not recommended for this scenario.</span></span>


<span data-ttu-id="3ea86-276">V tomto cvičení použijete **systému SQL Server** k distribuci zpráv mezi **Geek kvízu** aplikace.</span><span class="sxs-lookup"><span data-stu-id="3ea86-276">In this exercise, you will use **SQL Server** to distribute messages across the **Geek Quiz** application.</span></span> <span data-ttu-id="3ea86-277">Tyto úlohy poběží na jeden testovací počítač se dozvíte, jak nastavit konfiguraci, ale pokud chcete získat úplné účinek, budete muset nasadit aplikaci SignalR na dva nebo více serverů.</span><span class="sxs-lookup"><span data-stu-id="3ea86-277">You will run these tasks on a single test machine to learn how to set up the configuration, but in order to get the full effect, you will need to deploy the SignalR application to two or more servers.</span></span> <span data-ttu-id="3ea86-278">Musíte také nainstalovat SQL Server na jednom ze serverů nebo na samostatný vyhrazený server.</span><span class="sxs-lookup"><span data-stu-id="3ea86-278">You must also install SQL Server on one of the servers, or on a separate dedicated server.</span></span>

![Horizontální navýšení kapacity pomocí Diagram serveru SQL](real-time-web-applications-with-signalr/_static/image15.png)

<a id="Ex2Task1"></a>
#### <a name="task-1---understanding-the-scenario"></a><span data-ttu-id="3ea86-280">Úloha 1 – Principy scénář</span><span class="sxs-lookup"><span data-stu-id="3ea86-280">Task 1 - Understanding the Scenario</span></span>

<span data-ttu-id="3ea86-281">V této úloze budete spouštět 2 instance **Geek kvízu** simulaci IIS více instancí v místním počítači.</span><span class="sxs-lookup"><span data-stu-id="3ea86-281">In this task, you will run 2 instances of **Geek Quiz** simulating multiple IIS instances on your local machine.</span></span> <span data-ttu-id="3ea86-282">V tomto scénáři při odpovědi na otázky trivia na jednu aplikaci nebudete nijak upozorněni aktualizace na stránce Statistika druhé instance.</span><span class="sxs-lookup"><span data-stu-id="3ea86-282">In this scenario, when answering trivia questions on one application, update won't be notified on the statistics page of the second instance.</span></span> <span data-ttu-id="3ea86-283">Tato simulace vypadá takto: prostředí, kde vaše aplikace je nasazená na několik instancí a použití služby Vyrovnávání zatížení komunikovat s nimi.</span><span class="sxs-lookup"><span data-stu-id="3ea86-283">This simulation resembles an environment where your application is deployed on multiple instances and using a load balancer to communicate with them.</span></span>

1. <span data-ttu-id="3ea86-284">Otevřete **Begin.sln** řešení umístěný v **zdroj/Ex2-ScalingOutWithSQLServer/Begin** složky.</span><span class="sxs-lookup"><span data-stu-id="3ea86-284">Open the **Begin.sln** solution located in the **Source/Ex2-ScalingOutWithSQLServer/Begin** folder.</span></span> <span data-ttu-id="3ea86-285">Jakmile načteny, si všimnete na **Průzkumníka serveru** , řešení obsahuje dva projekty s identické struktury ale různými názvy.</span><span class="sxs-lookup"><span data-stu-id="3ea86-285">Once loaded, you will notice on the **Server Explorer** that the solution has two projects with identical structures but different names.</span></span> <span data-ttu-id="3ea86-286">To bude simulovat spuštěné dvě instance stejné aplikace na místním počítači.</span><span class="sxs-lookup"><span data-stu-id="3ea86-286">This will simulate running two instances of the same application on your local machine.</span></span>

    <span data-ttu-id="3ea86-287">![Začněte řešení simulaci 2 instance Geek kvízu s časovým limitem](real-time-web-applications-with-signalr/_static/image16.png "začít řešení simulaci 2 instance Geek kvízu s časovým limitem")</span><span class="sxs-lookup"><span data-stu-id="3ea86-287">![Begin Solution Simulating 2 Instances of Geek Quiz](real-time-web-applications-with-signalr/_static/image16.png "Begin Solution Simulating 2 Instances of Geek Quiz")</span></span>

    <span data-ttu-id="3ea86-288">*Začněte řešení simulaci 2 instance Geek kvízu s časovým limitem*</span><span class="sxs-lookup"><span data-stu-id="3ea86-288">*Begin Solution Simulating 2 Instances of Geek Quiz*</span></span>
2. <span data-ttu-id="3ea86-289">Otevře se stránka vlastností řešení pravým tlačítkem myši na uzel řešení a výběrem **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-289">Open the properties page of the solution by right-clicking the solution node and selecting **Properties**.</span></span> <span data-ttu-id="3ea86-290">V části **spouštěný projekt**, vyberte **více projektů po spuštění** a změňte **akce** hodnotu pro oba projekty tak, aby *spustit*.</span><span class="sxs-lookup"><span data-stu-id="3ea86-290">Under **Startup Project**, select **Multiple startup projects** and change the **Action** value for both projects to *Start*.</span></span>

    <span data-ttu-id="3ea86-291">![Spouštění více projektů](real-time-web-applications-with-signalr/_static/image17.png "spouštění více projektů")</span><span class="sxs-lookup"><span data-stu-id="3ea86-291">![Starting Multiple Projects](real-time-web-applications-with-signalr/_static/image17.png "Starting Multiple Projects")</span></span>

    <span data-ttu-id="3ea86-292">*Spouštění více projektů*</span><span class="sxs-lookup"><span data-stu-id="3ea86-292">*Starting Multiple Projects*</span></span>
3. <span data-ttu-id="3ea86-293">Stiskněte klávesu **F5** ke spuštění řešení.</span><span class="sxs-lookup"><span data-stu-id="3ea86-293">Press **F5** to run the solution.</span></span> <span data-ttu-id="3ea86-294">Aplikace spustí dvě instance **Geek kvízu** v jiné porty, simulaci více instancí stejné aplikace.</span><span class="sxs-lookup"><span data-stu-id="3ea86-294">The application will launch two instances of **Geek Quiz** in different ports, simulating multiple instances of the same application.</span></span> <span data-ttu-id="3ea86-295">Jeden z prohlížečů PIN kódu na levé straně a druhý na pravé straně obrazovky.</span><span class="sxs-lookup"><span data-stu-id="3ea86-295">Pin one of the browsers on left and the other on the right of your screen.</span></span> <span data-ttu-id="3ea86-296">Přihlaste se pomocí přihlašovacích údajů nebo registraci nového uživatele.</span><span class="sxs-lookup"><span data-stu-id="3ea86-296">Log in with your credentials or register a new user.</span></span> <span data-ttu-id="3ea86-297">Po přihlášení, zachovat stránce Trivia na levé straně a Přejít **statistiky** stránku v prohlížeči na pravé straně.</span><span class="sxs-lookup"><span data-stu-id="3ea86-297">Once logged in, keep the Trivia page on the left and go to the **Statistics** page in the browser on the right.</span></span>

    ![Geek kvízu vedle sebe](real-time-web-applications-with-signalr/_static/image18.png)

    <span data-ttu-id="3ea86-299">*Geek kvízu vedle sebe*</span><span class="sxs-lookup"><span data-stu-id="3ea86-299">*Geek Quiz Side by Side*</span></span>

    ![Geek kvízu s časovým limitem v jiné porty](real-time-web-applications-with-signalr/_static/image19.png)

    <span data-ttu-id="3ea86-301">*Geek kvízu s časovým limitem v jiné porty*</span><span class="sxs-lookup"><span data-stu-id="3ea86-301">*Geek Quiz in Different Ports*</span></span>
4. <span data-ttu-id="3ea86-302">Spusťte zodpovězení otázek v levém prohlížeči a bude zjistíte, že **statistiky** stránku v prohlížeči správné není aktualizován.</span><span class="sxs-lookup"><span data-stu-id="3ea86-302">Start answering questions in the left browser and you will notice that the **Statistics** page in the right browser is not being updated.</span></span> <span data-ttu-id="3ea86-303">Důvodem je, že **SignalR** používá místní mezipaměti distribuci zprávy přes svým klientům a tento scénář je simulaci víc instancí, proto není mezi nimi sdílené mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="3ea86-303">This is because **SignalR** uses a local cache to distribute messages across their clients and this scenario is simulating multiple instances, therefore the cache is not shared between them.</span></span> <span data-ttu-id="3ea86-304">Ověřte, že **SignalR** pracuje podle testování stejný postup, ale pomocí jediné aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3ea86-304">You can verify that **SignalR** is working by testing the same steps but using a single app.</span></span> <span data-ttu-id="3ea86-305">V následujících úloh můžete nakonfigurovat propojovacího rozhraní k replikaci zprávy napříč instancemi.</span><span class="sxs-lookup"><span data-stu-id="3ea86-305">In the following tasks you will configure a backplane to replicate the messages across instances.</span></span>
5. <span data-ttu-id="3ea86-306">Přejděte zpět na Visual Studio a zastavte ladění.</span><span class="sxs-lookup"><span data-stu-id="3ea86-306">Go back to Visual Studio and stop debugging.</span></span>

<a id="Ex2Task2"></a>
#### <a name="task-2--creating-the-sql-server-backplane"></a><span data-ttu-id="3ea86-307">Úloha 2 – Vytvoření propojovacího rozhraní SQL Server</span><span class="sxs-lookup"><span data-stu-id="3ea86-307">Task 2 – Creating the SQL Server Backplane</span></span>

<span data-ttu-id="3ea86-308">V této úloze se vytvoří databázi, která bude sloužit jako propojovací rozhraní systému pro **Geek kvízu** aplikace.</span><span class="sxs-lookup"><span data-stu-id="3ea86-308">In this task, you will create a database that will serve as a backplane for the **Geek Quiz** application.</span></span> <span data-ttu-id="3ea86-309">Budete používat **Průzkumník objektů systému SQL Server** procházet váš server a inicializace databáze.</span><span class="sxs-lookup"><span data-stu-id="3ea86-309">You will use **SQL Server Object Explorer** to browse your server and initialize the database.</span></span> <span data-ttu-id="3ea86-310">Kromě toho vám umožní **služby Service Broker**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-310">Additionally, you will enable the **Service Broker**.</span></span>

1. <span data-ttu-id="3ea86-311">V **Visual Studio**, otevřete nabídku **zobrazení** a vyberte **Průzkumník objektů systému SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-311">In **Visual Studio**, open menu **View** and select **SQL Server Object Explorer**.</span></span>
2. <span data-ttu-id="3ea86-312">Připojení k vaší instanci LocalDB kliknutím pravým tlačítkem myši **systému SQL Server** uzlu a výběrem **přidat SQL Server...**  možnost.</span><span class="sxs-lookup"><span data-stu-id="3ea86-312">Connect to your LocalDB instance by right-clicking the **SQL Server** node and selecting **Add SQL Server...** option.</span></span>

    <span data-ttu-id="3ea86-313">![Přidání Instance systému SQL Server](real-time-web-applications-with-signalr/_static/image20.png "přidání Instance systému SQL Server")</span><span class="sxs-lookup"><span data-stu-id="3ea86-313">![Adding a SQL Server Instance](real-time-web-applications-with-signalr/_static/image20.png "Adding a SQL Server Instance")</span></span>

    <span data-ttu-id="3ea86-314">*Přidání instance systému SQL Server do Průzkumník objektů systému SQL Server*</span><span class="sxs-lookup"><span data-stu-id="3ea86-314">*Adding a SQL Server instance to SQL Server Object Explorer*</span></span>
3. <span data-ttu-id="3ea86-315">Nastavte **název serveru** k *(localdb) \v11.0* a nechte **ověřování systému Windows** jako vaše režim ověřování.</span><span class="sxs-lookup"><span data-stu-id="3ea86-315">Set the **server name** to *(localdb)\v11.0* and leave **Windows Authentication** as your authentication mode.</span></span> <span data-ttu-id="3ea86-316">Klikněte na tlačítko **Connect** pokračujte.</span><span class="sxs-lookup"><span data-stu-id="3ea86-316">Click **Connect** to continue.</span></span>

    <span data-ttu-id="3ea86-317">![Připojení k LocalDB](real-time-web-applications-with-signalr/_static/image21.png "připojení na instanci LocalDB")</span><span class="sxs-lookup"><span data-stu-id="3ea86-317">![Connecting to LocalDB](real-time-web-applications-with-signalr/_static/image21.png "Connecting to LocalDB")</span></span>

    <span data-ttu-id="3ea86-318">*Připojení k instanci LocalDB*</span><span class="sxs-lookup"><span data-stu-id="3ea86-318">*Connecting to LocalDB*</span></span>
4. <span data-ttu-id="3ea86-319">Teď, když se připojíte k vaší instanci LocalDB, musíte vytvořit databázi, která bude představovat propojovací rozhraní systému SQL Server pro služby SignalR.</span><span class="sxs-lookup"><span data-stu-id="3ea86-319">Now that you are connected to your LocalDB instance, you will need to create a database that will represent the SQL Server backplane for SignalR.</span></span> <span data-ttu-id="3ea86-320">Chcete-li to provést, klikněte pravým tlačítkem **databáze** uzel a vyberte možnost **přidat novou databázi**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-320">To do this, right-click the **Databases** node and select **Add New Database**.</span></span>

    <span data-ttu-id="3ea86-321">![Přidávání nové databáze](real-time-web-applications-with-signalr/_static/image22.png "přidávání nové databáze")</span><span class="sxs-lookup"><span data-stu-id="3ea86-321">![Adding a new database](real-time-web-applications-with-signalr/_static/image22.png "Adding a new database")</span></span>

    <span data-ttu-id="3ea86-322">*Přidávání nové databáze*</span><span class="sxs-lookup"><span data-stu-id="3ea86-322">*Adding a new database*</span></span>
5. <span data-ttu-id="3ea86-323">Nastavte název databáze na *SignalR* a klikněte na tlačítko **OK** k jeho vytvoření.</span><span class="sxs-lookup"><span data-stu-id="3ea86-323">Set the database name to *SignalR* and click **OK** to create it.</span></span>

    <span data-ttu-id="3ea86-324">![Vytvoření databáze SignalR](real-time-web-applications-with-signalr/_static/image23.png "vytvoření databáze SignalR")</span><span class="sxs-lookup"><span data-stu-id="3ea86-324">![Creating the SignalR database](real-time-web-applications-with-signalr/_static/image23.png "Creating the SignalR database")</span></span>

    <span data-ttu-id="3ea86-325">*Vytvoření databáze SignalR*</span><span class="sxs-lookup"><span data-stu-id="3ea86-325">*Creating the SignalR database*</span></span>

    > [!NOTE]
    > <span data-ttu-id="3ea86-326">Můžete použít libovolný název databáze.</span><span class="sxs-lookup"><span data-stu-id="3ea86-326">You can choose any name for the database.</span></span>
6. <span data-ttu-id="3ea86-327">Pokud chcete získat aktualizace efektivněji z propojovacího rozhraní, se doporučuje povolte službu Service Broker pro databázi.</span><span class="sxs-lookup"><span data-stu-id="3ea86-327">To receive updates more efficiently from the backplane, it is recommended to enable Service Broker for the database.</span></span> <span data-ttu-id="3ea86-328">Service Broker poskytuje nativní podporu pro zasílání zpráv a služby Řízení front v systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3ea86-328">Service Broker provides native support for messaging and queuing in SQL Server.</span></span> <span data-ttu-id="3ea86-329">Propojovacího rozhraní funguje taky bez služby Service Broker.</span><span class="sxs-lookup"><span data-stu-id="3ea86-329">The backplane also works without Service Broker.</span></span> <span data-ttu-id="3ea86-330">Otevřete nový dotaz tak, že kliknete pravým tlačítkem na databázi a vyberte **nový dotaz**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-330">Open a new query by right-clicking the database and select **New Query**.</span></span>

    <span data-ttu-id="3ea86-331">![Otevřete nový dotaz](real-time-web-applications-with-signalr/_static/image24.png "otevření nového dotazu")</span><span class="sxs-lookup"><span data-stu-id="3ea86-331">![Opening a New Query](real-time-web-applications-with-signalr/_static/image24.png "Opening a New Query")</span></span>

    <span data-ttu-id="3ea86-332">*Otevření nového dotazu*</span><span class="sxs-lookup"><span data-stu-id="3ea86-332">*Opening a New Query*</span></span>
7. <span data-ttu-id="3ea86-333">Chcete-li zkontrolovat, zda je povoleno služby Service Broker, dotaz **je\_zprostředkovatele\_povoleno** sloupec v **zobrazení sys.databases** katalogu zobrazení.</span><span class="sxs-lookup"><span data-stu-id="3ea86-333">To check whether Service Broker is enabled, query the **is\_broker\_enabled** column in the **sys.databases** catalog view.</span></span> <span data-ttu-id="3ea86-334">Spusťte následující skript v okně naposledy otevřeného dotazu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-334">Execute the following script in the recently opened query window.</span></span>

    [!code-sql[Main](real-time-web-applications-with-signalr/samples/sample11.sql)]

    <span data-ttu-id="3ea86-335">![Dotazování na stav služby Broker](real-time-web-applications-with-signalr/_static/image25.png "dotazování na stav zprostředkovatele služby.")</span><span class="sxs-lookup"><span data-stu-id="3ea86-335">![Querying the Service Broker Status](real-time-web-applications-with-signalr/_static/image25.png "Querying the Service Broker Status")</span></span>

    <span data-ttu-id="3ea86-336">*Dotazování na stav zprostředkovatele služby.*</span><span class="sxs-lookup"><span data-stu-id="3ea86-336">*Querying the Service Broker Status*</span></span>
8. <span data-ttu-id="3ea86-337">Pokud hodnota **je\_zprostředkovatele\_povoleno** sloupec v databázi je &quot;0&quot;, použijte následující příkaz k jeho povolení.</span><span class="sxs-lookup"><span data-stu-id="3ea86-337">If the value of the **is\_broker\_enabled** column in your database is &quot;0&quot;, use the following command to enable it.</span></span> <span data-ttu-id="3ea86-338">Nahraďte **&lt;YOUR databáze&gt;** s názvem jste nastavili při vytváření databáze (např: SignalR).</span><span class="sxs-lookup"><span data-stu-id="3ea86-338">Replace **&lt;YOUR-DATABASE&gt;** with the name you set when creating the database (e.g.: SignalR).</span></span>

    [!code-sql[Main](real-time-web-applications-with-signalr/samples/sample12.sql)]

    <span data-ttu-id="3ea86-339">![Povolení služby Service Broker](real-time-web-applications-with-signalr/_static/image26.png "povolení služby Service Broker")</span><span class="sxs-lookup"><span data-stu-id="3ea86-339">![Enabling Service Broker](real-time-web-applications-with-signalr/_static/image26.png "Enabling Service Broker")</span></span>

    <span data-ttu-id="3ea86-340">*Povolení služby Service Broker*</span><span class="sxs-lookup"><span data-stu-id="3ea86-340">*Enabling Service Broker*</span></span>

    > [!NOTE]
    > <span data-ttu-id="3ea86-341">Pokud tento dotaz zobrazí zablokování, ujistěte se, nejsou žádné aplikace, připojení k databázi.</span><span class="sxs-lookup"><span data-stu-id="3ea86-341">If this query appears to deadlock, make sure there are no applications connected to the DB.</span></span>

<a id="Ex2Task3"></a>
#### <a name="task-3--configuring-the-signalr-application"></a><span data-ttu-id="3ea86-342">Úloha 3 – konfigurace aplikace SignalR</span><span class="sxs-lookup"><span data-stu-id="3ea86-342">Task 3 – Configuring the SignalR Application</span></span>

<span data-ttu-id="3ea86-343">V této úloze nakonfigurujete **Geek kvízu** pro připojení k systému SQL Server propojovacího rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3ea86-343">In this task, you will configure **Geek Quiz** to connect to the SQL Server backplane.</span></span> <span data-ttu-id="3ea86-344">Nejprve přidejte **SignalR.SqlServer** balíček NuGet a sady připojení řetězec k vaší databázi propojovacího rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3ea86-344">You will first add the **SignalR.SqlServer** NuGet package and set the connection string to your backplane database.</span></span>

1. <span data-ttu-id="3ea86-345">Otevřete **Konzola správce balíčků** z **nástroje** | **Správce balíčků knihoven**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-345">Open the **Package Manager Console** from **Tools** | **Library Package Manager**.</span></span> <span data-ttu-id="3ea86-346">Ujistěte se, že **GeekQuiz** je vybrán projekt v **výchozí projekt** rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-346">Make sure that **GeekQuiz** project is selected in the **Default project** drop-down list.</span></span> <span data-ttu-id="3ea86-347">Zadejte následující příkaz k instalaci **Microsoft.AspNet.SignalR.SqlServer** balíček NuGet.</span><span class="sxs-lookup"><span data-stu-id="3ea86-347">Type the following command to install the **Microsoft.AspNet.SignalR.SqlServer** NuGet package.</span></span>

    [!code-powershell[Main](real-time-web-applications-with-signalr/samples/sample13.ps1)]
2. <span data-ttu-id="3ea86-348">Opakujte předchozí krok, ale tentokrát pro projekt **GeekQuiz2**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-348">Repeat the previous step but this time for project **GeekQuiz2**.</span></span>
3. <span data-ttu-id="3ea86-349">Ke konfiguraci propojovací rozhraní systému SQL Server, otevřete **Startup.cs** soubor **GeekQuiz** projekt a přidejte následující kód do **konfigurace** metoda.</span><span class="sxs-lookup"><span data-stu-id="3ea86-349">To configure the SQL Server backplane, open the **Startup.cs** file of the **GeekQuiz** project and add the following code to the **Configure** method.</span></span> <span data-ttu-id="3ea86-350">Nahraďte **&lt;YOUR databáze&gt;** názvem vaší databáze, můžete použít při vytváření propojovací rozhraní systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3ea86-350">Replace **&lt;YOUR-DATABASE&gt;** with your database name you used when creating the SQL Server backplane.</span></span> <span data-ttu-id="3ea86-351">Opakujte tento krok pro **GeekQuiz2** projektu.</span><span class="sxs-lookup"><span data-stu-id="3ea86-351">Repeat this step for the **GeekQuiz2** project.</span></span>

    <span data-ttu-id="3ea86-352">(Code fragment kódu - *RealTimeSignalR - Ex2 - StartupConfiguration*)</span><span class="sxs-lookup"><span data-stu-id="3ea86-352">(Code Snippet - *RealTimeSignalR - Ex2 - StartupConfiguration*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample14.cs)]
4. <span data-ttu-id="3ea86-353">Teď, když oba projekty jsou nakonfigurovány pro použití propojovací rozhraní systému SQL Server, stiskněte klávesu **F5** je současně spustit.</span><span class="sxs-lookup"><span data-stu-id="3ea86-353">Now that both projects are configured to use the SQL Server backplane, press **F5** to run them simultaneously.</span></span>
5. <span data-ttu-id="3ea86-354">Znovu **Visual Studio** spustí dvě instance **Geek kvízu** v jiné porty.</span><span class="sxs-lookup"><span data-stu-id="3ea86-354">Again, **Visual Studio** will launch two instances of **Geek Quiz** in different ports.</span></span> <span data-ttu-id="3ea86-355">Jeden z prohlížečů připnout na levé straně a druhý na pravé straně obrazovky a přihlaste se pomocí přihlašovacích údajů.</span><span class="sxs-lookup"><span data-stu-id="3ea86-355">Pin one of the browsers on the left and the other on the right of your screen and log in with your credentials.</span></span> <span data-ttu-id="3ea86-356">Zachovat stránce Trivia na levé straně, přejděte na **statistiky** pagein správné prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="3ea86-356">Keep the Trivia page on the left and go to **Statistics** pagein the right browser.</span></span>
6. <span data-ttu-id="3ea86-357">Spusťte odpovědi na otázky v levém prohlížeči.</span><span class="sxs-lookup"><span data-stu-id="3ea86-357">Start answering questions in the left browser.</span></span> <span data-ttu-id="3ea86-358">Tentokrát **statistiky** aktualizaci stránky díky propojovacího rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3ea86-358">This time, the **Statistics** page is updated thanks to the backplane.</span></span> <span data-ttu-id="3ea86-359">Přepínání mezi aplikací (**statistiky** je teď na levé straně a **Trivia** je na pravé straně) a opakujte test pro ověření, zda je funkční pro oba instance.</span><span class="sxs-lookup"><span data-stu-id="3ea86-359">Switch between applications (**Statistics** is now on the left, and **Trivia** is on the right) and repeat the test to validate that it is working for both instances.</span></span> <span data-ttu-id="3ea86-360">Propojovacího rozhraní slouží jako *sdílené mezipaměti* zpráv pro každý připojený server a každý server budou ukládat zprávy do vlastní místní mezipaměti pro distribuci do připojených klientů.</span><span class="sxs-lookup"><span data-stu-id="3ea86-360">The backplane serves as a *shared cache* of messages for each connected server, and each server will store the messages in their own local cache to distribute to connected clients.</span></span>
7. <span data-ttu-id="3ea86-361">Přejděte zpět na Visual Studio a zastavte ladění.</span><span class="sxs-lookup"><span data-stu-id="3ea86-361">Go back to Visual Studio and stop debugging.</span></span>
8. <span data-ttu-id="3ea86-362">Součást propojovací rozhraní systému SQL Server se automaticky vytvoří nezbytné tabulky se zadanou databází.</span><span class="sxs-lookup"><span data-stu-id="3ea86-362">The SQL Server backplane component automatically generates the necessary tables on the specified database.</span></span> <span data-ttu-id="3ea86-363">V **Průzkumník objektů systému SQL Server** panelu, otevřete databázi, který jste vytvořili pro propojovacího rozhraní (např: SignalR) a rozbalte její tabulky.</span><span class="sxs-lookup"><span data-stu-id="3ea86-363">In the **SQL Server Object Explorer** panel, open the database you created for the backplane (e.g.: SignalR) and expand its tables.</span></span> <span data-ttu-id="3ea86-364">Měli byste vidět v následujících tabulkách:</span><span class="sxs-lookup"><span data-stu-id="3ea86-364">You should see the following tables:</span></span>

    ![Propojovací rozhraní systému vygenerované tabulky](real-time-web-applications-with-signalr/_static/image27.png)

    <span data-ttu-id="3ea86-366">*Propojovací rozhraní systému vygenerované tabulky*</span><span class="sxs-lookup"><span data-stu-id="3ea86-366">*Backplane Generated Tables*</span></span>
9. <span data-ttu-id="3ea86-367">Klikněte pravým tlačítkem myši **SignalR.Messages\_0** tabulky a vyberte **Data zobrazení**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-367">Right-click the **SignalR.Messages\_0** table and select **View Data**.</span></span>

    ![Zobrazení tabulky zpráv propojovací rozhraní systému SignalR](real-time-web-applications-with-signalr/_static/image28.png)

    <span data-ttu-id="3ea86-369">*Zobrazení tabulky zpráv propojovací rozhraní systému SignalR*</span><span class="sxs-lookup"><span data-stu-id="3ea86-369">*View SignalR Backplane Messages Table*</span></span>
10. <span data-ttu-id="3ea86-370">Zobrazí se různé zprávy odeslané do **rozbočovače** při odpovědi na otázky trivia.</span><span class="sxs-lookup"><span data-stu-id="3ea86-370">You can see the different messages sent to the **Hub** when answering the trivia questions.</span></span> <span data-ttu-id="3ea86-371">Propojovacího rozhraní distribuuje tyto zprávy na jakoukoli instanci připojené.</span><span class="sxs-lookup"><span data-stu-id="3ea86-371">The backplane distributes these messages to any connected instance.</span></span>

    ![Tabulka zpráv propojovací rozhraní systému](real-time-web-applications-with-signalr/_static/image29.png)

    <span data-ttu-id="3ea86-373">*Tabulka zpráv propojovací rozhraní systému*</span><span class="sxs-lookup"><span data-stu-id="3ea86-373">*Backplane Messages Table*</span></span>

* * *

<a id="Summary"></a>
## <a name="summary"></a><span data-ttu-id="3ea86-374">Souhrn</span><span class="sxs-lookup"><span data-stu-id="3ea86-374">Summary</span></span>

<span data-ttu-id="3ea86-375">V tomto testovacím prostředí praktických jste se naučili postup přidání **SignalR** do aplikace a odesílání oznámení ze serveru vaší připojeným klientům pomocí **Hubs**.</span><span class="sxs-lookup"><span data-stu-id="3ea86-375">In this hands-on lab, you have learned how to add **SignalR** to your application and send notifications from the server to your connected clients using **Hubs**.</span></span> <span data-ttu-id="3ea86-376">Kromě toho jste zjistili, jak chcete škálovat aplikaci pomocí *propojovacího rozhraní* součást při nasazení vaší aplikace na několik instancí služby IIS.</span><span class="sxs-lookup"><span data-stu-id="3ea86-376">Additionally, you learned how to scale out your application by using a *backplane* component when your application is deployed in multiple IIS instances.</span></span>
