---
uid: signalr/overview/older-versions/introduction-to-security
title: Úvod k zabezpečení SignalR (SignalR 1.x) | Microsoft Docs
author: pfletcher
description: Popisuje problémy se zabezpečením, které musíte zvážit při vývoji aplikace SignalR.
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/17/2013
ms.topic: article
ms.assetid: 715a4059-d307-4631-abbb-c789c95d6eb4
ms.technology: dotnet-signalr
ms.prod: .net-framework
msc.legacyurl: /signalr/overview/older-versions/introduction-to-security
msc.type: authoredcontent
ms.openlocfilehash: b756d3e71d89b6c826bd497f73d052c4c8f634e8
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/06/2018
ms.locfileid: "30874194"
---
<a name="introduction-to-signalr-security-signalr-1x"></a><span data-ttu-id="c600e-103">Úvod k zabezpečení SignalR (SignalR 1.x)</span><span class="sxs-lookup"><span data-stu-id="c600e-103">Introduction to SignalR Security (SignalR 1.x)</span></span>
====================
<span data-ttu-id="c600e-104">podle [Patrik Fletcher](https://github.com/pfletcher), [tní FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="c600e-104">by [Patrick Fletcher](https://github.com/pfletcher), [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="c600e-105">Tento článek popisuje problémy se zabezpečením, které musíte zvážit při vývoji aplikace SignalR.</span><span class="sxs-lookup"><span data-stu-id="c600e-105">This article describes the security issues you must consider when developing a SignalR application.</span></span>


## <a name="overview"></a><span data-ttu-id="c600e-106">Přehled</span><span class="sxs-lookup"><span data-stu-id="c600e-106">Overview</span></span>

<span data-ttu-id="c600e-107">Tento dokument obsahuje následující části:</span><span class="sxs-lookup"><span data-stu-id="c600e-107">This document contains the following sections:</span></span>

- [<span data-ttu-id="c600e-108">Koncepty zabezpečení SignalR</span><span class="sxs-lookup"><span data-stu-id="c600e-108">SignalR Security Concepts</span></span>](#concepts)

    - [<span data-ttu-id="c600e-109">Ověřování a autorizace</span><span class="sxs-lookup"><span data-stu-id="c600e-109">Authentication and authorization</span></span>](#authentication)
    - [<span data-ttu-id="c600e-110">Token připojení</span><span class="sxs-lookup"><span data-stu-id="c600e-110">Connection token</span></span>](#connectiontoken)
    - [<span data-ttu-id="c600e-111">Při opětovné připojení, opětovné připojování ke skupinám</span><span class="sxs-lookup"><span data-stu-id="c600e-111">Rejoining groups when reconnecting</span></span>](#rejoingroup)
- [<span data-ttu-id="c600e-112">Jak SignalR brání padělání požadavku posílaného mezi weby</span><span class="sxs-lookup"><span data-stu-id="c600e-112">How SignalR prevents Cross-Site Request Forgery</span></span>](#csrf)
- [<span data-ttu-id="c600e-113">Doporučení zabezpečení SignalR</span><span class="sxs-lookup"><span data-stu-id="c600e-113">SignalR Security Recommendations</span></span>](#recommendations)

    - [<span data-ttu-id="c600e-114">Zabezpečený protokol soketu vrstvy (SSL)</span><span class="sxs-lookup"><span data-stu-id="c600e-114">Secure Socket Layers (SSL) protocol</span></span>](#ssl)
    - [<span data-ttu-id="c600e-115">Nepoužívejte skupiny jako mechanismus zabezpečení</span><span class="sxs-lookup"><span data-stu-id="c600e-115">Do not use groups as a security mechanism</span></span>](#groupsecurity)
    - [<span data-ttu-id="c600e-116">Bezpečně zpracování vstupu z klientů</span><span class="sxs-lookup"><span data-stu-id="c600e-116">Safely handling input from clients</span></span>](#input)
    - [<span data-ttu-id="c600e-117">Sjednocování změnu stavu uživatele s aktivního připojení</span><span class="sxs-lookup"><span data-stu-id="c600e-117">Reconciling a change in user status with an active connection</span></span>](#reconcile)
    - [<span data-ttu-id="c600e-118">Automaticky generované soubory proxy JavaScript</span><span class="sxs-lookup"><span data-stu-id="c600e-118">Automatically generated JavaScript proxy files</span></span>](#autogen)
    - [<span data-ttu-id="c600e-119">Výjimky</span><span class="sxs-lookup"><span data-stu-id="c600e-119">Exceptions</span></span>](#exceptions)

<a id="concepts"></a>

## <a name="signalr-security-concepts"></a><span data-ttu-id="c600e-120">Koncepty zabezpečení SignalR</span><span class="sxs-lookup"><span data-stu-id="c600e-120">SignalR Security Concepts</span></span>

<a id="authentication"></a>

### <a name="authentication-and-authorization"></a><span data-ttu-id="c600e-121">Ověřování a autorizace</span><span class="sxs-lookup"><span data-stu-id="c600e-121">Authentication and authorization</span></span>

<span data-ttu-id="c600e-122">SignalR je určena pro integrovat do stávající struktury ověřování pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c600e-122">SignalR is designed to be integrated into the existing authentication structure for an application.</span></span> <span data-ttu-id="c600e-123">Neposkytuje všechny funkce pro ověřování uživatelů.</span><span class="sxs-lookup"><span data-stu-id="c600e-123">It does not provide any features for authenticating users.</span></span> <span data-ttu-id="c600e-124">Místo toho můžete ověřování uživatelů, jako by normálně ve vaší aplikaci a pak pracovat s výsledky ověřování ve vašem kódu SignalR.</span><span class="sxs-lookup"><span data-stu-id="c600e-124">Instead, you authenticate users as you would normally in your application, and then work with the results of the authentication in your SignalR code.</span></span> <span data-ttu-id="c600e-125">Například můžete ověřit uživatele pomocí ověřování ASP.NET pomocí formulářů a pak vynutit v centru, kteří uživatelé nebo role mají oprávnění k volání metody.</span><span class="sxs-lookup"><span data-stu-id="c600e-125">For example, you might authenticate your users with ASP.NET forms authentication, and then in your hub, enforce which users or roles are authorized to call a method.</span></span> <span data-ttu-id="c600e-126">V centru můžete předat také informace o ověřování, jako je například uživatelské jméno nebo jestli se uživatel patří do role, do klienta.</span><span class="sxs-lookup"><span data-stu-id="c600e-126">In your hub, you can also pass authentication information, such as user name or whether a user belongs to a role, to the client.</span></span>

<span data-ttu-id="c600e-127">Funkce SignalR poskytuje [Autorizovat](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.authorizeattribute(v=vs.111).aspx) atribut k určení uživatelů, kteří mají přístup do rozbočovače nebo metoda.</span><span class="sxs-lookup"><span data-stu-id="c600e-127">SignalR provides the [Authorize](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.authorizeattribute(v=vs.111).aspx) attribute to specify which users have access to a hub or method.</span></span> <span data-ttu-id="c600e-128">Použít atribut autorizovat k rozbočovači nebo konkrétní metody v rozbočovači.</span><span class="sxs-lookup"><span data-stu-id="c600e-128">You apply the Authorize attribute to either a hub or particular methods in a hub.</span></span> <span data-ttu-id="c600e-129">Bez atribut autorizovat jsou k dispozici pro klienta, který je připojený k rozbočovači všechny veřejné metody v rozbočovači.</span><span class="sxs-lookup"><span data-stu-id="c600e-129">Without the Authorize attribute, all public methods on the hub are available to a client that is connected to the hub.</span></span> <span data-ttu-id="c600e-130">Další informace o centrech najdete v tématu [ověřování a autorizace pro rozbočovače SignalR](../security/hub-authorization.md).</span><span class="sxs-lookup"><span data-stu-id="c600e-130">For more information about hubs, see [Authentication and Authorization for SignalR Hubs](../security/hub-authorization.md).</span></span>

<span data-ttu-id="c600e-131">`Authorize` Atribut se používá jenom s rozbočovači.</span><span class="sxs-lookup"><span data-stu-id="c600e-131">The `Authorize` attribute is used only with hubs.</span></span> <span data-ttu-id="c600e-132">K vynucení pravidel autorizace při použití `PersistentConnection` je nutné přepsat `AuthorizeRequest` metoda.</span><span class="sxs-lookup"><span data-stu-id="c600e-132">To enforce authorization rules when using a `PersistentConnection` you must override the `AuthorizeRequest` method.</span></span> <span data-ttu-id="c600e-133">Další informace o trvalé připojení najdete v tématu [ověřování a autorizace pro trvalé připojení SignalR](../security/persistent-connection-authorization.md).</span><span class="sxs-lookup"><span data-stu-id="c600e-133">For more information about persistent connections, see [Authentication and Authorization for SignalR Persistent Connections](../security/persistent-connection-authorization.md).</span></span>

<a id="connectiontoken"></a>

### <a name="connection-token"></a><span data-ttu-id="c600e-134">Token připojení</span><span class="sxs-lookup"><span data-stu-id="c600e-134">Connection token</span></span>

<span data-ttu-id="c600e-135">SignalR snižuje riziko provádění škodlivý příkazy ověřením identity odesílatele.</span><span class="sxs-lookup"><span data-stu-id="c600e-135">SignalR mitigates the risk of executing malicious commands by validating the identity of the sender.</span></span> <span data-ttu-id="c600e-136">Token připojení obsahující id připojení a uživatelské jméno pro ověřené uživatele, se předávají mezi klientem a serverem pro každý požadavek.</span><span class="sxs-lookup"><span data-stu-id="c600e-136">A connection token, containing the connection id and username for authenticated users, is passed between the client and server for each request.</span></span> <span data-ttu-id="c600e-137">Id připojení je jedinečný identifikátor, který je náhodně generovaný serverem, když se vytvoří nové připojení a je trvalé po dobu trvání připojení.</span><span class="sxs-lookup"><span data-stu-id="c600e-137">The connection id is a unique identifier that is randomly generated by the server when a new connection is created, and is persisted for the duration of the connection.</span></span> <span data-ttu-id="c600e-138">Uživatelské jméno je poskytovaný ověřovací mechanismus pro webovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="c600e-138">The username is provided by the authentication mechanism for the web application.</span></span> <span data-ttu-id="c600e-139">Token připojení je chránit pomocí šifrování a digitální podpis.</span><span class="sxs-lookup"><span data-stu-id="c600e-139">The connection token is protected with encryption and a digital signature.</span></span>

![](introduction-to-security/_static/image2.png)

<span data-ttu-id="c600e-140">Pro každý požadavek server ověřuje obsah tokenu, aby zajistila, že požadavek pochází ze zadaného uživatele.</span><span class="sxs-lookup"><span data-stu-id="c600e-140">For each request, the server validates the contents of the token to ensure that the request is coming from the specified user.</span></span> <span data-ttu-id="c600e-141">Uživatelské jméno musí odpovídat id připojení. Tím, že ověří id připojení a uživatelské jméno, SignalR zabrání uživatel se zlými úmysly snadno zosobnění jiného uživatele.</span><span class="sxs-lookup"><span data-stu-id="c600e-141">The username must correspond to the connection id. By validating both the connection id and the username, SignalR prevents a malicious user from easily impersonating another user.</span></span> <span data-ttu-id="c600e-142">Pokud server nelze ověřit token připojení, žádost skončí s chybou.</span><span class="sxs-lookup"><span data-stu-id="c600e-142">If the server cannot validate the connection token, the request fails.</span></span>

![](introduction-to-security/_static/image4.png)

<span data-ttu-id="c600e-143">Id připojení je součástí procesu ověřování, by neměl odhalit id připojení pro jednoho uživatele jiným uživatelům nebo uložení hodnoty na straně klienta, jako v souboru cookie.</span><span class="sxs-lookup"><span data-stu-id="c600e-143">Because the connection id is part of the verification process, you should not reveal one user's connection id to other users or store the value on the client, such as in a cookie.</span></span>

<a id="rejoingroup"></a>

### <a name="rejoining-groups-when-reconnecting"></a><span data-ttu-id="c600e-144">Při opětovné připojení, opětovné připojování ke skupinám</span><span class="sxs-lookup"><span data-stu-id="c600e-144">Rejoining groups when reconnecting</span></span>

<span data-ttu-id="c600e-145">Ve výchozím nastavení SignalR aplikace bude automaticky znovu přiřadit uživatele do příslušných skupin po opětovném připojení z dočasné přerušení, jako je například když je připojení vyřazen a znovu vytvořit předtím, než vyprší časový limit připojení. Při opětovné připojení, klient bude provedeno úspěšně skupiny token, který obsahuje id připojení a skupiny přiřazené.</span><span class="sxs-lookup"><span data-stu-id="c600e-145">By default, the SignalR application will automatically re-assign a user to the appropriate groups when reconnecting from a temporary disruption, such as when a connection is dropped and re-established before the connection times out. When reconnecting, the client passes a group token that includes the connection id and the assigned groups.</span></span> <span data-ttu-id="c600e-146">Skupiny tokenu je digitálně podepsat a zašifrovat.</span><span class="sxs-lookup"><span data-stu-id="c600e-146">The group token is digitally signed and encrypted.</span></span> <span data-ttu-id="c600e-147">Klient zachová stejné id připojení po opětovné připojení; id připojení předán z opětovného připojení klienta proto musí odpovídat id předchozího připojení používaná klientem.</span><span class="sxs-lookup"><span data-stu-id="c600e-147">The client retains the same connection id after a reconnection; therefore, the connection id passed from the reconnected client must match the previous connection id used by the client.</span></span> <span data-ttu-id="c600e-148">Toto ověření zabrání předání žádosti o připojení neoprávněným skupiny při opětovném připojení uživatel se zlými úmysly.</span><span class="sxs-lookup"><span data-stu-id="c600e-148">This verification prevents a malicious user from passing requests to join unauthorized groups when reconnecting.</span></span>

<span data-ttu-id="c600e-149">Je ale důležité si uvědomit, že token skupiny nevyprší platnost.</span><span class="sxs-lookup"><span data-stu-id="c600e-149">However, it is important to note, that the group token does not expire.</span></span> <span data-ttu-id="c600e-150">Pokud uživatel patřil do skupiny v minulosti, ale byl vyloučen z této skupiny, může tento uživatel moci napodobovat skupiny token, který obsahuje zakázané skupiny.</span><span class="sxs-lookup"><span data-stu-id="c600e-150">If a user belonged to a group in the past, but was banned from that group, that user may be able to mimic a group token that includes the prohibited group.</span></span> <span data-ttu-id="c600e-151">Pokud potřebujete bezpečně spravovat uživatele, kteří patří do skupiny, které potřebujete k ukládání dat na serveru, například v databázi.</span><span class="sxs-lookup"><span data-stu-id="c600e-151">If you need to securely manage which users belong to which groups, you need to store that data on the server, such as in a database.</span></span> <span data-ttu-id="c600e-152">Potom si do vaší aplikace, která ověřuje na serveru, zda uživatel patří do skupiny přidejte logiku.</span><span class="sxs-lookup"><span data-stu-id="c600e-152">Then, add logic to your application that verifies on the server whether a user belongs to a group.</span></span> <span data-ttu-id="c600e-153">Příklad ověření členství ve skupině, najdete v části [práce se skupinami](../guide-to-the-api/working-with-groups.md).</span><span class="sxs-lookup"><span data-stu-id="c600e-153">For an example of verifying group membership, see [Working with groups](../guide-to-the-api/working-with-groups.md).</span></span>

<span data-ttu-id="c600e-154">Automaticky opětovné připojování ke skupinám platí pouze při připojení je znovu připojeny po dočasné přerušení.</span><span class="sxs-lookup"><span data-stu-id="c600e-154">Automatically rejoining groups only applies when a connection is reconnected after a temporary disruption.</span></span> <span data-ttu-id="c600e-155">Pokud uživatel odpojí podle přechodem z aplikace nebo se aplikace restartuje, aplikace musí zpracovávat postup přidání tohoto uživatele správný skupinám.</span><span class="sxs-lookup"><span data-stu-id="c600e-155">If a user disconnects by navigating away from the application or the application restarts, your application must handle how to add that user to the correct groups.</span></span> <span data-ttu-id="c600e-156">Další informace najdete v tématu [práce se skupinami](../guide-to-the-api/working-with-groups.md).</span><span class="sxs-lookup"><span data-stu-id="c600e-156">For more information, see [Working with groups](../guide-to-the-api/working-with-groups.md).</span></span>

<a id="csrf"></a>

## <a name="how-signalr-prevents-cross-site-request-forgery"></a><span data-ttu-id="c600e-157">Jak SignalR brání padělání požadavku posílaného mezi weby</span><span class="sxs-lookup"><span data-stu-id="c600e-157">How SignalR prevents Cross-Site Request Forgery</span></span>

<span data-ttu-id="c600e-158">Proti útokům webů padělání požadavku (CSRF) je útok, při kterém škodlivé weby odešle požadavek na citlivé lokality, kde uživatel momentálně přihlášen.</span><span class="sxs-lookup"><span data-stu-id="c600e-158">Cross-Site Request Forgery (CSRF) is an attack where a malicious site sends a request to a vulnerable site where the user is currently logged in.</span></span> <span data-ttu-id="c600e-159">SignalR zabraňuje proti útokům CSRF tím, že velmi pravděpodobně škodlivý lokality za účelem vytvoření žádost platná pro vaši aplikaci SignalR.</span><span class="sxs-lookup"><span data-stu-id="c600e-159">SignalR prevents CSRF by making it extremely unlikely for a malicious site to create a valid request for your SignalR application.</span></span>

### <a name="description-of-csrf-attack"></a><span data-ttu-id="c600e-160">Popis útoku proti útokům CSRF</span><span class="sxs-lookup"><span data-stu-id="c600e-160">Description of CSRF attack</span></span>

<span data-ttu-id="c600e-161">Tady je příklad útoku proti útokům CSRF:</span><span class="sxs-lookup"><span data-stu-id="c600e-161">Here is an example of a CSRF attack:</span></span>

1. <span data-ttu-id="c600e-162">Uživatel přihlásí do www.example.com, ověřování pomocí formulářů.</span><span class="sxs-lookup"><span data-stu-id="c600e-162">A user logs into www.example.com, using forms authentication.</span></span>
2. <span data-ttu-id="c600e-163">Server ověřuje uživatele.</span><span class="sxs-lookup"><span data-stu-id="c600e-163">The server authenticates the user.</span></span> <span data-ttu-id="c600e-164">Odpověď ze serveru obsahuje soubor cookie ověřování.</span><span class="sxs-lookup"><span data-stu-id="c600e-164">The response from the server includes an authentication cookie.</span></span>
3. <span data-ttu-id="c600e-165">Bez protokolování uživatel navštíví škodlivý web.</span><span class="sxs-lookup"><span data-stu-id="c600e-165">Without logging out, the user visits a malicious web site.</span></span> <span data-ttu-id="c600e-166">Tento škodlivý lokalita obsahuje následující formuláře HTML:</span><span class="sxs-lookup"><span data-stu-id="c600e-166">This malicious site contains the following HTML form:</span></span> 

    [!code-html[Main](introduction-to-security/samples/sample1.html)]

   <span data-ttu-id="c600e-167">Všimněte si, že akce formuláře požadavky na server, snadno napadnutelný, aby škodlivé weby.</span><span class="sxs-lookup"><span data-stu-id="c600e-167">Notice that the form action posts to the vulnerable site, not to the malicious site.</span></span> <span data-ttu-id="c600e-168">Toto je část "webů" proti útokům CSRF.</span><span class="sxs-lookup"><span data-stu-id="c600e-168">This is the "cross-site" part of CSRF.</span></span>
4. <span data-ttu-id="c600e-169">Uživatel kliknutím na tlačítko pro odeslání.</span><span class="sxs-lookup"><span data-stu-id="c600e-169">The user clicks the submit button.</span></span> <span data-ttu-id="c600e-170">V prohlížeči zahrnuje ověřovacího souboru cookie s požadavkem.</span><span class="sxs-lookup"><span data-stu-id="c600e-170">The browser includes the authentication cookie with the request.</span></span>
5. <span data-ttu-id="c600e-171">Žádost se spustí na serveru example.com s kontext ověřování uživatele a dělat vše, co ověřený uživatel může provádět.</span><span class="sxs-lookup"><span data-stu-id="c600e-171">The request runs on the example.com server with the user's authentication context, and can do anything that an authenticated user is allowed to do.</span></span>

<span data-ttu-id="c600e-172">I když tento příklad vyžaduje, aby uživatel klepnutím na tlačítko formuláře, na stránce škodlivého může stejným způsobem jako snadno spustit skript, který odešle požadavek AJAX do vaší aplikace SignalR.</span><span class="sxs-lookup"><span data-stu-id="c600e-172">Although this example requires the user to click the form button, the malicious page could just as easily run a script that sends an AJAX request to your SignalR application.</span></span> <span data-ttu-id="c600e-173">Kromě toho pomocí protokolu SSL nebrání útoku proti útokům CSRF protože škodlivé weby můžete odeslat požadavek "https://".</span><span class="sxs-lookup"><span data-stu-id="c600e-173">Moreover, using SSL does not prevent a CSRF attack, because the malicious site can send an "https://" request.</span></span>

<span data-ttu-id="c600e-174">Obvykle je možné proti webové stránky, které používají soubory cookie pro ověřování, proti útokům CSRF útokům, protože prohlížeče odesílají všechny relevantní soubory cookie k cílovému webu.</span><span class="sxs-lookup"><span data-stu-id="c600e-174">Typically, CSRF attacks are possible against web sites that use cookies for authentication, because browsers send all relevant cookies to the destination web site.</span></span> <span data-ttu-id="c600e-175">Útoky proti útokům CSRF však nejsou omezeny na zneužitím soubory cookie.</span><span class="sxs-lookup"><span data-stu-id="c600e-175">However, CSRF attacks are not limited to exploiting cookies.</span></span> <span data-ttu-id="c600e-176">Ověřování Basic a Digest jsou například také snadno napadnutelný.</span><span class="sxs-lookup"><span data-stu-id="c600e-176">For example, Basic and Digest authentication are also vulnerable.</span></span> <span data-ttu-id="c600e-177">Po přihlášení uživatele pomocí ověřování základní nebo Digest, v prohlížeči automaticky odesílá přihlašovací údaje až do ukončení relace.</span><span class="sxs-lookup"><span data-stu-id="c600e-177">After a user logs in with Basic or Digest authentication, the browser automatically sends the credentials until the session ends.</span></span>

### <a name="csrf-mitigations-taken-by-signalr"></a><span data-ttu-id="c600e-178">Způsoby zmírnění proti útokům CSRF provedenou SignalR</span><span class="sxs-lookup"><span data-stu-id="c600e-178">CSRF mitigations taken by SignalR</span></span>

<span data-ttu-id="c600e-179">SignalR provede následující kroky na škodlivé weby zabránit ve vytváření platné požadavky do vaší aplikace SignalR.</span><span class="sxs-lookup"><span data-stu-id="c600e-179">SignalR takes the following steps to prevent a malicious site from creating valid requests to your SignalR application.</span></span> <span data-ttu-id="c600e-180">Tyto kroky se provádějí ve výchozím nastavení a nevyžadují žádnou akci v kódu.</span><span class="sxs-lookup"><span data-stu-id="c600e-180">These steps are taken by default and do not require any action in your code.</span></span>

- <span data-ttu-id="c600e-181">**Zakázat žádosti napříč doménami**</span><span class="sxs-lookup"><span data-stu-id="c600e-181">**Disable cross domain requests**</span></span>  
 <span data-ttu-id="c600e-182">Ve výchozím nastavení křížové domény požadavky jsou zakázané v aplikaci SignalR uživatelům zabránit v volání koncový bod SignalR z externí domény.</span><span class="sxs-lookup"><span data-stu-id="c600e-182">By default, cross domain requests are disabled in a SignalR application to prevent users from calling a SignalR endpoint from an external domain.</span></span> <span data-ttu-id="c600e-183">Každá žádost, která pochází z externí domény je automaticky považovány za neplatné a budou blokovány.</span><span class="sxs-lookup"><span data-stu-id="c600e-183">Any request that comes from an external domain is automatically considered invalid and is blocked.</span></span> <span data-ttu-id="c600e-184">Doporučujeme, abyste toto výchozí chování; v opačném škodlivé weby by mohl přimět uživatele odesílání příkazů na váš web.</span><span class="sxs-lookup"><span data-stu-id="c600e-184">It is recommended that you keep this default behavior; otherwise, a malicious site could trick users into sending commands to your site.</span></span> <span data-ttu-id="c600e-185">Pokud budete muset použít napříč požadavky domény, najdete v části [postup připojení mezi doménami](../guide-to-the-api/hubs-api-guide-javascript-client.md#crossdomain) .</span><span class="sxs-lookup"><span data-stu-id="c600e-185">If you need to use cross domain requests, see     [How to establish a cross-domain connection](../guide-to-the-api/hubs-api-guide-javascript-client.md#crossdomain) .</span></span>
- <span data-ttu-id="c600e-186">**Předejte token připojení řetězce dotazu, není soubor cookie**</span><span class="sxs-lookup"><span data-stu-id="c600e-186">**Pass connection token in query string, not cookie**</span></span>  
 <span data-ttu-id="c600e-187">SignalR předá token připojení jako hodnotu řetězce dotazu místo jako soubor cookie.</span><span class="sxs-lookup"><span data-stu-id="c600e-187">SignalR passes the connection token as a query string value, instead of as a cookie.</span></span> <span data-ttu-id="c600e-188">Token připojení není uložíte jako soubor cookie, nastavení není token připojení v prohlížeči předají nechtěně vyskytne škodlivý kód.</span><span class="sxs-lookup"><span data-stu-id="c600e-188">By not storing the connection token as a cookie, the connection token is not inadvertently forwarded by the browser when malicious code is encountered.</span></span> <span data-ttu-id="c600e-189">Token připojení navíc není trvalý nad rámec aktuální připojení.</span><span class="sxs-lookup"><span data-stu-id="c600e-189">Also, the connection token is not persisted beyond the current connection.</span></span> <span data-ttu-id="c600e-190">Uživatel se zlými úmysly proto nelze provést žádost pověřeními ověřování jiným uživatelem.</span><span class="sxs-lookup"><span data-stu-id="c600e-190">Therefore, a malicious user cannot make a request under another user's authentication credentials.</span></span>
- <span data-ttu-id="c600e-191">**Ověřit token připojení**</span><span class="sxs-lookup"><span data-stu-id="c600e-191">**Verify connection token**</span></span>  
 <span data-ttu-id="c600e-192">Jak je popsáno v [token připojení](#connectiontoken) části serveru zná, které id připojení souvisí s každou ověřeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="c600e-192">As described in the [Connection token](#connectiontoken) section, the server knows which connection id is associated with each authenticated user.</span></span> <span data-ttu-id="c600e-193">Server nezpracovává každá žádost z id připojení, která neodpovídá uživatelské jméno.</span><span class="sxs-lookup"><span data-stu-id="c600e-193">The server does not process any request from a connection id that does not match the user name.</span></span> <span data-ttu-id="c600e-194">Není pravděpodobné, že uživatel se zlými úmysly může uhodnout žádost platná, protože uživatel se zlými úmysly musel předem znát uživatelské jméno a aktuální id náhodně generované připojení. Toto id připojení stává neplatným, jakmile je připojení ukončeno.</span><span class="sxs-lookup"><span data-stu-id="c600e-194">It is unlikely a malicious user could guess a valid request because the malicious user would have to know the user name and the current randomly-generated connection id. That connection id becomes invalid as soon as the connection is ended.</span></span> <span data-ttu-id="c600e-195">Anonymní uživatelé by neměl mít přístup k žádné citlivé informace.</span><span class="sxs-lookup"><span data-stu-id="c600e-195">Anonymous users should not have access to any sensitive information.</span></span>

<a id="recommendations"></a>

## <a name="signalr-security-recommendations"></a><span data-ttu-id="c600e-196">Doporučení zabezpečení SignalR</span><span class="sxs-lookup"><span data-stu-id="c600e-196">SignalR Security Recommendations</span></span>

<a id="ssl"></a>

### <a name="secure-socket-layers-ssl-protocol"></a><span data-ttu-id="c600e-197">Zabezpečený protokol soketu vrstvy (SSL)</span><span class="sxs-lookup"><span data-stu-id="c600e-197">Secure Socket Layers (SSL) protocol</span></span>

<span data-ttu-id="c600e-198">Protokol SSL používá šifrování k zabezpečení přenosu dat mezi klientem a serverem.</span><span class="sxs-lookup"><span data-stu-id="c600e-198">The SSL protocol uses encryption to secure the transport of data between a client and server.</span></span> <span data-ttu-id="c600e-199">Pokud vaše aplikace SignalR přenáší citlivé informace mezi klientem a serverem, použijte protokol SSL pro přenos.</span><span class="sxs-lookup"><span data-stu-id="c600e-199">If your SignalR application transmits sensitive information between the client and server, use SSL for the transport.</span></span> <span data-ttu-id="c600e-200">Další informace o nastavení protokolu SSL najdete v tématu [postup nastavení protokolu SSL ve službě IIS 7](https://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis).</span><span class="sxs-lookup"><span data-stu-id="c600e-200">For more information about setting up SSL, see [How to set up SSL on IIS 7](https://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis).</span></span>

<a id="groupsecurity"></a>

### <a name="do-not-use-groups-as-a-security-mechanism"></a><span data-ttu-id="c600e-201">Nepoužívejte skupiny jako mechanismus zabezpečení</span><span class="sxs-lookup"><span data-stu-id="c600e-201">Do not use groups as a security mechanism</span></span>

<span data-ttu-id="c600e-202">Skupiny jsou pohodlný způsob shromažďování související uživatele, ale nejsou zabezpečené mechanismus pro omezení přístupu k důvěrným informacím.</span><span class="sxs-lookup"><span data-stu-id="c600e-202">Groups are a convenient way of collecting related users, but they are not a secure mechanism for limiting access to sensitive information.</span></span> <span data-ttu-id="c600e-203">To platí hlavně když uživatelé mohou automaticky znovu připojí skupiny během o obnovení.</span><span class="sxs-lookup"><span data-stu-id="c600e-203">This is especially true when users can automatically rejoin groups during a reconnect.</span></span> <span data-ttu-id="c600e-204">Místo toho zvažte přidání mohou uživatelé s oprávněním k roli a omezení přístupu k metodě rozbočovače pouze členům této role.</span><span class="sxs-lookup"><span data-stu-id="c600e-204">Instead, consider adding privileged users to a role and limiting access to a hub method to only members of that role.</span></span> <span data-ttu-id="c600e-205">Příklad omezení přístupu na základě role, naleznete v části [ověřování a autorizace pro rozbočovače SignalR](../security/hub-authorization.md).</span><span class="sxs-lookup"><span data-stu-id="c600e-205">For an example of restricting access based on a role, see [Authentication and Authorization for SignalR Hubs](../security/hub-authorization.md).</span></span> <span data-ttu-id="c600e-206">Příklad ověření přístupu uživatelů do skupin, pokud připojení, naleznete v části [práce se skupinami](../guide-to-the-api/working-with-groups.md).</span><span class="sxs-lookup"><span data-stu-id="c600e-206">For an example of checking user access to groups when reconnecting, see [Working with groups](../guide-to-the-api/working-with-groups.md).</span></span>

<a id="input"></a>

### <a name="safely-handling-input-from-clients"></a><span data-ttu-id="c600e-207">Bezpečně zpracování vstupu z klientů</span><span class="sxs-lookup"><span data-stu-id="c600e-207">Safely handling input from clients</span></span>

<span data-ttu-id="c600e-208">Veškerý vstup z klientů, který je určený pro vysílání na jiných klientů musí být kódovaný zajistit, že uživatel se zlými úmysly neodesílá skriptu do jiných uživatelů.</span><span class="sxs-lookup"><span data-stu-id="c600e-208">All input from clients that is intended for broadcast to other clients must be encoded to ensure that a malicious user does not send script to other users.</span></span> <span data-ttu-id="c600e-209">Je nejvhodnější kódování zprávy v přijímající klientů, nikoli na server, protože aplikace SignalR může mít mnoho různých typů klientů.</span><span class="sxs-lookup"><span data-stu-id="c600e-209">It is best to encode messages on the receiving clients rather than the server, because your SignalR application may have many different types of clients.</span></span> <span data-ttu-id="c600e-210">Kódování HTML funguje proto webovému klientovi, ale ne pro jiné typy klientů.</span><span class="sxs-lookup"><span data-stu-id="c600e-210">Therefore, HTML-encoding works for a web client, but not for other types of clients.</span></span> <span data-ttu-id="c600e-211">Například metoda klienta webové zobrazíte chatovací zprávy by bezpečně popisovač uživatelské jméno a zpráva voláním `html()` funkce.</span><span class="sxs-lookup"><span data-stu-id="c600e-211">For example, a web client method to display a chat message would safely handle the user name and message by calling the `html()` function.</span></span>

[!code-html[Main](introduction-to-security/samples/sample2.html?highlight=3-4)]

<a id="reconcile"></a>

### <a name="reconciling-a-change-in-user-status-with-an-active-connection"></a><span data-ttu-id="c600e-212">Sjednocování změnu stavu uživatele s aktivního připojení</span><span class="sxs-lookup"><span data-stu-id="c600e-212">Reconciling a change in user status with an active connection</span></span>

<span data-ttu-id="c600e-213">Pokud se stav ověření uživatele, změní během aktivního připojení existuje, uživateli se zobrazí chyba s oznámením, "identity uživatele se nemůže změnit během aktivního připojení SignalR."</span><span class="sxs-lookup"><span data-stu-id="c600e-213">If a user's authentication status changes while an active connection exists, the user will receive an error that states, "The user identity cannot change during an active SignalR connection."</span></span> <span data-ttu-id="c600e-214">V takovém případě aplikace by měl znovu připojit k serveru a ujistěte se, že jsou koordinované id připojení a uživatelské jméno.</span><span class="sxs-lookup"><span data-stu-id="c600e-214">In that case, your application should re-connect to the server to make sure the connection id and username are coordinated.</span></span> <span data-ttu-id="c600e-215">Například pokud vaše aplikace umožňuje uživatelům odhlášení během aktivního připojení existuje, uživatelské jméno pro připojení se už nebude shodovat s názvem, je předaná pro další požadavek.</span><span class="sxs-lookup"><span data-stu-id="c600e-215">For example, if your application allows the user to log out while an active connection exists, the username for the connection will no longer match the name that is passed in for the next request.</span></span> <span data-ttu-id="c600e-216">Bude chtít zastavit připojení, než odhlášení uživatele a pak ji znovu spusťte.</span><span class="sxs-lookup"><span data-stu-id="c600e-216">You will want to stop the connection before the user logs out, and then restart it.</span></span>

<span data-ttu-id="c600e-217">Je ale důležité si uvědomit, že většina aplikací nebude potřeba ručně zastavit a spustit připojení.</span><span class="sxs-lookup"><span data-stu-id="c600e-217">However, it is important to note that most applications will not need to manually stop and start the connection.</span></span> <span data-ttu-id="c600e-218">Pokud vaše aplikace přesměruje uživatele na samostatné stránce po přihlášení, jako je například výchozí chování v aplikaci Web Forms nebo aplikace MVC nebo aktualizuje aktuální stránku po odhlášení, aktivní připojení automaticky odpojí a ne nevyžaduje žádnou další akci.</span><span class="sxs-lookup"><span data-stu-id="c600e-218">If your application redirects users to a separate page after logging out, such as the default behavior in a Web Forms application or MVC application, or refreshes the current page after logging out, the active connection is automatically disconnected and does not require any additional action.</span></span>

<span data-ttu-id="c600e-219">Následující příklad ukazuje, jak zastavit a spustit připojení v případě, že došlo ke změně stavu uživatele.</span><span class="sxs-lookup"><span data-stu-id="c600e-219">The following example shows how to stop and start a connection when the user status has changed.</span></span>

[!code-html[Main](introduction-to-security/samples/sample3.html)]

<span data-ttu-id="c600e-220">Nebo ověřování stavu uživatele může změnit, pokud váš web používá klouzavé vypršení platnosti se ověřování pomocí formulářů a neaktivní zachovat ověřovacího souboru cookie platné.</span><span class="sxs-lookup"><span data-stu-id="c600e-220">Or, the user's authentication status may change if your site uses sliding expiration with Forms Authentication, and there is no activity to keep the authentication cookie valid.</span></span> <span data-ttu-id="c600e-221">V takovém případě se odhlásit uživatele a uživatelské jméno se již nebudou shodovat s názvem uživatele v token připojení.</span><span class="sxs-lookup"><span data-stu-id="c600e-221">In that case, the user will be logged out and the user name will no longer match the user name in the connection token.</span></span> <span data-ttu-id="c600e-222">Tento problém můžete vyřešit tak, že přidáte některé skript, který pravidelně požádá o prostředek na webovém serveru chcete zachovat ověřovacího souboru cookie platné.</span><span class="sxs-lookup"><span data-stu-id="c600e-222">You can fix this problem by adding some script that periodically requests a resource on the web server to keep the authentication cookie valid.</span></span> <span data-ttu-id="c600e-223">Následující příklad ukazuje, jak požádat o prostředku každých 30 minut.</span><span class="sxs-lookup"><span data-stu-id="c600e-223">The following example shows how to request a resource every 30 minutes.</span></span>

[!code-javascript[Main](introduction-to-security/samples/sample4.js)]

<a id="autogen"></a>

### <a name="automatically-generated-javascript-proxy-files"></a><span data-ttu-id="c600e-224">Automaticky generované soubory proxy JavaScript</span><span class="sxs-lookup"><span data-stu-id="c600e-224">Automatically generated JavaScript proxy files</span></span>

<span data-ttu-id="c600e-225">Pokud nechcete zahrnout všechny rozbočovače a metody soubor proxy JavaScript pro každého uživatele, můžete zakázat automatické generování souboru.</span><span class="sxs-lookup"><span data-stu-id="c600e-225">If you do not want to include all of the hubs and methods in the JavaScript proxy file for each user, you can disable the automatic generation of the file.</span></span> <span data-ttu-id="c600e-226">Tuto možnost můžete zvolit, pokud máte více rozbočovače a metody, ale nechcete, aby každý uživatel znát všechny metody.</span><span class="sxs-lookup"><span data-stu-id="c600e-226">You might choose this option if you have multiple hubs and methods, but do not want every user to be aware of all of the methods.</span></span> <span data-ttu-id="c600e-227">Zakázat automatické generování nastavením **EnableJavaScriptProxies** k **false**.</span><span class="sxs-lookup"><span data-stu-id="c600e-227">You disable automatic generation by setting **EnableJavaScriptProxies** to **false**.</span></span>

[!code-csharp[Main](introduction-to-security/samples/sample5.cs)]

<span data-ttu-id="c600e-228">Další informace o souborech proxy JavaScript najdete v tématu [vygenerovaný proxy server a jakým způsobem vám](../guide-to-the-api/hubs-api-guide-javascript-client.md#genproxy).</span><span class="sxs-lookup"><span data-stu-id="c600e-228">For more information about the JavaScript proxy files, see [The generated proxy and what it does for you](../guide-to-the-api/hubs-api-guide-javascript-client.md#genproxy).</span></span> <a id="exceptions"></a>

### <a name="exceptions"></a><span data-ttu-id="c600e-229">Výjimky</span><span class="sxs-lookup"><span data-stu-id="c600e-229">Exceptions</span></span>

<span data-ttu-id="c600e-230">Vyhněte se předávání objektů výjimky pro klienty, vzhledem k tomu objekty mohou být citlivé informace pro klienty.</span><span class="sxs-lookup"><span data-stu-id="c600e-230">You should avoid passing exception objects to clients because the objects may expose sensitive information to the clients.</span></span> <span data-ttu-id="c600e-231">Místo toho volání metody na straně klienta, který zobrazí relevantní chybovou zprávu.</span><span class="sxs-lookup"><span data-stu-id="c600e-231">Instead, call a method on the client that displays the relevant error message.</span></span>

[!code-csharp[Main](introduction-to-security/samples/sample6.cs)]
