---
uid: whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
title: "Postupy: Přidání mobilních stránek do svých formulářů technologie ASP.NET nebo aplikace MVC | Microsoft Docs"
author: rick-anderson
description: "Tento způsob k popisuje různé způsoby, jak sloužit stránky optimalizované pro mobilní zařízení z vaší webové formuláře ASP.NET nebo aplikace MVC a navrhne architektury a..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/20/2011
ms.topic: article
ms.assetid: 3124f28e-cc32-418a-afe3-519fa56f4c36
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
msc.type: content
ms.openlocfilehash: aac359b26c508784793a67260dc2e65c30db687a
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/24/2018
---
<a name="how-to-add-mobile-pages-to-your-aspnet-web-forms--mvc-application"></a><span data-ttu-id="60860-103">Postupy: Přidání mobilních stránek do svých formulářů technologie ASP.NET nebo aplikace MVC</span><span class="sxs-lookup"><span data-stu-id="60860-103">How To: Add Mobile Pages to Your ASP.NET Web Forms / MVC Application</span></span>
====================
> <span data-ttu-id="60860-104">**Platí pro**</span><span class="sxs-lookup"><span data-stu-id="60860-104">**Applies To**</span></span>
> 
> - <span data-ttu-id="60860-105">Verze webových formulářů ASP.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="60860-105">ASP.NET Web Forms version 4.0</span></span>
> - <span data-ttu-id="60860-106">ASP.NET MVC verze 3.0</span><span class="sxs-lookup"><span data-stu-id="60860-106">ASP.NET MVC version 3.0</span></span>
> 
> <span data-ttu-id="60860-107">**Shrnutí**</span><span class="sxs-lookup"><span data-stu-id="60860-107">**Summary**</span></span>
> 
> <span data-ttu-id="60860-108">Tento způsob k popisuje různé způsoby, jak sloužit stránky optimalizované pro mobilní zařízení z vaší webové formuláře ASP.NET nebo aplikace MVC a navrhuje architektury a návrhu, které byste měli zvážit při cílení na širokou škálu zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-108">This How To describes various ways to serve pages optimized for mobile devices from your ASP.NET Web Forms / MVC application, and suggests architectural and design issues to consider when targeting a broad range of devices.</span></span> <span data-ttu-id="60860-109">Tento dokument také vysvětluje, proč jsou nyní zastaralé ovládací prvky Mobile ASP.NET z technologie ASP.NET 2.0 až 3.5 a popisuje některé moderní alternativy.</span><span class="sxs-lookup"><span data-stu-id="60860-109">This document also explains why the ASP.NET Mobile Controls from ASP.NET 2.0 to 3.5 are now obsolete, and discusses some modern alternatives.</span></span>


## <a name="contents"></a><span data-ttu-id="60860-110">Obsah</span><span class="sxs-lookup"><span data-stu-id="60860-110">Contents</span></span>

- <span data-ttu-id="60860-111">Přehled</span><span class="sxs-lookup"><span data-stu-id="60860-111">Overview</span></span>
- <span data-ttu-id="60860-112">Možnosti architektury</span><span class="sxs-lookup"><span data-stu-id="60860-112">Architectural options</span></span>
- <span data-ttu-id="60860-113">Zjišťování prohlížeče a zařízení</span><span class="sxs-lookup"><span data-stu-id="60860-113">Browser and device detection</span></span>
- <span data-ttu-id="60860-114">Jak poskytnout stránek specifických pro mobilní aplikace webových formulářů ASP.NET</span><span class="sxs-lookup"><span data-stu-id="60860-114">How ASP.NET Web Forms applications can present mobile-specific pages</span></span>
- <span data-ttu-id="60860-115">Jak poskytnout stránek specifických pro mobilní aplikace ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="60860-115">How ASP.NET MVC applications can present mobile-specific pages</span></span>
- <span data-ttu-id="60860-116">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="60860-116">Additional resources</span></span>

<span data-ttu-id="60860-117">Ukázky kódu ke stažení demonstraci tento dokument techniky pro webové formuláře ASP.NET a MVC naleznete v části [Mobile Apps & servery s technologií ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="60860-117">For downloadable code samples demonstrating this white paper's techniques for both ASP.NET Web Forms and MVC, see [Mobile Apps & Sites with ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span></span>

## <a name="overview"></a><span data-ttu-id="60860-118">Přehled</span><span class="sxs-lookup"><span data-stu-id="60860-118">Overview</span></span>

<span data-ttu-id="60860-119">Mobilní zařízení – smartphony, funkce telefonů a tabletů – dál zvýší popularita jako prostředek pro přístup k webu.</span><span class="sxs-lookup"><span data-stu-id="60860-119">Mobile devices – smartphones, feature phones, and tablets – continue to grow in popularity as a means to access the Web.</span></span> <span data-ttu-id="60860-120">Pro mnoho vývojářům webů a zaměřené na konkrétní webový firmy to znamená, že je stále důležité zajistit skvělé možnosti procházení pro návštěvníky pomocí těchto zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-120">For many web developers and web-oriented businesses, this means it's increasingly important to provide a great browsing experience for visitors using those devices.</span></span>

### <a name="how-earlier-versions-of-aspnet-supported-mobile-browsers"></a><span data-ttu-id="60860-121">Jak starší verze ASP.NET podporované mobilních prohlížečů</span><span class="sxs-lookup"><span data-stu-id="60860-121">How earlier versions of ASP.NET supported mobile browsers</span></span>

<span data-ttu-id="60860-122">Verze technologie ASP.NET 2.0 až 3.5 zahrnuté *ovládací prvky ASP.NET Mobile*: sadu ovládacích prvků serveru pro mobilní zařízení v *System.Web.Mobile.dll* sestavení a  *System.Web.UI.MobileControls* oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="60860-122">ASP.NET versions 2.0 to 3.5 included *ASP.NET Mobile Controls*: a set of server controls for mobile devices in the *System.Web.Mobile.dll* assembly and the *System.Web.UI.MobileControls* namespace.</span></span> <span data-ttu-id="60860-123">Sestavení je stále součástí ASP.NET 4, ale je zastaralý.</span><span class="sxs-lookup"><span data-stu-id="60860-123">The assembly is still included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="60860-124">Vývojáři by měli migrovat do více moderní přístupy, jsou popsané v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="60860-124">Developers are advised to migrate to more modern approaches, such as those described in this paper.</span></span>

<span data-ttu-id="60860-125">Důvod, proč ovládací prvky ASP.NET Mobile bylo označeno jako zastaralé je orientován jejich návrh kolem mobilních telefonů, které byly běžné kolem 2005 a starší.</span><span class="sxs-lookup"><span data-stu-id="60860-125">The reason why ASP.NET Mobile Controls have been marked as obsolete is that their design is oriented around the mobile phones that were common around 2005 and earlier.</span></span> <span data-ttu-id="60860-126">Ovládací prvky slouží především k vykreslení kódu WML nebo cHTML (namísto regulární HTML) pro službu WAP prohlížeče z této letopočtu.</span><span class="sxs-lookup"><span data-stu-id="60860-126">The controls are mainly designed to render WML or cHTML markup (instead of regular HTML) for the WAP browsers of that era.</span></span> <span data-ttu-id="60860-127">Ale WAP, WML a cHTML již nejsou relevantní pro většinu projektů, protože HTML se nyní staly všudypřítomný značek jazyk prohlížeče mobilních a desktopových agentem.</span><span class="sxs-lookup"><span data-stu-id="60860-127">But WAP, WML, and cHTML are no longer relevant for most projects, because HTML has now become the ubiquitous markup language for mobile and desktop browsers alike.</span></span>

### <a name="the-challenges-of-supporting-mobile-devices-today"></a><span data-ttu-id="60860-128">Na výzvy dnes podporu mobilních zařízení</span><span class="sxs-lookup"><span data-stu-id="60860-128">The challenges of supporting mobile devices today</span></span>

<span data-ttu-id="60860-129">Přestože mobilní prohlížeče teď podporují téměř všech HTML, budete stále mít mnoho problémů při s cílem vytvořit skvělé mobilní procházení prostředí:</span><span class="sxs-lookup"><span data-stu-id="60860-129">Even though mobile browsers now almost universally support HTML, you will still face many challenges when aiming to create great mobile browsing experiences:</span></span>

- <span data-ttu-id="60860-130">***Velikost obrazovky*** – mobilní zařízení se výrazně liší v podobě, a jejich obrazovky jsou často mnohem menší než monitorování klientů.</span><span class="sxs-lookup"><span data-stu-id="60860-130">***Screen size*** - Mobile devices vary dramatically in form, and their screens are often much smaller than desktop monitors.</span></span> <span data-ttu-id="60860-131">Potřebujete tedy návrh úplně jiné stránky rozložení pro ně.</span><span class="sxs-lookup"><span data-stu-id="60860-131">So, you may need to design completely different page layouts for them.</span></span>
- <span data-ttu-id="60860-132">***Vstupní metody*** – některá zařízení mají klávesnice, některé mají styluses, ostatní používat dotykové ovládání.</span><span class="sxs-lookup"><span data-stu-id="60860-132">***Input methods*** – Some devices have keypads, some have styluses, others use touch.</span></span> <span data-ttu-id="60860-133">Musíte vzít v úvahu několik navigační mechanismy a data metody zadávání znaků.</span><span class="sxs-lookup"><span data-stu-id="60860-133">You may need to consider multiple navigation mechanisms and data input methods.</span></span>
- <span data-ttu-id="60860-134">***Dodržování standardů*** – mnoho mobilních prohlížečů nepodporují nejnovějších standardů HTML, CSS a JavaScript.</span><span class="sxs-lookup"><span data-stu-id="60860-134">***Standards compliance*** – Many mobile browsers do not support the latest HTML, CSS, or JavaScript standards.</span></span>
- <span data-ttu-id="60860-135">***Šířka pásma*** – výkon sítě mobilních dat se liší podle velkým a jsou některé koncovým uživatelům o tarifech, které se účtují podle megabajtech.</span><span class="sxs-lookup"><span data-stu-id="60860-135">***Bandwidth*** – Cellular data network performance varies wildly, and some end users are on tariffs that charge by the megabyte.</span></span>

<span data-ttu-id="60860-136">Neexistuje univerzálně řešení; vaše aplikace bude muset vypadají a chovají se odlišně podle zařízení, které jsou k ní přistupují.</span><span class="sxs-lookup"><span data-stu-id="60860-136">There's no one-size-fits-all solution; your application will have to look and behave differently according to the device accessing it.</span></span> <span data-ttu-id="60860-137">V závislosti na tom, jakou úroveň mobilní podpory chcete může to být větší výzvu pro vývojářům webů než někdy byl desktop "prohlížeče válek".</span><span class="sxs-lookup"><span data-stu-id="60860-137">Depending on what level of mobile support you want, this can be a bigger challenge for web developers than the desktop "browser wars" ever was.</span></span>

<span data-ttu-id="60860-138">Vývojáři často původně blíží Podpora mobilních prohlížečů poprvé myslíte, že se že jedná pouze důležité možná podporovat nejnovější a nejvíce sofistikované smartphony (například Windows Phone 7, iPhone nebo Android), protože vývojáři často osobní vlastní, například zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-138">Developers approaching mobile browser support for the first time often initially think it's only important to support the latest and most sophisticated smartphones (e.g., Windows Phone 7, iPhone, or Android), perhaps because developers often personally own such devices.</span></span> <span data-ttu-id="60860-139">Ale levnější telefony jsou stále velmi oblíbenou a jejich vlastníky, je použít k procházení webu – hlavně v zemí, kde se snadněji získat než širokopásmové připojení mobilních telefonů.</span><span class="sxs-lookup"><span data-stu-id="60860-139">However, cheaper phones are still extremely popular, and their owners do use them to browse the web – especially in countries where mobile phones are easier to get than a broadband connection.</span></span> <span data-ttu-id="60860-140">Vaši firmu muset rozhodnout, jaký rozsah zařízení, které podporují v úvahu svých pravděpodobně zákazníků.</span><span class="sxs-lookup"><span data-stu-id="60860-140">Your business will need to decide what range of devices to support by considering its likely customers.</span></span> <span data-ttu-id="60860-141">Pokud vytváříte online – Příručka pro zabezpečené ověřování hesla možnost stavu, můžete provést obchodní rozhodnutí pouze pro cíl pokročilé smartphony, že pokud vytváříte rezervace systém lístků pro filmu, pravděpodobně muset účet pro návštěvníky s méně výkonná funkce telefony.</span><span class="sxs-lookup"><span data-stu-id="60860-141">If you're building an online brochure for a luxury health spa, you might make a business decision only to target advanced smartphones, whereas if you're creating a ticket booking system for a cinema, you probably need to account for visitors with less powerful feature phones.</span></span>

## <a name="architectural-options"></a><span data-ttu-id="60860-142">Možnosti architektury</span><span class="sxs-lookup"><span data-stu-id="60860-142">Architectural options</span></span>

<span data-ttu-id="60860-143">Před jsme se k určité technické informace o webových formulářů ASP.NET nebo MVC, vezměte na vědomí, že vývojáři webů obecně mají tři hlavní možnosti Podpora mobilních prohlížečů:</span><span class="sxs-lookup"><span data-stu-id="60860-143">Before we get to the specific technical details of ASP.NET Web Forms or MVC, note that web developers in general have three main possible options for supporting mobile browsers:</span></span>

1. <span data-ttu-id="60860-144">***Nedělat nic –*** můžete jednoduše vytvořit standardní, orientovaný na ploše webovou aplikaci a spoléhají na mobilní prohlížeče pro vykreslení přijatelně.</span><span class="sxs-lookup"><span data-stu-id="60860-144">***Do nothing –*** You can simply create a standard, desktop-oriented web application, and rely on mobile browsers to render it acceptably.</span></span> 

    - <span data-ttu-id="60860-145">**Výhody**: je nejlevnější možnost implementovat a udržovat – žádné dodatečné fungovat.</span><span class="sxs-lookup"><span data-stu-id="60860-145">**Advantage**: It's the cheapest option to implement and maintain – no extra work</span></span>
    - <span data-ttu-id="60860-146">**Nevýhodou**: poskytuje nejhorší činnost koncového uživatele:</span><span class="sxs-lookup"><span data-stu-id="60860-146">**Disadvantage**: Gives the worst end-user experience:</span></span> 

        - <span data-ttu-id="60860-147">Nejnovější smartphony může vykreslení kódu HTML stejně dobře jako prohlížeč pro stolní počítač, ale budou uživatelé stále přinucení přiblížení a posuňte se vodorovně a svisle využívat obsah na malou obrazovku.</span><span class="sxs-lookup"><span data-stu-id="60860-147">The latest smartphones may render your HTML just as well as a desktop browser, but users will still be forced to zoom and scroll horizontally and vertically to consume your content on a small screen.</span></span> <span data-ttu-id="60860-148">Toto je daleko od optimální.</span><span class="sxs-lookup"><span data-stu-id="60860-148">This is far from optimal.</span></span>
        - <span data-ttu-id="60860-149">Starší zařízení a funkce telefony může selhat k vykreslení k spokojenosti vašeho kódu.</span><span class="sxs-lookup"><span data-stu-id="60860-149">Older devices and feature phones may fail to render your markup in a satisfactory way.</span></span>
        - <span data-ttu-id="60860-150">Dokonce i v nejnovější tablet zařízení (jehož obrazovky může mít stejnou velikost jako obrazovky přenosného počítače) platí pravidla různých interakce.</span><span class="sxs-lookup"><span data-stu-id="60860-150">Even on the latest tablet devices (whose screens can be as big as laptop screens), different interaction rules apply.</span></span> <span data-ttu-id="60860-151">Na základě touch vstup funguje nejlépe s větší tlačítka a odkazy šíření další od sebe a neexistuje žádný způsob, jak najeďte ukazatelem myši rozevírací nabídce.</span><span class="sxs-lookup"><span data-stu-id="60860-151">Touch-based input works best with larger buttons and links spread further apart, and there's no way to hover a mouse cursor over a fly-out menu.</span></span>
2. <span data-ttu-id="60860-152">***Vyřešit problém na straně klienta* –** s pečlivě použití šablon stylů CSS a [postupném rozšiřování](http://en.wikipedia.org/wiki/Progressive_enhancement) můžete vytvořit značky, stylů a skripty, které se aktivují prohlížeče běží přizpůsobit.</span><span class="sxs-lookup"><span data-stu-id="60860-152">***Solve the problem on the client* –** With careful use of CSS and [progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) you can create markup, styles, and scripts that adapt to whatever browser is running them.</span></span> <span data-ttu-id="60860-153">Například s [dotazy na média šablon stylů CSS 3](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), můžete vytvořit rozložení více sloupců, které do jednoho sloupce rozložení se změní na zařízení, jehož obrazovky jsou užší než zvolenou prahovou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="60860-153">For example, with [CSS 3 media queries](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), you could create a multi-column layout that turns into a single column layout on devices whose screens are narrower than a chosen threshold.</span></span> 

    - <span data-ttu-id="60860-154">**Výhody**: optimalizuje vykreslování pro určité zařízení používá, a to i pro neznámé budoucí zařízení podle ať obrazovky a vstupní vlastnosti mají</span><span class="sxs-lookup"><span data-stu-id="60860-154">**Advantage**: Optimizes rendering for the specific device in use, even for unknown future devices according to whatever screen and input characteristics they have</span></span>
    - <span data-ttu-id="60860-155">**Výhody**: umožňuje snadné sdílení všech typů zařízení – minimální duplicitních kód nebo úsilí logiku na straně serveru</span><span class="sxs-lookup"><span data-stu-id="60860-155">**Advantage**: Easily lets you share server-side logic across all device types – minimal duplication of code or effort</span></span>
    - <span data-ttu-id="60860-156">**Nevýhodou**: mobilní zařízení se tak liší od klientů zařízení může Opravdu chcete svoje mobilní stránky být zcela liší od vaší ploše stránky zobrazující různé informace.</span><span class="sxs-lookup"><span data-stu-id="60860-156">**Disadvantage**: Mobile devices are so different from desktop devices that you may really want your mobile pages to be completely different from your desktop pages, showing different information.</span></span> <span data-ttu-id="60860-157">Takovéto změny může být neefektivní nebo možné dosáhnout robustní prostřednictvím šablon stylů CSS samostatně, zejména vzhledem k tomu, jak nekonzistentně starší zařízení interpretace pravidla šablon stylů CSS.</span><span class="sxs-lookup"><span data-stu-id="60860-157">Such variations can be inefficient or impossible to achieve robustly through CSS alone, especially considering how inconsistently older devices interpret CSS rules.</span></span> <span data-ttu-id="60860-158">To platí hlavně šablon stylů CSS 3 atributů.</span><span class="sxs-lookup"><span data-stu-id="60860-158">This is particularly true of CSS 3 attributes.</span></span>
    - <span data-ttu-id="60860-159">**Nevýhodou**: poskytuje žádná podpora pro různých logiku na straně serveru a pracovní postupy pro různá zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-159">**Disadvantage**: Provides no support for varying server-side logic and workflows for different devices.</span></span> <span data-ttu-id="60860-160">Zjednodušená nákupní košík najdete v článku věnovaném pracovního postupu pro mobilní uživatele nelze, například implementovat prostřednictvím šablon stylů CSS samostatně.</span><span class="sxs-lookup"><span data-stu-id="60860-160">You can't, for example, implement a simplified shopping cart checkout workflow for mobile users by means of CSS alone.</span></span>
    - <span data-ttu-id="60860-161">**Nevýhodou**: využití neefektivní šířky pásma.</span><span class="sxs-lookup"><span data-stu-id="60860-161">**Disadvantage**: Inefficient bandwidth use.</span></span> <span data-ttu-id="60860-162">Server je pravděpodobně nutné přenášet značek a stylů, která se týkají všech možných zařízení a to i v případě, že cílové zařízení se použije pouze podmnožinu těchto informací.</span><span class="sxs-lookup"><span data-stu-id="60860-162">You server may have to transmit the markup and styles that apply to all possible devices, even though the target device will only use a subset of that information.</span></span>
3. <span data-ttu-id="60860-163">***Vyřešit problém na serveru* –** Pokud váš server zná, jaké zařízení přistupuje k jeho – nebo minimálně charakteristiky těchto zařízení, například jeho velikost obrazovky a IME, a jestli je mobilní zařízení – může být spuštěn jiný logiku a výstup různý kód HTML.</span><span class="sxs-lookup"><span data-stu-id="60860-163">***Solve the problem on the server* –** If your server knows what device is accessing it – or at least the characteristics of that device, such as its screen size and input method, and whether it's a mobile device – it can run different logic and output different HTML markup.</span></span> 

    - <span data-ttu-id="60860-164">**Výhody:** maximální flexibilitu.</span><span class="sxs-lookup"><span data-stu-id="60860-164">**Advantage:** Maximum flexibility.</span></span> <span data-ttu-id="60860-165">Neexistuje žádné omezení kolik může lišit logika straně serveru pro mobilní telefony nebo optimalizaci váš kód pro konkrétní zařízení, požadované rozložení.</span><span class="sxs-lookup"><span data-stu-id="60860-165">There's no limit to how much you can vary your server-side logic for mobiles or optimize your markup for the desired, device-specific layout.</span></span>
    - <span data-ttu-id="60860-166">**Výhody:** využití efektivní šířky pásma.</span><span class="sxs-lookup"><span data-stu-id="60860-166">**Advantage:** Efficient bandwidth use.</span></span> <span data-ttu-id="60860-167">Potřebujete jenom přenášet značek a informací o stylu, které cílové zařízení bude používat.</span><span class="sxs-lookup"><span data-stu-id="60860-167">You only need to transmit the markup and styling information that the target device is going to use.</span></span>
    - <span data-ttu-id="60860-168">**Nevýhodou:** někdy Vynutí opakování úsilí nebo kód (například, že můžete vytvořit podobné, ale poněkud liší kopie stránky webových formulářů nebo zobrazení MVC).</span><span class="sxs-lookup"><span data-stu-id="60860-168">**Disadvantage:** Sometimes forces repetition of effort or code (e.g., making you create similar but slightly different copies of your Web Forms pages or MVC views).</span></span> <span data-ttu-id="60860-169">Kde to možné, bude zohlednit na běžné logiku do základní vrstvy nebo služby, ale přesto některé části kód uživatelského rozhraní nebo značek pravděpodobně duplicitní a pak uchovávat paralelně.</span><span class="sxs-lookup"><span data-stu-id="60860-169">Where possible you will factor out common logic into an underlying layer or service, but still, some parts of your UI code or markup may have to be duplicated and then maintained in parallel.</span></span>
    - <span data-ttu-id="60860-170">**Nevýhodou:** zařízení zjištění není triviální.</span><span class="sxs-lookup"><span data-stu-id="60860-170">**Disadvantage:** Device detection is not trivial.</span></span> <span data-ttu-id="60860-171">To vyžaduje seznamu nebo v databázi typů známé zařízení a jejich vlastnosti (které nemusí být vždy zcela aktuální) a není zaručena tak, aby přesně odpovídaly každého příchozího požadavku.</span><span class="sxs-lookup"><span data-stu-id="60860-171">It requires a list or database of known device types and their characteristics (which may not always be perfectly up-to-date) and isn't guaranteed to accurately match every incoming request.</span></span> <span data-ttu-id="60860-172">Tento dokument popisuje některé možnosti a jejich nástrahy později.</span><span class="sxs-lookup"><span data-stu-id="60860-172">This document describes some options and their pitfalls later.</span></span>

<span data-ttu-id="60860-173">K dosažení nejlepších výsledků, najít Většina vývojářů, že které potřebují k kombinovat možnosti (2) a (3).</span><span class="sxs-lookup"><span data-stu-id="60860-173">To get the best results, most developers find they need to combine options (2) and (3).</span></span> <span data-ttu-id="60860-174">Drobné rozdíly stylových nejlepší sloučeny na straně klienta pomocí šablon stylů CSS nebo i JavaScript, zatímco hlavní rozdíly v datech a pracovního postupu a značek jsou nejvíce efektivně implementovat v kódu na straně serveru.</span><span class="sxs-lookup"><span data-stu-id="60860-174">Minor stylistic differences are best accommodated on the client using CSS or even JavaScript, whereas major differences in data, workflow, or markup are most effectively implemented in server-side code.</span></span>

### <a name="this-paper-focuses-on-server-side-techniques"></a><span data-ttu-id="60860-175">Tento dokument se zaměřuje na straně serveru techniky</span><span class="sxs-lookup"><span data-stu-id="60860-175">This paper focuses on server-side techniques</span></span>

<span data-ttu-id="60860-176">Vzhledem k tomu, že jsou oba především serverovou technologie webových formulářů ASP.NET a MVC, tento dokument white paper se soustředí na straně serveru technik, které umožňují vytvořit různých značek a logiku pro mobilní prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="60860-176">Since ASP.NET Web Forms and MVC are both primarily server-side technologies, this white paper will focus on server-side techniques that let you produce different markup and logic for mobile browsers.</span></span> <span data-ttu-id="60860-177">Samozřejmě to můžete také kombinovat s libovolnou techniku klienta (například šablon stylů CSS 3 dotazy na média, vylepšení progresivního JavaScript), ale který je více řádu návrh webu než vývoji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="60860-177">Of course, you can also combine this with any client-side technique (e.g., CSS 3 media queries, progressive-enhancement JavaScript), but that's more a matter of web design than ASP.NET development.</span></span>

## <a name="browser-and-device-detection"></a><span data-ttu-id="60860-178">Zjišťování prohlížeče a zařízení</span><span class="sxs-lookup"><span data-stu-id="60860-178">Browser and device detection</span></span>

<span data-ttu-id="60860-179">Klíče předpokladem pro všechny serverové techniky pro podporu mobilních zařízení je vědět, jaké zařízení se pomocí vaší návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="60860-179">The key prerequisite for all server-side techniques for supporting mobile devices is to know what device your visitor is using.</span></span> <span data-ttu-id="60860-180">Ve skutečnosti ještě lepší než zároveň budete vědět, je znalost číslo výrobce a model zařízení *charakteristiky* zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-180">In fact, even better than knowing the manufacturer and model number of that device is knowing the *characteristics* of the device.</span></span> <span data-ttu-id="60860-181">Vlastnosti mohou zahrnovat:</span><span class="sxs-lookup"><span data-stu-id="60860-181">Characteristics may include:</span></span>

- <span data-ttu-id="60860-182">Je mobilní zařízení?</span><span class="sxs-lookup"><span data-stu-id="60860-182">Is it a mobile device?</span></span>
- <span data-ttu-id="60860-183">Vstupní metoda (myši nebo klávesnice, dotykového ovládání, klávesnici, pákový,...)</span><span class="sxs-lookup"><span data-stu-id="60860-183">Input method (mouse/keyboard, touch, keypad, joystick, …)</span></span>
- <span data-ttu-id="60860-184">Velikost obrazovky (fyzicky a v pixelech)</span><span class="sxs-lookup"><span data-stu-id="60860-184">Screen size (physically and in pixels)</span></span>
- <span data-ttu-id="60860-185">Podporované formáty média a dat</span><span class="sxs-lookup"><span data-stu-id="60860-185">Supported media and data formats</span></span>
- <span data-ttu-id="60860-186">Atd.</span><span class="sxs-lookup"><span data-stu-id="60860-186">Etc.</span></span>

<span data-ttu-id="60860-187">Je lepší rozhodnutí na základě charakteristik než číslo modelu, protože pak budete lépe vybavena pro budoucí zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-187">It's better to make decisions based on characteristics than model number, because then you'll be better equipped to handle future devices.</span></span>

### <a name="using-aspnets-built-in-browser-detection-support"></a><span data-ttu-id="60860-188">Použití prostředí ASP. Podpora detekce prohlížeče integrované na NET</span><span class="sxs-lookup"><span data-stu-id="60860-188">Using ASP.NET's built-in browser detection support</span></span>

<span data-ttu-id="60860-189">Webové formuláře ASP.NET a MVC vývojáři mohou okamžitě zjistit důležité charakteristiky hostujícími prohlížeče zkontrolováním vlastnosti *Request.Browser* objektu.</span><span class="sxs-lookup"><span data-stu-id="60860-189">ASP.NET Web Forms and MVC developers can immediately discover important characteristics of a visiting browser by inspecting properties of the *Request.Browser* object.</span></span> <span data-ttu-id="60860-190">Například v tématu</span><span class="sxs-lookup"><span data-stu-id="60860-190">For example, see</span></span>

- <span data-ttu-id="60860-191">Request.Browser.IsMobileDevice</span><span class="sxs-lookup"><span data-stu-id="60860-191">Request.Browser.IsMobileDevice</span></span>
- <span data-ttu-id="60860-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span><span class="sxs-lookup"><span data-stu-id="60860-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span></span>
- <span data-ttu-id="60860-193">Request.Browser.ScreenPixelsWidth</span><span class="sxs-lookup"><span data-stu-id="60860-193">Request.Browser.ScreenPixelsWidth</span></span>
- <span data-ttu-id="60860-194">Request.Browser.SupportsXmlHttp</span><span class="sxs-lookup"><span data-stu-id="60860-194">Request.Browser.SupportsXmlHttp</span></span>
- <span data-ttu-id="60860-195">.. a mnoho dalších</span><span class="sxs-lookup"><span data-stu-id="60860-195">…and many others</span></span>

<span data-ttu-id="60860-196">Na pozadí, platformu ASP.NET odpovídá příchozí *User-Agent* hlavičky protokolu HTTP (uživatelský Agent) proti regulárních výrazů v sadě souborů XML definice prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="60860-196">Behind the scenes, the ASP.NET platform matches the incoming *User-Agent* (UA) HTTP header against regular expressions in a set of Browser Definition XML files.</span></span> <span data-ttu-id="60860-197">Ve výchozím nastavení platforma obsahuje definice pro mnoho běžných mobilních zařízení a ostatní uživatelé, který si přejete rozpoznat můžete přidat vlastní soubory definicí prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="60860-197">By default the platform includes definitions for many common mobile devices, and you can add custom Browser Definition files for others you wish to recognize.</span></span> <span data-ttu-id="60860-198">Další podrobnosti najdete v tématu stránce MSDN [ovládací prvky webového serveru technologie ASP.NET a možnosti prohlížeče](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span><span class="sxs-lookup"><span data-stu-id="60860-198">For more details, see the MSDN page [ASP.NET Web Server Controls and Browser Capabilities](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span></span>

### <a name="using-the-wurfl-device-database-via-51degreesmobi-foundation"></a><span data-ttu-id="60860-199">Použití databáze zařízení WURFL prostřednictvím 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="60860-199">Using the WURFL device database via 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="60860-200">Při ASP. Když nemusí být dost NET pro prohlížeče integrované detekce podporu jsou dostatečné pro mnoho aplikací jsou dvě hlavní případy:</span><span class="sxs-lookup"><span data-stu-id="60860-200">While ASP.NET's built-in browser detection support will be sufficient for many applications, there are two main cases when it might not be enough:</span></span>

- <span data-ttu-id="60860-201">***Chcete rozpoznat nejnovější zařízení***(bez ruční vytvoření souborů definic prohlížeče pro ně).</span><span class="sxs-lookup"><span data-stu-id="60860-201">***You want to recognize the latest devices***(without manually creating Browser Definition files for them).</span></span> <span data-ttu-id="60860-202">Všimněte si, že rozhraní .NET 4 prohlížeče definiční soubory nejsou dostatečně nová, aby Windows Phone 7, telefony Android, prohlížeči Opera Mobile prohlížeče nebo Ipady Apple.</span><span class="sxs-lookup"><span data-stu-id="60860-202">Note that .NET 4's Browser Definition files are not recent enough to recognize Windows Phone 7, Android phones, Opera Mobile browsers, or Apple iPads.</span></span>
- <span data-ttu-id="60860-203">***Potřebujete podrobnější informace o možnostech zařízení***.</span><span class="sxs-lookup"><span data-stu-id="60860-203">***You need more detailed information about device capabilities***.</span></span> <span data-ttu-id="60860-204">Budete muset vědět o vstupní metoda zařízení (například touch vs klávesnici) nebo jaký zvuk formáty prohlížeč podporuje.</span><span class="sxs-lookup"><span data-stu-id="60860-204">You may need to know about a device's input method (e.g., touch vs keypad), or what audio formats the browser supports.</span></span> <span data-ttu-id="60860-205">Tyto informace není k dispozici v standardní prohlížeče definičních souborech.</span><span class="sxs-lookup"><span data-stu-id="60860-205">This information isn't available in the standard Browser Definition files.</span></span>

<span data-ttu-id="60860-206">[ *Universal souboru prostředků bezdrátové* projektu (WURFL)](http://wurfl.sourceforge.net/) udržuje mnohem víc aktuální a podrobné informace o mobilních zařízeních nepoužívá ještě dnes.</span><span class="sxs-lookup"><span data-stu-id="60860-206">The [*Wireless Universal Resource File* (WURFL) project](http://wurfl.sourceforge.net/) maintains much more up-to-date and detailed information about mobile devices in use today.</span></span>

<span data-ttu-id="60860-207">Skvělé zprávy pro vývojáře .NET je tento ASP. Funkce zjišťování prohlížeče na NET je rozšiřitelný, takže je možné jej lze vyřešit tyto problémy můžete vylepšit.</span><span class="sxs-lookup"><span data-stu-id="60860-207">The great news for .NET developers is that ASP.NET's browser detection feature is extensible, so it's possible to enhance it to overcome these problems.</span></span> <span data-ttu-id="60860-208">Například můžete přidat open source [ *51Degrees.mobi Foundation* ](https://github.com/51Degrees/dotNET-Device-Detection) knihovny do projektu.</span><span class="sxs-lookup"><span data-stu-id="60860-208">For example, you can add the open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) library to your project.</span></span> <span data-ttu-id="60860-209">Je ASP.NET IHttpModule nebo prohlížeče možnosti zprostředkovatele (lze použít u aplikací webových formulářů a MVC), který přímo čte WURFL data a zachytí do ASP. NET pro prohlížeče integrované detekce mechanismus.</span><span class="sxs-lookup"><span data-stu-id="60860-209">It's an ASP.NET IHttpModule or Browser Capabilities Provider (usable on both Web Forms and MVC applications), that directly reads WURFL data and hooks it into ASP.NET's built-in browser detection mechanism.</span></span> <span data-ttu-id="60860-210">Po instalaci modulu, *Request.Browser* bude najednou obsahovat mnohem přesnější a podrobné informace: bude správně rozpoznat množství zařízení výše a jejich možnosti (včetně seznamu Další funkce jako je například IME).</span><span class="sxs-lookup"><span data-stu-id="60860-210">Once you've installed the module, *Request.Browser* will suddenly contain a lot more accurate and detailed information: it will correctly recognize many of the devices previously mentioned and list their capabilities (including additional capabilities such as input method).</span></span> <span data-ttu-id="60860-211">Další podrobnosti naleznete v dokumentaci daného projektu.</span><span class="sxs-lookup"><span data-stu-id="60860-211">See the project's documentation for more details.</span></span>

## <a name="how-web-forms-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="60860-212">Jak poskytnout stránek specifických pro mobilní aplikace webových formulářů</span><span class="sxs-lookup"><span data-stu-id="60860-212">How Web Forms applications can present mobile-specific pages</span></span>

<span data-ttu-id="60860-213">Ve výchozím nastavení zde je, jak úplně nová aplikace webových formulářů zobrazí na běžné mobilních zařízeních:</span><span class="sxs-lookup"><span data-stu-id="60860-213">By default, here's how a brand new Web Forms application displays on common mobile devices:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image1.png)

<span data-ttu-id="60860-214">Je zřejmé ani rozložení vypadá velmi mobilní zařízení – tato stránka byla navržena pro velký, orientovaný na šířku monitorování, ne pro malou obrazovku orientované na výšku.</span><span class="sxs-lookup"><span data-stu-id="60860-214">Clearly, neither layout looks very mobile-friendly – this page was designed for a large, landscape-oriented monitor, not for a small portrait-oriented screen.</span></span> <span data-ttu-id="60860-215">Proto co lze provádět o něm?</span><span class="sxs-lookup"><span data-stu-id="60860-215">So what can you do about it?</span></span>

<span data-ttu-id="60860-216">Jak je popsáno výše v tomto dokumentu, přizpůsobit svoje stránky pro mobilní zařízení mnoha způsoby.</span><span class="sxs-lookup"><span data-stu-id="60860-216">As discussed earlier in this paper, there are many ways to tailor your pages for mobile devices.</span></span> <span data-ttu-id="60860-217">Některé techniky jsou na serveru, ostatní spustit na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="60860-217">Some techniques are server-based, others run on the client.</span></span>

### <a name="creating-a-mobile-specific-master-page"></a><span data-ttu-id="60860-218">Vytvoření mobilní konkrétní stránky předlohy</span><span class="sxs-lookup"><span data-stu-id="60860-218">Creating a mobile-specific master page</span></span>

<span data-ttu-id="60860-219">V závislosti na požadavcích, bude pravděpodobně možné používat stejné webové formuláře pro všechny návštěvníky, ale, abyste měli dva samostatné stránky předlohy: jednu pro stolní návštěvníky, druhý pro mobilní návštěvníky.</span><span class="sxs-lookup"><span data-stu-id="60860-219">Depending on your requirements, you may be able to use the same Web Forms for all visitors, but have two separate master pages: one for desktop visitors, another for mobile visitors.</span></span> <span data-ttu-id="60860-220">To vám dává možnost změny šablony stylů CSS nebo vaši nejvyšší úrovně značka jazyka HTML, aby vyhovovala mobilní zařízení, bez nutnosti duplikovat veškeré logiky stránky.</span><span class="sxs-lookup"><span data-stu-id="60860-220">This gives you the flexibility of changing the CSS stylesheet or your top-level HTML markup to suit mobile devices, without forcing you to duplicate any page logic.</span></span>

<span data-ttu-id="60860-221">Toto je snadné provést.</span><span class="sxs-lookup"><span data-stu-id="60860-221">This is easy to do.</span></span> <span data-ttu-id="60860-222">Můžete třeba, přidejte obslužnou rutinu PreInit například následující webového formuláře:</span><span class="sxs-lookup"><span data-stu-id="60860-222">For example, you can add a PreInit handler such as the following to a Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample1.cs)]

<span data-ttu-id="60860-223">Teď vytvořte hlavní stránku s názvem Mobile.Master ve složce nejvyšší úrovně vaší aplikace a použije se při zjištění mobilních zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-223">Now, create a master page called Mobile.Master in the top-level folder of your application, and it will be used when a mobile device is detected.</span></span> <span data-ttu-id="60860-224">Vaše stránky předlohy můžete odkazovat šablonu stylů CSS specifické pro mobilní, v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="60860-224">Your mobile master page can reference a mobile-specific CSS stylesheet if necessary.</span></span> <span data-ttu-id="60860-225">Plochy návštěvníky se pořád zobrazí výchozí stránku předlohy, není ta mobilní.</span><span class="sxs-lookup"><span data-stu-id="60860-225">Desktop visitors will still see your default master page, not the mobile one.</span></span>

### <a name="creating-independent-mobile-specific-web-forms"></a><span data-ttu-id="60860-226">Vytváření nezávislé specifické mobilní webové formuláře</span><span class="sxs-lookup"><span data-stu-id="60860-226">Creating independent mobile-specific Web Forms</span></span>

<span data-ttu-id="60860-227">Flexibilní můžete přejít mnohem další než jenom s samostatné stránky předlohy pro různé typy zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-227">For maximum flexibility, you can go much further than just having separate master pages for different device types.</span></span> <span data-ttu-id="60860-228">Můžete implementovat dvě *zcela samostatné sady stránky webových formulářů* – jeden nastavit u stolních počítačů, jiné nastavení pro mobilní telefony.</span><span class="sxs-lookup"><span data-stu-id="60860-228">You can implement two *totally separate sets of Web Forms pages* – one set for desktop browsers, another set for mobiles.</span></span> <span data-ttu-id="60860-229">Tato metoda funguje nejlépe, pokud chcete nabízet velmi různé informace nebo pracovní postupy pro mobilní návštěvníky.</span><span class="sxs-lookup"><span data-stu-id="60860-229">This works best if you want to present very different information or workflows to mobile visitors.</span></span> <span data-ttu-id="60860-230">Zbývající část tohoto oddílu popisuje tento postup podrobně.</span><span class="sxs-lookup"><span data-stu-id="60860-230">The rest of this section describes this approach in detail.</span></span>

<span data-ttu-id="60860-231">Za předpokladu, že již máte aplikaci webové formuláře navržené pro stolních počítačů, je vytvoření podsložce s názvem "Mobilní" v rámci projektu a sestavení svoje mobilní stránky nejjednodušší způsob, jak pokračovat.</span><span class="sxs-lookup"><span data-stu-id="60860-231">Assuming you already have a Web Forms application designed for desktop browsers, the easiest way to proceed is to create a subfolder called "Mobile" within your project, and build your mobile pages there.</span></span> <span data-ttu-id="60860-232">Dílčí celý web, s vlastní stránky předlohy, šablony stylů a stránky, můžete vytvořit pomocí stejné techniky, které byste použili pro žádnou jinou aplikaci webových formulářů.</span><span class="sxs-lookup"><span data-stu-id="60860-232">You can construct an entire sub-site, with its own master pages, style sheets, and pages, using all the same techniques that you'd use for any other Web Forms application.</span></span> <span data-ttu-id="60860-233">K vytvoření mobilní ekvivalentní pro nepotřebujete nutně *každých* stránka ve vaší lokalitě plochy; můžete zvolit, jaké podmnožinu funkcí dává smysl pro mobilní návštěvníky.</span><span class="sxs-lookup"><span data-stu-id="60860-233">You don't necessarily need to produce a mobile equivalent for *every* page in your desktop site; you can choose what subset of functionality makes sense for mobile visitors.</span></span>

<span data-ttu-id="60860-234">Mobilních stránek můžete sdílet běžné statické prostředky (například obrázky, JavaScript nebo šablon stylů CSS soubory) s svoje regulární stránky, pokud chcete.</span><span class="sxs-lookup"><span data-stu-id="60860-234">Your mobile pages can share common static resources (such as images, JavaScript, or CSS files) with your regular pages if you wish.</span></span> <span data-ttu-id="60860-235">Vzhledem k tomu, že bude vaší složky "Mobilní" *není* označit jako samostatné aplikace při hostovaný ve službě IIS (je stejně jednoduché podsložky stránky webových formulářů), ji budou také sdílet stejné konfiguraci, data relace a další infrastrukturou jako vaše plochy stránky.</span><span class="sxs-lookup"><span data-stu-id="60860-235">Since your "Mobile" folder will *not* be marked as a separate application when hosted in IIS (it's just a simple subfolder of Web Forms pages), it will also share all the same configuration, Session data, and other infrastructure as your desktop pages.</span></span>

> [!NOTE]
> <span data-ttu-id="60860-236">Vzhledem k tomu, že tento postup obvykle zahrnuje některé duplikace kódu (mobilních stránek jsou pravděpodobně sdílet některé podobnosti s plochy stránek), je důležité faktor se všechny běžné obchodní logiky nebo data přístupový kód do sdílené základní vrstvy nebo služby.</span><span class="sxs-lookup"><span data-stu-id="60860-236">Since this approach usually involves some duplication of code (mobile pages are likely to share some similarities with desktop pages), it's important to factor out any common business logic or data access code into a shared underlying layer or service.</span></span> <span data-ttu-id="60860-237">V ostatních případech budete double úsilí při vytváření a údržba vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="60860-237">Otherwise, you'll double the effort of creating and maintaining your application.</span></span>


#### <a name="redirecting-mobile-visitors-to-your-mobile-pages"></a><span data-ttu-id="60860-238">Přesměrování mobilní návštěvníkům mobilních stránek</span><span class="sxs-lookup"><span data-stu-id="60860-238">Redirecting mobile visitors to your mobile pages</span></span>

<span data-ttu-id="60860-239">Často je vhodné pro přesměrování mobilní návštěvníkům mobilních stránek pouze na *první* požadavek v jejich procházení relace (a ne na každého požadavku v jejich relace), protože:</span><span class="sxs-lookup"><span data-stu-id="60860-239">It's often convenient to redirect mobile visitors to the mobile pages only on the *first* request in their browsing session (and not on every request in their session), because:</span></span>

- <span data-ttu-id="60860-240">Potom můžete snadno povolit mobilní návštěvníky pro přístup k vaší ploše stránky, pokud si přejí – stačí vložit odkaz na hlavní stránce, která přejde na "Desktop verze".</span><span class="sxs-lookup"><span data-stu-id="60860-240">You can then easily allow mobile visitors to access your desktop pages if they wish – just put a link on your master page that goes to "Desktop version".</span></span> <span data-ttu-id="60860-241">Návštěvník nebude přesměrováni zpět na stránku mobilní, protože je již na první požadavky v jejich relace.</span><span class="sxs-lookup"><span data-stu-id="60860-241">The visitor won't be redirected back to a mobile page, because it's no longer the first request in their session.</span></span>
- <span data-ttu-id="60860-242">Tím eliminujete odesílání riziko zasahovala do činnosti žádostí pro dynamické zdroje sdílené mezi desktop a mobile části serveru (např. Pokud máte běžné webový formulář, který desktop a mobile části serveru zobrazit v elementu IFRAME nebo určité obslužné rutiny Ajax)</span><span class="sxs-lookup"><span data-stu-id="60860-242">It avoids the risk of interfering with requests for any dynamic resources shared between desktop and mobile parts of your site (e.g., if you have a common Web Form that both desktop and mobile parts of your site display in an IFRAME, or certain Ajax handlers)</span></span>

<span data-ttu-id="60860-243">K tomuto účelu můžete umístit logika přesměrování v **relace\_spustit** metoda.</span><span class="sxs-lookup"><span data-stu-id="60860-243">To do this, you can place your redirection logic in a **Session\_Start** method.</span></span> <span data-ttu-id="60860-244">Například přidejte následující metodu do souboru Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="60860-244">For example, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample2.cs)]

#### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="60860-245">Konfigurace ověřování pomocí formulářů dodržovat mobilních stránek</span><span class="sxs-lookup"><span data-stu-id="60860-245">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="60860-246">Všimněte si, že ověřování pomocí formulářů určitých předpokladů o kde ji můžete během a po dokončení procesu ověřování přesměrování návštěvníky:</span><span class="sxs-lookup"><span data-stu-id="60860-246">Note that Forms Authentication makes certain assumptions about where it can redirect visitors during and after the authentication process:</span></span>

- <span data-ttu-id="60860-247">Když uživatel potřebuje k ověření, ověřování pomocí formulářů je bude přesměrování na stránku desktopovém přihlášení, bez ohledu na to, jestli jsou desktop či mobile uživatele (protože má jenom koncept *jeden* přihlašovací adresa URL).</span><span class="sxs-lookup"><span data-stu-id="60860-247">When a user needs to be authenticated, Forms Authentication will redirect them to your desktop login page, regardless of whether they're a desktop or mobile user (because it only has a concept of *one* login URL).</span></span> <span data-ttu-id="60860-248">Za předpokladu, že chcete jinak styl mobilní přihlašovací stránku, musíte k vylepšení plochy přihlašovací stránku tak, aby ho mobilní uživatele přesměruje na samostatné mobilní přihlašovací stránku.</span><span class="sxs-lookup"><span data-stu-id="60860-248">Assuming you want to style your mobile login page differently, you need to enhance your desktop login page so that it redirects mobile users to a separate mobile login page.</span></span> <span data-ttu-id="60860-249">Například přidejte následující kód do vaší **plochy** přihlašovací stránky kódu:</span><span class="sxs-lookup"><span data-stu-id="60860-249">For example, add the following code to your **desktop** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample3.cs)]
- <span data-ttu-id="60860-250">Poté, co uživatel úspěšně přihlásí, ověřování pomocí formulářů bude ve výchozím nastavení přesměrování je na ploše domovskou stránku (protože má jenom koncept *jeden* výchozí stránky).</span><span class="sxs-lookup"><span data-stu-id="60860-250">After a user successfully logs in, Forms Authentication will by default redirect them to your desktop home page (because it only has a concept of *one* default page).</span></span> <span data-ttu-id="60860-251">Je potřeba zvýšit mobilní přihlašovací stránku tak, aby je přesměrován na mobilní domovskou stránku po úspěšném přihlášení.</span><span class="sxs-lookup"><span data-stu-id="60860-251">You need to enhance your mobile login page so that it redirects to the mobile home page after a successful log-in.</span></span> <span data-ttu-id="60860-252">Například přidejte následující kód do vaší **mobilní** přihlašovací stránky kódu:</span><span class="sxs-lookup"><span data-stu-id="60860-252">For example, add the following code to your **mobile** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample4.cs)]
  
 <span data-ttu-id="60860-253">Tento kód předpokládá, že stránka má ovládací prvek serveru přihlášení názvem LoginUser, jako výchozí šablona projektu.</span><span class="sxs-lookup"><span data-stu-id="60860-253">This code assumes your page has a Login server control called LoginUser, as in the default project template.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="60860-254">Práce s ukládání výstupu do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="60860-254">Working with Output Caching</span></span>

<span data-ttu-id="60860-255">Pokud používáte ukládání výstupu do mezipaměti, mějte na paměti, že ve výchozím nastavení je možné pro plochy uživatele, aby navštívil některé adresy URL (což její výstup do mezipaměti), následuje mobilní uživatele, který pak obdrží plochy výstup z mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="60860-255">If you're using output caching, beware that by default it's possible for a desktop user to visit a certain URL (causing its output to be cached), followed by a mobile user who then receives the cached desktop output.</span></span> <span data-ttu-id="60860-256">Toto upozornění se použije, zda je právě různých stránky předlohy podle typu zařízení, nebo zda implementace zcela samostatné webové formuláře podle typu zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-256">This warning applies whether you're just varying your master page by device type, or implementing totally separate Web Forms per device type.</span></span>

<span data-ttu-id="60860-257">Se tomuto problému vyhnout, můžete určit, aby ASP.NET k odlišení položky mezipaměti na základě jestli návštěvníka používá mobilních zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-257">To avoid the problem, you can instruct ASP.NET to vary the cache entry according to whether the visitor is using a mobile device.</span></span> <span data-ttu-id="60860-258">Přidejte parametr VaryByCustom deklarace OutputCache vaší stránky následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="60860-258">Add a VaryByCustom parameter to your page's OutputCache declaration as follows:</span></span>

[!code-aspx[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample5.aspx)]

<span data-ttu-id="60860-259">V dalším kroku definovat *isMobileDevice* jako vlastní mezipaměti přepsat parametr přidáním následující metodu do souboru Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="60860-259">Next, define *isMobileDevice* as a custom cache parameter by adding the following method override to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample6.cs)]

<span data-ttu-id="60860-260">Tím bude zajištěno, že mobilní návštěvníky na stránku neobdrželi dříve umístí do mezipaměti klientů návštěvníkem výstup.</span><span class="sxs-lookup"><span data-stu-id="60860-260">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="60860-261">Příklad práce</span><span class="sxs-lookup"><span data-stu-id="60860-261">A working example</span></span>

<span data-ttu-id="60860-262">Pokud chcete zobrazit tyto postupy v akci, stáhněte si [ukázky kódu tento dokument](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="60860-262">To see these techniques in action, download [this white paper's code samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="60860-263">Ukázková aplikace webových formulářů automaticky přesměruje mobilní uživatele na sadu stránek specifických pro mobilní v podsložce s názvem Mobile.</span><span class="sxs-lookup"><span data-stu-id="60860-263">The Web Forms sample application automatically redirects mobile users to a set of mobile-specific pages in a subfolder called Mobile.</span></span> <span data-ttu-id="60860-264">Značky a stylů tyto stránek je lépe optimalizovaná pro mobilní prohlížeče, jak je vidět na následujících snímcích obrazovky:</span><span class="sxs-lookup"><span data-stu-id="60860-264">The markup and styling of those pages is better optimized for mobile browsers, as you can see from the following screenshots:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image2.png)

<span data-ttu-id="60860-265">Další tipy k optimalizaci značek a šablon stylů CSS pro mobilní prohlížeče najdete v části "Stylů mobilních stránek pro mobilní prohlížeče" dál v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="60860-265">For more tips about optimizing your markup and CSS for mobile browsers, see the section "Styling mobile pages for mobile browsers" later in this document.</span></span>

## <a name="how-aspnet-mvc-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="60860-266">Jak poskytnout stránek specifických pro mobilní aplikace ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="60860-266">How ASP.NET MVC applications can present mobile-specific pages</span></span>

<span data-ttu-id="60860-267">Vzhledem k tomu, že vzoru Model-View-Controller oddělí aplikace logiky (v řadiče) z logiky prezentace (v zobrazení), můžete z jakéhokoli z následujících dvou přístupů zpracování mobilní podpory v kódu na straně serveru:</span><span class="sxs-lookup"><span data-stu-id="60860-267">Since the Model-View-Controller pattern decouples application logic (in controllers) from presentation logic (in views), you can choose from any of the following approaches to handling mobile support in server-side code:</span></span>

1. <span data-ttu-id="60860-268">***Použít stejnou řadiče a zobrazení pro stolní počítače a mobilní prohlížeče, ale vykreslit zobrazení s jinou Razor rozložení v závislosti na typu zařízení *.**</span><span class="sxs-lookup"><span data-stu-id="60860-268">***Use the same controllers and views for both desktop and mobile browsers, but render the views with different Razor layouts depending on the device type*.**</span></span> <span data-ttu-id="60860-269">Tato možnost funguje nejlíp, pokud jste zobrazení identické dat na všech zařízeních, ale jednoduše chcete zadat jinou šablony stylů CSS nebo změnit několik nejvyšší úrovně elementů HTML pro mobilní telefony.</span><span class="sxs-lookup"><span data-stu-id="60860-269">This option works best if you're displaying identical data on all devices, but simply want to supply different CSS stylesheets or change a few top-level HTML elements for mobiles.</span></span>
2. <span data-ttu-id="60860-270">***Použít stejnou řadiče pro stolní počítače a mobilní prohlížeče, ale vykreslení různá zobrazení v závislosti na typu zařízení***.</span><span class="sxs-lookup"><span data-stu-id="60860-270">***Use the same controllers for both desktop and mobile browsers, but render different views depending on the device type***.</span></span> <span data-ttu-id="60860-271">Tato možnost funguje nejlíp, pokud jste zobrazení zhruba stejná data a poskytuje stejné pracovních postupů pro koncové uživatele, ale chcete vykreslit velmi různý kód HTML tak, aby vyhovovala zařízení používá.</span><span class="sxs-lookup"><span data-stu-id="60860-271">This option works best if you're displaying roughly the same data and providing the same workflows for end users, but want to render very different HTML markup to suit the device being used.</span></span>
3. <span data-ttu-id="60860-272">***Vytvoření samostatné oblasti pro stolní počítače a mobilní prohlížeče, implementace nezávislé kontrolery a zobrazení pro každý *.**</span><span class="sxs-lookup"><span data-stu-id="60860-272">***Create separate areas for desktop and mobile browsers, implementing independent controllers and views for each*.**</span></span> <span data-ttu-id="60860-273">Tato možnost funguje nejlíp, pokud jste zobrazení obrazovky příliš neliší, obsahující různé informace a úvodní uživatele prostřednictvím různých pracovních optimalizované pro jejich typu.</span><span class="sxs-lookup"><span data-stu-id="60860-273">This option works best if you're displaying very different screens, containing different information and leading the user through different workflows optimized for their device type.</span></span> <span data-ttu-id="60860-274">Může to znamenat některé opakování kódu, ale můžete minimalizovat, pomocí řešení se běžné logiku do podkladové vrstvy nebo služby.</span><span class="sxs-lookup"><span data-stu-id="60860-274">It may mean some repetition of code, but you can minimize that by factoring out common logic into an underlying layer or service.</span></span>

<span data-ttu-id="60860-275">Pokud budete chtít využít **první** možnost a pouze Razor rozložení se liší podle typu zařízení, je velmi snadné.</span><span class="sxs-lookup"><span data-stu-id="60860-275">If you want to take the **first** option and vary only the Razor layout per device type, it's very easy.</span></span> <span data-ttu-id="60860-276">Právě upravit vaše \_ViewStart.cshtml souboru následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="60860-276">Just modify your \_ViewStart.cshtml file as follows:</span></span>

[!code-cshtml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample7.cshtml)]

<span data-ttu-id="60860-277">Nyní můžete vytvořit konkrétní mobilní rozložení názvem \_LayoutMobile.cshtml se strukturou stránky a šablon stylů CSS pravidla optimalizované pro mobilní zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-277">Now you can create a mobile-specific layout called \_LayoutMobile.cshtml with a page structure and CSS rules optimized for mobile devices.</span></span>

<span data-ttu-id="60860-278">Pokud budete chtít využít **druhý** možnost vykreslení uvidíte úplně jiné zobrazení v závislosti na typu zařízení návštěvníka, najdete v části [Scott Hanselman příspěvku na blogu](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span><span class="sxs-lookup"><span data-stu-id="60860-278">If you want to take the **second** option render totally different views according to the visitor's device type, see [Scott Hanselman's blog post](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span></span>

<span data-ttu-id="60860-279">Zbytek tohoto dokumentu se zaměřuje na **třetí** možnost – vytvoření samostatné řadičů *a* zobrazení pro mobilní zařízení – tak můžete řídit přesně se nabízí jaké podmnožinu funkce pro mobilní návštěvníky.</span><span class="sxs-lookup"><span data-stu-id="60860-279">The rest of this paper focuses on the **third** option – creating separate controllers *and* views for mobile devices – so you can control exactly what subset of functionality is offered for mobile visitors.</span></span>

### <a name="setting-up-a-mobile-area-within-your-aspnet-mvc-application"></a><span data-ttu-id="60860-280">Nastavení mobilních oblasti v rámci vaší aplikace ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="60860-280">Setting up a Mobile area within your ASP.NET MVC application</span></span>

<span data-ttu-id="60860-281">Můžete přidat oblast s názvem "Mobilní" do existující aplikace ASP.NET MVC běžným způsobem: klikněte pravým tlačítkem na název projektu v Průzkumníku řešení, a potom vyberte ve přidat oblast.</span><span class="sxs-lookup"><span data-stu-id="60860-281">You can add an area called "Mobile" to an existing ASP.NET MVC application in the normal way: right-click on your project name in Solution Explorer, then choose Add à Area.</span></span> <span data-ttu-id="60860-282">Poté můžete přidat kontrolery a zobrazení jako u jiných oblasti v aplikaci ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="60860-282">You can then add controllers and views as you would for any other area within an ASP.NET MVC application.</span></span> <span data-ttu-id="60860-283">Například přidáte do vaší mobilní oblasti nový řadič názvem HomeController tak, aby fungoval jako domovskou stránku pro mobilní návštěvníky.</span><span class="sxs-lookup"><span data-stu-id="60860-283">For example, add to your Mobile area a new controller called HomeController to act as a homepage for mobile visitors.</span></span>

### <a name="ensuring-the-url-mobile-reaches-the-mobile-homepage"></a><span data-ttu-id="60860-284">Zajištění URL /Mobile dosáhne mobilní domovské stránky</span><span class="sxs-lookup"><span data-stu-id="60860-284">Ensuring the URL /Mobile reaches the mobile homepage</span></span>

<span data-ttu-id="60860-285">Pokud chcete /Mobile adresu URL k dosažení akce indexu na HomeController uvnitř vaší mobilní oblasti, musíte provést dvě malé změny konfigurace služby směrování.</span><span class="sxs-lookup"><span data-stu-id="60860-285">If you want the URL /Mobile to reach the Index action on HomeController inside your Mobile area, you will need to make two small changes to your routing configuration.</span></span> <span data-ttu-id="60860-286">Nejdřív aktualizujte třídě MobileAreaRegistration tak, aby HomeController je výchozí v oblasti systému mobilní, jak je znázorněno v následujícím kódu:</span><span class="sxs-lookup"><span data-stu-id="60860-286">First, update your MobileAreaRegistration class so that HomeController is the default controller in your Mobile area, as shown in the following code:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample8.cs)]

<span data-ttu-id="60860-287">To znamená mobilní domovské stránce teď budou umístěné na /Mobile, nikoli/Mobile/Domů, protože "Domů" je teď výchozí název řadiče implicitně pro mobilních stránek.</span><span class="sxs-lookup"><span data-stu-id="60860-287">This means the mobile homepage will now be located at /Mobile, rather than /Mobile/Home, because "Home" is now the implicitly default controller name for mobile pages.</span></span>

<span data-ttu-id="60860-288">Dále si všimněte, že přidáním druhý HomeController do vaší aplikace (tj, mobilní ten, kromě existující ploše jeden) jste budete zrušili regulární plochy domovské stránky.</span><span class="sxs-lookup"><span data-stu-id="60860-288">Next, note that by adding a second HomeController to your application (i.e., the mobile one, in addition to the existing desktop one), you'll have broken your regular desktop homepage.</span></span> <span data-ttu-id="60860-289">Se nezdaří s chybou "*více typů nebyly nalezeny odpovídající řadičem s názvem"Home"*".</span><span class="sxs-lookup"><span data-stu-id="60860-289">It will fail with the error "*Multiple types were found that match the controller named 'Home'*".</span></span> <span data-ttu-id="60860-290">To vyřešit, aktualizujte konfiguraci nejvyšší úrovně směrování (v Global.asax.cs) k určení, že by vaše plochy HomeController po nejednoznačnosti mají přednost:</span><span class="sxs-lookup"><span data-stu-id="60860-290">To resolve this, update your top-level routing configuration (in Global.asax.cs) to specify that your desktop HomeController should take priority when there's ambiguity:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample9.cs)]

<span data-ttu-id="60860-291">Teď chyba přejde tokeny a adresu URL http://*yoursite*/ dosáhnou plochy domovské stránky a http://*yoursite*/mobile/ dosáhnou mobilní domovské stránky.</span><span class="sxs-lookup"><span data-stu-id="60860-291">Now the error will go away, and the URL http://*yoursite*/ will reach the desktop homepage, and http://*yoursite*/mobile/ will reach the mobile homepage.</span></span>

### <a name="redirecting-mobile-visitors-to-your-mobile-area"></a><span data-ttu-id="60860-292">Přesměrování mobilní návštěvníkům vaší mobilní oblasti</span><span class="sxs-lookup"><span data-stu-id="60860-292">Redirecting mobile visitors to your mobile area</span></span>

<span data-ttu-id="60860-293">Existuje mnoho různých rozšíření bodů v architektuře ASP.NET MVC, proto nejsou možné způsoby vložit logiku přesměrování.</span><span class="sxs-lookup"><span data-stu-id="60860-293">There are many different extensibility points in ASP.NET MVC, so there are many possible ways to inject redirection logic.</span></span> <span data-ttu-id="60860-294">Úhledné jednou z možností je vytvořit atribut filtru, [RedirectMobileDevicesToMobileArea], který provádí přesměrování, pokud jsou splněny následující podmínky:</span><span class="sxs-lookup"><span data-stu-id="60860-294">One neat option is to create a filter attribute, [RedirectMobileDevicesToMobileArea], that performs a redirection if the following conditions are met:</span></span>

1. <span data-ttu-id="60860-295">Jde o první požadavek v relaci uživatele (tj, Session.IsNewSession hodnotu PRAVDA)</span><span class="sxs-lookup"><span data-stu-id="60860-295">It's the first request in the user's session (i.e., Session.IsNewSession equals true)</span></span>
2. <span data-ttu-id="60860-296">Požadavek pochází z prohlížeč pro mobilní zařízení (tj, Request.Browser.IsMobileDevice hodnotu PRAVDA)</span><span class="sxs-lookup"><span data-stu-id="60860-296">The request comes from a mobile browser (i.e., Request.Browser.IsMobileDevice equals true)</span></span>
3. <span data-ttu-id="60860-297">Uživatel není už žádají o prostředku v oblasti mobilních (tj, *cesta* část adresy URL nezačíná /Mobile)</span><span class="sxs-lookup"><span data-stu-id="60860-297">The user is not already requesting a resource in the mobile area (i.e., the *path* part of the URL does not begin with /Mobile)</span></span>

<span data-ttu-id="60860-298">Ke stažení ukázkové součástí tento dokument white paper zahrnuje implementace této logiky.</span><span class="sxs-lookup"><span data-stu-id="60860-298">The downloadable sample included with this white paper includes an implementation of this logic.</span></span> <span data-ttu-id="60860-299">Je implementovaný jako filtr autorizace, který je odvozen od třídy AuthorizeAttribute, což znamená, že je správně fungovaly i v případě, že používáte ukládání výstupu do mezipaměti (jinak, pokud první přístupů plochy návštěvníka některé adresy URL, plochy výstupu mohou být uložené v mezipaměti a pak dodávat do následné mobilní návštěvníky).</span><span class="sxs-lookup"><span data-stu-id="60860-299">It's implemented as an authorization filter, derived from AuthorizeAttribute, which means it can work correctly even if you are using output caching (otherwise, if a desktop visitor first accesses a certain URL, the desktop output might be cached and then served to subsequent mobile visitors).</span></span>

<span data-ttu-id="60860-300">Protože je filtr, můžete zvolit buď jej použít na konkrétní kontrolerů a akcí, například</span><span class="sxs-lookup"><span data-stu-id="60860-300">As it's a filter, you can choose either to apply it to specific controllers and actions, e.g.,</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample10.cs)]

<span data-ttu-id="60860-301">…</span><span class="sxs-lookup"><span data-stu-id="60860-301">…</span></span> <span data-ttu-id="60860-302">nebo můžete použít jej pro všechny kontrolery a akce jako MVC 3 *globálních filtrů* v souboru Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="60860-302">or you can apply it to all controllers and actions as an MVC 3 *global filter* in your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample11.cs)]

<span data-ttu-id="60860-303">Ke stažení ukázkové také ukazuje, jak můžete vytvořit podtříd tento atribut přesměrovat na konkrétní umístění v rámci vaší mobilní oblasti.</span><span class="sxs-lookup"><span data-stu-id="60860-303">The downloadable sample also demonstrates how you can create subclasses of this attribute that redirect to specific locations within your mobile area.</span></span> <span data-ttu-id="60860-304">To znamená, například že můžete:</span><span class="sxs-lookup"><span data-stu-id="60860-304">This means, for example, you can:</span></span>

- <span data-ttu-id="60860-305">Registraci globálního filtru jak je uvedené výše, odešle mobilní návštěvníky na mobilní domovskou stránku ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="60860-305">Register a global filter as shown above that sends mobile visitors to the mobile homepage by default.</span></span>
- <span data-ttu-id="60860-306">Také použijte speciální filtr [RedirectMobileDevicesToMobileProductPage] "zobrazení produkt" akci, která přebírá mobilní návštěvníkům mobilní verzi produktu stránka měl požadovali.</span><span class="sxs-lookup"><span data-stu-id="60860-306">Also apply a special [RedirectMobileDevicesToMobileProductPage] filter to a "view product" action that takes mobile visitors to the mobile version of whatever product page they had requested.</span></span>
- <span data-ttu-id="60860-307">Jiné speciální podtřídy filtru se rovněž vztahují na konkrétní akce, přesměrování mobilní návštěvníky na stránku ekvivalentní mobilní</span><span class="sxs-lookup"><span data-stu-id="60860-307">Also apply other special subclasses of the filter to specific actions, redirecting mobile visitors to the equivalent mobile page</span></span>

### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="60860-308">Konfigurace ověřování pomocí formulářů dodržovat mobilních stránek</span><span class="sxs-lookup"><span data-stu-id="60860-308">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="60860-309">Pokud používáte ověřování pomocí formulářů, upozorňujeme ale, že když uživatel potřebuje k přihlášení, se automaticky přesměruje uživatele na jednu konkrétní "přihlášení" adresu URL, který ve výchozím nastavení je **/Account/přihlášení**.</span><span class="sxs-lookup"><span data-stu-id="60860-309">If you're using Forms Authentication, you should note that when a user needs to log in, it automatically redirects the user to a single specific "log on" URL, which by default is **/Account/LogOn**.</span></span> <span data-ttu-id="60860-310">To znamená, že mobilní uživatelé mohou přesměrováni na akci plochy "přihlášení".</span><span class="sxs-lookup"><span data-stu-id="60860-310">This means that mobile users may be redirected to your desktop "log on" action.</span></span>

<span data-ttu-id="60860-311">K tomuto problému nedošlo, přidejte logiku plochy akci "přihlášení" tak, aby znovu přesměrování mobilní uživatele na mobilní "přihlášení" akce.</span><span class="sxs-lookup"><span data-stu-id="60860-311">To avoid this problem, add logic to your desktop "log on" action so that it redirects mobile users again to a mobile "log on" action.</span></span> <span data-ttu-id="60860-312">Pokud používáte výchozí šablony aplikace ASP.NET MVC, aktualizujte akce AccountController na přihlášení následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="60860-312">If you're using the default ASP.NET MVC application template, update AccountController's LogOn action as follows:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample12.cs)]

<span data-ttu-id="60860-313">…</span><span class="sxs-lookup"><span data-stu-id="60860-313">…</span></span> <span data-ttu-id="60860-314">a potom implementovat vhodný účet specifické mobile "přihlášení" akce na řadiči názvem AccountController ve vaší mobilní oblasti.</span><span class="sxs-lookup"><span data-stu-id="60860-314">and then implement a suitable mobile-specific "log on" action on a controller called AccountController in your Mobile area.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="60860-315">Práce s ukládání výstupu do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="60860-315">Working with Output Caching</span></span>

<span data-ttu-id="60860-316">Pokud používáte filtr [OutputCache], je nutné vynutit položky mezipaměti na mění podle typu zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-316">If you're using the [OutputCache] filter, you must force the cache entry to vary by device type.</span></span> <span data-ttu-id="60860-317">Například se zapisuje:</span><span class="sxs-lookup"><span data-stu-id="60860-317">For example, write:</span></span>

[!code-javascript[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample13.js)]

<span data-ttu-id="60860-318">Pak přidejte následující metodu do souboru Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="60860-318">Then, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample14.cs)]

<span data-ttu-id="60860-319">Tím bude zajištěno, že mobilní návštěvníky na stránku neobdrželi dříve umístí do mezipaměti klientů návštěvníkem výstup.</span><span class="sxs-lookup"><span data-stu-id="60860-319">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="60860-320">Příklad práce</span><span class="sxs-lookup"><span data-stu-id="60860-320">A working example</span></span>

<span data-ttu-id="60860-321">Pokud chcete zobrazit tyto postupy v akci, stáhněte si [tento dokument kódu přidružené ukázky](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="60860-321">To see these techniques in action, download [this white paper's code associated samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="60860-322">Ukázka obsahuje aplikaci ASP.NET MVC 3 (Release Candidate) rozšířené k podpoře mobilních zařízení pomocí metody popsané výše.</span><span class="sxs-lookup"><span data-stu-id="60860-322">The sample includes an ASP.NET MVC 3 (Release Candidate) application enhanced to support mobile devices using the methods described above.</span></span>

## <a name="further-guidance-and-suggestions"></a><span data-ttu-id="60860-323">Další pokyny a doporučení</span><span class="sxs-lookup"><span data-stu-id="60860-323">Further guidance and suggestions</span></span>

<span data-ttu-id="60860-324">Následující informace platí jak pro webové formuláře a MVC vývojáři, kteří používají techniky zahrnuté v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="60860-324">The following discussion applies both to Web Forms and MVC developers who are using the techniques covered in this document.</span></span>

### <a name="enhancing-your-redirection-logic-using-51degreesmobi-foundation"></a><span data-ttu-id="60860-325">Rozšíření přesměrování logiky pomocí 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="60860-325">Enhancing your redirection logic using 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="60860-326">Přesměrování logiku v tomto dokumentu, může být perfektně pro vaši aplikaci, ale nebude fungovat, pokud je nutné zakázat relace, nebo v mobilních prohlížečích, které odmítnout soubory cookie (tyto nemůže mít relace), protože nebude vědět, zda daný požadavek je první z nich z tohoto návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="60860-326">The redirection logic shown in this document may be perfectly sufficient for your application, but it won't work if you need to disable sessions, or with mobile browsers that reject cookies (these can't have sessions), because it won't know whether a given request is the first one from that visitor.</span></span>

<span data-ttu-id="60860-327">Již jste zjistili, jak otevřít zdroj 51Degrees.mobi Foundation může zlepšit přesnost ASP. Zjišťování na NET prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="60860-327">You already learned how the open source 51Degrees.mobi Foundation can improve the accuracy of ASP.NET's browser detection.</span></span> <span data-ttu-id="60860-328">Je také integrovanou schopnost přesměrování mobilní návštěvníky na konkrétní umístění nakonfigurované v souboru Web.config. Je možné pracovat bez v závislosti na relací ASP.NET (a tím i soubory cookie) uložením dočasné protokolu hodnoty hash návštěvníků hlavičky protokolu HTTP a IP adres tak bude vědět, jestli je každý požadavek první z nich z daného vistor.</span><span class="sxs-lookup"><span data-stu-id="60860-328">It also has a built-in ability to redirect mobile visitors to specific locations configured in Web.config. It's able to work without depending on ASP.NET Sessions (and hence cookies) by storing a temporary log of hashes of visitors' HTTP headers and IP addresses, so it knows whether or not each request is the first one from a given vistor.</span></span>

<span data-ttu-id="60860-329">Přidat do sekce fiftyOne v souboru web.config následující element bude přesměrovávat první požadavek zjištěné mobilních zařízení na stránce ~ / Mobile/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="60860-329">The following element added to the fiftyOne section of the web.config file will redirect the first request from a detected mobile device to the page ~/Mobile/Default.aspx.</span></span> <span data-ttu-id="60860-330">Budou všechny požadavky na stránky ve složce mobilní *není* přesměrovat, bez ohledu na typ zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-330">Any requests to pages under the Mobile folder will *not* be redirected, regardless of device type.</span></span> <span data-ttu-id="60860-331">Pokud mobilní zařízení bylo nečinné po dobu 20 minut nebo další zařízení bude zapomenete a následné žádosti budou považovány za nové pro účely přesměrování.</span><span class="sxs-lookup"><span data-stu-id="60860-331">If the mobile device has been inactive for a period of 20 minutes or more the device will be forgotten and subsequent requests will be treated as new ones for the purposes of redirection.</span></span>

[!code-xml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample15.xml)]

<span data-ttu-id="60860-332">Další podrobnosti najdete v tématu [51degrees.mobi Foundation dokumentaci](https://github.com/51Degrees/dotNET-Device-Detection).</span><span class="sxs-lookup"><span data-stu-id="60860-332">For more details, see [51degrees.mobi Foundation documentation](https://github.com/51Degrees/dotNET-Device-Detection).</span></span>

> [!NOTE]
> <span data-ttu-id="60860-333">Můžete *můžete* Foundation 51Degrees.mobi použití funkce přesměrování na aplikace ASP.NET MVC, ale bude nutné definovat konfiguraci přesměrování z hlediska prostý adresy URL, není z hlediska směrování parametry nebo umístěním filtry MVC na akce.</span><span class="sxs-lookup"><span data-stu-id="60860-333">You *can* use 51Degrees.mobi Foundation's redirection feature on ASP.NET MVC applications, but you will need to define your redirection configuration in terms of plain URLs, not in terms of routing parameters or by putting MVC filters on actions.</span></span> <span data-ttu-id="60860-334">Důvodem je, že (v době psaní) 51Degrees.mobi Foundation nelze rozpoznat filtry nebo směrování.</span><span class="sxs-lookup"><span data-stu-id="60860-334">This is because (at the time of writing) 51Degrees.mobi Foundation does not recognize filters or routing.</span></span>


### <a name="disabling-transcoders-and-proxy-servers"></a><span data-ttu-id="60860-335">Zakázání Transkodéry a Proxy servery</span><span class="sxs-lookup"><span data-stu-id="60860-335">Disabling Transcoders and Proxy Servers</span></span>

<span data-ttu-id="60860-336">Operátory mobilní sítě mají dva široké cíle v jejich přístupu k mobilní síti internet.</span><span class="sxs-lookup"><span data-stu-id="60860-336">Mobile network operators have two broad objectives in their approach to the mobile internet:</span></span>

1. <span data-ttu-id="60860-337">Zadejte jako mnohem souvisejícího obsahu nejdříve</span><span class="sxs-lookup"><span data-stu-id="60860-337">Provide as much relevant content as possible</span></span>
2. <span data-ttu-id="60860-338">Co nejvíce zákazníci, kteří mohou sdílet přepínač omezenou šířku pásma sítě</span><span class="sxs-lookup"><span data-stu-id="60860-338">Maximize the number of customers who can share the limited radio network bandwidth</span></span>

<span data-ttu-id="60860-339">Vzhledem k tomu, že většina webových stránek byly navrženy pro velké plochy proměnlivé velikosti obrazovky a rychlé pevné řádku širokopásmové připojení, použijte řada operátorů *transkodéry* nebo *proxy servery* který dynamicky upravit obsah webového serveru.</span><span class="sxs-lookup"><span data-stu-id="60860-339">Since most web pages were designed for large desktop-sized screens and fast fixed-line broadband connections, many operators use *transcoders* or *proxy servers* that dynamically alter web content.</span></span> <span data-ttu-id="60860-340">Se může změnit kód HTML nebo šablon stylů CSS tak, aby vyhovovala menších obrazovkách (hlavně u "funkce telefonů" která nemají výpočetní výkon zpracování komplexní rozložení) a jejich znovu komprimovat obrázků (výrazně snižuje jejich kvality) k vylepšení rychlostmi doručení stránky.</span><span class="sxs-lookup"><span data-stu-id="60860-340">They may modify your HTML markup or CSS to suit smaller screens (especially for "feature phones" that lack the processing power to handle complex layouts), and they may recompress your images (significantly reducing their quality) to improve page delivery speeds.</span></span>

<span data-ttu-id="60860-341">Ale pokud jste prováděné úsilí nezbytné k vytvoření optimalizované mobilní verzi vaší lokality, pravděpodobně nebudete chtít, operátora mobilní sítě narušoval ho žádné další.</span><span class="sxs-lookup"><span data-stu-id="60860-341">But if you've taken the effort to produce a mobile-optimized version of your site, you probably don't want the network operator to interfere with it any further.</span></span> <span data-ttu-id="60860-342">Můžete přidat následující řádek na stránku\_zatížení událost v jakékoli webové formuláře ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="60860-342">You can add the following line to the Page\_Load event in any ASP.NET Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample16.cs)]

<span data-ttu-id="60860-343">Nebo pro kontroler ASP.NET MVC, můžete přidat následující přepsání metody tak, aby se vztahuje na všechny akce v kontroleru:</span><span class="sxs-lookup"><span data-stu-id="60860-343">Or, for an ASP.NET MVC controller, you could add the following method override so that it applies to all actions on that controller:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample17.cs)]

<span data-ttu-id="60860-344">Výsledný zprávy HTTP informuje W3C kompatibilní transkodéry a proxy servery nemění obsah.</span><span class="sxs-lookup"><span data-stu-id="60860-344">The resulting HTTP message informs W3C compliant transcoders and proxies not to alter content.</span></span> <span data-ttu-id="60860-345">Samozřejmě není zaručeno, že mobilní sítě operátory respektuje tuto zprávu.</span><span class="sxs-lookup"><span data-stu-id="60860-345">Of course, there is no guarantee that mobile network operators will respect this message.</span></span>

### <a name="styling-mobile-pages-for-mobile-browsers"></a><span data-ttu-id="60860-346">Práce se styly mobilních stránek pro mobilní prohlížeče</span><span class="sxs-lookup"><span data-stu-id="60860-346">Styling mobile pages for mobile browsers</span></span>

<span data-ttu-id="60860-347">Je nad rámec tohoto dokumentu příliš podrobně popisují, jaké druhy pracovní značek HTML správně nebo které techniky návrhu webové maximalizovat použitelnost na konkrétní zařízení.</span><span class="sxs-lookup"><span data-stu-id="60860-347">It's beyond the scope of this document to describe in great detail what kinds of HTML markup work correctly or which web design techniques maximize usability on particular devices.</span></span> <span data-ttu-id="60860-348">Ho má až vám najít dostatečně jednoduché rozložení, optimalizované pro obrazovky mobile proměnlivé velikosti, bez použití nespolehlivé HTML nebo umístění triky šablony stylů CSS.</span><span class="sxs-lookup"><span data-stu-id="60860-348">It's up to you to find a sufficiently simple layout, optimized for a mobile-sized screen, without using unreliable HTML or CSS positioning tricks.</span></span> <span data-ttu-id="60860-349">Jedním z důležitých postupů důležité zmínit, je však *zobrazení metaznačku*.</span><span class="sxs-lookup"><span data-stu-id="60860-349">One important technique worth mentioning, however, is the *viewport meta tag*.</span></span>

<span data-ttu-id="60860-350">Některé moderní mobilní prohlížeče v úsilí zobrazení webové stránky určené výhradně pro monitorování klientů, vykreslení stránky na virtuální plátno, označované taky jako "zobrazení" (například virtuální zobrazení je 980 pixelů na zařízení iPhone a 850 pixelů v prohlížeči Opera Mobile ve výchozím nastavení) a potom snižovat výsledek pro uložení na fyzické pixelů na obrazovce.</span><span class="sxs-lookup"><span data-stu-id="60860-350">Certain modern mobile browsers, in an effort display web pages meant for desktop monitors, render the page on a virtual canvas, also called "viewport" (e.g., the virtual viewport is 980 pixels wide on iPhone, and 850 pixels wide on Opera Mobile by default) and then scale the result down to fit onto the screen's physical pixels.</span></span> <span data-ttu-id="60860-351">Uživatel může potom přiblížení a posouvání zobrazení tohoto zobrazení.</span><span class="sxs-lookup"><span data-stu-id="60860-351">The user can then zoom in and pan around that viewport.</span></span> <span data-ttu-id="60860-352">To má výhodu, že umožňuje, aby prohlížeč zobrazení stránky v jeho určený rozložení, ale je také má nevýhodou, vynutí si přibližování a posouvání, což je nepohodlná pro uživatele.</span><span class="sxs-lookup"><span data-stu-id="60860-352">This has the advantage that it lets the browser display the page in its intended layout, but it's also has the disadvantage that it forces zooming and panning, which is inconvenient for the user.</span></span> <span data-ttu-id="60860-353">Pokud vytváříte Mobile, je lepší návrhu úzké obrazovky tak, aby žádné přiblížení a oddálení nebo vodorovného posouvání je nezbytné.</span><span class="sxs-lookup"><span data-stu-id="60860-353">If you're designing for mobile, it's better to design for a narrow screen so that no zooming or horizontal scrolling is necessary.</span></span>

<span data-ttu-id="60860-354">Určit prohlížeč pro mobilní zařízení, jak široké by měla být zobrazení je prostřednictvím nestandardní *zobrazení* značka meta.</span><span class="sxs-lookup"><span data-stu-id="60860-354">A way to tell the mobile browser how wide the viewport should be is through the nonstandard *viewport* meta tag.</span></span> <span data-ttu-id="60860-355">Například přidejte následující části HEAD vaší stránky</span><span class="sxs-lookup"><span data-stu-id="60860-355">For example, if you add the following to your page's HEAD section,</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample18.html)]

<span data-ttu-id="60860-356">…</span><span class="sxs-lookup"><span data-stu-id="60860-356">…</span></span> <span data-ttu-id="60860-357">potom podpora prohlížečů smartphone bude rozložení stránky na plátně celý virtuální 480 pixelů.</span><span class="sxs-lookup"><span data-stu-id="60860-357">then supporting smartphone browsers will lay out the page on a 480-pixel wide virtual canvas.</span></span> <span data-ttu-id="60860-358">To znamená, že pokud vaše elementů HTML definovat jejich šířku v procentech, procenta interpretovat s ohledem na tato šířka 480 pixelů, není šířka výchozí zobrazení.</span><span class="sxs-lookup"><span data-stu-id="60860-358">This means that if your HTML elements define their widths in percentage terms, the percentages will be interpreted with respect to this 480-pixel width, not the default viewport width.</span></span> <span data-ttu-id="60860-359">V důsledku toho je méně pravděpodobné, že máte přiblížení a posouvání vodorovně – podstatně zlepšení mobilní rozhraní prohlížeče uživatele.</span><span class="sxs-lookup"><span data-stu-id="60860-359">As a result, the user is less likely to have to zoom and pan horizontally – considerably improving the mobile browsing experience.</span></span>

<span data-ttu-id="60860-360">Pokud chcete, aby šířka zobrazení tak, aby odpovídala fyzické pixelů zařízení, můžete zadat následující:</span><span class="sxs-lookup"><span data-stu-id="60860-360">If you want the viewport width to match the device's physical pixels, you can specify the following:</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample19.html)]

<span data-ttu-id="60860-361">Tento postup fungovat správně, nesmí vynutíte explicitně elementy delší než tento šířka (například pomocí *šířka* atribut nebo vlastnost CSS), jinak se vynutí prohlížeči používat větší zobrazení bez ohledu na to.</span><span class="sxs-lookup"><span data-stu-id="60860-361">For this to work correctly, you must not explicitly force elements to exceed that width (e.g., using a *width* attribute or CSS property), otherwise the browser will be forced to use a larger viewport regardless.</span></span> <span data-ttu-id="60860-362">Viz také: [další podrobnosti o značce nestandardní zobrazení](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span><span class="sxs-lookup"><span data-stu-id="60860-362">See also: [more details about the nonstandard viewport tag](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span></span>

<span data-ttu-id="60860-363">Většina moderních smartphony podporu *duální orientaci*: můžete možné uchovávat v režimu na výšku nebo na šířku.</span><span class="sxs-lookup"><span data-stu-id="60860-363">Most modern smartphones support *dual orientation*: they can be held in either portrait or landscape mode.</span></span> <span data-ttu-id="60860-364">Ano je důležité, abyste Zkontrolujte předpoklady o obrazovky šířku v pixelech.</span><span class="sxs-lookup"><span data-stu-id="60860-364">So, it's important not to make assumptions about the screen width in pixels.</span></span> <span data-ttu-id="60860-365">I Nepředpokládejte, že šířku obrazovky odstraněna, protože uživatel může znovu orientaci jejich zařízení, době, kdy jsou na stránce.</span><span class="sxs-lookup"><span data-stu-id="60860-365">Don't even assume that the screen width is fixed, because the user can re-orient their device while they are on your page.</span></span>

<span data-ttu-id="60860-366">Starší zařízení Windows Mobile a Blackberry může také přijímat těchto značek meta v záhlaví stránky k informování obsahu je optimalizovaná pro mobilní a proto by nemělo být transformaci.</span><span class="sxs-lookup"><span data-stu-id="60860-366">Older Windows Mobile and Blackberry devices may also accept the following meta tags in the page header to inform them content has been optimized for mobile and therefore should not be transformed.</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample20.html)]

## <a name="additional-resources"></a><span data-ttu-id="60860-367">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="60860-367">Additional Resources</span></span>

<span data-ttu-id="60860-368">Seznam mobilních zařízení emulátorů a simulátorů, můžete použít k testování mobilní webové aplikace ASP.NET naleznete na stránce [simulovat oblíbených mobilních zařízení pro testování](../mobile/device-simulators.md).</span><span class="sxs-lookup"><span data-stu-id="60860-368">For a list of mobile device emulators and simulators you can use to test your mobile ASP.NET web application, see the page [Simulate popular mobile devices for testing](../mobile/device-simulators.md).</span></span>

## <a name="credits"></a><span data-ttu-id="60860-369">Kredity</span><span class="sxs-lookup"><span data-stu-id="60860-369">Credits</span></span>

- <span data-ttu-id="60860-370">Primárního autora: Steven Sanderson</span><span class="sxs-lookup"><span data-stu-id="60860-370">Primary author: Steven Sanderson</span></span>
- <span data-ttu-id="60860-371">Kontroloři / další obsahu zapisovače: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span><span class="sxs-lookup"><span data-stu-id="60860-371">Reviewers / additional content writers: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span></span>
