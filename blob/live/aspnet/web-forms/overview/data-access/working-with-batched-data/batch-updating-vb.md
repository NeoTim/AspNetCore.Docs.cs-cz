---
uid: web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
title: "Dávkové aktualizace (VB) | Microsoft Docs"
author: rick-anderson
description: "Zjistěte, jak aktualizovat více záznamů databáze v rámci jedné operace. V uživatelské rozhraní vrstvě využijeme GridView, kde je každý řádek upravovat. V datech..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: d191a204-d7ea-458d-b81c-0b9049ecb55f
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
msc.type: authoredcontent
ms.openlocfilehash: 02df858a7ad2ccefce4717e9bb7b08fc4c8d6ace
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/10/2017
---
<a name="batch-updating-vb"></a><span data-ttu-id="677d5-105">Dávkové aktualizace (VB)</span><span class="sxs-lookup"><span data-stu-id="677d5-105">Batch Updating (VB)</span></span>
====================
<span data-ttu-id="677d5-106">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="677d5-106">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="677d5-107">[Stáhněte si kód](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) nebo [stáhnout PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="677d5-107">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) or [Download PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span></span>

> <span data-ttu-id="677d5-108">Zjistěte, jak aktualizovat více záznamů databáze v rámci jedné operace.</span><span class="sxs-lookup"><span data-stu-id="677d5-108">Learn how to update multiple database records in a single operation.</span></span> <span data-ttu-id="677d5-109">V uživatelské rozhraní vrstvě využijeme GridView, kde je každý řádek upravovat.</span><span class="sxs-lookup"><span data-stu-id="677d5-109">In the User Interface Layer we build a GridView where each row is editable.</span></span> <span data-ttu-id="677d5-110">V Data Access Layer jsme zabalit více operací aktualizace v rámci transakce zajistit, že všechny aktualizace úspěch nebo všechny aktualizace jsou vrácena zpět.</span><span class="sxs-lookup"><span data-stu-id="677d5-110">In the Data Access Layer we wrap the multiple Update operations within a transaction to ensure that all updates succeed or all updates are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="677d5-111">Úvod</span><span class="sxs-lookup"><span data-stu-id="677d5-111">Introduction</span></span>

<span data-ttu-id="677d5-112">V [předchozí kurzu](wrapping-database-modifications-within-a-transaction-vb.md) jsme viděli, jak rozšířit Data Access Layer přidání podpory pro databázové transakce.</span><span class="sxs-lookup"><span data-stu-id="677d5-112">In the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md) we saw how to extend the Data Access Layer to add support for database transactions.</span></span> <span data-ttu-id="677d5-113">Databázové transakce zaručit řadu příkazů změny dat, bude považována za jeden atomické operace, která zajišťuje, že selžou všechny změny, nebo všechny bude úspěšné.</span><span class="sxs-lookup"><span data-stu-id="677d5-113">Database transactions guarantee that a series of data modification statements will be treated as one atomic operation, which ensures that all modifications will fail or all will succeed.</span></span> <span data-ttu-id="677d5-114">Pomocí této nízké úrovně DAL funkce stranou jsme re připraveni zapnout naše pozornost vytváření dávky dat úpravy rozhraní.</span><span class="sxs-lookup"><span data-stu-id="677d5-114">With this low-level DAL functionality out of the way, we re ready to turn our attention to creating batch data modification interfaces.</span></span>

<span data-ttu-id="677d5-115">V tomto kurzu využijeme GridView, kde každý řádek je upravovat (viz obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="677d5-115">In this tutorial we'll build a GridView where each row is editable (see Figure 1).</span></span> <span data-ttu-id="677d5-116">Vzhledem k tomu, že každý řádek je vykreslen v jeho úpravy rozhraní zde s není nutné pro sloupec upravit, aktualizovat a stornovací tlačítka.</span><span class="sxs-lookup"><span data-stu-id="677d5-116">Since each row is rendered in its editing interface, there s no need for a column of Edit, Update, and Cancel buttons.</span></span> <span data-ttu-id="677d5-117">Místo toho existují dvě aktualizace produktů tlačítka na stránce, která po kliknutí na vytvořit výčet GridView řádky a aktualizaci databáze.</span><span class="sxs-lookup"><span data-stu-id="677d5-117">Instead, there are two Update Products buttons on the page that, when clicked, enumerate the GridView rows and update the database.</span></span>


<span data-ttu-id="677d5-118">[![Každý řádek v GridView je upravit](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-118">[![Each Row in the GridView is Editable](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span></span>

<span data-ttu-id="677d5-119">**Obrázek 1**: každý řádek v GridView je upravit ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-119">**Figure 1**: Each Row in the GridView is Editable ([Click to view full-size image](batch-updating-vb/_static/image2.png))</span></span>


<span data-ttu-id="677d5-120">Umožňují s začít!</span><span class="sxs-lookup"><span data-stu-id="677d5-120">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="677d5-121">V [provádění dávková aktualizace](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) kurzu jsme vytvořili batch úpravy rozhraní pomocí ovládacího prvku DataList.</span><span class="sxs-lookup"><span data-stu-id="677d5-121">In the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we created a batch editing interface using the DataList control.</span></span> <span data-ttu-id="677d5-122">V tomto kurzu se liší od předchozí jednu v tom, že se používá GridView a dávková aktualizace se provádí v rámci oboru transakce.</span><span class="sxs-lookup"><span data-stu-id="677d5-122">This tutorial differs from the previous one in that is uses a GridView and the batch update is performed within the scope of a transaction.</span></span> <span data-ttu-id="677d5-123">Po dokončení tohoto kurzu I doporučujeme, abyste vraťte do starší kurzu a aktualizovat ji používat funkce související s transakcí databáze přidali v předchozím kurzu.</span><span class="sxs-lookup"><span data-stu-id="677d5-123">After completing this tutorial I encourage you to return to the earlier tutorial and update it to use the database transaction-related functionality added in the preceding tutorial.</span></span>


## <a name="examining-the-steps-for-making-all-gridview-rows-editable"></a><span data-ttu-id="677d5-124">Zkoumání kroky pro vytváření upravovat všechny řádky GridView</span><span class="sxs-lookup"><span data-stu-id="677d5-124">Examining the Steps for Making All GridView Rows Editable</span></span>

<span data-ttu-id="677d5-125">Jak je popsáno v [přehled o vložení, aktualizace a odstranění dat](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) kurzu GridView má integrovanou podporu pro úpravy podkladová data na základě na řádek.</span><span class="sxs-lookup"><span data-stu-id="677d5-125">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView offers built-in support for editing its underlying data on a per-row basis.</span></span> <span data-ttu-id="677d5-126">Interně GridView poznámky, jaké řádek je upravovat pomocí jeho [ `EditIndex` vlastnost](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="677d5-126">Internally, the GridView notes what row is editable through its [`EditIndex` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span></span> <span data-ttu-id="677d5-127">Jako GridView je vázán na zdroj dat, zkontroluje každý řádek pro zobrazení, je-li index řádku rovná hodnotě `EditIndex`.</span><span class="sxs-lookup"><span data-stu-id="677d5-127">As the GridView is being bound to its data source, it checks each row to see if the index of the row equals the value of `EditIndex`.</span></span> <span data-ttu-id="677d5-128">Pokud ano, tento řádek s, který pole jsou vykreslovány pomocí jejich úpravy rozhraní.</span><span class="sxs-lookup"><span data-stu-id="677d5-128">If so, that row s fields are rendered using their editing interfaces.</span></span> <span data-ttu-id="677d5-129">Textové pole je rozhraní úpravy BoundFields, jejichž `Text` vlastnost přiřazena hodnota pole dat určeného BoundField s `DataField` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="677d5-129">For BoundFields, the editing interface is a TextBox whose `Text` property is assigned the value of the data field specified by the BoundField s `DataField` property.</span></span> <span data-ttu-id="677d5-130">Pro TemplateFields `EditItemTemplate` slouží místě `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="677d5-130">For TemplateFields, the `EditItemTemplate` is used in place of the `ItemTemplate`.</span></span>

<span data-ttu-id="677d5-131">Odvolat, aby úpravy pracovní postup spustí, když uživatel klikne tlačítko Upravit řádek s.</span><span class="sxs-lookup"><span data-stu-id="677d5-131">Recall that the editing workflow starts when a user clicks a row s Edit button.</span></span> <span data-ttu-id="677d5-132">To způsobí, že zpětné volání, nastaví GridView s `EditIndex` vlastnost index kliknutelnou řádku s a znovu připojí data k mřížce.</span><span class="sxs-lookup"><span data-stu-id="677d5-132">This causes a postback, sets the GridView s `EditIndex` property to the clicked row s index, and rebinds the data to the grid.</span></span> <span data-ttu-id="677d5-133">Při stisknutí tlačítka Storno řádek s, na zpětné volání `EditIndex` je nastaven na hodnotu `-1` před obnovení vazby dat k mřížce.</span><span class="sxs-lookup"><span data-stu-id="677d5-133">When a row s Cancel button is clicked, on postback the `EditIndex` is set to a value of `-1` before rebinding the data to the grid.</span></span> <span data-ttu-id="677d5-134">Vzhledem k tomu, že řádky s GridView Spustit indexování od nuly, nastavení `EditIndex` k `-1` má za následek zobrazení GridView v režimu jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="677d5-134">Since the GridView s rows start indexing at zero, setting `EditIndex` to `-1` has the effect of displaying the GridView in read-only mode.</span></span>

<span data-ttu-id="677d5-135">`EditIndex` Vlastnost funguje dobře pro úpravy na řádek, ale není určen pro úpravy batch.</span><span class="sxs-lookup"><span data-stu-id="677d5-135">The `EditIndex` property works well for per-row editing, but is not designed for batch editing.</span></span> <span data-ttu-id="677d5-136">Chcete-li upravovat celou GridView, potřebujeme mít každý řádek vykreslit pomocí jeho úpravy rozhraní.</span><span class="sxs-lookup"><span data-stu-id="677d5-136">To make the entire GridView editable, we need to have each row render using its editing interface.</span></span> <span data-ttu-id="677d5-137">Nejjednodušší způsob, jak tomu je vytvoření, kde každé upravitelné pole je implementovaný jako TemplateField s jeho úpravy rozhraní definované v `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="677d5-137">The easiest way to accomplish this is to create where each editable field is implemented as a TemplateField with its editing interface defined in the `ItemTemplate`.</span></span>

<span data-ttu-id="677d5-138">V dalším několik kroků vytvoříme úplně upravitelné GridView.</span><span class="sxs-lookup"><span data-stu-id="677d5-138">Over the next several steps we'll create a completely editable GridView.</span></span> <span data-ttu-id="677d5-139">V kroku 1 jsme budete začněte vytvořením GridView a jeho ObjectDataSource a převést jeho BoundFields a vlastnost CheckBoxField TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="677d5-139">In Step 1 we'll start by creating the GridView and its ObjectDataSource and convert its BoundFields and CheckBoxField into TemplateFields.</span></span> <span data-ttu-id="677d5-140">Kroky 2 a 3 přesunete úpravy rozhraní z TemplateFields `EditItemTemplate` s k jejich `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="677d5-140">In Steps 2 and 3 we'll move the editing interfaces from the TemplateFields `EditItemTemplate` s to their `ItemTemplate` s.</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="677d5-141">Krok 1: Zobrazení informací o produktu</span><span class="sxs-lookup"><span data-stu-id="677d5-141">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="677d5-142">Před jsme starat o vytváření GridView kde jsou řádky je možné upravovat, umožní s začít tím, že jednoduše zobrazuje informace o produktu.</span><span class="sxs-lookup"><span data-stu-id="677d5-142">Before we worry about creating a GridView where are rows are editable, let s start by simply displaying the product information.</span></span> <span data-ttu-id="677d5-143">Otevřete `BatchUpdate.aspx` stránku `BatchData` složku a přetáhněte GridView z panelu nástrojů na návrháře.</span><span class="sxs-lookup"><span data-stu-id="677d5-143">Open the `BatchUpdate.aspx` page in the `BatchData` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="677d5-144">Nastavit GridView s `ID` k `ProductsGrid` a z jeho inteligentních značek, zvolte pro vazbu k nové ObjectDataSource s názvem `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="677d5-144">Set the GridView s `ID` to `ProductsGrid` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="677d5-145">Konfigurace ObjectDataSource načíst data z `ProductsBLL` třídu s `GetProducts` metoda.</span><span class="sxs-lookup"><span data-stu-id="677d5-145">Configure the ObjectDataSource to retrieve its data from the `ProductsBLL` class s `GetProducts` method.</span></span>


<span data-ttu-id="677d5-146">[![Konfigurace ObjectDataSource použití třídy ProductsBLL](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-146">[![Configure the ObjectDataSource to Use the ProductsBLL Class](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span></span>

<span data-ttu-id="677d5-147">**Obrázek 2**: Konfigurace ObjectDataSource pro použití `ProductsBLL` – třída ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-147">**Figure 2**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image4.png))</span></span>


<span data-ttu-id="677d5-148">[![Načtení dat produktu pomocí metody GetProducts](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-148">[![Retrieve the Product Data Using the GetProducts Method](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span></span>

<span data-ttu-id="677d5-149">**Obrázek 3**: načtení dat produktu pomocí `GetProducts` – metoda ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-149">**Figure 3**: Retrieve the Product Data Using the `GetProducts` Method ([Click to view full-size image](batch-updating-vb/_static/image6.png))</span></span>


<span data-ttu-id="677d5-150">Jako GridView jsou funkce ObjectDataSource s úpravy navrženy pro práci na základě na řádek.</span><span class="sxs-lookup"><span data-stu-id="677d5-150">Like the GridView, the ObjectDataSource s modification features are designed to work on a per-row basis.</span></span> <span data-ttu-id="677d5-151">Aby bylo možné aktualizovat sadu záznamů, budeme potřebovat k zápisu ve třídě kódu stránky s ASP.NET, která dávek dat a předává je BLL bit kódu.</span><span class="sxs-lookup"><span data-stu-id="677d5-151">In order to update a set of records, we'll need to write a bit of code in the ASP.NET page s code-behind class that batches the data and passes it to the BLL.</span></span> <span data-ttu-id="677d5-152">Proto nastavte rozevírací seznamy v ObjectDataSource s UPDATE, INSERT a DELETE karty na (žádný).</span><span class="sxs-lookup"><span data-stu-id="677d5-152">Therefore, set the drop-down lists in the ObjectDataSource s UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="677d5-153">Kliknutím na tlačítko Dokončit ukončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="677d5-153">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="677d5-154">[![Nastavte rozevírací seznamy v aktualizaci UPDATE, INSERT a odstranit karty na (žádný)](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-154">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span></span>

<span data-ttu-id="677d5-155">**Obrázek 4**: rozevíracího seznamu jsou uvedeny ve UPDATE, INSERT a odstranit karty na hodnotu (žádná) ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-155">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image8.png))</span></span>


<span data-ttu-id="677d5-156">Po dokončení průvodce Konfigurace zdroje dat, ObjectDataSource s deklarativní by měl vypadat následovně:</span><span class="sxs-lookup"><span data-stu-id="677d5-156">After completing the Configure Data Source wizard, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample1.aspx)]

<span data-ttu-id="677d5-157">Probíhá dokončování Průvodce konfigurace zdroje dat také způsobí, že chcete vytvořit v GridView BoundFields a vlastnost CheckBoxField pro datová pole produktu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="677d5-157">Completing the Configure Data Source wizard also causes Visual Studio to create BoundFields and a CheckBoxField for the product data fields in the GridView.</span></span> <span data-ttu-id="677d5-158">V tomto kurzu mohli s pouze povolit uživatelům zobrazení a úprava s název produktu, kategorie, ceny a stav – starší formáty.</span><span class="sxs-lookup"><span data-stu-id="677d5-158">For this tutorial, let s only allow the user to view and edit the product s name, category, price, and discontinued status.</span></span> <span data-ttu-id="677d5-159">Odeberte všechny ale na `ProductName`, `CategoryName`, `UnitPrice`, a `Discontinued` pole a přejmenujte `HeaderText` vlastnosti první tři pole na produkt, kategorie a cenu v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="677d5-159">Remove all but the `ProductName`, `CategoryName`, `UnitPrice`, and `Discontinued` fields and rename the `HeaderText` properties of the first three fields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="677d5-160">Nakonec zkontrolujte zaškrtávací políčka Povolit stránkování a Povolit řazení v GridView s inteligentním.</span><span class="sxs-lookup"><span data-stu-id="677d5-160">Lastly, check the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="677d5-161">V tomto okamžiku GridView má tři BoundFields (`ProductName`, `CategoryName`, a `UnitPrice`) a třídy CheckBoxField (`Discontinued`).</span><span class="sxs-lookup"><span data-stu-id="677d5-161">At this point the GridView has three BoundFields (`ProductName`, `CategoryName`, and `UnitPrice`) and a CheckBoxField (`Discontinued`).</span></span> <span data-ttu-id="677d5-162">Je potřeba převést TemplateFields tyto čtyři pole a poté přesuňte úpravy rozhraní z TemplateField s `EditItemTemplate` k jeho `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="677d5-162">We need to convert these four fields into TemplateFields and then move the editing interface from the TemplateField s `EditItemTemplate` to its `ItemTemplate`.</span></span>

> [!NOTE]
> <span data-ttu-id="677d5-163">Jsme prozkoumali vytváření a přizpůsobení TemplateFields v [přizpůsobení rozhraní pro úpravu dat](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="677d5-163">We explored creating and customizing TemplateFields in the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span> <span data-ttu-id="677d5-164">Projdeme kroky převodu BoundFields a vlastnost CheckBoxField TemplateFields a jejich úpravy definice rozhraní v jejich `ItemTemplate` s, ale pokud získat zablokované nebo potřebovat aktualizační program, tento t váhání odkazovat zpět do tohoto kurzu starší.</span><span class="sxs-lookup"><span data-stu-id="677d5-164">We'll walk through the steps of converting the BoundFields and CheckBoxField into TemplateFields and defining their editing interfaces in their `ItemTemplate` s, but if you get stuck or need a refresher, don t hesitate to refer back to this earlier tutorial.</span></span>


<span data-ttu-id="677d5-165">Z s GridView inteligentních značek klikněte na odkaz Upravit sloupce otevřete dialogové okno pole.</span><span class="sxs-lookup"><span data-stu-id="677d5-165">From the GridView s smart tag, click the Edit Columns link to open the Fields dialog box.</span></span> <span data-ttu-id="677d5-166">V dalším kroku vyberte každé pole a klikněte na tlačítko Převést toto pole na TemplateField odkaz.</span><span class="sxs-lookup"><span data-stu-id="677d5-166">Next, select each field and click the Convert this field into a TemplateField link.</span></span>


![Převést stávající BoundFields a vlastnost CheckBoxField TemplateFields](batch-updating-vb/_static/image5.gif)

<span data-ttu-id="677d5-168">**Obrázek 5**: převést stávající BoundFields a vlastnost CheckBoxField TemplateFields</span><span class="sxs-lookup"><span data-stu-id="677d5-168">**Figure 5**: Convert the Existing BoundFields and CheckBoxField Into TemplateFields</span></span>


<span data-ttu-id="677d5-169">Teď, když každé pole je TemplateField, jsme re připravení přesunout úpravu rozhraní z `EditItemTemplate` s k `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="677d5-169">Now that each field is a TemplateField, we re ready to move the editing interface from the `EditItemTemplate` s to the `ItemTemplate` s.</span></span>

## <a name="step-2-creating-theproductnameunitprice-anddiscontinuedediting-interfaces"></a><span data-ttu-id="677d5-170">Krok 2: Vytvoření`ProductName`,`UnitPrice`, a`Discontinued`úpravy rozhraní</span><span class="sxs-lookup"><span data-stu-id="677d5-170">Step 2: Creating the`ProductName`,`UnitPrice`, and`Discontinued`Editing Interfaces</span></span>

<span data-ttu-id="677d5-171">Vytváření `ProductName`, `UnitPrice`, a `Discontinued` úpravy rozhraní jsou tématu tohoto kroku a jsou poměrně jednoduché, jako je každé rozhraní již je definována v TemplateField s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="677d5-171">Creating the `ProductName`, `UnitPrice`, and `Discontinued` editing interfaces are the topic of this step and are pretty straightforward, as each interface is already defined in the TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="677d5-172">Vytváření `CategoryName` úpravy rozhraní je složitější, protože je potřeba vytvořit rozevírací seznam příslušné kategorie.</span><span class="sxs-lookup"><span data-stu-id="677d5-172">Creating the `CategoryName` editing interface is a bit more involved since we need to create a DropDownList of the applicable categories.</span></span> <span data-ttu-id="677d5-173">To `CategoryName` úpravy rozhraní, se zabývá v kroku 3.</span><span class="sxs-lookup"><span data-stu-id="677d5-173">This `CategoryName` editing interface is tackled in Step 3.</span></span>

<span data-ttu-id="677d5-174">Umožní s začínat `ProductName` TemplateField.</span><span class="sxs-lookup"><span data-stu-id="677d5-174">Let s start with the `ProductName` TemplateField.</span></span> <span data-ttu-id="677d5-175">Klikněte na odkaz Upravit šablony ze inteligentní značky s GridView a přejdete dolů k `ProductName` TemplateField s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="677d5-175">Click on the Edit Templates link from the GridView s smart tag and drill down to the `ProductName` TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="677d5-176">Vyberte textové pole, zkopírujte jej do schránky a vložte jej do `ProductName` TemplateField s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="677d5-176">Select the TextBox, copy it to the clipboard, and then paste it to the `ProductName` TemplateField s `ItemTemplate`.</span></span> <span data-ttu-id="677d5-177">Změna textového pole s `ID` vlastnost `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="677d5-177">Change the TextBox s `ID` property to `ProductName`.</span></span>

<span data-ttu-id="677d5-178">Dál přidejte RequiredFieldValidator k `ItemTemplate` zajistit, že uživatel nezadá hodnotu pro každý název produktu s.</span><span class="sxs-lookup"><span data-stu-id="677d5-178">Next, add a RequiredFieldValidator to the `ItemTemplate` to ensure that the user provides a value for each product s name.</span></span> <span data-ttu-id="677d5-179">Nastavte `ControlToValidate` Vlastnost ProductName, `ErrorMessage` vlastnost je nutné zadat název produktu.</span><span class="sxs-lookup"><span data-stu-id="677d5-179">Set the `ControlToValidate` property to ProductName, the `ErrorMessage` property to You must provide the product's name.</span></span> <span data-ttu-id="677d5-180">a `Text` vlastnost \*.</span><span class="sxs-lookup"><span data-stu-id="677d5-180">and the `Text` property to \*.</span></span> <span data-ttu-id="677d5-181">Po provedení těchto doplňky `ItemTemplate`, obrazovky by měl vypadat podobně jako na obrázku 6.</span><span class="sxs-lookup"><span data-stu-id="677d5-181">After making these additions to the `ItemTemplate`, your screen should look similar to Figure 6.</span></span>


<span data-ttu-id="677d5-182">[![Nyní TemplateField ProductName zahrnuje textové pole a RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-182">[![The ProductName TemplateField Now Includes a TextBox and a RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span></span>

<span data-ttu-id="677d5-183">**Obrázek 6**: `ProductName` TemplateField teď obsahuje textové pole a RequiredFieldValidator ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-183">**Figure 6**: The `ProductName` TemplateField Now Includes a TextBox and a RequiredFieldValidator ([Click to view full-size image](batch-updating-vb/_static/image10.png))</span></span>


<span data-ttu-id="677d5-184">Pro `UnitPrice` úpravy rozhraní, spusťte zkopírováním do textového pole z `EditItemTemplate` k `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="677d5-184">For the `UnitPrice` editing interface, start by copying the TextBox from the `EditItemTemplate` to the `ItemTemplate`.</span></span> <span data-ttu-id="677d5-185">V dalším kroku umístit $ před do textového pole a nastavte její `ID` vlastnost UnitPrice a jeho `Columns` vlastnost na 8.</span><span class="sxs-lookup"><span data-stu-id="677d5-185">Next, place a $ in front of the TextBox and set its `ID` property to UnitPrice and its `Columns` property to 8 .</span></span>

<span data-ttu-id="677d5-186">Také přidat CompareValidator k `UnitPrice` s `ItemTemplate` zajistit, že uživatelem zadaná hodnota je platná měna hodnotu větší než nebo rovna hodnotě 0,00 Kč.</span><span class="sxs-lookup"><span data-stu-id="677d5-186">Also add a CompareValidator to the `UnitPrice` s `ItemTemplate` to ensure that the value entered by the user is a valid currency value greater than or equal to $0.00.</span></span> <span data-ttu-id="677d5-187">Nastavit s validátoru `ControlToValidate` vlastnost UnitPrice, jeho `ErrorMessage` vlastnost je třeba zadat hodnotu platný měny.</span><span class="sxs-lookup"><span data-stu-id="677d5-187">Set the validator s `ControlToValidate` property to UnitPrice, its `ErrorMessage` property to You must enter a valid currency value.</span></span> <span data-ttu-id="677d5-188">Prosím vynechejte žádné měna symboly., jeho `Text` vlastnost \*, jeho `Type` vlastnost `Currency`, jeho `Operator` vlastnost `GreaterThanEqual`a jeho `ValueToCompare` vlastnost na hodnotu 0.</span><span class="sxs-lookup"><span data-stu-id="677d5-188">Please omit any currency symbols., its `Text` property to \*, its `Type` property to `Currency`, its `Operator` property to `GreaterThanEqual`, and its `ValueToCompare` property to 0 .</span></span>


<span data-ttu-id="677d5-189">[![Přidat CompareValidator zajistit zadali cena je nezáporná hodnota měny](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-189">[![Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span></span>

<span data-ttu-id="677d5-190">**Obrázek 7**: přidejte CompareValidator zajistit zadali cena se nezáporná hodnota měny ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-190">**Figure 7**: Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value ([Click to view full-size image](batch-updating-vb/_static/image12.png))</span></span>


<span data-ttu-id="677d5-191">Pro `Discontinued` TemplateField můžete použít políčko již definována v `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="677d5-191">For the `Discontinued` TemplateField you can use the CheckBox already defined in the `ItemTemplate`.</span></span> <span data-ttu-id="677d5-192">Jednoduše nastavit jeho `ID` pro nákup ukončen a jeho `Enabled` vlastnost `True`.</span><span class="sxs-lookup"><span data-stu-id="677d5-192">Simply set its `ID` to Discontinued and its `Enabled` property to `True`.</span></span>

## <a name="step-3-creating-thecategorynameediting-interface"></a><span data-ttu-id="677d5-193">Krok 3: Vytvoření`CategoryName`úpravy rozhraní</span><span class="sxs-lookup"><span data-stu-id="677d5-193">Step 3: Creating the`CategoryName`Editing Interface</span></span>

<span data-ttu-id="677d5-194">Úpravy rozhraní v `CategoryName` TemplateField s `EditItemTemplate` obsahuje textové pole, které se zobrazí hodnota `CategoryName` datové pole.</span><span class="sxs-lookup"><span data-stu-id="677d5-194">The editing interface in the `CategoryName` TemplateField s `EditItemTemplate` contains a TextBox that displays the value of the `CategoryName` data field.</span></span> <span data-ttu-id="677d5-195">Je potřeba nahradit rozevírací seznam, který obsahuje seznam možných kategorií.</span><span class="sxs-lookup"><span data-stu-id="677d5-195">We need to replace this with a DropDownList that lists the possible categories.</span></span>

> [!NOTE]
> <span data-ttu-id="677d5-196">[Přizpůsobení rozhraní pro úpravu dat](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) kurz obsahuje důkladnější a dokončení diskusi k přizpůsobení šablonu, která má obsahovat rozevírací seznam a textové pole.</span><span class="sxs-lookup"><span data-stu-id="677d5-196">The [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial contains a more thorough and complete discussion on customizing a template to include a DropDownList as opposed to a TextBox.</span></span> <span data-ttu-id="677d5-197">Při dokončení kroků v tomto poli se se mají zobrazovat tersely.</span><span class="sxs-lookup"><span data-stu-id="677d5-197">While the steps here are complete, they are presented tersely.</span></span> <span data-ttu-id="677d5-198">Podrobnější pohled na vytvoření a konfigurace kategorie rozevírací seznam, najdete v části zpět [přizpůsobení rozhraní pro úpravu dat](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="677d5-198">For a more in-depth look at creating and configuring the categories DropDownList, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>


<span data-ttu-id="677d5-199">Přetáhněte rozevírací seznam z panelu nástrojů na `CategoryName` TemplateField s `ItemTemplate`, nastavení jeho `ID` k `Categories`.</span><span class="sxs-lookup"><span data-stu-id="677d5-199">Drag a DropDownList from the Toolbox onto the `CategoryName` TemplateField s `ItemTemplate`, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="677d5-200">V tomto okamžiku by obvykle definujeme zdroj dat s DropDownLists pomocí inteligentních značek, vytváření nových ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="677d5-200">At this point we would usually define the DropDownLists s data source through its smart tag, creating a new ObjectDataSource.</span></span> <span data-ttu-id="677d5-201">To však přidá ObjectDataSource v rámci `ItemTemplate`, který bude mít za následek ObjectDataSource instance vytvořené pro každý řádek GridView.</span><span class="sxs-lookup"><span data-stu-id="677d5-201">However, this will add the ObjectDataSource within the `ItemTemplate`, which will result in an ObjectDataSource instance created for each GridView row.</span></span> <span data-ttu-id="677d5-202">Místo toho umožní vytvořit ObjectDataSource mimo GridView s TemplateFields s.</span><span class="sxs-lookup"><span data-stu-id="677d5-202">Instead, let s create the ObjectDataSource outside of the GridView s TemplateFields.</span></span> <span data-ttu-id="677d5-203">Ukončení úprav šablony a přetáhněte ji ObjectDataSource z panelu nástrojů na návrháře pod `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="677d5-203">End the template editing and drag an ObjectDataSource from the Toolbox onto the Designer beneath the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="677d5-204">Název nové ObjectDataSource `CategoriesDataSource` a nakonfigurujte ho na používání `CategoriesBLL` třídu s `GetCategories` metoda.</span><span class="sxs-lookup"><span data-stu-id="677d5-204">Name the new ObjectDataSource `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories` method.</span></span>


<span data-ttu-id="677d5-205">[![Konfigurace ObjectDataSource použití třídy CategoriesBLL](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-205">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span></span>

<span data-ttu-id="677d5-206">**Obrázek 8**: Konfigurace ObjectDataSource pro použití `CategoriesBLL` – třída ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-206">**Figure 8**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image14.png))</span></span>


<span data-ttu-id="677d5-207">[![Načtení dat kategorie metodou GetCategories](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-207">[![Retrieve the Category Data Using the GetCategories Method](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span></span>

<span data-ttu-id="677d5-208">**Obrázek 9**: načtení kategorie dat pomocí `GetCategories` – metoda ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-208">**Figure 9**: Retrieve the Category Data Using the `GetCategories` Method ([Click to view full-size image](batch-updating-vb/_static/image16.png))</span></span>


<span data-ttu-id="677d5-209">Vzhledem k tomu, že tento ObjectDataSource slouží jenom k načtení dat, nastavte rozevírací seznamy v karty aktualizace a odstranění na (žádný).</span><span class="sxs-lookup"><span data-stu-id="677d5-209">Since this ObjectDataSource is used merely to retrieve data, set the drop-down lists in the UPDATE and DELETE tabs to (None).</span></span> <span data-ttu-id="677d5-210">Kliknutím na tlačítko Dokončit ukončete průvodce.</span><span class="sxs-lookup"><span data-stu-id="677d5-210">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="677d5-211">[![Sada rozevíracích seznamů v aktualizaci a odstranění karty na (žádný)](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-211">[![Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None)](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span></span>

<span data-ttu-id="677d5-212">**Obrázek 10**: rozevíracího seznamu jsou uvedeny v aktualizaci a odstranění karty na hodnotu (žádná) ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-212">**Figure 10**: Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image18.png))</span></span>


<span data-ttu-id="677d5-213">Po dokončení průvodce, `CategoriesDataSource` s deklarativní by měl vypadat třeba takto:</span><span class="sxs-lookup"><span data-stu-id="677d5-213">After completing the wizard, the `CategoriesDataSource` s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample2.aspx)]

<span data-ttu-id="677d5-214">Pomocí `CategoriesDataSource` vytvořený a nakonfigurovaný, vraťte se do `CategoryName` TemplateField s `ItemTemplate` a z rozevírací seznam s inteligentní značky klikněte na odkaz zvolit zdroj dat.</span><span class="sxs-lookup"><span data-stu-id="677d5-214">With the `CategoriesDataSource` created and configured, return to the `CategoryName` TemplateField s `ItemTemplate` and, from the DropDownList s smart tag, click on the Choose Data Source link.</span></span> <span data-ttu-id="677d5-215">V průvodci Konfigurace zdroje dat, vyberte `CategoriesDataSource` možnost v prvním rozevíracím seznamu a zvolte tak, aby měl `CategoryName` používá pro zobrazení a `CategoryID` jako hodnotu.</span><span class="sxs-lookup"><span data-stu-id="677d5-215">In the Data Source Configuration wizard, select the `CategoriesDataSource` option from the first drop-down list and choose to have `CategoryName` used for the display and `CategoryID` as the value.</span></span>


<span data-ttu-id="677d5-216">[![Vytvořit vazbu rozevírací seznam CategoriesDataSource](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-216">[![Bind the DropDownList to the CategoriesDataSource](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span></span>

<span data-ttu-id="677d5-217">**Obrázek 11**: rozevírací seznam pro vytvoření vazby `CategoriesDataSource` ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-217">**Figure 11**: Bind the DropDownList to the `CategoriesDataSource` ([Click to view full-size image](batch-updating-vb/_static/image20.png))</span></span>


<span data-ttu-id="677d5-218">V tomto okamžiku `Categories` rozevírací seznam uvádí všechny kategorie, ale jeho není ještě automaticky vyberte odpovídající kategorii produktu vázaný na GridView řádek.</span><span class="sxs-lookup"><span data-stu-id="677d5-218">At this point the `Categories` DropDownList lists all of the categories, but it does not yet automatically select the appropriate category for the product bound to the GridView row.</span></span> <span data-ttu-id="677d5-219">K tomu je potřeba nastavit `Categories` rozevírací seznam s `SelectedValue` na produkt s `CategoryID` hodnotu.</span><span class="sxs-lookup"><span data-stu-id="677d5-219">To accomplish this we need to set the `Categories` DropDownList s `SelectedValue` to the product s `CategoryID` value.</span></span> <span data-ttu-id="677d5-220">Klikněte na odkaz Upravit datové vazby z rozevírací seznam s inteligentním a přidružit `SelectedValue` vlastnost s `CategoryID` pole dat, jak ukazuje obrázek 12.</span><span class="sxs-lookup"><span data-stu-id="677d5-220">Click on the Edit DataBindings link from the DropDownList s smart tag and associate the `SelectedValue` property with the `CategoryID` data field as shown in Figure 12.</span></span>


![Vazby pro vlastnost SelectedValue rozevírací seznam s hodnotě v poli produktu s](batch-updating-vb/_static/image12.gif)

<span data-ttu-id="677d5-222">**Obrázek 12**: vytvoření vazby produktu s `CategoryID` hodnotu na rozevírací seznam s `SelectedValue` vlastnost</span><span class="sxs-lookup"><span data-stu-id="677d5-222">**Figure 12**: Bind the Product s `CategoryID` Value to the DropDownList s `SelectedValue` Property</span></span>


<span data-ttu-id="677d5-223">Jeden poslední problém zůstane: Pokud máte t nemá produktu `CategoryID` zadána hodnota poté příkaz datové vazby v `SelectedValue` bude mít za následek výjimku.</span><span class="sxs-lookup"><span data-stu-id="677d5-223">One last problem remains: if the product doesn t have a `CategoryID` value specified then the databinding statement on `SelectedValue` will result in an exception.</span></span> <span data-ttu-id="677d5-224">Důvodem je, že rozevírací seznam obsahuje pouze položky pro kategorie a nenabízí možnost pro tyto produkty, které mají `NULL` databáze hodnotu `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="677d5-224">This is because the DropDownList contains only items for the categories and does not offer an option for those products that have a `NULL` database value for `CategoryID`.</span></span> <span data-ttu-id="677d5-225">Chcete-li to opravit, nastavte rozevírací seznam s `AppendDataBoundItems` vlastnost `True` a přidat novou položku do rozevírací seznam, vynechání `Value` vlastnost z deklarativní syntaxi.</span><span class="sxs-lookup"><span data-stu-id="677d5-225">To remedy this, set the DropDownList s `AppendDataBoundItems` property to `True` and add a new item to the DropDownList, omitting the `Value` property from the declarative syntax.</span></span> <span data-ttu-id="677d5-226">To znamená, ujistěte se, že `Categories` rozevírací seznam s deklarativní syntaxe vypadá takto:</span><span class="sxs-lookup"><span data-stu-id="677d5-226">That is, make sure that the `Categories` DropDownList s declarative syntax looks like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample3.aspx)]

<span data-ttu-id="677d5-227">Poznámka: Jak `<asp:ListItem Value="">` – vyberte jednu – má jeho `Value` atribut explicitně nastavit na prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="677d5-227">Note how the `<asp:ListItem Value="">` -- Select One -- has its `Value` attribute explicitly set to an empty string.</span></span> <span data-ttu-id="677d5-228">Odkazovat zpět [přizpůsobení rozhraní pro úpravu dat](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) kurz podrobnější diskuzi na Proč je potřeba tato další položka rozevírací seznam pro zpracování `NULL` případu a proč přiřazení `Value` je nezbytné vlastnosti na prázdný řetězec.</span><span class="sxs-lookup"><span data-stu-id="677d5-228">Refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial for a more thorough discussion on why this additional DropDownList item is needed to handle the `NULL` case and why assignment of the `Value` property to an empty string is essential.</span></span>

> [!NOTE]
> <span data-ttu-id="677d5-229">Potenciální výkon a škálovatelnost problém tady, je důležité zmínit, není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="677d5-229">There is a potential performance and scalability issue here that is worth mentioning.</span></span> <span data-ttu-id="677d5-230">Vzhledem k tomu, že každý řádek obsahuje rozevírací seznam, který používá `CategoriesDataSource` jako svůj zdroj dat `CategoriesBLL` třídu s `GetCategories` bude volána metoda  *n*  navštěvovat za stránky, kde  *n*  je počet řádků v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="677d5-230">Since each row has a DropDownList that uses the `CategoriesDataSource` as its data source, the `CategoriesBLL` class s `GetCategories` method will be called *n* times per page visit, where *n* is the number of rows in the GridView.</span></span> <span data-ttu-id="677d5-231">Tyto  *n*  volání `GetCategories` za následek  *n*  dotazy do databáze.</span><span class="sxs-lookup"><span data-stu-id="677d5-231">These *n* calls to `GetCategories` result in *n* queries to the database.</span></span> <span data-ttu-id="677d5-232">Tento dopad na databázi může dojít ke snížení za pomocí ukládání do mezipaměti vrácený kategorií v mezipaměti na požadavek nebo prostřednictvím vrstvě ukládání do mezipaměti pomocí ukládání do mezipaměti závislosti nebo velmi založené na krátkou dobu vypršení platnosti SQL.</span><span class="sxs-lookup"><span data-stu-id="677d5-232">This impact on the database could be lessened by caching the returned categories either in a per-request cache or through the Caching Layer using a SQL caching dependency or a very short time-based expiry.</span></span> <span data-ttu-id="677d5-233">Další informace o za požadavek ukládání do mezipaměti možnost, najdete v části [ `HttpContext.Items` mezipaměť za požadavku](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="677d5-233">For more information on the per-request caching option, see [`HttpContext.Items` a Per-Request Cache Store](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span></span>


## <a name="step-4-completing-the-editing-interface"></a><span data-ttu-id="677d5-234">Krok 4: Dokončení úprav rozhraní</span><span class="sxs-lookup"><span data-stu-id="677d5-234">Step 4: Completing the Editing Interface</span></span>

<span data-ttu-id="677d5-235">Jsme jste provedli několik změny šablon s GridView bez pozastavení zobrazíte naše průběh.</span><span class="sxs-lookup"><span data-stu-id="677d5-235">We ve made a number of changes to the GridView s templates without pausing to view our progress.</span></span> <span data-ttu-id="677d5-236">Chcete-li zobrazit naše průběh prostřednictvím prohlížeče chvíli trvat.</span><span class="sxs-lookup"><span data-stu-id="677d5-236">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="677d5-237">Jak ukazuje obrázek 13, každý řádek je vykreslen pomocí jeho `ItemTemplate`, který obsahuje s buňky úpravy rozhraní.</span><span class="sxs-lookup"><span data-stu-id="677d5-237">As Figure 13 shows, each row is rendered using its `ItemTemplate`, which contains the cell s editing interface.</span></span>


<span data-ttu-id="677d5-238">[![Každý řádek GridView je upravit](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-238">[![Each GridView Row is Editable](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span></span>

<span data-ttu-id="677d5-239">**Obrázek 13**: každý řádek GridView je upravit ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-239">**Figure 13**: Each GridView Row is Editable ([Click to view full-size image](batch-updating-vb/_static/image22.png))</span></span>


<span data-ttu-id="677d5-240">Existuje několik menší problémy formátování, které by měl staráme o v tomto okamžiku.</span><span class="sxs-lookup"><span data-stu-id="677d5-240">There are a few minor formatting issues that we should take care of at this point.</span></span> <span data-ttu-id="677d5-241">První, Všimněte si, že `UnitPrice` hodnota obsahuje čtyři desetinných míst.</span><span class="sxs-lookup"><span data-stu-id="677d5-241">First, note that the `UnitPrice` value contains four decimal points.</span></span> <span data-ttu-id="677d5-242">Chcete-li odstranit tento problém, vraťte se k `UnitPrice` TemplateField s `ItemTemplate` a z textové pole s inteligentní značky klikněte na odkaz Upravit datové vazby.</span><span class="sxs-lookup"><span data-stu-id="677d5-242">To fix this, return to the `UnitPrice` TemplateField s `ItemTemplate` and, from the TextBox s smart tag, click on the Edit DataBindings link.</span></span> <span data-ttu-id="677d5-243">Dále určit, že `Text` vlastnost musí být formátována jako číslo.</span><span class="sxs-lookup"><span data-stu-id="677d5-243">Next, specify that the `Text` property should be formatted as a number.</span></span>


![Formátuje vlastnost Text jako číslo](batch-updating-vb/_static/image14.gif)

<span data-ttu-id="677d5-245">**Obrázek 14**: formát `Text` vlastnost jako číslo</span><span class="sxs-lookup"><span data-stu-id="677d5-245">**Figure 14**: Format the `Text` Property as a Number</span></span>


<span data-ttu-id="677d5-246">Druhý, umožňují s center políčko ve `Discontinued` sloupce (místo nutnosti ho zarovnaný doleva).</span><span class="sxs-lookup"><span data-stu-id="677d5-246">Second, let s center the checkbox in the `Discontinued` column (rather than having it left-aligned).</span></span> <span data-ttu-id="677d5-247">Klikněte na Upravit sloupce z GridView s inteligentním a vyberte `Discontinued` TemplateField ze seznamu polí v levém dolním rohu.</span><span class="sxs-lookup"><span data-stu-id="677d5-247">Click on Edit Columns from the GridView s smart tag and select the `Discontinued` TemplateField from the list of fields in the bottom left corner.</span></span> <span data-ttu-id="677d5-248">K podrobnostem `ItemStyle` a nastavte `HorizontalAlign` vlastnost Center, jak ukazuje obrázek 15.</span><span class="sxs-lookup"><span data-stu-id="677d5-248">Drill down into `ItemStyle` and set the `HorizontalAlign` property to Center as shown in Figure 15.</span></span>


![Center – starší formáty zaškrtávací políčko](batch-updating-vb/_static/image15.gif)

<span data-ttu-id="677d5-250">**Obrázek 15**: Center `Discontinued` zaškrtávací políčko</span><span class="sxs-lookup"><span data-stu-id="677d5-250">**Figure 15**: Center the `Discontinued` CheckBox</span></span>


<span data-ttu-id="677d5-251">V dalším kroku přidání ValidationSummary ovládacího prvku na stránku a nastavit jeho `ShowMessageBox` vlastnost `True` a jeho `ShowSummary` vlastnost `False`.</span><span class="sxs-lookup"><span data-stu-id="677d5-251">Next, add a ValidationSummary control to the page and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="677d5-252">Také přidat že tlačítko webové ovládací prvky, při kliknutí na, dojde k aktualizaci s změny uživatelů.</span><span class="sxs-lookup"><span data-stu-id="677d5-252">Also add the Button Web controls that, when clicked, will update the user s changes.</span></span> <span data-ttu-id="677d5-253">Konkrétně přidat dva ovládací prvky webového tlačítko, nad GridView a jeden pod něj nastavení obou ovládacích prvků `Text` vlastnosti, které chcete aktualizace produktů.</span><span class="sxs-lookup"><span data-stu-id="677d5-253">Specifically, add two Button Web controls, one above the GridView and one below it, setting both controls `Text` properties to Update Products .</span></span>

<span data-ttu-id="677d5-254">Protože rutina GridView s úpravy rozhraní je definována v jeho TemplateFields `ItemTemplate` s, `EditItemTemplate` s jsou nadbytečné a může dojít k odstranění.</span><span class="sxs-lookup"><span data-stu-id="677d5-254">Since the GridView s editing interface is defined in its TemplateFields `ItemTemplate` s, the `EditItemTemplate` s are superfluous and may be deleted.</span></span>

<span data-ttu-id="677d5-255">Po provedení výše uvedených změny formátování, ovládací prvky tlačítek přidání a odebrání nadbytečné `EditItemTemplate` s, deklarativní syntaxi stránky s by měl vypadat asi takto:</span><span class="sxs-lookup"><span data-stu-id="677d5-255">After making the above mentioned formatting changes, adding the Button controls, and removing the unnecessary `EditItemTemplate` s, your page s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample4.aspx)]

<span data-ttu-id="677d5-256">Obrázek 16 zobrazuje tato stránka při zobrazení prostřednictvím prohlížeče, po přidání ovládací prvky webového tlačítko a formátování změny.</span><span class="sxs-lookup"><span data-stu-id="677d5-256">Figure 16 shows this page when viewed through a browser after the Button Web controls have been added and the formatting changes made.</span></span>


<span data-ttu-id="677d5-257">[![Stránka teď obsahuje dvě tlačítka aktualizace produktů](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="677d5-257">[![The Page Now Includes Two Update Products Buttons](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span></span>

<span data-ttu-id="677d5-258">**Obrázek 16**: stránky teď obsahuje dvě aktualizace produktů tlačítka ([Kliknutím zobrazit obrázek v plné velikosti](batch-updating-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="677d5-258">**Figure 16**: The Page Now Includes Two Update Products Buttons ([Click to view full-size image](batch-updating-vb/_static/image24.png))</span></span>


## <a name="step-5-updating-the-products"></a><span data-ttu-id="677d5-259">Krok 5: Aktualizace produktů</span><span class="sxs-lookup"><span data-stu-id="677d5-259">Step 5: Updating the Products</span></span>

<span data-ttu-id="677d5-260">Pokud uživatel navštíví této stránce se budou proveďte jejich úpravy a pak klikněte na jednu pro dvě tlačítka aktualizace produktů.</span><span class="sxs-lookup"><span data-stu-id="677d5-260">When a user visits this page they will make their modifications and then click one of the two Update Products buttons.</span></span> <span data-ttu-id="677d5-261">V tomto bodě musíme nějakým způsobem uložit hodnot zadaných uživatelem pro každý řádek do `ProductsDataTable` instance a předat který BLL metodu, která se pak předejte, `ProductsDataTable` instance DAL s `UpdateWithTransaction` metoda.</span><span class="sxs-lookup"><span data-stu-id="677d5-261">At that point we need to somehow save the user-entered values for each row into a `ProductsDataTable` instance and then pass that to a BLL method that will then pass that `ProductsDataTable` instance to the DAL s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="677d5-262">`UpdateWithTransaction` Metodu, která jsme vytvořili v [předchozí kurzu](wrapping-database-modifications-within-a-transaction-vb.md), zajišťuje dávku změny budou aktualizaci jako atomickou operaci.</span><span class="sxs-lookup"><span data-stu-id="677d5-262">The `UpdateWithTransaction` method, which we created in the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md), ensures that the batch of changes will be updated as an atomic operation.</span></span>

<span data-ttu-id="677d5-263">Vytvořit metodu s názvem `BatchUpdate` v `BatchUpdate.aspx.vb` a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="677d5-263">Create a method named `BatchUpdate` in `BatchUpdate.aspx.vb` and add the following code:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample5.vb)]

<span data-ttu-id="677d5-264">Tato metoda začíná získáním na všechny produkty zpět v `ProductsDataTable` prostřednictvím volání BLL s `GetProducts` metoda.</span><span class="sxs-lookup"><span data-stu-id="677d5-264">This method starts out by getting all of the products back in a `ProductsDataTable` via a call to the BLL s `GetProducts` method.</span></span> <span data-ttu-id="677d5-265">Pak zobrazí `ProductGrid` GridView s [ `Rows` kolekce](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="677d5-265">It then enumerates the `ProductGrid` GridView s [`Rows` collection](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span></span> <span data-ttu-id="677d5-266">`Rows` Kolekce obsahuje [ `GridViewRow` instance](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.aspx) pro každý řádek v GridView zobrazí.</span><span class="sxs-lookup"><span data-stu-id="677d5-266">The `Rows` collection contains a [`GridViewRow` instance](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.aspx) for each row displayed in the GridView.</span></span> <span data-ttu-id="677d5-267">Vzhledem k tomu, že jsme zobrazují maximálně deset řádků na každé stránce, rutina GridView s `Rows` kolekce bude obsahovat více než deset položky.</span><span class="sxs-lookup"><span data-stu-id="677d5-267">Since we are showing at most ten rows per page, the GridView s `Rows` collection will have no more than ten items.</span></span>

<span data-ttu-id="677d5-268">Pro každý řádek `ProductID` bude převzat z `DataKeys` kolekce a odpovídající `ProductsRow` je vybraný `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="677d5-268">For each row the `ProductID` is grabbed from the `DataKeys` collection and the appropriate `ProductsRow` is selected from the `ProductsDataTable`.</span></span> <span data-ttu-id="677d5-269">Čtyři vstupní ovládací prvky TemplateField se odkazuje prostřednictvím kódu programu a jejich hodnoty přiřazené `ProductsRow` s vlastnosti instance.</span><span class="sxs-lookup"><span data-stu-id="677d5-269">The four TemplateField input controls are programmatically referenced and their values assigned to the `ProductsRow` instance s properties.</span></span> <span data-ttu-id="677d5-270">Po každé GridView hodnoty řádků s použily aktualizace `ProductsDataTable`, ho s předaný BLL s `UpdateWithTransaction` metodu, která jako jsme viděli v tomto kurzu předchozí jednoduše volá do DAL s `UpdateWithTransaction` metoda.</span><span class="sxs-lookup"><span data-stu-id="677d5-270">After each GridView row s values have been used to update the `ProductsDataTable`, it s passed to the BLL s `UpdateWithTransaction` method which, as we saw in the preceding tutorial, simply calls down into the DAL s `UpdateWithTransaction` method.</span></span>

<span data-ttu-id="677d5-271">Algoritmus aktualizace batch používá pro účely tohoto kurzu aktualizuje každý řádek `ProductsDataTable` odpovídající řádek v GridView, bez ohledu na to, jestli se změnil informace o produktu s.</span><span class="sxs-lookup"><span data-stu-id="677d5-271">The batch update algorithm used for this tutorial updates each row in the `ProductsDataTable` that corresponds to a row in the GridView, regardless of whether the product s information has been changed.</span></span> <span data-ttu-id="677d5-272">Při takové blind aktualizací t nejsou obvykle problémy výkonem, mohou vést nadbytečné záznamy li níž auditování změn do databázové tabulky.</span><span class="sxs-lookup"><span data-stu-id="677d5-272">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="677d5-273">Zpět v [provádění dávková aktualizace](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) kurzu jsme prozkoumali dávce aktualizuje rozhraní s prvku DataList a přidat kód, který by aktualizovat pouze tyto záznamy, které byly upraveny ve skutečnosti uživatelem.</span><span class="sxs-lookup"><span data-stu-id="677d5-273">Back in the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we explored a batch updating interface with the DataList and added code that would only update those records that were actually modified by the user.</span></span> <span data-ttu-id="677d5-274">Nebojte se použít techniky z [provádění dávková aktualizace](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) v případě potřeby aktualizujte kód v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="677d5-274">Feel free to use the techniques from [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) to update the code in this tutorial, if desired.</span></span>

> [!NOTE]
> <span data-ttu-id="677d5-275">Při vytváření vazby zdroje dat pro GridView prostřednictvím jeho inteligentních značek, Visual Studio automaticky přiřadí datový zdroj s primární klíče hodnoty GridView s `DataKeyNames` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="677d5-275">When binding the data source to the GridView through its smart tag, Visual Studio automatically assigns the data source s primary key value(s) to the GridView s `DataKeyNames` property.</span></span> <span data-ttu-id="677d5-276">Pokud jste není navázán ObjectDataSource na GridView prostřednictvím GridView s inteligentním jak je uvedeno v kroku 1, pak budete muset ručně nastavit GridView s `DataKeyNames` vlastnost ProductID, aby měli přístup `ProductID` hodnotu pro každý řádek prostřednictvím `DataKeys` kolekce.</span><span class="sxs-lookup"><span data-stu-id="677d5-276">If you did not bind the ObjectDataSource to the GridView through the GridView s smart tag as outlined in Step 1, then you will need to manually set the GridView s `DataKeyNames` property to ProductID in order to access the `ProductID` value for each row through the `DataKeys` collection.</span></span>


<span data-ttu-id="677d5-277">Kód použitý v `BatchUpdate` je podobná používán BLL s `UpdateProduct` metody, hlavní rozdíl je, že v `UpdateProduct` metody jediným `ProductRow` instance se načítají architekturu.</span><span class="sxs-lookup"><span data-stu-id="677d5-277">The code used in `BatchUpdate` is similar to that used in the BLL s `UpdateProduct` methods, the main difference being that in the `UpdateProduct` methods only a single `ProductRow` instance is retrieved from the architecture.</span></span> <span data-ttu-id="677d5-278">Kód, který přiřazuje vlastnosti `ProductRow` je stejný mezi `UpdateProducts` metody a kódu v rámci `For Each` smyčky v `BatchUpdate`, jako je celkový vzor.</span><span class="sxs-lookup"><span data-stu-id="677d5-278">The code that assigns the properties of the `ProductRow` is the same between the `UpdateProducts` methods and the code within the `For Each` loop in `BatchUpdate`, as is the overall pattern.</span></span>

<span data-ttu-id="677d5-279">K dokončení tohoto kurzu, je potřeba mít `BatchUpdate` metoda volána, když po kliknutí na některý z tlačítka aktualizace produktů.</span><span class="sxs-lookup"><span data-stu-id="677d5-279">To complete this tutorial, we need to have the `BatchUpdate` method invoked when either of the Update Products buttons is clicked.</span></span> <span data-ttu-id="677d5-280">Vytváření obslužných rutin událostí pro `Click` události těchto dvou tlačítko – ovládací prvky a přidejte následující kód v obslužné rutiny událostí:</span><span class="sxs-lookup"><span data-stu-id="677d5-280">Create event handlers for the `Click` events of these two Button controls and add the following code in the event handlers:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample6.vb)]

<span data-ttu-id="677d5-281">Nejprve je volána k `BatchUpdate`.</span><span class="sxs-lookup"><span data-stu-id="677d5-281">First a call is made to `BatchUpdate`.</span></span> <span data-ttu-id="677d5-282">Dále [ `ClientScript` vlastnost](https://msdn.microsoft.com/en-us/library/system.web.ui.page.clientscript(VS.80).aspx) slouží k vložení JavaScript, který se zobrazí messagebox, který čte produkty byly aktualizovány.</span><span class="sxs-lookup"><span data-stu-id="677d5-282">Next, the [`ClientScript` property](https://msdn.microsoft.com/en-us/library/system.web.ui.page.clientscript(VS.80).aspx) is used to inject JavaScript that will display a messagebox that reads The products have been updated.</span></span>

<span data-ttu-id="677d5-283">Trvat několik minut k otestování tohoto kódu.</span><span class="sxs-lookup"><span data-stu-id="677d5-283">Take a minute to test out this code.</span></span> <span data-ttu-id="677d5-284">Navštivte `BatchUpdate.aspx` prostřednictvím prohlížeče, upravit počet řádků a klikněte na jednu z tlačítka aktualizace produktů.</span><span class="sxs-lookup"><span data-stu-id="677d5-284">Visit `BatchUpdate.aspx` through a browser, edit a number of rows, and click one of the Update Products buttons.</span></span> <span data-ttu-id="677d5-285">Za předpokladu, že nejsou žádné chyby ověření vstupu, měli byste vidět messagebox, který čte, že byly aktualizovány produkty.</span><span class="sxs-lookup"><span data-stu-id="677d5-285">Assuming there are no input validation errors, you should see a messagebox that reads The products have been updated.</span></span> <span data-ttu-id="677d5-286">Chcete-li ověřit nedělitelnost aktualizace, zvažte přidání náhodnou `CHECK` omezení, jako je ten, který zakáže `UnitPrice` hodnoty 1234.56.</span><span class="sxs-lookup"><span data-stu-id="677d5-286">To verify the atomicity of the update, consider adding a random `CHECK` constraint, like one that disallows `UnitPrice` values of 1234.56.</span></span> <span data-ttu-id="677d5-287">Potom z `BatchUpdate.aspx`, upravit počet záznamů, a zkontrolujte, zda nastavte jednu z produktu s `UnitPrice` hodnotu zakázané hodnotou (1234.56).</span><span class="sxs-lookup"><span data-stu-id="677d5-287">Then from `BatchUpdate.aspx`, edit a number of records, making sure to set one of the product s `UnitPrice` value to the forbidden value ( 1234.56 ).</span></span> <span data-ttu-id="677d5-288">Výsledkem by mělo chybu při kliknutí na aktualizace produktů s další změny během této operace batch vrátit zpět na původní hodnoty.</span><span class="sxs-lookup"><span data-stu-id="677d5-288">This should result in an error when clicking Update Products with the other changes during that batch operation rolled back to their original values.</span></span>

## <a name="an-alternativebatchupdatemethod"></a><span data-ttu-id="677d5-289">Alternativu`BatchUpdate`– metoda</span><span class="sxs-lookup"><span data-stu-id="677d5-289">An Alternative`BatchUpdate`Method</span></span>

<span data-ttu-id="677d5-290">`BatchUpdate` Metoda jsme právě zkontrolován načte *všechny* produkty z BLL s `GetProducts` metoda a pak aktualizuje pouze tyto záznamy, které se zobrazují v GridView.</span><span class="sxs-lookup"><span data-stu-id="677d5-290">The `BatchUpdate` method we just examined retrieves *all* of the products from the BLL s `GetProducts` method and then updates just those records that appear in the GridView.</span></span> <span data-ttu-id="677d5-291">Tento přístup je ideální, pokud GridView nepoužívá stránkování, ale pokud ano, může existovat stovky, tisíc nebo desetitisíce produkty, ale maximálně deset řádků v prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="677d5-291">This approach is ideal if the GridView does not use paging, but if it does, there may be hundreds, thousands, or tens of thousands of products, but only ten rows in the GridView.</span></span> <span data-ttu-id="677d5-292">V takovém případě je menší než vhodné získávání všechny produkty z databáze pouze k úpravě 10 z nich.</span><span class="sxs-lookup"><span data-stu-id="677d5-292">In such a case, getting all of the products from the database only to modify 10 of them is less than ideal.</span></span>

<span data-ttu-id="677d5-293">Pro tyto typy situacích zvažte použití následujících `BatchUpdateAlternate` metoda místo:</span><span class="sxs-lookup"><span data-stu-id="677d5-293">For those types of situations, consider using the following `BatchUpdateAlternate` method instead:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample7.vb)]

<span data-ttu-id="677d5-294">`BatchMethodAlternate`začne tím, že vytvoříte nový prázdný `ProductsDataTable` s názvem `products`.</span><span class="sxs-lookup"><span data-stu-id="677d5-294">`BatchMethodAlternate` starts by creating a new empty `ProductsDataTable` named `products`.</span></span> <span data-ttu-id="677d5-295">Následně kroky prostřednictvím GridView s `Rows` kolekce a pro každý řádek získá informace o konkrétním produktu pomocí BLL s `GetProductByProductID(productID)` metoda.</span><span class="sxs-lookup"><span data-stu-id="677d5-295">It then steps through the GridView s `Rows` collection and for each row gets the particular product information using the BLL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="677d5-296">Načtený `ProductsRow` instance má jeho vlastnosti aktualizovat stejným způsobem jako `BatchUpdate`, ale po aktualizaci řádku je importovat do `products` `ProductsDataTable` prostřednictvím DataTable s [ `ImportRow(DataRow)` metoda](https://msdn.microsoft.com/en-us/library/system.data.datatable.importrow(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="677d5-296">The retrieved `ProductsRow` instance has its properties updated in the same fashion as `BatchUpdate`, but after updating the row it is imported into the `products` `ProductsDataTable` via the DataTable s [`ImportRow(DataRow)` method](https://msdn.microsoft.com/en-us/library/system.data.datatable.importrow(VS.80).aspx).</span></span>

<span data-ttu-id="677d5-297">Po `For Each` dokončení smyčky `products` obsahuje jeden `ProductsRow` instance pro každý řádek v GridView.</span><span class="sxs-lookup"><span data-stu-id="677d5-297">After the `For Each` loop completes, `products` contains one `ProductsRow` instance for each row in the GridView.</span></span> <span data-ttu-id="677d5-298">Od těchto `ProductsRow` instance jsou přidané do `products` (místo aktualizaci), pokud jsme slepě předejte ji do `UpdateWithTransaction` metoda `ProductsTableAdatper` se pokusí každý záznam vložit do databáze.</span><span class="sxs-lookup"><span data-stu-id="677d5-298">Since each of the `ProductsRow` instances have been added to the `products` (instead of updated), if we blindly pass it to the `UpdateWithTransaction` method the `ProductsTableAdatper` will try to insert each of the records into the database.</span></span> <span data-ttu-id="677d5-299">Místo toho je potřeba zadat, že všechny tyto řádky se změnila (není přidáno).</span><span class="sxs-lookup"><span data-stu-id="677d5-299">Instead, we need to specify that each of these rows has been modified (not added).</span></span>

<span data-ttu-id="677d5-300">Můžete to provést přidáním nové metody do BLL s názvem `UpdateProductsWithTransaction`.</span><span class="sxs-lookup"><span data-stu-id="677d5-300">This can be accomplished by adding a new method to the BLL named `UpdateProductsWithTransaction`.</span></span> <span data-ttu-id="677d5-301">`UpdateProductsWithTransaction`, vidíte níže, nastaví `RowState` jednotlivých `ProductsRow` instancí v `ProductsDataTable` k `Modified` a pak předá `ProductsDataTable` k DAL s `UpdateWithTransaction` metoda.</span><span class="sxs-lookup"><span data-stu-id="677d5-301">`UpdateProductsWithTransaction`, shown below, sets the `RowState` of each of the `ProductsRow` instances in the `ProductsDataTable` to `Modified` and then passes the `ProductsDataTable` to the DAL s `UpdateWithTransaction` method.</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample8.vb)]

## <a name="summary"></a><span data-ttu-id="677d5-302">Souhrn</span><span class="sxs-lookup"><span data-stu-id="677d5-302">Summary</span></span>

<span data-ttu-id="677d5-303">GridView poskytuje možnosti úprav předdefinované na řádek, ale chybí podpora pro vytváření plně upravitelné rozhraní.</span><span class="sxs-lookup"><span data-stu-id="677d5-303">The GridView provides built-in per-row editing capabilities, but lacks support for creating fully editable interfaces.</span></span> <span data-ttu-id="677d5-304">Jak jsme viděli v tomto kurzu, taková rozhraní je možné, ale vyžadují bit práce.</span><span class="sxs-lookup"><span data-stu-id="677d5-304">As we saw in this tutorial, such interfaces are possible, but require a bit of work.</span></span> <span data-ttu-id="677d5-305">Pokud chcete vytvořit GridView, kde je každý řádek upravovat, je potřeba převést pole s GridView TemplateFields a definovat úpravy rozhraní v rámci `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="677d5-305">To create a GridView where every row is editable, we need to convert the GridView s fields into TemplateFields and define the editing interface within the `ItemTemplate` s.</span></span> <span data-ttu-id="677d5-306">Kromě toho aktualizovat všechny – tlačítko webové ovládací prvky typu musí být přidaný do stránce odděleně od GridView.</span><span class="sxs-lookup"><span data-stu-id="677d5-306">Additionally, Update All -type Button Web controls must be added to the page, separate from the GridView.</span></span> <span data-ttu-id="677d5-307">Tato tlačítka `Click` obslužné rutiny událostí muset výčet GridView s `Rows` kolekce, uložit změny v `ProductsDataTable`a předat do odpovídající metodu BLL aktualizované informace.</span><span class="sxs-lookup"><span data-stu-id="677d5-307">These Buttons `Click` event handlers need to enumerate the GridView s `Rows` collection, store the changes in a `ProductsDataTable`, and pass the updated information into the appropriate BLL method.</span></span>

<span data-ttu-id="677d5-308">V dalším kurzu vidíte vytvoření rozhraní pro dávkové odstranění.</span><span class="sxs-lookup"><span data-stu-id="677d5-308">In the next tutorial we'll see how to create an interface for batch deleting.</span></span> <span data-ttu-id="677d5-309">Konkrétně, bude každý řádek GridView zahrnout zaškrtávací políčko a místo aktualizovat všechny – typ tlačítka, budeme mít tlačítka Odstranit vybrané řádky.</span><span class="sxs-lookup"><span data-stu-id="677d5-309">In particular, each GridView row will include a checkbox and instead of Update All -type buttons, we'll have Delete Selected Rows buttons.</span></span>

<span data-ttu-id="677d5-310">Radostí programování!</span><span class="sxs-lookup"><span data-stu-id="677d5-310">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="677d5-311">O autorovi</span><span class="sxs-lookup"><span data-stu-id="677d5-311">About the Author</span></span>

<span data-ttu-id="677d5-312">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a zakladatele z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje s technologií Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="677d5-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="677d5-313">Scott funguje jako nezávislé poradce, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="677d5-313">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="677d5-314">Jeho nejnovější seznam k [ *Edice nakladatelství Sams naučit sami technologii ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="677d5-314">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="677d5-315">Dosažitelný v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) nebo prostřednictvím svého blogu, který najdete na [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="677d5-315">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="677d5-316">Zvláštní poděkování</span><span class="sxs-lookup"><span data-stu-id="677d5-316">Special Thanks To</span></span>

<span data-ttu-id="677d5-317">Tento kurz řady byla zkontrolovány uživatelem mnoho užitečné kontrolorů.</span><span class="sxs-lookup"><span data-stu-id="677d5-317">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="677d5-318">Vést kontroloři v tomto kurzu se Teresy Murphy a David Suru.</span><span class="sxs-lookup"><span data-stu-id="677d5-318">Lead reviewers for this tutorial were Teresa Murphy and David Suru.</span></span> <span data-ttu-id="677d5-319">Kontrola Moje nadcházející články MSDN máte zájem?</span><span class="sxs-lookup"><span data-stu-id="677d5-319">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="677d5-320">Pokud ano, vyřaďte mi řádek v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="677d5-320">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="677d5-321">[Předchozí](wrapping-database-modifications-within-a-transaction-vb.md)
[další](batch-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="677d5-321">[Previous](wrapping-database-modifications-within-a-transaction-vb.md)
[Next](batch-deleting-vb.md)</span></span>
