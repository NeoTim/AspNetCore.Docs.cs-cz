---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
title: "Nasazení databázové projekty | Microsoft Docs"
author: jrjlee
description: "Poznámka: V mnoha podnikové scénáře nasazení, je třeba možnost publikovat přírůstkové aktualizace nasazené databáze. Alternativou je znovu vytvořit..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: 832f226a-1aa3-4093-8c29-ce4196793259
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
msc.type: authoredcontent
ms.openlocfilehash: aef8229f2920bd026e3dbf063afb57cffb9b21d0
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/10/2017
---
<a name="deploying-database-projects"></a><span data-ttu-id="2bb50-104">Databázové projekty nasazení</span><span class="sxs-lookup"><span data-stu-id="2bb50-104">Deploying Database Projects</span></span>
====================
<span data-ttu-id="2bb50-105">podle [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="2bb50-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="2bb50-106">Stáhnout PDF</span><span class="sxs-lookup"><span data-stu-id="2bb50-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> [!NOTE]
> <span data-ttu-id="2bb50-107">V mnoha podnikové scénáře nasazení je třeba možnost publikovat přírůstkové aktualizace nasazené databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-107">In lots of enterprise deployment scenarios, you need the ability to publish incremental updates to a deployed database.</span></span> <span data-ttu-id="2bb50-108">Alternativou je znovu vytvořit databázi na každém nasazení, což znamená, že přijdete o všechna data v existující databázi.</span><span class="sxs-lookup"><span data-stu-id="2bb50-108">The alternative is to recreate the database on every deployment, which means you lose any data in the existing database.</span></span> <span data-ttu-id="2bb50-109">Při práci s Visual Studio 2010 pomocí VSDBCMD je doporučeným přístupem k přírůstkové publikování databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-109">When you work with Visual Studio 2010, using VSDBCMD is the recommended approach to incremental database publishing.</span></span> <span data-ttu-id="2bb50-110">Další verze sady Visual Studio a webové publikování kanálu (WPP) však bude obsahovat nástrojů, který podporuje přírůstkové publikování přímo.</span><span class="sxs-lookup"><span data-stu-id="2bb50-110">However, the next version of Visual Studio and the Web Publishing Pipeline (WPP) will include tooling that supports incremental publishing directly.</span></span>


<span data-ttu-id="2bb50-111">Pokud otevřete obraťte se na správce ukázkové řešení v sadě Visual Studio 2010, uvidíte, že k databázovému projektu obsahuje vlastnosti složky, která obsahuje čtyři soubory.</span><span class="sxs-lookup"><span data-stu-id="2bb50-111">If you open the Contact Manager sample solution in Visual Studio 2010, you'll see that the database project includes a Properties folder that contains four files.</span></span>

![](deploying-database-projects/_static/image1.png)

<span data-ttu-id="2bb50-112">Společně s souboru projektu (*ContactManager.Database.dbproj* v tomto případě), tyto soubory ovládat různé aspekty procesu sestavení a nasazení:</span><span class="sxs-lookup"><span data-stu-id="2bb50-112">Together with the project file (*ContactManager.Database.dbproj* in this case), these files control various aspects of the build and deployment process:</span></span>

- <span data-ttu-id="2bb50-113">*Database.sqlcmdvars* soubor poskytuje hodnoty pro všechny proměnné SQLCMD použít při nasazení projektu.</span><span class="sxs-lookup"><span data-stu-id="2bb50-113">The *Database.sqlcmdvars* file provides values for any SQLCMD variables you use when you deploy the project.</span></span> <span data-ttu-id="2bb50-114">Každé řešení konfiguraci (například ladění a vydání) můžete zadat různé .sqlcmdvars souboru.</span><span class="sxs-lookup"><span data-stu-id="2bb50-114">Each solution configuration (for example, debug and release) can specify a different .sqlcmdvars file.</span></span>
- <span data-ttu-id="2bb50-115">*Database.sqldeployment* soubor poskytuje nastavení pro konkrétní nasazení, jako jestli se má používat kolaci definované v projektu nebo kolaci na cílovém serveru, jestli se má znovu vytvořit cílové databázi každých čas nebo jednoduše upravit existující databázi a převeďte ho do aktuální a tak dále.</span><span class="sxs-lookup"><span data-stu-id="2bb50-115">The *Database.sqldeployment* file provides deployment-specific settings, like whether to use the collation defined in your project or the collation of the destination server, whether to recreate the destination database every time or simply amend the existing database to bring it up to date, and so on.</span></span> <span data-ttu-id="2bb50-116">Každé řešení konfiguraci můžete zadat různé .sqldeployment souboru.</span><span class="sxs-lookup"><span data-stu-id="2bb50-116">Each solution configuration can specify a different .sqldeployment file.</span></span>
- <span data-ttu-id="2bb50-117">*Database.sqlpermissions* soubor je dokument XML, který můžete použít k definování všechna oprávnění, které chcete přidat na cílovou databázi.</span><span class="sxs-lookup"><span data-stu-id="2bb50-117">The *Database.sqlpermissions* file is an XML document that you can use to define any permissions you want to add to the target database.</span></span> <span data-ttu-id="2bb50-118">Všechny konfigurace řešení sdílet stejný soubor .sqlpermissions.</span><span class="sxs-lookup"><span data-stu-id="2bb50-118">All solution configurations share the same .sqlpermissions file.</span></span>
- <span data-ttu-id="2bb50-119">*Database.sqlsettings* soubor Určuje úroveň databáze vlastnosti, které chcete použít při vytváření databáze, jako je kolaci na použití chování relační operátory a tak dále.</span><span class="sxs-lookup"><span data-stu-id="2bb50-119">The *Database.sqlsettings* file specifies the database-level properties to use when creating the database, like the collation to use, the behavior of comparison operators, and so on.</span></span> <span data-ttu-id="2bb50-120">Všechny konfigurace řešení sdílet stejný soubor .sqlsettings.</span><span class="sxs-lookup"><span data-stu-id="2bb50-120">All solution configurations share the same .sqlsettings file.</span></span>

<span data-ttu-id="2bb50-121">Je vhodné věnovat chvíli k otevření těchto souborů v sadě Visual Studio a seznamte se s obsahem.</span><span class="sxs-lookup"><span data-stu-id="2bb50-121">It's worth taking a moment to open these files in Visual Studio and familiarize yourself with the contents.</span></span>

<span data-ttu-id="2bb50-122">Při sestavování projektu databáze procesu sestavení vytvoří dva soubory:</span><span class="sxs-lookup"><span data-stu-id="2bb50-122">When you build a database project, the build process creates two files:</span></span>

- <span data-ttu-id="2bb50-123">A *schéma databáze* (.dbschema soubor).</span><span class="sxs-lookup"><span data-stu-id="2bb50-123">A *database schema* (.dbschema file).</span></span> <span data-ttu-id="2bb50-124">Popisuje schéma databáze, kterou chcete vytvořit ve formátu XML.</span><span class="sxs-lookup"><span data-stu-id="2bb50-124">This describes the schema of the database you want to create in XML format.</span></span>
- <span data-ttu-id="2bb50-125">A *– manifest nasazení* (.deploymanifest soubor).</span><span class="sxs-lookup"><span data-stu-id="2bb50-125">A *deployment manifest* (.deploymanifest file).</span></span> <span data-ttu-id="2bb50-126">Tato položka obsahuje všechny informace požadované pro vytvoření a nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-126">This contains all the information required to create and deploy your database.</span></span> <span data-ttu-id="2bb50-127">Odkazuje na soubor .dbschema spolu s jiným prostředkům, jako jsou pokyny k nasazení (soubor .sqldeployment) a všechny skripty SQL před nasazením nebo po nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-127">It references the .dbschema file along with other resources, like the deployment instructions (the .sqldeployment file) and any pre-deployment or post-deployment SQL scripts.</span></span>

<span data-ttu-id="2bb50-128">To ukazuje vztah mezi tyto prostředky:</span><span class="sxs-lookup"><span data-stu-id="2bb50-128">This shows the relationship between these resources:</span></span>

![](deploying-database-projects/_static/image2.png)

<span data-ttu-id="2bb50-129">Jak vidíte, .sqlsettings soubor a soubor .sqlpermissions jsou vstupy do procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-129">As you can see, the .sqlsettings file and the .sqlpermissions file are inputs to the build process.</span></span> <span data-ttu-id="2bb50-130">Projekt souborem databáze jsou tyto soubory použít k vytvoření souboru schématu databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-130">Along with the database project file, these files are used to create the database schema file.</span></span> <span data-ttu-id="2bb50-131">.Sqldeployment soubor a soubor .sqlcmdvars předávat procesu sestavení beze změny.</span><span class="sxs-lookup"><span data-stu-id="2bb50-131">The .sqldeployment file and the .sqlcmdvars file pass through the build process unchanged.</span></span> <span data-ttu-id="2bb50-132">Manifest nasazení určuje umístění schématu databáze, .sqldeployment souboru, soubor .sqlcmdvars a všechny skripty SQL před nasazením nebo po nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-132">The deployment manifest indicates the location of the database schema, the .sqldeployment file, the .sqlcmdvars file, and any pre-deployment or post-deployment SQL scripts.</span></span>

## <a name="why-use-vsdbcmd-to-deploy-a-database-project"></a><span data-ttu-id="2bb50-133">Proč používat VSDBCMD nasadit projekt databáze?</span><span class="sxs-lookup"><span data-stu-id="2bb50-133">Why Use VSDBCMD to Deploy a Database Project?</span></span>

<span data-ttu-id="2bb50-134">Existují různé různé přístupy k nasazení databázové projekty.</span><span class="sxs-lookup"><span data-stu-id="2bb50-134">There are various different approaches to deploying database projects.</span></span> <span data-ttu-id="2bb50-135">Ne všechny z nich jsou však vhodné pro nasazení databáze projektu na vzdálených serverech v podnikovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="2bb50-135">However, not all of them are suitable for deploying a database project to remote servers in an enterprise environment.</span></span> <span data-ttu-id="2bb50-136">Zvažte, co chcete z projektu nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-136">Consider what you want from a database project deployment.</span></span> <span data-ttu-id="2bb50-137">V podnikové scénáře nasazení budete pravděpodobně chcete:</span><span class="sxs-lookup"><span data-stu-id="2bb50-137">In enterprise deployment scenarios, you're likely to want:</span></span>

- <span data-ttu-id="2bb50-138">Schopnost nasadit projekt databáze ze vzdáleného umístění.</span><span class="sxs-lookup"><span data-stu-id="2bb50-138">The ability to deploy the database project from a remote location.</span></span>
- <span data-ttu-id="2bb50-139">Schopnost provádět přírůstkové aktualizace existující databázi.</span><span class="sxs-lookup"><span data-stu-id="2bb50-139">The ability to make incremental updates to an existing database.</span></span>
- <span data-ttu-id="2bb50-140">Možnost zahrnout skripty před nasazením nebo skripty po nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-140">The ability to include pre-deployment scripts or post-deployment scripts.</span></span>
- <span data-ttu-id="2bb50-141">Možnost přizpůsobit pro prostředí s více cílové nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-141">The ability to tailor the deployment to multiple destination environments.</span></span>
- <span data-ttu-id="2bb50-142">Schopnost nasadit projekt databáze jako součást větší, obvykle skriptován, krokování řešení nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-142">The ability to deploy the database project as part of a larger, typically scripted, single-step solution deployment.</span></span>

<span data-ttu-id="2bb50-143">Existují tři hlavní přístupy, které můžete nasadit projekt databáze:</span><span class="sxs-lookup"><span data-stu-id="2bb50-143">There are three main approaches you can use to deploy a database project:</span></span>

- <span data-ttu-id="2bb50-144">Můžete použít funkci nasazení s typem databáze projektu v sadě Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="2bb50-144">You can use the deployment functionality with the database project type in Visual Studio 2010.</span></span> <span data-ttu-id="2bb50-145">Vytvořit a nasadit projekt databáze v sadě Visual Studio 2010, proces nasazení používá ke generování specifická pro konfiguraci sestavení na základě SQL nasazení souboru manifest nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-145">When you build and deploy a database project in Visual Studio 2010, the deployment process uses the deployment manifest to generate a SQL-based deployment file specific to the build configuration.</span></span> <span data-ttu-id="2bb50-146">Tím se vytvoří databáze, pokud není již neexistuje nebo proveďte potřebné změny do databáze, pokud již existuje.</span><span class="sxs-lookup"><span data-stu-id="2bb50-146">This will create the database if it doesn't already exist or make any necessary changes to the database if it does already exist.</span></span> <span data-ttu-id="2bb50-147">SQLCMD.exe můžete použít ke spuštění tohoto souboru na cílovém serveru, nebo můžete nastavit sady Visual Studio vytvořte a spusťte soubor.</span><span class="sxs-lookup"><span data-stu-id="2bb50-147">You can use SQLCMD.exe to run this file on your destination server, or you can set Visual Studio to create and run the file.</span></span> <span data-ttu-id="2bb50-148">Nevýhodou tohoto přístupu je, že máte jenom omezený kontrolu nad nastavení nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-148">The disadvantage of this approach is that you have only limited control over the deployment settings.</span></span> <span data-ttu-id="2bb50-149">Často také musíte upravit soubor nasazení nástroje SQL k zadání hodnot proměnných konkrétní prostředí.</span><span class="sxs-lookup"><span data-stu-id="2bb50-149">You may often also need to modify the SQL deployment file to provide environment-specific variable values.</span></span> <span data-ttu-id="2bb50-150">Tento přístup z počítače lze použít pouze s Visual Studio 2010 nainstalovaný a vývojář by bylo potřeba vědět a zadejte připojovací řetězce a přihlašovací údaje pro všechny cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="2bb50-150">You can only use this approach from a computer with Visual Studio 2010 installed, and the developer would need to know and provide connection strings and credentials for all destination environments.</span></span>
- <span data-ttu-id="2bb50-151">Nástroj pro nasazení Internetové informační služby (IIS) webu (Web Deploy) můžete [nasadit databázi jako součást projektu webové aplikace](https://msdn.microsoft.com/en-us/library/dd465343.aspx).</span><span class="sxs-lookup"><span data-stu-id="2bb50-151">You can use the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to [deploy a database as part of a web application project](https://msdn.microsoft.com/en-us/library/dd465343.aspx).</span></span> <span data-ttu-id="2bb50-152">Tento přístup je však mnohem složitější, pokud chcete nasadit projekt databáze než jednoduše replikovat existující místní databázi na cílovém serveru.</span><span class="sxs-lookup"><span data-stu-id="2bb50-152">However, this approach is a lot more complex if you want to deploy a database project rather than simply replicate an existing local database on a destination server.</span></span> <span data-ttu-id="2bb50-153">Můžete nakonfigurovat nasazení webu pro spuštění skriptu nasazení SQL, který generuje k databázovému projektu, ale pokud to chcete provést, musíte vytvořit vlastní soubor jako cíle pro váš projekt webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="2bb50-153">You can configure Web Deploy to run the SQL deployment script that the database project generates, but in order to do this, you need to create a custom WPP targets file for your web application project.</span></span> <span data-ttu-id="2bb50-154">Tento postup přidá vyžadovat značné množství složitost do procesu nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-154">This adds a substantial amount of complexity to the deployment process.</span></span> <span data-ttu-id="2bb50-155">Kromě toho Web Deploy přímo nepodporuje přírůstkové aktualizace existující databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-155">In addition, Web Deploy does not directly support incremental updates to existing databases.</span></span> <span data-ttu-id="2bb50-156">Další informace o tento přístup, najdete v části [rozšíření kanálu publikování webové do projektu balíček databáze nasazeném souboru SQL](https://go.microsoft.com/?linkid=9805121).</span><span class="sxs-lookup"><span data-stu-id="2bb50-156">For more information on this approach, see [Extending the Web Publishing Pipeline to package database project deployed SQL file](https://go.microsoft.com/?linkid=9805121).</span></span>
- <span data-ttu-id="2bb50-157">Můžete použít nástroj VSDBCMD pro nasazení databáze, pomocí schématu databáze nebo manifest nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-157">You can use the VSDBCMD utility to deploy the database, using either the database schema or the deployment manifest.</span></span> <span data-ttu-id="2bb50-158">VSDBCMD.exe můžete volat z nástroje MSBuild cíl, který vám umožňuje publikování databází v rámci procesu nasazení větší, pomocí skriptu.</span><span class="sxs-lookup"><span data-stu-id="2bb50-158">You can call VSDBCMD.exe from an MSBuild target, which lets you publish databases as part of a larger, scripted deployment process.</span></span> <span data-ttu-id="2bb50-159">Proměnné v souboru .sqlcmdvars a spoustu dalších vlastnosti databáze z VSDBCMD příkaz, který můžete vytvořit vlastní nastavení nasazení pro různá prostředí bez vytvoření konfigurací s více sestavení můžete přepsat.</span><span class="sxs-lookup"><span data-stu-id="2bb50-159">You can override the variables in your .sqlcmdvars file and lots of other database properties from a VSDBCMD command, which allows you to customize your deployment for different environments without creating multiple build configurations.</span></span> <span data-ttu-id="2bb50-160">VSDBCMD poskytuje rozdílů mezi funkce, což znamená, že budou pouze potřebné změny, chcete-li zarovnat cílové databáze s svého schématu databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-160">VSDBCMD provides differentiation functionality, which means it will make only the necessary changes to align a destination database with your database schema.</span></span> <span data-ttu-id="2bb50-161">VSDBCMD také nabízí širokou škálu možností příkazového řádku, které poskytují jemně odstupňovanou kontrolu nad procesu nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-161">VSDBCMD also offers a wide range of command-line options, which give you fine-grained control over the deployment process.</span></span>

<span data-ttu-id="2bb50-162">Z tohoto přehledu můžete zjistit, že pomocí nástroje MSBuild VSDBCMD je nejvhodnější pro použití v typické podnikové nasazení:</span><span class="sxs-lookup"><span data-stu-id="2bb50-162">From this overview, you can see that using VSDBCMD with MSBuild is the approach best suited to a typical enterprise deployment scenario:</span></span>

|  | <span data-ttu-id="2bb50-163">Visual Studio 2010</span><span class="sxs-lookup"><span data-stu-id="2bb50-163">Visual Studio 2010</span></span> | <span data-ttu-id="2bb50-164">Web Deploy 2.0</span><span class="sxs-lookup"><span data-stu-id="2bb50-164">Web Deploy 2.0</span></span> | <span data-ttu-id="2bb50-165">VSDBCMD.exe</span><span class="sxs-lookup"><span data-stu-id="2bb50-165">VSDBCMD.exe</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="2bb50-166">Podporuje vzdálené nasazení?</span><span class="sxs-lookup"><span data-stu-id="2bb50-166">Supports remote deployment?</span></span> | <span data-ttu-id="2bb50-167">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-167">Yes</span></span> | <span data-ttu-id="2bb50-168">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-168">Yes</span></span> | <span data-ttu-id="2bb50-169">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-169">Yes</span></span> |
| <span data-ttu-id="2bb50-170">Podporuje přírůstkové aktualizace?</span><span class="sxs-lookup"><span data-stu-id="2bb50-170">Supports incremental updates?</span></span> | <span data-ttu-id="2bb50-171">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-171">Yes</span></span> | <span data-ttu-id="2bb50-172">Ne</span><span class="sxs-lookup"><span data-stu-id="2bb50-172">No</span></span> | <span data-ttu-id="2bb50-173">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-173">Yes</span></span> |
| <span data-ttu-id="2bb50-174">Podporuje skripty před nebo po-deployment?</span><span class="sxs-lookup"><span data-stu-id="2bb50-174">Supports pre/post-deployment scripts?</span></span> | <span data-ttu-id="2bb50-175">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-175">Yes</span></span> | <span data-ttu-id="2bb50-176">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-176">Yes</span></span> | <span data-ttu-id="2bb50-177">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-177">Yes</span></span> |
| <span data-ttu-id="2bb50-178">Podporuje nasazení s více prostředí?</span><span class="sxs-lookup"><span data-stu-id="2bb50-178">Supports multi-environment deployment?</span></span> | <span data-ttu-id="2bb50-179">Omezené</span><span class="sxs-lookup"><span data-stu-id="2bb50-179">Limited</span></span> | <span data-ttu-id="2bb50-180">Omezené</span><span class="sxs-lookup"><span data-stu-id="2bb50-180">Limited</span></span> | <span data-ttu-id="2bb50-181">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-181">Yes</span></span> |
| <span data-ttu-id="2bb50-182">Podporuje skriptování nasazení?</span><span class="sxs-lookup"><span data-stu-id="2bb50-182">Supports scripted deployment?</span></span> | <span data-ttu-id="2bb50-183">Omezené</span><span class="sxs-lookup"><span data-stu-id="2bb50-183">Limited</span></span> | <span data-ttu-id="2bb50-184">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-184">Yes</span></span> | <span data-ttu-id="2bb50-185">Ano</span><span class="sxs-lookup"><span data-stu-id="2bb50-185">Yes</span></span> |

<span data-ttu-id="2bb50-186">Zbývající část tohoto tématu popisuje použití VSDBCMD pomocí nástroje MSBuild nasazení databázové projekty.</span><span class="sxs-lookup"><span data-stu-id="2bb50-186">The remainder of this topic describes the use of VSDBCMD with MSBuild to deploy database projects.</span></span>

## <a name="understanding-the-deployment-process"></a><span data-ttu-id="2bb50-187">Principy procesu nasazení</span><span class="sxs-lookup"><span data-stu-id="2bb50-187">Understanding the Deployment Process</span></span>

<span data-ttu-id="2bb50-188">Nástroj VSDBCMD umožňuje nasadit databázi pomocí schématu databáze (soubor .dbschema) nebo nasazení manifestu (soubor .deploymanifest).</span><span class="sxs-lookup"><span data-stu-id="2bb50-188">The VSDBCMD utility lets you deploy a database using either the database schema (the .dbschema file) or the deployment manifest (the .deploymanifest file).</span></span> <span data-ttu-id="2bb50-189">V praxi budete téměř vždy používat manifest nasazení jako manifest nasazení, můžete zadat výchozí hodnoty pro různé vlastnosti nasazení a identifikovat všechny před nasazením nebo po nasazení skripty SQL, které chcete spustit.</span><span class="sxs-lookup"><span data-stu-id="2bb50-189">In practice, you'll almost always use the deployment manifest, as the deployment manifest lets you provide default values for various deployment properties and identify any pre-deployment or post-deployment SQL scripts you want to run.</span></span> <span data-ttu-id="2bb50-190">Například tento příkaz VSDBCMD se používá k nasazení **ContactManager** databáze pro databázový server v testovacím prostředí:</span><span class="sxs-lookup"><span data-stu-id="2bb50-190">For example, this VSDBCMD command is used to deploy the **ContactManager** database to a database server in a test environment:</span></span>


[!code-console[Main](deploying-database-projects/samples/sample1.cmd)]


<span data-ttu-id="2bb50-191">V tomto případě:</span><span class="sxs-lookup"><span data-stu-id="2bb50-191">In this case:</span></span>

- <span data-ttu-id="2bb50-192">**/A** (nebo **/Action**) přepínač určuje, co chcete udělat VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="2bb50-192">The **/a** (or **/Action**) switch specifies what you want VSDBCMD to do.</span></span> <span data-ttu-id="2bb50-193">Můžete nastavit na **Import** nebo **nasadit**.</span><span class="sxs-lookup"><span data-stu-id="2bb50-193">You can set this to **Import** or **Deploy**.</span></span> <span data-ttu-id="2bb50-194">**Import** možnost se používá ke generování souboru .dbschema z existující databáze a **nasadit** možnost se používá k nasazení souboru .dbschema na cílovou databázi.</span><span class="sxs-lookup"><span data-stu-id="2bb50-194">The **Import** option is used to generate a .dbschema file from an existing database, and the **Deploy** option is used to deploy a .dbschema file to a target database.</span></span>
- <span data-ttu-id="2bb50-195">**/Manifest** (nebo **/ManifestFile**) přepínač identifikuje .deploymanifest soubor, který chcete nasadit.</span><span class="sxs-lookup"><span data-stu-id="2bb50-195">The **/manifest** (or **/ManifestFile**) switch identifies the .deploymanifest file you want to deploy.</span></span> <span data-ttu-id="2bb50-196">Pokud chcete místo toho použijte soubor .dbschema, byste použili **/modelu** (nebo **/ModelFile**) přepínače.</span><span class="sxs-lookup"><span data-stu-id="2bb50-196">If you wanted to use the .dbschema file instead, you'd use the **/model** (or **/ModelFile**) switch.</span></span>
- <span data-ttu-id="2bb50-197">**/Cs** (nebo **/ConnectionString**) přepínač poskytuje připojovací řetězec pro cílový server databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-197">The **/cs** (or **/ConnectionString**) switch provides the connection string for the target database server.</span></span> <span data-ttu-id="2bb50-198">Všimněte si, že to neobsahuje název databáze & #x 2014; VSDBCMD potřebuje připojit k serveru k vytvoření databáze; není třeba připojení k databázi jednotlivých.</span><span class="sxs-lookup"><span data-stu-id="2bb50-198">Note that this doesn't include the name of the database&#x2014;VSDBCMD needs to connect to the server to create the database; it doesn't need to connect to an individual database.</span></span> <span data-ttu-id="2bb50-199">Pokud vaše .deploymanifest soubor obsahuje připojovací řetězec, můžete vynechat tento přepínač.</span><span class="sxs-lookup"><span data-stu-id="2bb50-199">If your .deploymanifest file includes a connection string, you can omit this switch.</span></span> <span data-ttu-id="2bb50-200">Pokud chcete přesto použít přepínač, hodnota přepínače přepíše hodnotu .deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="2bb50-200">If you use the switch anyway, the switch value will override the .deploymanifest value.</span></span>
- <span data-ttu-id="2bb50-201">**/P:TargetDatabase** vlastnost poskytuje název, kterou chcete přiřadit k cílové databázi na vytvoření.</span><span class="sxs-lookup"><span data-stu-id="2bb50-201">The **/p:TargetDatabase** property provides the name you want to assign to the target database on creation.</span></span> <span data-ttu-id="2bb50-202">Přepíše hodnotu **TargetDatabase** vlastnost v souboru .deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="2bb50-202">This overrides the value of the **TargetDatabase** property in the .deploymanifest file.</span></span> <span data-ttu-id="2bb50-203">Můžete použít **/p:** *[název vlastnosti]*syntaxe nastavit celou řadu vlastností nasazení a přepsat všechny proměnné SQLCMD deklarován v souboru .sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="2bb50-203">You can use the **/p:** *[property name]*syntax to set a wide variety of deployment properties and to override any SQLCMD variables declared in your .sqlcmdvars file.</span></span>
- <span data-ttu-id="2bb50-204">**/Dd+** (nebo **/DeployToDatabase+**) přepínač označuje, že chcete vytvořit nasazení a nasadíte ho do cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="2bb50-204">The **/dd+** (or **/DeployToDatabase+**) switch indicates that you want to create a deployment and deploy it to the target environment.</span></span> <span data-ttu-id="2bb50-205">Pokud zadáte **/dd-**, nebo vynechejte přepínač, VSDBCMD vygeneruje skript nasazení, ale nebude nasazení na cílovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="2bb50-205">If you specify **/dd-**, or omit the switch, VSDBCMD will generate a deployment script but will not deploy it to the target environment.</span></span> <span data-ttu-id="2bb50-206">Tento přepínač je často zdroji záměny a je vysvětlené podrobněji v další části.</span><span class="sxs-lookup"><span data-stu-id="2bb50-206">This switch is often the source of confusion and is explained in more detail in the next section.</span></span>
- <span data-ttu-id="2bb50-207">**/Script** (nebo **/DeploymentScriptFile**) přepínač určuje, kde chcete vygenerovat skript nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-207">The **/script** (or **/DeploymentScriptFile**) switch specifies where you want to generate the deployment script.</span></span> <span data-ttu-id="2bb50-208">Tato hodnota nemá vliv na proces nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-208">This value does not affect the deployment process.</span></span>

<span data-ttu-id="2bb50-209">Další informace o VSDBCMD najdete v tématu [Reference k příkazovému řádku pro VSDBCMD. EXE (nasazení a Import schématu)](https://msdn.microsoft.com/en-us/library/dd193283.aspx) a [postupy: Příprava databáze pro nasazení z příkazového řádku pomocí VSDBCMD. EXE](https://msdn.microsoft.com/en-us/library/dd193258.aspx).</span><span class="sxs-lookup"><span data-stu-id="2bb50-209">For more information on VSDBCMD, see [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/en-us/library/dd193283.aspx) and [How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE](https://msdn.microsoft.com/en-us/library/dd193258.aspx).</span></span>

<span data-ttu-id="2bb50-210">Příklad použití VSDBCMD ze souboru projektu nástroje MSBuild, naleznete v části [Principy procesu sestavení](understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="2bb50-210">For an example of how you can use VSDBCMD from an MSBuild project file, see [Understanding the Build Process](understanding-the-build-process.md).</span></span> <span data-ttu-id="2bb50-211">Příklady, jak nakonfigurovat nastavení nasazení databáze pro prostředí s více najdete v tématu [přizpůsobení nasazení databáze pro prostředí s více](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="2bb50-211">For examples of how to configure database deployment settings for multiple environments, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="understanding-the-deploytodatabase-switch"></a><span data-ttu-id="2bb50-212">Seznámení s přepínačem DeployToDatabase</span><span class="sxs-lookup"><span data-stu-id="2bb50-212">Understanding the DeployToDatabase Switch</span></span>

<span data-ttu-id="2bb50-213">Chování **/dd** nebo **/DeployToDatabase** přepínač závisí na tom, jestli používáte VSDBCMD s .dbschema soubor nebo soubor .deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="2bb50-213">The behavior of the **/dd** or **/DeployToDatabase** switch depends on whether you're using VSDBCMD with a .dbschema file or a .deploymanifest file.</span></span> <span data-ttu-id="2bb50-214">Pokud používáte soubor .dbschema, toto chování je přímočará:</span><span class="sxs-lookup"><span data-stu-id="2bb50-214">If you're using a .dbschema file, the behavior is fairly straightforward:</span></span>

- <span data-ttu-id="2bb50-215">Pokud zadáte **/dd+** nebo **/dd**, VSDBCMD vygenerovat skript nasazení a nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-215">If you specify **/dd+** or **/dd**, VSDBCMD will generate a deployment script and deploy the database.</span></span>
- <span data-ttu-id="2bb50-216">Pokud zadáte **/dd-** nebo vynechejte přepínač, VSDBCMD vydá skript nasazení.</span><span class="sxs-lookup"><span data-stu-id="2bb50-216">If you specify **/dd-** or omit the switch, VSDBCMD will generate a deployment script only.</span></span>

<span data-ttu-id="2bb50-217">Pokud používáte soubor .deploymanifest, chování je mnohem složitější.</span><span class="sxs-lookup"><span data-stu-id="2bb50-217">If you're using a .deploymanifest file, the behavior is a lot more complicated.</span></span> <span data-ttu-id="2bb50-218">Důvodem je, že soubor .deploymanifest obsahuje název vlastnosti **DeployToDatabase** , také určuje, zda je nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-218">This is because the .deploymanifest file contains a property name **DeployToDatabase** that also determines whether the database is deployed.</span></span>


[!code-xml[Main](deploying-database-projects/samples/sample2.xml)]


<span data-ttu-id="2bb50-219">Hodnota této vlastnosti je nastavena podle vlastnosti k databázovému projektu.</span><span class="sxs-lookup"><span data-stu-id="2bb50-219">The value of this property is set according to the properties of the database project.</span></span> <span data-ttu-id="2bb50-220">Pokud nastavíte **nasazení akce** k **vytvořit skript nasazení (.sql)**, bude hodnota **False**.</span><span class="sxs-lookup"><span data-stu-id="2bb50-220">If you set the **Deploy action** to **Create a deployment script (.sql)**, the value will be **False**.</span></span> <span data-ttu-id="2bb50-221">Pokud nastavíte **nasazení akce** k **vytvořit skript nasazení (.sql) a nasadit do databáze**, bude hodnota **True**.</span><span class="sxs-lookup"><span data-stu-id="2bb50-221">If you set the **Deploy action** to **Create a deployment script (.sql) and deploy to the database**, the value will be **True**.</span></span>

> [!NOTE]
> <span data-ttu-id="2bb50-222">Tato nastavení jsou přidružené k určité sestavení konfigurace a platformy.</span><span class="sxs-lookup"><span data-stu-id="2bb50-222">These settings are associated with a specific build configuration and platform.</span></span> <span data-ttu-id="2bb50-223">Například pokud nakonfigurujete nastavení pro **ladění** konfigurace a pak publikovat pomocí **verze** konfigurace, nastavení se nepoužijí.</span><span class="sxs-lookup"><span data-stu-id="2bb50-223">For example, if you configure settings for the **Debug** configuration and then publish using the **Release** configuration, your settings will not be used.</span></span>


![](deploying-database-projects/_static/image3.png)

> [!NOTE]
> <span data-ttu-id="2bb50-224">V tomto scénáři **nasazení akce** musí být vždy nastavená na **vytvořit skript nasazení (.sql)**, protože nechcete, aby Visual Studio 2010 nasazení vaší databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-224">In this scenario, the **Deploy action** should always be set to **Create a deployment script (.sql)**, because you don't want Visual Studio 2010 to deploy your database.</span></span> <span data-ttu-id="2bb50-225">Jinými slovy **DeployToDatabase** vlastnost by měla být vždy **False**.</span><span class="sxs-lookup"><span data-stu-id="2bb50-225">In other words, the **DeployToDatabase** property should always be **False**.</span></span>


<span data-ttu-id="2bb50-226">Při **DeployToDatabase** vlastnost zadána, **/dd** přepínač pouze přepíše vlastnost, pokud je hodnota vlastnosti **false**:</span><span class="sxs-lookup"><span data-stu-id="2bb50-226">When a **DeployToDatabase** property is specified, the **/dd** switch will only override the property if the property value is **false**:</span></span>

- <span data-ttu-id="2bb50-227">Pokud **DeployToDatabase** vlastnost je **False**, a zadáte **/dd+** nebo **/dd**, přepíše VSDBCMD  **DeployToDatabase** vlastnost a nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-227">If the **DeployToDatabase** property is **False**, and you specify **/dd+** or **/dd**, VSDBCMD will override the **DeployToDatabase** property and deploy the database.</span></span>
- <span data-ttu-id="2bb50-228">Pokud **DeployToDatabase** vlastnost je **False**, a zadáte **/dd-** nebo vynechejte přepínači, nebudou VSDBCMD nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-228">If the **DeployToDatabase** property is **False**, and you specify **/dd-** or omit the switch, VSDBCMD will not deploy the database.</span></span>
- <span data-ttu-id="2bb50-229">Pokud **DeployToDatabase** vlastnost je **True**, VSDBCMD bude ignorovat přepínač a nasazení databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-229">If the **DeployToDatabase** property is **True**, VSDBCMD will ignore the switch and deploy the database.</span></span>
- <span data-ttu-id="2bb50-230">Skript nasazení se generuje v každém případě bez ohledu na to, jestli nasazujete také databáze.</span><span class="sxs-lookup"><span data-stu-id="2bb50-230">A deployment script is generated in each case, regardless of whether you're deploying the database as well.</span></span>

## <a name="conclusion"></a><span data-ttu-id="2bb50-231">Závěr</span><span class="sxs-lookup"><span data-stu-id="2bb50-231">Conclusion</span></span>

<span data-ttu-id="2bb50-232">Toto téma poskytuje přehled procesu sestavení a nasazení pro databázové projekty v sadě Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="2bb50-232">This topic provided an overview of the build and deployment process for database projects in Visual Studio 2010.</span></span> <span data-ttu-id="2bb50-233">Také popisuje, jak používat VSDBCMD.exe pomocí nástroje MSBuild pro podporu nasazení databáze podnikovém měřítku.</span><span class="sxs-lookup"><span data-stu-id="2bb50-233">It also described how you can use VSDBCMD.exe with MSBuild to support enterprise-scale database deployment.</span></span>

<span data-ttu-id="2bb50-234">Další informace o tom, jak to funguje v praxi, najdete v části [přizpůsobení nasazení databáze pro prostředí s více](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="2bb50-234">For more information on how this works in practice, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="further-reading"></a><span data-ttu-id="2bb50-235">Další čtení</span><span class="sxs-lookup"><span data-stu-id="2bb50-235">Further Reading</span></span>

<span data-ttu-id="2bb50-236">Informace o tom, jak přizpůsobit tak, že vytvoříte samostatné nasazení konfiguračního souboru pro jednotlivá prostředí nasazení databáze najdete v tématu [přizpůsobení nasazení databáze pro prostředí s více](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="2bb50-236">For information on how to customize database deployments by creating a separate deployment configuration file for each environment, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span> <span data-ttu-id="2bb50-237">Pokyny ke konfiguraci členství v rolích databáze spuštěním skriptu po nasazení najdete v tématu [nasazení členství Role databáze pro testovací prostředí](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span><span class="sxs-lookup"><span data-stu-id="2bb50-237">For guidance on how to configure database role memberships by running a post-deployment script, see [Deploying Database Role Memberships to Test Environments](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span></span> <span data-ttu-id="2bb50-238">Pokyny týkající se správy některé jedinečné výzvy členství databází chce použít, najdete v části [nasazení databáze členství v podnikových prostředích](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span><span class="sxs-lookup"><span data-stu-id="2bb50-238">For guidance on managing some of the unique challenges that membership databases impose, see [Deploying Membership Databases to Enterprise Environments](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span></span>

<span data-ttu-id="2bb50-239">Tato témata na webu MSDN poskytují širší pokyny a obecné informace o sadě Visual Studio databázové projekty a proces nasazení databáze:</span><span class="sxs-lookup"><span data-stu-id="2bb50-239">These topics on MSDN provide broader guidance and background information on Visual Studio database projects and the database deployment process:</span></span>

- [<span data-ttu-id="2bb50-240">Visual Studio 2010 SQL serveru databázové projekty</span><span class="sxs-lookup"><span data-stu-id="2bb50-240">Visual Studio 2010 SQL Server Database Projects</span></span>](https://msdn.microsoft.com/en-us/library/ff678491.aspx)
- [<span data-ttu-id="2bb50-241">Správa změn databáze</span><span class="sxs-lookup"><span data-stu-id="2bb50-241">Managing Database Change</span></span>](https://msdn.microsoft.com/en-us/library/aa833404.aspx)
- [<span data-ttu-id="2bb50-242">Postupy: Příprava databáze pro nasazení z příkazového řádku pomocí VSDBCMD. SOUBOR EXE</span><span class="sxs-lookup"><span data-stu-id="2bb50-242">How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE</span></span>](https://msdn.microsoft.com/en-us/library/dd193258.aspx)
- [<span data-ttu-id="2bb50-243">Přehled databáze sestavení a nasazení</span><span class="sxs-lookup"><span data-stu-id="2bb50-243">An Overview of Database Build and Deployment</span></span>](https://msdn.microsoft.com/en-us/library/aa833165.aspx)

>[!div class="step-by-step"]
<span data-ttu-id="2bb50-244">[Předchozí](deploying-web-packages.md)
[další](creating-and-running-a-deployment-command-file.md)</span><span class="sxs-lookup"><span data-stu-id="2bb50-244">[Previous](deploying-web-packages.md)
[Next](creating-and-running-a-deployment-command-file.md)</span></span>
