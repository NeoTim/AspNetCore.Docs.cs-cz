---
title: "Řešení potíží s ASP.NET Core ve službě IIS"
author: guardrex
description: "Zjistěte, jak diagnostikovat problémy s IIS nasazení aplikací ASP.NET Core."
ms.author: riande
manager: wpickett
ms.custom: mvc
ms.date: 03/13/2017
ms.topic: article
ms.technology: aspnet
ms.prod: asp.net-core
uid: host-and-deploy/iis/troubleshoot
ms.openlocfilehash: 2e42d5904e2be8c031c5c6d4bbc104a251b699f2
ms.sourcegitcommit: 12e5194936b7e820efc5505a2d5d4f84e88eb5ef
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/11/2018
---
# <a name="troubleshoot-aspnet-core-on-iis"></a><span data-ttu-id="882cf-103">Řešení potíží s ASP.NET Core ve službě IIS</span><span class="sxs-lookup"><span data-stu-id="882cf-103">Troubleshoot ASP.NET Core on IIS</span></span>

<span data-ttu-id="882cf-104">Podle [Luke Latham](https://github.com/guardrex)</span><span class="sxs-lookup"><span data-stu-id="882cf-104">By [Luke Latham](https://github.com/guardrex)</span></span>

<span data-ttu-id="882cf-105">O vyřešení problémů s nasazením služby IIS:</span><span class="sxs-lookup"><span data-stu-id="882cf-105">To diagnose issues with IIS deployments:</span></span>

* <span data-ttu-id="882cf-106">Studie výstup prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="882cf-106">Study browser output.</span></span>
* <span data-ttu-id="882cf-107">Zkontrolovat, zda systém **aplikace** protokolu prostřednictvím **Prohlížeč událostí**.</span><span class="sxs-lookup"><span data-stu-id="882cf-107">Examine the system's **Application** log through **Event Viewer**.</span></span>
* <span data-ttu-id="882cf-108">Povolit `stdout` protokolování.</span><span class="sxs-lookup"><span data-stu-id="882cf-108">Enable `stdout` logging.</span></span> <span data-ttu-id="882cf-109">**ASP.NET Core modulu** protokolu nachází na v zadané cestě *stdoutLogFile* atribut `<aspNetCore>` element v *web.config*. Všechny složky v cestě uvedené v hodnotě atributu musí existovat v nasazení.</span><span class="sxs-lookup"><span data-stu-id="882cf-109">The **ASP.NET Core Module** log is found on the path provided in the *stdoutLogFile* attribute of the `<aspNetCore>` element in *web.config*. Any folders on the path provided in the attribute value must exist in the deployment.</span></span> <span data-ttu-id="882cf-110">Nastavit *stdoutLogEnabled* k `true`.</span><span class="sxs-lookup"><span data-stu-id="882cf-110">Set *stdoutLogEnabled* to `true`.</span></span> <span data-ttu-id="882cf-111">Aplikace, které používají `Microsoft.NET.Sdk.Web` SDK k vytvoření *web.config* souboru výchozí *stdoutLogEnabled* nastavení `false`, takže ručně, zadejte *web.config* souboru nebo upravte soubor. Chcete-li povolit `stdout` protokolování.</span><span class="sxs-lookup"><span data-stu-id="882cf-111">Apps that use the the `Microsoft.NET.Sdk.Web` SDK to create the *web.config* file default the *stdoutLogEnabled* setting to `false`, so manually provide the *web.config* file or modify the file in order to enable `stdout` logging.</span></span>

<span data-ttu-id="882cf-112">Použijte informace z těchto tří zdrojů s [běžné chyby referenční téma](xref:host-and-deploy/azure-iis-errors-reference) ke zjištění problému.</span><span class="sxs-lookup"><span data-stu-id="882cf-112">Use information from those three sources with the [common errors reference topic](xref:host-and-deploy/azure-iis-errors-reference) to determine the problem.</span></span> <span data-ttu-id="882cf-113">Postupujte podle pomoc při řešení potíží poskytuje k vyřešení problému.</span><span class="sxs-lookup"><span data-stu-id="882cf-113">Follow the troubleshooting advice provided to resolve the issue.</span></span>

<span data-ttu-id="882cf-114">Několik běžných chyb, dokud modul nezobrazí v prohlížeči, protokolu aplikace a ASP.NET Core modulu protokolu *startupTimeLimit* (výchozí: 120 sekundách) a *startupRetryCount* (výchozí: 2) byly splněny.</span><span class="sxs-lookup"><span data-stu-id="882cf-114">Several of the common errors don't appear in the browser, Application Log, and ASP.NET Core Module Log until the module *startupTimeLimit* (default: 120 seconds) and *startupRetryCount* (default: 2) have passed.</span></span> <span data-ttu-id="882cf-115">Proto počkejte úplné šest minut před deducing které modulu se nepodařilo spustit proces pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="882cf-115">Therefore, wait a full six minutes before deducing that the module has failed to start a process for the app.</span></span>

<span data-ttu-id="882cf-116">A spusťte aplikaci přímo na Kestrel je jeden rychlý způsob, jak zjistit, zda aplikace funguje správně.</span><span class="sxs-lookup"><span data-stu-id="882cf-116">One quick way to determine if the app is working properly is to run the app directly on Kestrel.</span></span> <span data-ttu-id="882cf-117">Pokud aplikace byl publikován jako [nasazení závislé na framework](/dotnet/core/deploying/#framework-dependent-deployments-fdd), provést `dotnet <assembly_name>.dll` ve složce nasazení, což je fyzická cesta k aplikaci služby IIS.</span><span class="sxs-lookup"><span data-stu-id="882cf-117">If the app was published as a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd), execute `dotnet <assembly_name>.dll` in the deployment folder, which is the IIS physical path to the app.</span></span> <span data-ttu-id="882cf-118">Pokud aplikace byl publikován jako [samostatná nasazení](/dotnet/core/deploying/#self-contained-deployments-scd)spusťte aplikaci je spustitelný soubor přímo z příkazového řádku, `<assembly_name>.exe`, ve složce nasazení.</span><span class="sxs-lookup"><span data-stu-id="882cf-118">If the app was published as a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd), run the app's executable directly from a command prompt, `<assembly_name>.exe`, in the deployment folder.</span></span> <span data-ttu-id="882cf-119">Pokud Kestrel naslouchá na výchozí port 5000, aplikace by měly být dostupné v `http://localhost:5000/`.</span><span class="sxs-lookup"><span data-stu-id="882cf-119">If Kestrel is listening on default port 5000, the app should be available at `http://localhost:5000/`.</span></span> <span data-ttu-id="882cf-120">Pokud aplikace odpovídá za normálních okolností na adrese Kestrel koncový bod, problém je pravděpodobnější související s konfigurací reverzní proxy server a méně pravděpodobně v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="882cf-120">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the reverse proxy configuration and less likely within the app.</span></span>

<span data-ttu-id="882cf-121">Jeden způsob jak určit, jestli je správně funguje reverzní proxy server je provést žádost o jednoduché statických souborů pro šablony stylů, skript nebo bitovou kopii z aplikace statické soubory v *wwwroot* pomocí [Middleware statické soubory](xref:fundamentals/static-files).</span><span class="sxs-lookup"><span data-stu-id="882cf-121">One way to determine if the reverse proxy is working properly is to perform a simple static file request for a stylesheet, script, or image from the app's static files in *wwwroot* using [Static File Middleware](xref:fundamentals/static-files).</span></span> <span data-ttu-id="882cf-122">Pokud aplikace může obsluhovat statické soubory, ale další koncové body a zobrazení MVC selhávají, problém je méně pravděpodobné týkající se konfigurace reverzní proxy server a vyšší pravděpodobnost v rámci aplikace (pro příklad směrování MVC nebo 500 – Vnitřní chyba serveru).</span><span class="sxs-lookup"><span data-stu-id="882cf-122">If the app can serve static files but MVC Views and other endpoints are failing, the problem is less likely related to the reverse proxy configuration and more likely within the app (for example, MVC routing or 500 Internal Server Error).</span></span>

<span data-ttu-id="882cf-123">Pokud Kestrel spustí běžným způsobem za služby IIS, ale aplikace se nespustí v systému po úspěšném spuštění místně, proměnné prostředí můžete dočasně zařadí do *web.config* nastavit `ASPNETCORE_ENVIRONMENT` k `Development`.</span><span class="sxs-lookup"><span data-stu-id="882cf-123">When Kestrel starts normally behind IIS but the app won't run on the system after successfully running locally, an environment variable can be temporarily added to *web.config* to set the `ASPNETCORE_ENVIRONMENT` to `Development`.</span></span> <span data-ttu-id="882cf-124">Tak dlouho, dokud prostředí není přepsána ve spuštění aplikace, nastavení proměnné prostředí umožňuje [vývojáře výjimka stránky](xref:fundamentals/error-handling) zobrazí při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="882cf-124">As long as the environment isn't overridden in app startup, setting the environment variable allows the [developer exception page](xref:fundamentals/error-handling) to appear when the app is run.</span></span> <span data-ttu-id="882cf-125">Nastavení proměnné prostředí pro `ASPNETCORE_ENVIRONMENT` tímto způsobem doporučujeme pouze pro testování nebo pracovní servery, které nejsou vystaveny k Internetu.</span><span class="sxs-lookup"><span data-stu-id="882cf-125">Setting the environment variable for `ASPNETCORE_ENVIRONMENT` in this way is only recommended for staging/testing servers that aren't exposed to the Internet.</span></span> <span data-ttu-id="882cf-126">Nezapomeňte odebrat proměnnou prostředí z *web.config* souboru po dokončení.</span><span class="sxs-lookup"><span data-stu-id="882cf-126">Be sure to remove the environment variable from the *web.config* file when finished.</span></span> <span data-ttu-id="882cf-127">Informace o nastavení proměnné prostředí prostřednictvím *web.config*, najdete v části [environmentVariables podřízený element aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span><span class="sxs-lookup"><span data-stu-id="882cf-127">For information on setting environment variables via *web.config*, see [environmentVariables child element of aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span></span>

<span data-ttu-id="882cf-128">Ve většině případů povolení protokolování aplikací pomáhá při řešení potíží s aplikací nebo reverzní proxy server.</span><span class="sxs-lookup"><span data-stu-id="882cf-128">In most cases, enabling application logging assists in troubleshooting problems with the app or the reverse proxy.</span></span> <span data-ttu-id="882cf-129">V tématu [protokolování](xref:fundamentals/logging/index) Další informace.</span><span class="sxs-lookup"><span data-stu-id="882cf-129">See [Logging](xref:fundamentals/logging/index) for more information.</span></span>

<span data-ttu-id="882cf-130">Poslední tip pro odstraňování potíží se vztahují k aplikacím, které se nepodařilo spustit po upgradu buď .NET Core SDK na vývoj pro počítače nebo balíček verze v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="882cf-130">The last troubleshooting tip pertains to apps that fail to run after upgrading either the .NET Core SDK on the development machine or package versions within the app.</span></span> <span data-ttu-id="882cf-131">V některých případech je možné osamocené balíčky ukončit aplikaci při provádění hlavních aktualizací.</span><span class="sxs-lookup"><span data-stu-id="882cf-131">In some cases, incoherent packages may break an app when performing major upgrades.</span></span> <span data-ttu-id="882cf-132">Většina těchto problémů je možné vyřešit:</span><span class="sxs-lookup"><span data-stu-id="882cf-132">Most of these issues can be fixed by:</span></span>

* <span data-ttu-id="882cf-133">Odstraňování `bin` a `obj` složek v projektu.</span><span class="sxs-lookup"><span data-stu-id="882cf-133">Deleting the `bin` and `obj` folders in the project.</span></span>
* <span data-ttu-id="882cf-134">Probíhá vymazání balíček ukládá do mezipaměti na `%UserProfile%\.nuget\packages\` a `%LocalAppData%\Nuget\v3-cache`.</span><span class="sxs-lookup"><span data-stu-id="882cf-134">Clearing package caches at `%UserProfile%\.nuget\packages\` and `%LocalAppData%\Nuget\v3-cache`.</span></span>
* <span data-ttu-id="882cf-135">Obnovení a projekt znovu sestavit.</span><span class="sxs-lookup"><span data-stu-id="882cf-135">Restoring and rebuilding the project.</span></span>
* <span data-ttu-id="882cf-136">Potvrzení, že předchozí nasazení na serveru úplně odstranit před novým nasazením aplikace.</span><span class="sxs-lookup"><span data-stu-id="882cf-136">Confirming that the prior deployment on the server has been completely deleted prior to re-deploying the app.</span></span>

> [!TIP]
> <span data-ttu-id="882cf-137">Je spuštění vhodný způsob k vymazání mezipamětí balíček `dotnet nuget locals all --clear` z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="882cf-137">A convenient way to clear package caches is to execute `dotnet nuget locals all --clear` from a command prompt.</span></span>
> 
> <span data-ttu-id="882cf-138">Vymazání mezipaměti balíčku můžete také provést pomocí [nuget.exe](https://www.nuget.org/downloads) nástroj a provádění příkazu `nuget locals all -clear`.</span><span class="sxs-lookup"><span data-stu-id="882cf-138">Clearing package caches can also be accomplished by using the [nuget.exe](https://www.nuget.org/downloads) tool and executing the command `nuget locals all -clear`.</span></span> <span data-ttu-id="882cf-139">*nuget.exe* není připojené instalace s Windows 10 a musí být samostatně získat z webu NuGet.</span><span class="sxs-lookup"><span data-stu-id="882cf-139">*nuget.exe* isn't a bundled install with Windows 10 and must be obtained separately from the NuGet website.</span></span>
<!--
> [!TIP]
> A convenient way to clear package caches is to:
>
> * Obtain the *NuGet.exe* tool from [NuGet.org](https://www.nuget.org/).
> * Add the path to *NuGet.exe* to the system PATH.
> * Execute `nuget locals all -clear` from a command prompt.
>
> Alternatively, execute `dotnet nuget locals all --clear` from a command prompt without obtaining *NuGet.exe*. -->

## <a name="additional-resources"></a><span data-ttu-id="882cf-140">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="882cf-140">Additional resources</span></span>

* [<span data-ttu-id="882cf-141">Běžné chyby referenční dokumentace pro Azure App Service a IIS s ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="882cf-141">Common errors reference for Azure App Service and IIS with ASP.NET Core</span></span>](xref:host-and-deploy/azure-iis-errors-reference)
* [<span data-ttu-id="882cf-142">Odkaz na konfiguraci základní modul ASP.NET</span><span class="sxs-lookup"><span data-stu-id="882cf-142">ASP.NET Core Module configuration reference</span></span>](xref:host-and-deploy/aspnet-core-module)
